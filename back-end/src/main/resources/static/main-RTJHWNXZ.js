var T9=Object.create;var fh=Object.defineProperty,F9=Object.defineProperties,B9=Object.getOwnPropertyDescriptor,I9=Object.getOwnPropertyDescriptors,P9=Object.getOwnPropertyNames,ky=Object.getOwnPropertySymbols,R9=Object.getPrototypeOf,Ly=Object.prototype.hasOwnProperty,O9=Object.prototype.propertyIsEnumerable;var Ny=(i,e,t)=>e in i?fh(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Me=(i,e)=>{for(var t in e||={})Ly.call(e,t)&&Ny(i,t,e[t]);if(ky)for(var t of ky(e))O9.call(e,t)&&Ny(i,t,e[t]);return i},on=(i,e)=>F9(i,I9(e));var Uy=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),k9=(i,e)=>{for(var t in e)fh(i,t,{get:e[t],enumerable:!0})},N9=(i,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of P9(e))!Ly.call(i,r)&&r!==t&&fh(i,r,{get:()=>e[r],enumerable:!(n=B9(e,r))||n.enumerable});return i};var Vy=(i,e,t)=>(t=i!=null?T9(R9(i)):{},N9(e||!i||!i.__esModule?fh(t,"default",{value:i,enumerable:!0}):t,i));var He=(i,e,t)=>new Promise((n,r)=>{var s=c=>{try{a(t.next(c))}catch(l){r(l)}},o=c=>{try{a(t.throw(c))}catch(l){r(l)}},a=c=>c.done?n(c.value):Promise.resolve(c.value).then(s,o);a((t=t.apply(i,e)).next())});var f9=Uy((lh,Sy)=>{"use strict";(function(e,t){typeof lh=="object"&&typeof Sy=="object"?Sy.exports=t():typeof define=="function"&&define.amd?define([],t):typeof lh=="object"?lh.jsQR=t():e.jsQR=t()})(typeof self<"u"?self:lh,function(){return function(i){var e={};function t(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return i[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}return t.m=i,t.c=e,t.d=function(n,r,s){t.o(n,r)||Object.defineProperty(n,r,{configurable:!1,enumerable:!0,get:s})},t.n=function(n){var r=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(r,"a",r),r},t.o=function(n,r){return Object.prototype.hasOwnProperty.call(n,r)},t.p="",t(t.s=3)}([function(i,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function r(s,o){this.width=o,this.height=s.length/o,this.data=s}return r.createEmpty=function(s,o){return new r(new Uint8ClampedArray(s*o),s)},r.prototype.get=function(s,o){return s<0||s>=this.width||o<0||o>=this.height?!1:!!this.data[o*this.width+s]},r.prototype.set=function(s,o,a){this.data[o*this.width+s]=a?1:0},r.prototype.setRegion=function(s,o,a,c,l){for(var u=o;u<o+c;u++)for(var h=s;h<s+a;h++)this.set(h,u,!!l)},r}();e.BitMatrix=n},function(i,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=t(2);function r(o,a){return o^a}e.addOrSubtractGF=r;var s=function(){function o(a,c,l){this.primitive=a,this.size=c,this.generatorBase=l,this.expTable=new Array(this.size),this.logTable=new Array(this.size);for(var u=1,h=0;h<this.size;h++)this.expTable[h]=u,u=u*2,u>=this.size&&(u=(u^this.primitive)&this.size-1);for(var h=0;h<this.size-1;h++)this.logTable[this.expTable[h]]=h;this.zero=new n.default(this,Uint8ClampedArray.from([0])),this.one=new n.default(this,Uint8ClampedArray.from([1]))}return o.prototype.multiply=function(a,c){return a===0||c===0?0:this.expTable[(this.logTable[a]+this.logTable[c])%(this.size-1)]},o.prototype.inverse=function(a){if(a===0)throw new Error("Can't invert 0");return this.expTable[this.size-this.logTable[a]-1]},o.prototype.buildMonomial=function(a,c){if(a<0)throw new Error("Invalid monomial degree less than 0");if(c===0)return this.zero;var l=new Uint8ClampedArray(a+1);return l[0]=c,new n.default(this,l)},o.prototype.log=function(a){if(a===0)throw new Error("Can't take log(0)");return this.logTable[a]},o.prototype.exp=function(a){return this.expTable[a]},o}();e.default=s},function(i,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=t(1),r=function(){function s(o,a){if(a.length===0)throw new Error("No coefficients.");this.field=o;var c=a.length;if(c>1&&a[0]===0){for(var l=1;l<c&&a[l]===0;)l++;if(l===c)this.coefficients=o.zero.coefficients;else{this.coefficients=new Uint8ClampedArray(c-l);for(var u=0;u<this.coefficients.length;u++)this.coefficients[u]=a[l+u]}}else this.coefficients=a}return s.prototype.degree=function(){return this.coefficients.length-1},s.prototype.isZero=function(){return this.coefficients[0]===0},s.prototype.getCoefficient=function(o){return this.coefficients[this.coefficients.length-1-o]},s.prototype.addOrSubtract=function(o){var a;if(this.isZero())return o;if(o.isZero())return this;var c=this.coefficients,l=o.coefficients;c.length>l.length&&(a=[l,c],c=a[0],l=a[1]);for(var u=new Uint8ClampedArray(l.length),h=l.length-c.length,d=0;d<h;d++)u[d]=l[d];for(var d=h;d<l.length;d++)u[d]=n.addOrSubtractGF(c[d-h],l[d]);return new s(this.field,u)},s.prototype.multiply=function(o){if(o===0)return this.field.zero;if(o===1)return this;for(var a=this.coefficients.length,c=new Uint8ClampedArray(a),l=0;l<a;l++)c[l]=this.field.multiply(this.coefficients[l],o);return new s(this.field,c)},s.prototype.multiplyPoly=function(o){if(this.isZero()||o.isZero())return this.field.zero;for(var a=this.coefficients,c=a.length,l=o.coefficients,u=l.length,h=new Uint8ClampedArray(c+u-1),d=0;d<c;d++)for(var f=a[d],x=0;x<u;x++)h[d+x]=n.addOrSubtractGF(h[d+x],this.field.multiply(f,l[x]));return new s(this.field,h)},s.prototype.multiplyByMonomial=function(o,a){if(o<0)throw new Error("Invalid degree less than 0");if(a===0)return this.field.zero;for(var c=this.coefficients.length,l=new Uint8ClampedArray(c+o),u=0;u<c;u++)l[u]=this.field.multiply(this.coefficients[u],a);return new s(this.field,l)},s.prototype.evaluateAt=function(o){var a=0;if(o===0)return this.getCoefficient(0);var c=this.coefficients.length;if(o===1)return this.coefficients.forEach(function(u){a=n.addOrSubtractGF(a,u)}),a;a=this.coefficients[0];for(var l=1;l<c;l++)a=n.addOrSubtractGF(this.field.multiply(o,a),this.coefficients[l]);return a},s}();e.default=r},function(i,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=t(4),r=t(5),s=t(11),o=t(12);function a(u){var h=o.locate(u);if(!h)return null;for(var d=0,f=h;d<f.length;d++){var x=f[d],g=s.extract(u,x),p=r.decode(g.matrix);if(p)return{binaryData:p.bytes,data:p.text,chunks:p.chunks,version:p.version,location:{topRightCorner:g.mappingFunction(x.dimension,0),topLeftCorner:g.mappingFunction(0,0),bottomRightCorner:g.mappingFunction(x.dimension,x.dimension),bottomLeftCorner:g.mappingFunction(0,x.dimension),topRightFinderPattern:x.topRight,topLeftFinderPattern:x.topLeft,bottomLeftFinderPattern:x.bottomLeft,bottomRightAlignmentPattern:x.alignmentPattern}}}return null}var c={inversionAttempts:"attemptBoth"};function l(u,h,d,f){f===void 0&&(f={});var x=c;Object.keys(x||{}).forEach(function(w){x[w]=f[w]||x[w]});var g=x.inversionAttempts==="attemptBoth"||x.inversionAttempts==="invertFirst",p=x.inversionAttempts==="onlyInvert"||x.inversionAttempts==="invertFirst",m=n.binarize(u,h,d,g),v=m.binarized,E=m.inverted,y=a(p?E:v);return!y&&(x.inversionAttempts==="attemptBoth"||x.inversionAttempts==="invertFirst")&&(y=a(p?v:E)),y}l.default=l,e.default=l},function(i,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=t(0),r=8,s=24;function o(l,u,h){return l<u?u:l>h?h:l}var a=function(){function l(u,h){this.width=u,this.data=new Uint8ClampedArray(u*h)}return l.prototype.get=function(u,h){return this.data[h*this.width+u]},l.prototype.set=function(u,h,d){this.data[h*this.width+u]=d},l}();function c(l,u,h,d){if(l.length!==u*h*4)throw new Error("Malformed data passed to binarizer.");for(var f=new a(u,h),x=0;x<u;x++)for(var g=0;g<h;g++){var p=l[(g*u+x)*4+0],m=l[(g*u+x)*4+1],v=l[(g*u+x)*4+2];f.set(x,g,.2126*p+.7152*m+.0722*v)}for(var E=Math.ceil(u/r),y=Math.ceil(h/r),w=new a(E,y),A=0;A<y;A++)for(var b=0;b<E;b++){for(var D=0,C=1/0,_=0,g=0;g<r;g++)for(var x=0;x<r;x++){var M=f.get(b*r+x,A*r+g);D+=M,C=Math.min(C,M),_=Math.max(_,M)}var B=D/Math.pow(r,2);if(_-C<=s&&(B=C/2,A>0&&b>0)){var F=(w.get(b,A-1)+2*w.get(b-1,A)+w.get(b-1,A-1))/4;C<F&&(B=F)}w.set(b,A,B)}var N=n.BitMatrix.createEmpty(u,h),L=null;d&&(L=n.BitMatrix.createEmpty(u,h));for(var A=0;A<y;A++)for(var b=0;b<E;b++){for(var Z=o(b,2,E-3),Q=o(A,2,y-3),D=0,j=-2;j<=2;j++)for(var W=-2;W<=2;W++)D+=w.get(Z+j,Q+W);for(var ie=D/25,j=0;j<r;j++)for(var W=0;W<r;W++){var x=b*r+j,g=A*r+W,ue=f.get(x,g);N.set(x,g,ue<=ie),d&&L.set(x,g,!(ue<=ie))}}return d?{binarized:N,inverted:L}:{binarized:N}}e.binarize=c},function(i,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=t(0),r=t(6),s=t(9),o=t(10);function a(v,E){for(var y=v^E,w=0;y;)w++,y&=y-1;return w}function c(v,E){return E<<1|v}var l=[{bits:21522,formatInfo:{errorCorrectionLevel:1,dataMask:0}},{bits:20773,formatInfo:{errorCorrectionLevel:1,dataMask:1}},{bits:24188,formatInfo:{errorCorrectionLevel:1,dataMask:2}},{bits:23371,formatInfo:{errorCorrectionLevel:1,dataMask:3}},{bits:17913,formatInfo:{errorCorrectionLevel:1,dataMask:4}},{bits:16590,formatInfo:{errorCorrectionLevel:1,dataMask:5}},{bits:20375,formatInfo:{errorCorrectionLevel:1,dataMask:6}},{bits:19104,formatInfo:{errorCorrectionLevel:1,dataMask:7}},{bits:30660,formatInfo:{errorCorrectionLevel:0,dataMask:0}},{bits:29427,formatInfo:{errorCorrectionLevel:0,dataMask:1}},{bits:32170,formatInfo:{errorCorrectionLevel:0,dataMask:2}},{bits:30877,formatInfo:{errorCorrectionLevel:0,dataMask:3}},{bits:26159,formatInfo:{errorCorrectionLevel:0,dataMask:4}},{bits:25368,formatInfo:{errorCorrectionLevel:0,dataMask:5}},{bits:27713,formatInfo:{errorCorrectionLevel:0,dataMask:6}},{bits:26998,formatInfo:{errorCorrectionLevel:0,dataMask:7}},{bits:5769,formatInfo:{errorCorrectionLevel:3,dataMask:0}},{bits:5054,formatInfo:{errorCorrectionLevel:3,dataMask:1}},{bits:7399,formatInfo:{errorCorrectionLevel:3,dataMask:2}},{bits:6608,formatInfo:{errorCorrectionLevel:3,dataMask:3}},{bits:1890,formatInfo:{errorCorrectionLevel:3,dataMask:4}},{bits:597,formatInfo:{errorCorrectionLevel:3,dataMask:5}},{bits:3340,formatInfo:{errorCorrectionLevel:3,dataMask:6}},{bits:2107,formatInfo:{errorCorrectionLevel:3,dataMask:7}},{bits:13663,formatInfo:{errorCorrectionLevel:2,dataMask:0}},{bits:12392,formatInfo:{errorCorrectionLevel:2,dataMask:1}},{bits:16177,formatInfo:{errorCorrectionLevel:2,dataMask:2}},{bits:14854,formatInfo:{errorCorrectionLevel:2,dataMask:3}},{bits:9396,formatInfo:{errorCorrectionLevel:2,dataMask:4}},{bits:8579,formatInfo:{errorCorrectionLevel:2,dataMask:5}},{bits:11994,formatInfo:{errorCorrectionLevel:2,dataMask:6}},{bits:11245,formatInfo:{errorCorrectionLevel:2,dataMask:7}}],u=[function(v){return(v.y+v.x)%2===0},function(v){return v.y%2===0},function(v){return v.x%3===0},function(v){return(v.y+v.x)%3===0},function(v){return(Math.floor(v.y/2)+Math.floor(v.x/3))%2===0},function(v){return v.x*v.y%2+v.x*v.y%3===0},function(v){return(v.y*v.x%2+v.y*v.x%3)%2===0},function(v){return((v.y+v.x)%2+v.y*v.x%3)%2===0}];function h(v){var E=17+4*v.versionNumber,y=n.BitMatrix.createEmpty(E,E);y.setRegion(0,0,9,9,!0),y.setRegion(E-8,0,8,9,!0),y.setRegion(0,E-8,9,8,!0);for(var w=0,A=v.alignmentPatternCenters;w<A.length;w++)for(var b=A[w],D=0,C=v.alignmentPatternCenters;D<C.length;D++){var _=C[D];b===6&&_===6||b===6&&_===E-7||b===E-7&&_===6||y.setRegion(b-2,_-2,5,5,!0)}return y.setRegion(6,9,1,E-17,!0),y.setRegion(9,6,E-17,1,!0),v.versionNumber>6&&(y.setRegion(E-11,0,3,6,!0),y.setRegion(0,E-11,6,3,!0)),y}function d(v,E,y){for(var w=u[y.dataMask],A=v.height,b=h(E),D=[],C=0,_=0,M=!0,B=A-1;B>0;B-=2){B===6&&B--;for(var F=0;F<A;F++)for(var N=M?A-1-F:F,L=0;L<2;L++){var Z=B-L;if(!b.get(Z,N)){_++;var Q=v.get(Z,N);w({y:N,x:Z})&&(Q=!Q),C=c(Q,C),_===8&&(D.push(C),_=0,C=0)}}M=!M}return D}function f(v){var E=v.height,y=Math.floor((E-17)/4);if(y<=6)return o.VERSIONS[y-1];for(var w=0,A=5;A>=0;A--)for(var b=E-9;b>=E-11;b--)w=c(v.get(b,A),w);for(var D=0,b=5;b>=0;b--)for(var A=E-9;A>=E-11;A--)D=c(v.get(b,A),D);for(var C=1/0,_,M=0,B=o.VERSIONS;M<B.length;M++){var F=B[M];if(F.infoBits===w||F.infoBits===D)return F;var N=a(w,F.infoBits);N<C&&(_=F,C=N),N=a(D,F.infoBits),N<C&&(_=F,C=N)}if(C<=3)return _}function x(v){for(var E=0,y=0;y<=8;y++)y!==6&&(E=c(v.get(y,8),E));for(var w=7;w>=0;w--)w!==6&&(E=c(v.get(8,w),E));for(var A=v.height,b=0,w=A-1;w>=A-7;w--)b=c(v.get(8,w),b);for(var y=A-8;y<A;y++)b=c(v.get(y,8),b);for(var D=1/0,C=null,_=0,M=l;_<M.length;_++){var B=M[_],F=B.bits,N=B.formatInfo;if(F===E||F===b)return N;var L=a(E,F);L<D&&(C=N,D=L),E!==b&&(L=a(b,F),L<D&&(C=N,D=L))}return D<=3?C:null}function g(v,E,y){var w=E.errorCorrectionLevels[y],A=[],b=0;if(w.ecBlocks.forEach(function(Q){for(var j=0;j<Q.numBlocks;j++)A.push({numDataCodewords:Q.dataCodewordsPerBlock,codewords:[]}),b+=Q.dataCodewordsPerBlock+w.ecCodewordsPerBlock}),v.length<b)return null;v=v.slice(0,b);for(var D=w.ecBlocks[0].dataCodewordsPerBlock,C=0;C<D;C++)for(var _=0,M=A;_<M.length;_++){var B=M[_];B.codewords.push(v.shift())}if(w.ecBlocks.length>1)for(var F=w.ecBlocks[0].numBlocks,N=w.ecBlocks[1].numBlocks,C=0;C<N;C++)A[F+C].codewords.push(v.shift());for(;v.length>0;)for(var L=0,Z=A;L<Z.length;L++){var B=Z[L];B.codewords.push(v.shift())}return A}function p(v){var E=f(v);if(!E)return null;var y=x(v);if(!y)return null;var w=d(v,E,y),A=g(w,E,y.errorCorrectionLevel);if(!A)return null;for(var b=A.reduce(function(L,Z){return L+Z.numDataCodewords},0),D=new Uint8ClampedArray(b),C=0,_=0,M=A;_<M.length;_++){var B=M[_],F=s.decode(B.codewords,B.codewords.length-B.numDataCodewords);if(!F)return null;for(var N=0;N<B.numDataCodewords;N++)D[C++]=F[N]}try{return r.decode(D,E.versionNumber)}catch{return null}}function m(v){if(v==null)return null;var E=p(v);if(E)return E;for(var y=0;y<v.width;y++)for(var w=y+1;w<v.height;w++)v.get(y,w)!==v.get(w,y)&&(v.set(y,w,!v.get(y,w)),v.set(w,y,!v.get(w,y)));return p(v)}e.decode=m},function(i,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=t(7),r=t(8),s;(function(f){f.Numeric="numeric",f.Alphanumeric="alphanumeric",f.Byte="byte",f.Kanji="kanji",f.ECI="eci"})(s=e.Mode||(e.Mode={}));var o=function(f){return f[f.Terminator=0]="Terminator",f[f.Numeric=1]="Numeric",f[f.Alphanumeric=2]="Alphanumeric",f[f.Byte=4]="Byte",f[f.Kanji=8]="Kanji",f[f.ECI=7]="ECI",f}(o||{});function a(f,x){for(var g=[],p="",m=[10,12,14][x],v=f.readBits(m);v>=3;){var E=f.readBits(10);if(E>=1e3)throw new Error("Invalid numeric value above 999");var y=Math.floor(E/100),w=Math.floor(E/10)%10,A=E%10;g.push(48+y,48+w,48+A),p+=y.toString()+w.toString()+A.toString(),v-=3}if(v===2){var E=f.readBits(7);if(E>=100)throw new Error("Invalid numeric value above 99");var y=Math.floor(E/10),w=E%10;g.push(48+y,48+w),p+=y.toString()+w.toString()}else if(v===1){var E=f.readBits(4);if(E>=10)throw new Error("Invalid numeric value above 9");g.push(48+E),p+=E.toString()}return{bytes:g,text:p}}var c=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function l(f,x){for(var g=[],p="",m=[9,11,13][x],v=f.readBits(m);v>=2;){var E=f.readBits(11),y=Math.floor(E/45),w=E%45;g.push(c[y].charCodeAt(0),c[w].charCodeAt(0)),p+=c[y]+c[w],v-=2}if(v===1){var y=f.readBits(6);g.push(c[y].charCodeAt(0)),p+=c[y]}return{bytes:g,text:p}}function u(f,x){for(var g=[],p="",m=[8,16,16][x],v=f.readBits(m),E=0;E<v;E++){var y=f.readBits(8);g.push(y)}try{p+=decodeURIComponent(g.map(function(w){return"%"+("0"+w.toString(16)).substr(-2)}).join(""))}catch{}return{bytes:g,text:p}}function h(f,x){for(var g=[],p="",m=[8,10,12][x],v=f.readBits(m),E=0;E<v;E++){var y=f.readBits(13),w=Math.floor(y/192)<<8|y%192;w<7936?w+=33088:w+=49472,g.push(w>>8,w&255),p+=String.fromCharCode(r.shiftJISTable[w])}return{bytes:g,text:p}}function d(f,x){for(var g,p,m,v,E=new n.BitStream(f),y=x<=9?0:x<=26?1:2,w={text:"",bytes:[],chunks:[],version:x};E.available()>=4;){var A=E.readBits(4);if(A===o.Terminator)return w;if(A===o.ECI)E.readBits(1)===0?w.chunks.push({type:s.ECI,assignmentNumber:E.readBits(7)}):E.readBits(1)===0?w.chunks.push({type:s.ECI,assignmentNumber:E.readBits(14)}):E.readBits(1)===0?w.chunks.push({type:s.ECI,assignmentNumber:E.readBits(21)}):w.chunks.push({type:s.ECI,assignmentNumber:-1});else if(A===o.Numeric){var b=a(E,y);w.text+=b.text,(g=w.bytes).push.apply(g,b.bytes),w.chunks.push({type:s.Numeric,text:b.text})}else if(A===o.Alphanumeric){var D=l(E,y);w.text+=D.text,(p=w.bytes).push.apply(p,D.bytes),w.chunks.push({type:s.Alphanumeric,text:D.text})}else if(A===o.Byte){var C=u(E,y);w.text+=C.text,(m=w.bytes).push.apply(m,C.bytes),w.chunks.push({type:s.Byte,bytes:C.bytes,text:C.text})}else if(A===o.Kanji){var _=h(E,y);w.text+=_.text,(v=w.bytes).push.apply(v,_.bytes),w.chunks.push({type:s.Kanji,bytes:_.bytes,text:_.text})}}if(E.available()===0||E.readBits(E.available())===0)return w}e.decode=d},function(i,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function r(s){this.byteOffset=0,this.bitOffset=0,this.bytes=s}return r.prototype.readBits=function(s){if(s<1||s>32||s>this.available())throw new Error("Cannot read "+s.toString()+" bits");var o=0;if(this.bitOffset>0){var a=8-this.bitOffset,c=s<a?s:a,l=a-c,u=255>>8-c<<l;o=(this.bytes[this.byteOffset]&u)>>l,s-=c,this.bitOffset+=c,this.bitOffset===8&&(this.bitOffset=0,this.byteOffset++)}if(s>0){for(;s>=8;)o=o<<8|this.bytes[this.byteOffset]&255,this.byteOffset++,s-=8;if(s>0){var l=8-s,u=255>>l<<l;o=o<<s|(this.bytes[this.byteOffset]&u)>>l,this.bitOffset+=s}}return o},r.prototype.available=function(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset},r}();e.BitStream=n},function(i,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.shiftJISTable={32:32,33:33,34:34,35:35,36:36,37:37,38:38,39:39,40:40,41:41,42:42,43:43,44:44,45:45,46:46,47:47,48:48,49:49,50:50,51:51,52:52,53:53,54:54,55:55,56:56,57:57,58:58,59:59,60:60,61:61,62:62,63:63,64:64,65:65,66:66,67:67,68:68,69:69,70:70,71:71,72:72,73:73,74:74,75:75,76:76,77:77,78:78,79:79,80:80,81:81,82:82,83:83,84:84,85:85,86:86,87:87,88:88,89:89,90:90,91:91,92:165,93:93,94:94,95:95,96:96,97:97,98:98,99:99,100:100,101:101,102:102,103:103,104:104,105:105,106:106,107:107,108:108,109:109,110:110,111:111,112:112,113:113,114:114,115:115,116:116,117:117,118:118,119:119,120:120,121:121,122:122,123:123,124:124,125:125,126:8254,33088:12288,33089:12289,33090:12290,33091:65292,33092:65294,33093:12539,33094:65306,33095:65307,33096:65311,33097:65281,33098:12443,33099:12444,33100:180,33101:65344,33102:168,33103:65342,33104:65507,33105:65343,33106:12541,33107:12542,33108:12445,33109:12446,33110:12291,33111:20189,33112:12293,33113:12294,33114:12295,33115:12540,33116:8213,33117:8208,33118:65295,33119:92,33120:12316,33121:8214,33122:65372,33123:8230,33124:8229,33125:8216,33126:8217,33127:8220,33128:8221,33129:65288,33130:65289,33131:12308,33132:12309,33133:65339,33134:65341,33135:65371,33136:65373,33137:12296,33138:12297,33139:12298,33140:12299,33141:12300,33142:12301,33143:12302,33144:12303,33145:12304,33146:12305,33147:65291,33148:8722,33149:177,33150:215,33152:247,33153:65309,33154:8800,33155:65308,33156:65310,33157:8806,33158:8807,33159:8734,33160:8756,33161:9794,33162:9792,33163:176,33164:8242,33165:8243,33166:8451,33167:65509,33168:65284,33169:162,33170:163,33171:65285,33172:65283,33173:65286,33174:65290,33175:65312,33176:167,33177:9734,33178:9733,33179:9675,33180:9679,33181:9678,33182:9671,33183:9670,33184:9633,33185:9632,33186:9651,33187:9650,33188:9661,33189:9660,33190:8251,33191:12306,33192:8594,33193:8592,33194:8593,33195:8595,33196:12307,33208:8712,33209:8715,33210:8838,33211:8839,33212:8834,33213:8835,33214:8746,33215:8745,33224:8743,33225:8744,33226:172,33227:8658,33228:8660,33229:8704,33230:8707,33242:8736,33243:8869,33244:8978,33245:8706,33246:8711,33247:8801,33248:8786,33249:8810,33250:8811,33251:8730,33252:8765,33253:8733,33254:8757,33255:8747,33256:8748,33264:8491,33265:8240,33266:9839,33267:9837,33268:9834,33269:8224,33270:8225,33271:182,33276:9711,33359:65296,33360:65297,33361:65298,33362:65299,33363:65300,33364:65301,33365:65302,33366:65303,33367:65304,33368:65305,33376:65313,33377:65314,33378:65315,33379:65316,33380:65317,33381:65318,33382:65319,33383:65320,33384:65321,33385:65322,33386:65323,33387:65324,33388:65325,33389:65326,33390:65327,33391:65328,33392:65329,33393:65330,33394:65331,33395:65332,33396:65333,33397:65334,33398:65335,33399:65336,33400:65337,33401:65338,33409:65345,33410:65346,33411:65347,33412:65348,33413:65349,33414:65350,33415:65351,33416:65352,33417:65353,33418:65354,33419:65355,33420:65356,33421:65357,33422:65358,33423:65359,33424:65360,33425:65361,33426:65362,33427:65363,33428:65364,33429:65365,33430:65366,33431:65367,33432:65368,33433:65369,33434:65370,33439:12353,33440:12354,33441:12355,33442:12356,33443:12357,33444:12358,33445:12359,33446:12360,33447:12361,33448:12362,33449:12363,33450:12364,33451:12365,33452:12366,33453:12367,33454:12368,33455:12369,33456:12370,33457:12371,33458:12372,33459:12373,33460:12374,33461:12375,33462:12376,33463:12377,33464:12378,33465:12379,33466:12380,33467:12381,33468:12382,33469:12383,33470:12384,33471:12385,33472:12386,33473:12387,33474:12388,33475:12389,33476:12390,33477:12391,33478:12392,33479:12393,33480:12394,33481:12395,33482:12396,33483:12397,33484:12398,33485:12399,33486:12400,33487:12401,33488:12402,33489:12403,33490:12404,33491:12405,33492:12406,33493:12407,33494:12408,33495:12409,33496:12410,33497:12411,33498:12412,33499:12413,33500:12414,33501:12415,33502:12416,33503:12417,33504:12418,33505:12419,33506:12420,33507:12421,33508:12422,33509:12423,33510:12424,33511:12425,33512:12426,33513:12427,33514:12428,33515:12429,33516:12430,33517:12431,33518:12432,33519:12433,33520:12434,33521:12435,33600:12449,33601:12450,33602:12451,33603:12452,33604:12453,33605:12454,33606:12455,33607:12456,33608:12457,33609:12458,33610:12459,33611:12460,33612:12461,33613:12462,33614:12463,33615:12464,33616:12465,33617:12466,33618:12467,33619:12468,33620:12469,33621:12470,33622:12471,33623:12472,33624:12473,33625:12474,33626:12475,33627:12476,33628:12477,33629:12478,33630:12479,33631:12480,33632:12481,33633:12482,33634:12483,33635:12484,33636:12485,33637:12486,33638:12487,33639:12488,33640:12489,33641:12490,33642:12491,33643:12492,33644:12493,33645:12494,33646:12495,33647:12496,33648:12497,33649:12498,33650:12499,33651:12500,33652:12501,33653:12502,33654:12503,33655:12504,33656:12505,33657:12506,33658:12507,33659:12508,33660:12509,33661:12510,33662:12511,33664:12512,33665:12513,33666:12514,33667:12515,33668:12516,33669:12517,33670:12518,33671:12519,33672:12520,33673:12521,33674:12522,33675:12523,33676:12524,33677:12525,33678:12526,33679:12527,33680:12528,33681:12529,33682:12530,33683:12531,33684:12532,33685:12533,33686:12534,33695:913,33696:914,33697:915,33698:916,33699:917,33700:918,33701:919,33702:920,33703:921,33704:922,33705:923,33706:924,33707:925,33708:926,33709:927,33710:928,33711:929,33712:931,33713:932,33714:933,33715:934,33716:935,33717:936,33718:937,33727:945,33728:946,33729:947,33730:948,33731:949,33732:950,33733:951,33734:952,33735:953,33736:954,33737:955,33738:956,33739:957,33740:958,33741:959,33742:960,33743:961,33744:963,33745:964,33746:965,33747:966,33748:967,33749:968,33750:969,33856:1040,33857:1041,33858:1042,33859:1043,33860:1044,33861:1045,33862:1025,33863:1046,33864:1047,33865:1048,33866:1049,33867:1050,33868:1051,33869:1052,33870:1053,33871:1054,33872:1055,33873:1056,33874:1057,33875:1058,33876:1059,33877:1060,33878:1061,33879:1062,33880:1063,33881:1064,33882:1065,33883:1066,33884:1067,33885:1068,33886:1069,33887:1070,33888:1071,33904:1072,33905:1073,33906:1074,33907:1075,33908:1076,33909:1077,33910:1105,33911:1078,33912:1079,33913:1080,33914:1081,33915:1082,33916:1083,33917:1084,33918:1085,33920:1086,33921:1087,33922:1088,33923:1089,33924:1090,33925:1091,33926:1092,33927:1093,33928:1094,33929:1095,33930:1096,33931:1097,33932:1098,33933:1099,33934:1100,33935:1101,33936:1102,33937:1103,33951:9472,33952:9474,33953:9484,33954:9488,33955:9496,33956:9492,33957:9500,33958:9516,33959:9508,33960:9524,33961:9532,33962:9473,33963:9475,33964:9487,33965:9491,33966:9499,33967:9495,33968:9507,33969:9523,33970:9515,33971:9531,33972:9547,33973:9504,33974:9519,33975:9512,33976:9527,33977:9535,33978:9501,33979:9520,33980:9509,33981:9528,33982:9538,34975:20124,34976:21782,34977:23043,34978:38463,34979:21696,34980:24859,34981:25384,34982:23030,34983:36898,34984:33909,34985:33564,34986:31312,34987:24746,34988:25569,34989:28197,34990:26093,34991:33894,34992:33446,34993:39925,34994:26771,34995:22311,34996:26017,34997:25201,34998:23451,34999:22992,35e3:34427,35001:39156,35002:32098,35003:32190,35004:39822,35005:25110,35006:31903,35007:34999,35008:23433,35009:24245,35010:25353,35011:26263,35012:26696,35013:38343,35014:38797,35015:26447,35016:20197,35017:20234,35018:20301,35019:20381,35020:20553,35021:22258,35022:22839,35023:22996,35024:23041,35025:23561,35026:24799,35027:24847,35028:24944,35029:26131,35030:26885,35031:28858,35032:30031,35033:30064,35034:31227,35035:32173,35036:32239,35037:32963,35038:33806,35039:34915,35040:35586,35041:36949,35042:36986,35043:21307,35044:20117,35045:20133,35046:22495,35047:32946,35048:37057,35049:30959,35050:19968,35051:22769,35052:28322,35053:36920,35054:31282,35055:33576,35056:33419,35057:39983,35058:20801,35059:21360,35060:21693,35061:21729,35062:22240,35063:23035,35064:24341,35065:39154,35066:28139,35067:32996,35068:34093,35136:38498,35137:38512,35138:38560,35139:38907,35140:21515,35141:21491,35142:23431,35143:28879,35144:32701,35145:36802,35146:38632,35147:21359,35148:40284,35149:31418,35150:19985,35151:30867,35152:33276,35153:28198,35154:22040,35155:21764,35156:27421,35157:34074,35158:39995,35159:23013,35160:21417,35161:28006,35162:29916,35163:38287,35164:22082,35165:20113,35166:36939,35167:38642,35168:33615,35169:39180,35170:21473,35171:21942,35172:23344,35173:24433,35174:26144,35175:26355,35176:26628,35177:27704,35178:27891,35179:27945,35180:29787,35181:30408,35182:31310,35183:38964,35184:33521,35185:34907,35186:35424,35187:37613,35188:28082,35189:30123,35190:30410,35191:39365,35192:24742,35193:35585,35194:36234,35195:38322,35196:27022,35197:21421,35198:20870,35200:22290,35201:22576,35202:22852,35203:23476,35204:24310,35205:24616,35206:25513,35207:25588,35208:27839,35209:28436,35210:28814,35211:28948,35212:29017,35213:29141,35214:29503,35215:32257,35216:33398,35217:33489,35218:34199,35219:36960,35220:37467,35221:40219,35222:22633,35223:26044,35224:27738,35225:29989,35226:20985,35227:22830,35228:22885,35229:24448,35230:24540,35231:25276,35232:26106,35233:27178,35234:27431,35235:27572,35236:29579,35237:32705,35238:35158,35239:40236,35240:40206,35241:40644,35242:23713,35243:27798,35244:33659,35245:20740,35246:23627,35247:25014,35248:33222,35249:26742,35250:29281,35251:20057,35252:20474,35253:21368,35254:24681,35255:28201,35256:31311,35257:38899,35258:19979,35259:21270,35260:20206,35261:20309,35262:20285,35263:20385,35264:20339,35265:21152,35266:21487,35267:22025,35268:22799,35269:23233,35270:23478,35271:23521,35272:31185,35273:26247,35274:26524,35275:26550,35276:27468,35277:27827,35278:28779,35279:29634,35280:31117,35281:31166,35282:31292,35283:31623,35284:33457,35285:33499,35286:33540,35287:33655,35288:33775,35289:33747,35290:34662,35291:35506,35292:22057,35293:36008,35294:36838,35295:36942,35296:38686,35297:34442,35298:20420,35299:23784,35300:25105,35301:29273,35302:30011,35303:33253,35304:33469,35305:34558,35306:36032,35307:38597,35308:39187,35309:39381,35310:20171,35311:20250,35312:35299,35313:22238,35314:22602,35315:22730,35316:24315,35317:24555,35318:24618,35319:24724,35320:24674,35321:25040,35322:25106,35323:25296,35324:25913,35392:39745,35393:26214,35394:26800,35395:28023,35396:28784,35397:30028,35398:30342,35399:32117,35400:33445,35401:34809,35402:38283,35403:38542,35404:35997,35405:20977,35406:21182,35407:22806,35408:21683,35409:23475,35410:23830,35411:24936,35412:27010,35413:28079,35414:30861,35415:33995,35416:34903,35417:35442,35418:37799,35419:39608,35420:28012,35421:39336,35422:34521,35423:22435,35424:26623,35425:34510,35426:37390,35427:21123,35428:22151,35429:21508,35430:24275,35431:25313,35432:25785,35433:26684,35434:26680,35435:27579,35436:29554,35437:30906,35438:31339,35439:35226,35440:35282,35441:36203,35442:36611,35443:37101,35444:38307,35445:38548,35446:38761,35447:23398,35448:23731,35449:27005,35450:38989,35451:38990,35452:25499,35453:31520,35454:27179,35456:27263,35457:26806,35458:39949,35459:28511,35460:21106,35461:21917,35462:24688,35463:25324,35464:27963,35465:28167,35466:28369,35467:33883,35468:35088,35469:36676,35470:19988,35471:39993,35472:21494,35473:26907,35474:27194,35475:38788,35476:26666,35477:20828,35478:31427,35479:33970,35480:37340,35481:37772,35482:22107,35483:40232,35484:26658,35485:33541,35486:33841,35487:31909,35488:21e3,35489:33477,35490:29926,35491:20094,35492:20355,35493:20896,35494:23506,35495:21002,35496:21208,35497:21223,35498:24059,35499:21914,35500:22570,35501:23014,35502:23436,35503:23448,35504:23515,35505:24178,35506:24185,35507:24739,35508:24863,35509:24931,35510:25022,35511:25563,35512:25954,35513:26577,35514:26707,35515:26874,35516:27454,35517:27475,35518:27735,35519:28450,35520:28567,35521:28485,35522:29872,35523:29976,35524:30435,35525:30475,35526:31487,35527:31649,35528:31777,35529:32233,35530:32566,35531:32752,35532:32925,35533:33382,35534:33694,35535:35251,35536:35532,35537:36011,35538:36996,35539:37969,35540:38291,35541:38289,35542:38306,35543:38501,35544:38867,35545:39208,35546:33304,35547:20024,35548:21547,35549:23736,35550:24012,35551:29609,35552:30284,35553:30524,35554:23721,35555:32747,35556:36107,35557:38593,35558:38929,35559:38996,35560:39e3,35561:20225,35562:20238,35563:21361,35564:21916,35565:22120,35566:22522,35567:22855,35568:23305,35569:23492,35570:23696,35571:24076,35572:24190,35573:24524,35574:25582,35575:26426,35576:26071,35577:26082,35578:26399,35579:26827,35580:26820,35648:27231,35649:24112,35650:27589,35651:27671,35652:27773,35653:30079,35654:31048,35655:23395,35656:31232,35657:32e3,35658:24509,35659:35215,35660:35352,35661:36020,35662:36215,35663:36556,35664:36637,35665:39138,35666:39438,35667:39740,35668:20096,35669:20605,35670:20736,35671:22931,35672:23452,35673:25135,35674:25216,35675:25836,35676:27450,35677:29344,35678:30097,35679:31047,35680:32681,35681:34811,35682:35516,35683:35696,35684:25516,35685:33738,35686:38816,35687:21513,35688:21507,35689:21931,35690:26708,35691:27224,35692:35440,35693:30759,35694:26485,35695:40653,35696:21364,35697:23458,35698:33050,35699:34384,35700:36870,35701:19992,35702:20037,35703:20167,35704:20241,35705:21450,35706:21560,35707:23470,35708:24339,35709:24613,35710:25937,35712:26429,35713:27714,35714:27762,35715:27875,35716:28792,35717:29699,35718:31350,35719:31406,35720:31496,35721:32026,35722:31998,35723:32102,35724:26087,35725:29275,35726:21435,35727:23621,35728:24040,35729:25298,35730:25312,35731:25369,35732:28192,35733:34394,35734:35377,35735:36317,35736:37624,35737:28417,35738:31142,35739:39770,35740:20136,35741:20139,35742:20140,35743:20379,35744:20384,35745:20689,35746:20807,35747:31478,35748:20849,35749:20982,35750:21332,35751:21281,35752:21375,35753:21483,35754:21932,35755:22659,35756:23777,35757:24375,35758:24394,35759:24623,35760:24656,35761:24685,35762:25375,35763:25945,35764:27211,35765:27841,35766:29378,35767:29421,35768:30703,35769:33016,35770:33029,35771:33288,35772:34126,35773:37111,35774:37857,35775:38911,35776:39255,35777:39514,35778:20208,35779:20957,35780:23597,35781:26241,35782:26989,35783:23616,35784:26354,35785:26997,35786:29577,35787:26704,35788:31873,35789:20677,35790:21220,35791:22343,35792:24062,35793:37670,35794:26020,35795:27427,35796:27453,35797:29748,35798:31105,35799:31165,35800:31563,35801:32202,35802:33465,35803:33740,35804:34943,35805:35167,35806:35641,35807:36817,35808:37329,35809:21535,35810:37504,35811:20061,35812:20534,35813:21477,35814:21306,35815:29399,35816:29590,35817:30697,35818:33510,35819:36527,35820:39366,35821:39368,35822:39378,35823:20855,35824:24858,35825:34398,35826:21936,35827:31354,35828:20598,35829:23507,35830:36935,35831:38533,35832:20018,35833:27355,35834:37351,35835:23633,35836:23624,35904:25496,35905:31391,35906:27795,35907:38772,35908:36705,35909:31402,35910:29066,35911:38536,35912:31874,35913:26647,35914:32368,35915:26705,35916:37740,35917:21234,35918:21531,35919:34219,35920:35347,35921:32676,35922:36557,35923:37089,35924:21350,35925:34952,35926:31041,35927:20418,35928:20670,35929:21009,35930:20804,35931:21843,35932:22317,35933:29674,35934:22411,35935:22865,35936:24418,35937:24452,35938:24693,35939:24950,35940:24935,35941:25001,35942:25522,35943:25658,35944:25964,35945:26223,35946:26690,35947:28179,35948:30054,35949:31293,35950:31995,35951:32076,35952:32153,35953:32331,35954:32619,35955:33550,35956:33610,35957:34509,35958:35336,35959:35427,35960:35686,35961:36605,35962:38938,35963:40335,35964:33464,35965:36814,35966:39912,35968:21127,35969:25119,35970:25731,35971:28608,35972:38553,35973:26689,35974:20625,35975:27424,35976:27770,35977:28500,35978:31348,35979:32080,35980:34880,35981:35363,35982:26376,35983:20214,35984:20537,35985:20518,35986:20581,35987:20860,35988:21048,35989:21091,35990:21927,35991:22287,35992:22533,35993:23244,35994:24314,35995:25010,35996:25080,35997:25331,35998:25458,35999:26908,36e3:27177,36001:29309,36002:29356,36003:29486,36004:30740,36005:30831,36006:32121,36007:30476,36008:32937,36009:35211,36010:35609,36011:36066,36012:36562,36013:36963,36014:37749,36015:38522,36016:38997,36017:39443,36018:40568,36019:20803,36020:21407,36021:21427,36022:24187,36023:24358,36024:28187,36025:28304,36026:29572,36027:29694,36028:32067,36029:33335,36030:35328,36031:35578,36032:38480,36033:20046,36034:20491,36035:21476,36036:21628,36037:22266,36038:22993,36039:23396,36040:24049,36041:24235,36042:24359,36043:25144,36044:25925,36045:26543,36046:28246,36047:29392,36048:31946,36049:34996,36050:32929,36051:32993,36052:33776,36053:34382,36054:35463,36055:36328,36056:37431,36057:38599,36058:39015,36059:40723,36060:20116,36061:20114,36062:20237,36063:21320,36064:21577,36065:21566,36066:23087,36067:24460,36068:24481,36069:24735,36070:26791,36071:27278,36072:29786,36073:30849,36074:35486,36075:35492,36076:35703,36077:37264,36078:20062,36079:39881,36080:20132,36081:20348,36082:20399,36083:20505,36084:20502,36085:20809,36086:20844,36087:21151,36088:21177,36089:21246,36090:21402,36091:21475,36092:21521,36160:21518,36161:21897,36162:22353,36163:22434,36164:22909,36165:23380,36166:23389,36167:23439,36168:24037,36169:24039,36170:24055,36171:24184,36172:24195,36173:24218,36174:24247,36175:24344,36176:24658,36177:24908,36178:25239,36179:25304,36180:25511,36181:25915,36182:26114,36183:26179,36184:26356,36185:26477,36186:26657,36187:26775,36188:27083,36189:27743,36190:27946,36191:28009,36192:28207,36193:28317,36194:30002,36195:30343,36196:30828,36197:31295,36198:31968,36199:32005,36200:32024,36201:32094,36202:32177,36203:32789,36204:32771,36205:32943,36206:32945,36207:33108,36208:33167,36209:33322,36210:33618,36211:34892,36212:34913,36213:35611,36214:36002,36215:36092,36216:37066,36217:37237,36218:37489,36219:30783,36220:37628,36221:38308,36222:38477,36224:38917,36225:39321,36226:39640,36227:40251,36228:21083,36229:21163,36230:21495,36231:21512,36232:22741,36233:25335,36234:28640,36235:35946,36236:36703,36237:40633,36238:20811,36239:21051,36240:21578,36241:22269,36242:31296,36243:37239,36244:40288,36245:40658,36246:29508,36247:28425,36248:33136,36249:29969,36250:24573,36251:24794,36252:39592,36253:29403,36254:36796,36255:27492,36256:38915,36257:20170,36258:22256,36259:22372,36260:22718,36261:23130,36262:24680,36263:25031,36264:26127,36265:26118,36266:26681,36267:26801,36268:28151,36269:30165,36270:32058,36271:33390,36272:39746,36273:20123,36274:20304,36275:21449,36276:21766,36277:23919,36278:24038,36279:24046,36280:26619,36281:27801,36282:29811,36283:30722,36284:35408,36285:37782,36286:35039,36287:22352,36288:24231,36289:25387,36290:20661,36291:20652,36292:20877,36293:26368,36294:21705,36295:22622,36296:22971,36297:23472,36298:24425,36299:25165,36300:25505,36301:26685,36302:27507,36303:28168,36304:28797,36305:37319,36306:29312,36307:30741,36308:30758,36309:31085,36310:25998,36311:32048,36312:33756,36313:35009,36314:36617,36315:38555,36316:21092,36317:22312,36318:26448,36319:32618,36320:36001,36321:20916,36322:22338,36323:38442,36324:22586,36325:27018,36326:32948,36327:21682,36328:23822,36329:22524,36330:30869,36331:40442,36332:20316,36333:21066,36334:21643,36335:25662,36336:26152,36337:26388,36338:26613,36339:31364,36340:31574,36341:32034,36342:37679,36343:26716,36344:39853,36345:31545,36346:21273,36347:20874,36348:21047,36416:23519,36417:25334,36418:25774,36419:25830,36420:26413,36421:27578,36422:34217,36423:38609,36424:30352,36425:39894,36426:25420,36427:37638,36428:39851,36429:30399,36430:26194,36431:19977,36432:20632,36433:21442,36434:23665,36435:24808,36436:25746,36437:25955,36438:26719,36439:29158,36440:29642,36441:29987,36442:31639,36443:32386,36444:34453,36445:35715,36446:36059,36447:37240,36448:39184,36449:26028,36450:26283,36451:27531,36452:20181,36453:20180,36454:20282,36455:20351,36456:21050,36457:21496,36458:21490,36459:21987,36460:22235,36461:22763,36462:22987,36463:22985,36464:23039,36465:23376,36466:23629,36467:24066,36468:24107,36469:24535,36470:24605,36471:25351,36472:25903,36473:23388,36474:26031,36475:26045,36476:26088,36477:26525,36478:27490,36480:27515,36481:27663,36482:29509,36483:31049,36484:31169,36485:31992,36486:32025,36487:32043,36488:32930,36489:33026,36490:33267,36491:35222,36492:35422,36493:35433,36494:35430,36495:35468,36496:35566,36497:36039,36498:36060,36499:38604,36500:39164,36501:27503,36502:20107,36503:20284,36504:20365,36505:20816,36506:23383,36507:23546,36508:24904,36509:25345,36510:26178,36511:27425,36512:28363,36513:27835,36514:29246,36515:29885,36516:30164,36517:30913,36518:31034,36519:32780,36520:32819,36521:33258,36522:33940,36523:36766,36524:27728,36525:40575,36526:24335,36527:35672,36528:40235,36529:31482,36530:36600,36531:23437,36532:38635,36533:19971,36534:21489,36535:22519,36536:22833,36537:23241,36538:23460,36539:24713,36540:28287,36541:28422,36542:30142,36543:36074,36544:23455,36545:34048,36546:31712,36547:20594,36548:26612,36549:33437,36550:23649,36551:34122,36552:32286,36553:33294,36554:20889,36555:23556,36556:25448,36557:36198,36558:26012,36559:29038,36560:31038,36561:32023,36562:32773,36563:35613,36564:36554,36565:36974,36566:34503,36567:37034,36568:20511,36569:21242,36570:23610,36571:26451,36572:28796,36573:29237,36574:37196,36575:37320,36576:37675,36577:33509,36578:23490,36579:24369,36580:24825,36581:20027,36582:21462,36583:23432,36584:25163,36585:26417,36586:27530,36587:29417,36588:29664,36589:31278,36590:33131,36591:36259,36592:37202,36593:39318,36594:20754,36595:21463,36596:21610,36597:23551,36598:25480,36599:27193,36600:32172,36601:38656,36602:22234,36603:21454,36604:21608,36672:23447,36673:23601,36674:24030,36675:20462,36676:24833,36677:25342,36678:27954,36679:31168,36680:31179,36681:32066,36682:32333,36683:32722,36684:33261,36685:33311,36686:33936,36687:34886,36688:35186,36689:35728,36690:36468,36691:36655,36692:36913,36693:37195,36694:37228,36695:38598,36696:37276,36697:20160,36698:20303,36699:20805,36700:21313,36701:24467,36702:25102,36703:26580,36704:27713,36705:28171,36706:29539,36707:32294,36708:37325,36709:37507,36710:21460,36711:22809,36712:23487,36713:28113,36714:31069,36715:32302,36716:31899,36717:22654,36718:29087,36719:20986,36720:34899,36721:36848,36722:20426,36723:23803,36724:26149,36725:30636,36726:31459,36727:33308,36728:39423,36729:20934,36730:24490,36731:26092,36732:26991,36733:27529,36734:28147,36736:28310,36737:28516,36738:30462,36739:32020,36740:24033,36741:36981,36742:37255,36743:38918,36744:20966,36745:21021,36746:25152,36747:26257,36748:26329,36749:28186,36750:24246,36751:32210,36752:32626,36753:26360,36754:34223,36755:34295,36756:35576,36757:21161,36758:21465,36759:22899,36760:24207,36761:24464,36762:24661,36763:37604,36764:38500,36765:20663,36766:20767,36767:21213,36768:21280,36769:21319,36770:21484,36771:21736,36772:21830,36773:21809,36774:22039,36775:22888,36776:22974,36777:23100,36778:23477,36779:23558,36780:23567,36781:23569,36782:23578,36783:24196,36784:24202,36785:24288,36786:24432,36787:25215,36788:25220,36789:25307,36790:25484,36791:25463,36792:26119,36793:26124,36794:26157,36795:26230,36796:26494,36797:26786,36798:27167,36799:27189,36800:27836,36801:28040,36802:28169,36803:28248,36804:28988,36805:28966,36806:29031,36807:30151,36808:30465,36809:30813,36810:30977,36811:31077,36812:31216,36813:31456,36814:31505,36815:31911,36816:32057,36817:32918,36818:33750,36819:33931,36820:34121,36821:34909,36822:35059,36823:35359,36824:35388,36825:35412,36826:35443,36827:35937,36828:36062,36829:37284,36830:37478,36831:37758,36832:37912,36833:38556,36834:38808,36835:19978,36836:19976,36837:19998,36838:20055,36839:20887,36840:21104,36841:22478,36842:22580,36843:22732,36844:23330,36845:24120,36846:24773,36847:25854,36848:26465,36849:26454,36850:27972,36851:29366,36852:30067,36853:31331,36854:33976,36855:35698,36856:37304,36857:37664,36858:22065,36859:22516,36860:39166,36928:25325,36929:26893,36930:27542,36931:29165,36932:32340,36933:32887,36934:33394,36935:35302,36936:39135,36937:34645,36938:36785,36939:23611,36940:20280,36941:20449,36942:20405,36943:21767,36944:23072,36945:23517,36946:23529,36947:24515,36948:24910,36949:25391,36950:26032,36951:26187,36952:26862,36953:27035,36954:28024,36955:28145,36956:30003,36957:30137,36958:30495,36959:31070,36960:31206,36961:32051,36962:33251,36963:33455,36964:34218,36965:35242,36966:35386,36967:36523,36968:36763,36969:36914,36970:37341,36971:38663,36972:20154,36973:20161,36974:20995,36975:22645,36976:22764,36977:23563,36978:29978,36979:23613,36980:33102,36981:35338,36982:36805,36983:38499,36984:38765,36985:31525,36986:35535,36987:38920,36988:37218,36989:22259,36990:21416,36992:36887,36993:21561,36994:22402,36995:24101,36996:25512,36997:27700,36998:28810,36999:30561,37e3:31883,37001:32736,37002:34928,37003:36930,37004:37204,37005:37648,37006:37656,37007:38543,37008:29790,37009:39620,37010:23815,37011:23913,37012:25968,37013:26530,37014:36264,37015:38619,37016:25454,37017:26441,37018:26905,37019:33733,37020:38935,37021:38592,37022:35070,37023:28548,37024:25722,37025:23544,37026:19990,37027:28716,37028:30045,37029:26159,37030:20932,37031:21046,37032:21218,37033:22995,37034:24449,37035:24615,37036:25104,37037:25919,37038:25972,37039:26143,37040:26228,37041:26866,37042:26646,37043:27491,37044:28165,37045:29298,37046:29983,37047:30427,37048:31934,37049:32854,37050:22768,37051:35069,37052:35199,37053:35488,37054:35475,37055:35531,37056:36893,37057:37266,37058:38738,37059:38745,37060:25993,37061:31246,37062:33030,37063:38587,37064:24109,37065:24796,37066:25114,37067:26021,37068:26132,37069:26512,37070:30707,37071:31309,37072:31821,37073:32318,37074:33034,37075:36012,37076:36196,37077:36321,37078:36447,37079:30889,37080:20999,37081:25305,37082:25509,37083:25666,37084:25240,37085:35373,37086:31363,37087:31680,37088:35500,37089:38634,37090:32118,37091:33292,37092:34633,37093:20185,37094:20808,37095:21315,37096:21344,37097:23459,37098:23554,37099:23574,37100:24029,37101:25126,37102:25159,37103:25776,37104:26643,37105:26676,37106:27849,37107:27973,37108:27927,37109:26579,37110:28508,37111:29006,37112:29053,37113:26059,37114:31359,37115:31661,37116:32218,37184:32330,37185:32680,37186:33146,37187:33307,37188:33337,37189:34214,37190:35438,37191:36046,37192:36341,37193:36984,37194:36983,37195:37549,37196:37521,37197:38275,37198:39854,37199:21069,37200:21892,37201:28472,37202:28982,37203:20840,37204:31109,37205:32341,37206:33203,37207:31950,37208:22092,37209:22609,37210:23720,37211:25514,37212:26366,37213:26365,37214:26970,37215:29401,37216:30095,37217:30094,37218:30990,37219:31062,37220:31199,37221:31895,37222:32032,37223:32068,37224:34311,37225:35380,37226:38459,37227:36961,37228:40736,37229:20711,37230:21109,37231:21452,37232:21474,37233:20489,37234:21930,37235:22766,37236:22863,37237:29245,37238:23435,37239:23652,37240:21277,37241:24803,37242:24819,37243:25436,37244:25475,37245:25407,37246:25531,37248:25805,37249:26089,37250:26361,37251:24035,37252:27085,37253:27133,37254:28437,37255:29157,37256:20105,37257:30185,37258:30456,37259:31379,37260:31967,37261:32207,37262:32156,37263:32865,37264:33609,37265:33624,37266:33900,37267:33980,37268:34299,37269:35013,37270:36208,37271:36865,37272:36973,37273:37783,37274:38684,37275:39442,37276:20687,37277:22679,37278:24974,37279:33235,37280:34101,37281:36104,37282:36896,37283:20419,37284:20596,37285:21063,37286:21363,37287:24687,37288:25417,37289:26463,37290:28204,37291:36275,37292:36895,37293:20439,37294:23646,37295:36042,37296:26063,37297:32154,37298:21330,37299:34966,37300:20854,37301:25539,37302:23384,37303:23403,37304:23562,37305:25613,37306:26449,37307:36956,37308:20182,37309:22810,37310:22826,37311:27760,37312:35409,37313:21822,37314:22549,37315:22949,37316:24816,37317:25171,37318:26561,37319:33333,37320:26965,37321:38464,37322:39364,37323:39464,37324:20307,37325:22534,37326:23550,37327:32784,37328:23729,37329:24111,37330:24453,37331:24608,37332:24907,37333:25140,37334:26367,37335:27888,37336:28382,37337:32974,37338:33151,37339:33492,37340:34955,37341:36024,37342:36864,37343:36910,37344:38538,37345:40667,37346:39899,37347:20195,37348:21488,37349:22823,37350:31532,37351:37261,37352:38988,37353:40441,37354:28381,37355:28711,37356:21331,37357:21828,37358:23429,37359:25176,37360:25246,37361:25299,37362:27810,37363:28655,37364:29730,37365:35351,37366:37944,37367:28609,37368:35582,37369:33592,37370:20967,37371:34552,37372:21482,37440:21481,37441:20294,37442:36948,37443:36784,37444:22890,37445:33073,37446:24061,37447:31466,37448:36799,37449:26842,37450:35895,37451:29432,37452:40008,37453:27197,37454:35504,37455:20025,37456:21336,37457:22022,37458:22374,37459:25285,37460:25506,37461:26086,37462:27470,37463:28129,37464:28251,37465:28845,37466:30701,37467:31471,37468:31658,37469:32187,37470:32829,37471:32966,37472:34507,37473:35477,37474:37723,37475:22243,37476:22727,37477:24382,37478:26029,37479:26262,37480:27264,37481:27573,37482:30007,37483:35527,37484:20516,37485:30693,37486:22320,37487:24347,37488:24677,37489:26234,37490:27744,37491:30196,37492:31258,37493:32622,37494:33268,37495:34584,37496:36933,37497:39347,37498:31689,37499:30044,37500:31481,37501:31569,37502:33988,37504:36880,37505:31209,37506:31378,37507:33590,37508:23265,37509:30528,37510:20013,37511:20210,37512:23449,37513:24544,37514:25277,37515:26172,37516:26609,37517:27880,37518:34411,37519:34935,37520:35387,37521:37198,37522:37619,37523:39376,37524:27159,37525:28710,37526:29482,37527:33511,37528:33879,37529:36015,37530:19969,37531:20806,37532:20939,37533:21899,37534:23541,37535:24086,37536:24115,37537:24193,37538:24340,37539:24373,37540:24427,37541:24500,37542:25074,37543:25361,37544:26274,37545:26397,37546:28526,37547:29266,37548:30010,37549:30522,37550:32884,37551:33081,37552:33144,37553:34678,37554:35519,37555:35548,37556:36229,37557:36339,37558:37530,37559:38263,37560:38914,37561:40165,37562:21189,37563:25431,37564:30452,37565:26389,37566:27784,37567:29645,37568:36035,37569:37806,37570:38515,37571:27941,37572:22684,37573:26894,37574:27084,37575:36861,37576:37786,37577:30171,37578:36890,37579:22618,37580:26626,37581:25524,37582:27131,37583:20291,37584:28460,37585:26584,37586:36795,37587:34086,37588:32180,37589:37716,37590:26943,37591:28528,37592:22378,37593:22775,37594:23340,37595:32044,37596:29226,37597:21514,37598:37347,37599:40372,37600:20141,37601:20302,37602:20572,37603:20597,37604:21059,37605:35998,37606:21576,37607:22564,37608:23450,37609:24093,37610:24213,37611:24237,37612:24311,37613:24351,37614:24716,37615:25269,37616:25402,37617:25552,37618:26799,37619:27712,37620:30855,37621:31118,37622:31243,37623:32224,37624:33351,37625:35330,37626:35558,37627:36420,37628:36883,37696:37048,37697:37165,37698:37336,37699:40718,37700:27877,37701:25688,37702:25826,37703:25973,37704:28404,37705:30340,37706:31515,37707:36969,37708:37841,37709:28346,37710:21746,37711:24505,37712:25764,37713:36685,37714:36845,37715:37444,37716:20856,37717:22635,37718:22825,37719:23637,37720:24215,37721:28155,37722:32399,37723:29980,37724:36028,37725:36578,37726:39003,37727:28857,37728:20253,37729:27583,37730:28593,37731:3e4,37732:38651,37733:20814,37734:21520,37735:22581,37736:22615,37737:22956,37738:23648,37739:24466,37740:26007,37741:26460,37742:28193,37743:30331,37744:33759,37745:36077,37746:36884,37747:37117,37748:37709,37749:30757,37750:30778,37751:21162,37752:24230,37753:22303,37754:22900,37755:24594,37756:20498,37757:20826,37758:20908,37760:20941,37761:20992,37762:21776,37763:22612,37764:22616,37765:22871,37766:23445,37767:23798,37768:23947,37769:24764,37770:25237,37771:25645,37772:26481,37773:26691,37774:26812,37775:26847,37776:30423,37777:28120,37778:28271,37779:28059,37780:28783,37781:29128,37782:24403,37783:30168,37784:31095,37785:31561,37786:31572,37787:31570,37788:31958,37789:32113,37790:21040,37791:33891,37792:34153,37793:34276,37794:35342,37795:35588,37796:35910,37797:36367,37798:36867,37799:36879,37800:37913,37801:38518,37802:38957,37803:39472,37804:38360,37805:20685,37806:21205,37807:21516,37808:22530,37809:23566,37810:24999,37811:25758,37812:27934,37813:30643,37814:31461,37815:33012,37816:33796,37817:36947,37818:37509,37819:23776,37820:40199,37821:21311,37822:24471,37823:24499,37824:28060,37825:29305,37826:30563,37827:31167,37828:31716,37829:27602,37830:29420,37831:35501,37832:26627,37833:27233,37834:20984,37835:31361,37836:26932,37837:23626,37838:40182,37839:33515,37840:23493,37841:37193,37842:28702,37843:22136,37844:23663,37845:24775,37846:25958,37847:27788,37848:35930,37849:36929,37850:38931,37851:21585,37852:26311,37853:37389,37854:22856,37855:37027,37856:20869,37857:20045,37858:20970,37859:34201,37860:35598,37861:28760,37862:25466,37863:37707,37864:26978,37865:39348,37866:32260,37867:30071,37868:21335,37869:26976,37870:36575,37871:38627,37872:27741,37873:20108,37874:23612,37875:24336,37876:36841,37877:21250,37878:36049,37879:32905,37880:34425,37881:24319,37882:26085,37883:20083,37884:20837,37952:22914,37953:23615,37954:38894,37955:20219,37956:22922,37957:24525,37958:35469,37959:28641,37960:31152,37961:31074,37962:23527,37963:33905,37964:29483,37965:29105,37966:24180,37967:24565,37968:25467,37969:25754,37970:29123,37971:31896,37972:20035,37973:24316,37974:20043,37975:22492,37976:22178,37977:24745,37978:28611,37979:32013,37980:33021,37981:33075,37982:33215,37983:36786,37984:35223,37985:34468,37986:24052,37987:25226,37988:25773,37989:35207,37990:26487,37991:27874,37992:27966,37993:29750,37994:30772,37995:23110,37996:32629,37997:33453,37998:39340,37999:20467,38e3:24259,38001:25309,38002:25490,38003:25943,38004:26479,38005:30403,38006:29260,38007:32972,38008:32954,38009:36649,38010:37197,38011:20493,38012:22521,38013:23186,38014:26757,38016:26995,38017:29028,38018:29437,38019:36023,38020:22770,38021:36064,38022:38506,38023:36889,38024:34687,38025:31204,38026:30695,38027:33833,38028:20271,38029:21093,38030:21338,38031:25293,38032:26575,38033:27850,38034:30333,38035:31636,38036:31893,38037:33334,38038:34180,38039:36843,38040:26333,38041:28448,38042:29190,38043:32283,38044:33707,38045:39361,38046:40614,38047:20989,38048:31665,38049:30834,38050:31672,38051:32903,38052:31560,38053:27368,38054:24161,38055:32908,38056:30033,38057:30048,38058:20843,38059:37474,38060:28300,38061:30330,38062:37271,38063:39658,38064:20240,38065:32624,38066:25244,38067:31567,38068:38309,38069:40169,38070:22138,38071:22617,38072:34532,38073:38588,38074:20276,38075:21028,38076:21322,38077:21453,38078:21467,38079:24070,38080:25644,38081:26001,38082:26495,38083:27710,38084:27726,38085:29256,38086:29359,38087:29677,38088:30036,38089:32321,38090:33324,38091:34281,38092:36009,38093:31684,38094:37318,38095:29033,38096:38930,38097:39151,38098:25405,38099:26217,38100:30058,38101:30436,38102:30928,38103:34115,38104:34542,38105:21290,38106:21329,38107:21542,38108:22915,38109:24199,38110:24444,38111:24754,38112:25161,38113:25209,38114:25259,38115:26e3,38116:27604,38117:27852,38118:30130,38119:30382,38120:30865,38121:31192,38122:32203,38123:32631,38124:32933,38125:34987,38126:35513,38127:36027,38128:36991,38129:38750,38130:39131,38131:27147,38132:31800,38133:20633,38134:23614,38135:24494,38136:26503,38137:27608,38138:29749,38139:30473,38140:32654,38208:40763,38209:26570,38210:31255,38211:21305,38212:30091,38213:39661,38214:24422,38215:33181,38216:33777,38217:32920,38218:24380,38219:24517,38220:30050,38221:31558,38222:36924,38223:26727,38224:23019,38225:23195,38226:32016,38227:30334,38228:35628,38229:20469,38230:24426,38231:27161,38232:27703,38233:28418,38234:29922,38235:31080,38236:34920,38237:35413,38238:35961,38239:24287,38240:25551,38241:30149,38242:31186,38243:33495,38244:37672,38245:37618,38246:33948,38247:34541,38248:39981,38249:21697,38250:24428,38251:25996,38252:27996,38253:28693,38254:36007,38255:36051,38256:38971,38257:25935,38258:29942,38259:19981,38260:20184,38261:22496,38262:22827,38263:23142,38264:23500,38265:20904,38266:24067,38267:24220,38268:24598,38269:25206,38270:25975,38272:26023,38273:26222,38274:28014,38275:29238,38276:31526,38277:33104,38278:33178,38279:33433,38280:35676,38281:36e3,38282:36070,38283:36212,38284:38428,38285:38468,38286:20398,38287:25771,38288:27494,38289:33310,38290:33889,38291:34154,38292:37096,38293:23553,38294:26963,38295:39080,38296:33914,38297:34135,38298:20239,38299:21103,38300:24489,38301:24133,38302:26381,38303:31119,38304:33145,38305:35079,38306:35206,38307:28149,38308:24343,38309:25173,38310:27832,38311:20175,38312:29289,38313:39826,38314:20998,38315:21563,38316:22132,38317:22707,38318:24996,38319:25198,38320:28954,38321:22894,38322:31881,38323:31966,38324:32027,38325:38640,38326:25991,38327:32862,38328:19993,38329:20341,38330:20853,38331:22592,38332:24163,38333:24179,38334:24330,38335:26564,38336:20006,38337:34109,38338:38281,38339:38491,38340:31859,38341:38913,38342:20731,38343:22721,38344:30294,38345:30887,38346:21029,38347:30629,38348:34065,38349:31622,38350:20559,38351:22793,38352:29255,38353:31687,38354:32232,38355:36794,38356:36820,38357:36941,38358:20415,38359:21193,38360:23081,38361:24321,38362:38829,38363:20445,38364:33303,38365:37610,38366:22275,38367:25429,38368:27497,38369:29995,38370:35036,38371:36628,38372:31298,38373:21215,38374:22675,38375:24917,38376:25098,38377:26286,38378:27597,38379:31807,38380:33769,38381:20515,38382:20472,38383:21253,38384:21574,38385:22577,38386:22857,38387:23453,38388:23792,38389:23791,38390:23849,38391:24214,38392:25265,38393:25447,38394:25918,38395:26041,38396:26379,38464:27861,38465:27873,38466:28921,38467:30770,38468:32299,38469:32990,38470:33459,38471:33804,38472:34028,38473:34562,38474:35090,38475:35370,38476:35914,38477:37030,38478:37586,38479:39165,38480:40179,38481:40300,38482:20047,38483:20129,38484:20621,38485:21078,38486:22346,38487:22952,38488:24125,38489:24536,38490:24537,38491:25151,38492:26292,38493:26395,38494:26576,38495:26834,38496:20882,38497:32033,38498:32938,38499:33192,38500:35584,38501:35980,38502:36031,38503:37502,38504:38450,38505:21536,38506:38956,38507:21271,38508:20693,38509:21340,38510:22696,38511:25778,38512:26420,38513:29287,38514:30566,38515:31302,38516:37350,38517:21187,38518:27809,38519:27526,38520:22528,38521:24140,38522:22868,38523:26412,38524:32763,38525:20961,38526:30406,38528:25705,38529:30952,38530:39764,38531:40635,38532:22475,38533:22969,38534:26151,38535:26522,38536:27598,38537:21737,38538:27097,38539:24149,38540:33180,38541:26517,38542:39850,38543:26622,38544:40018,38545:26717,38546:20134,38547:20451,38548:21448,38549:25273,38550:26411,38551:27819,38552:36804,38553:20397,38554:32365,38555:40639,38556:19975,38557:24930,38558:28288,38559:28459,38560:34067,38561:21619,38562:26410,38563:39749,38564:24051,38565:31637,38566:23724,38567:23494,38568:34588,38569:28234,38570:34001,38571:31252,38572:33032,38573:22937,38574:31885,38575:27665,38576:30496,38577:21209,38578:22818,38579:28961,38580:29279,38581:30683,38582:38695,38583:40289,38584:26891,38585:23167,38586:23064,38587:20901,38588:21517,38589:21629,38590:26126,38591:30431,38592:36855,38593:37528,38594:40180,38595:23018,38596:29277,38597:28357,38598:20813,38599:26825,38600:32191,38601:32236,38602:38754,38603:40634,38604:25720,38605:27169,38606:33538,38607:22916,38608:23391,38609:27611,38610:29467,38611:30450,38612:32178,38613:32791,38614:33945,38615:20786,38616:26408,38617:40665,38618:30446,38619:26466,38620:21247,38621:39173,38622:23588,38623:25147,38624:31870,38625:36016,38626:21839,38627:24758,38628:32011,38629:38272,38630:21249,38631:20063,38632:20918,38633:22812,38634:29242,38635:32822,38636:37326,38637:24357,38638:30690,38639:21380,38640:24441,38641:32004,38642:34220,38643:35379,38644:36493,38645:38742,38646:26611,38647:34222,38648:37971,38649:24841,38650:24840,38651:27833,38652:30290,38720:35565,38721:36664,38722:21807,38723:20305,38724:20778,38725:21191,38726:21451,38727:23461,38728:24189,38729:24736,38730:24962,38731:25558,38732:26377,38733:26586,38734:28263,38735:28044,38736:29494,38737:29495,38738:30001,38739:31056,38740:35029,38741:35480,38742:36938,38743:37009,38744:37109,38745:38596,38746:34701,38747:22805,38748:20104,38749:20313,38750:19982,38751:35465,38752:36671,38753:38928,38754:20653,38755:24188,38756:22934,38757:23481,38758:24248,38759:25562,38760:25594,38761:25793,38762:26332,38763:26954,38764:27096,38765:27915,38766:28342,38767:29076,38768:29992,38769:31407,38770:32650,38771:32768,38772:33865,38773:33993,38774:35201,38775:35617,38776:36362,38777:36965,38778:38525,38779:39178,38780:24958,38781:25233,38782:27442,38784:27779,38785:28020,38786:32716,38787:32764,38788:28096,38789:32645,38790:34746,38791:35064,38792:26469,38793:33713,38794:38972,38795:38647,38796:27931,38797:32097,38798:33853,38799:37226,38800:20081,38801:21365,38802:23888,38803:27396,38804:28651,38805:34253,38806:34349,38807:35239,38808:21033,38809:21519,38810:23653,38811:26446,38812:26792,38813:29702,38814:29827,38815:30178,38816:35023,38817:35041,38818:37324,38819:38626,38820:38520,38821:24459,38822:29575,38823:31435,38824:33870,38825:25504,38826:30053,38827:21129,38828:27969,38829:28316,38830:29705,38831:30041,38832:30827,38833:31890,38834:38534,38835:31452,38836:40845,38837:20406,38838:24942,38839:26053,38840:34396,38841:20102,38842:20142,38843:20698,38844:20001,38845:20940,38846:23534,38847:26009,38848:26753,38849:28092,38850:29471,38851:30274,38852:30637,38853:31260,38854:31975,38855:33391,38856:35538,38857:36988,38858:37327,38859:38517,38860:38936,38861:21147,38862:32209,38863:20523,38864:21400,38865:26519,38866:28107,38867:29136,38868:29747,38869:33256,38870:36650,38871:38563,38872:40023,38873:40607,38874:29792,38875:22593,38876:28057,38877:32047,38878:39006,38879:20196,38880:20278,38881:20363,38882:20919,38883:21169,38884:23994,38885:24604,38886:29618,38887:31036,38888:33491,38889:37428,38890:38583,38891:38646,38892:38666,38893:40599,38894:40802,38895:26278,38896:27508,38897:21015,38898:21155,38899:28872,38900:35010,38901:24265,38902:24651,38903:24976,38904:28451,38905:29001,38906:31806,38907:32244,38908:32879,38976:34030,38977:36899,38978:37676,38979:21570,38980:39791,38981:27347,38982:28809,38983:36034,38984:36335,38985:38706,38986:21172,38987:23105,38988:24266,38989:24324,38990:26391,38991:27004,38992:27028,38993:28010,38994:28431,38995:29282,38996:29436,38997:31725,38998:32769,38999:32894,39e3:34635,39001:37070,39002:20845,39003:40595,39004:31108,39005:32907,39006:37682,39007:35542,39008:20525,39009:21644,39010:35441,39011:27498,39012:36036,39013:33031,39014:24785,39015:26528,39016:40434,39017:20121,39018:20120,39019:39952,39020:35435,39021:34241,39022:34152,39023:26880,39024:28286,39025:30871,39026:33109,39071:24332,39072:19984,39073:19989,39074:20010,39075:20017,39076:20022,39077:20028,39078:20031,39079:20034,39080:20054,39081:20056,39082:20098,39083:20101,39084:35947,39085:20106,39086:33298,39087:24333,39088:20110,39089:20126,39090:20127,39091:20128,39092:20130,39093:20144,39094:20147,39095:20150,39096:20174,39097:20173,39098:20164,39099:20166,39100:20162,39101:20183,39102:20190,39103:20205,39104:20191,39105:20215,39106:20233,39107:20314,39108:20272,39109:20315,39110:20317,39111:20311,39112:20295,39113:20342,39114:20360,39115:20367,39116:20376,39117:20347,39118:20329,39119:20336,39120:20369,39121:20335,39122:20358,39123:20374,39124:20760,39125:20436,39126:20447,39127:20430,39128:20440,39129:20443,39130:20433,39131:20442,39132:20432,39133:20452,39134:20453,39135:20506,39136:20520,39137:20500,39138:20522,39139:20517,39140:20485,39141:20252,39142:20470,39143:20513,39144:20521,39145:20524,39146:20478,39147:20463,39148:20497,39149:20486,39150:20547,39151:20551,39152:26371,39153:20565,39154:20560,39155:20552,39156:20570,39157:20566,39158:20588,39159:20600,39160:20608,39161:20634,39162:20613,39163:20660,39164:20658,39232:20681,39233:20682,39234:20659,39235:20674,39236:20694,39237:20702,39238:20709,39239:20717,39240:20707,39241:20718,39242:20729,39243:20725,39244:20745,39245:20737,39246:20738,39247:20758,39248:20757,39249:20756,39250:20762,39251:20769,39252:20794,39253:20791,39254:20796,39255:20795,39256:20799,39257:20800,39258:20818,39259:20812,39260:20820,39261:20834,39262:31480,39263:20841,39264:20842,39265:20846,39266:20864,39267:20866,39268:22232,39269:20876,39270:20873,39271:20879,39272:20881,39273:20883,39274:20885,39275:20886,39276:20900,39277:20902,39278:20898,39279:20905,39280:20906,39281:20907,39282:20915,39283:20913,39284:20914,39285:20912,39286:20917,39287:20925,39288:20933,39289:20937,39290:20955,39291:20960,39292:34389,39293:20969,39294:20973,39296:20976,39297:20981,39298:20990,39299:20996,39300:21003,39301:21012,39302:21006,39303:21031,39304:21034,39305:21038,39306:21043,39307:21049,39308:21071,39309:21060,39310:21067,39311:21068,39312:21086,39313:21076,39314:21098,39315:21108,39316:21097,39317:21107,39318:21119,39319:21117,39320:21133,39321:21140,39322:21138,39323:21105,39324:21128,39325:21137,39326:36776,39327:36775,39328:21164,39329:21165,39330:21180,39331:21173,39332:21185,39333:21197,39334:21207,39335:21214,39336:21219,39337:21222,39338:39149,39339:21216,39340:21235,39341:21237,39342:21240,39343:21241,39344:21254,39345:21256,39346:30008,39347:21261,39348:21264,39349:21263,39350:21269,39351:21274,39352:21283,39353:21295,39354:21297,39355:21299,39356:21304,39357:21312,39358:21318,39359:21317,39360:19991,39361:21321,39362:21325,39363:20950,39364:21342,39365:21353,39366:21358,39367:22808,39368:21371,39369:21367,39370:21378,39371:21398,39372:21408,39373:21414,39374:21413,39375:21422,39376:21424,39377:21430,39378:21443,39379:31762,39380:38617,39381:21471,39382:26364,39383:29166,39384:21486,39385:21480,39386:21485,39387:21498,39388:21505,39389:21565,39390:21568,39391:21548,39392:21549,39393:21564,39394:21550,39395:21558,39396:21545,39397:21533,39398:21582,39399:21647,39400:21621,39401:21646,39402:21599,39403:21617,39404:21623,39405:21616,39406:21650,39407:21627,39408:21632,39409:21622,39410:21636,39411:21648,39412:21638,39413:21703,39414:21666,39415:21688,39416:21669,39417:21676,39418:21700,39419:21704,39420:21672,39488:21675,39489:21698,39490:21668,39491:21694,39492:21692,39493:21720,39494:21733,39495:21734,39496:21775,39497:21780,39498:21757,39499:21742,39500:21741,39501:21754,39502:21730,39503:21817,39504:21824,39505:21859,39506:21836,39507:21806,39508:21852,39509:21829,39510:21846,39511:21847,39512:21816,39513:21811,39514:21853,39515:21913,39516:21888,39517:21679,39518:21898,39519:21919,39520:21883,39521:21886,39522:21912,39523:21918,39524:21934,39525:21884,39526:21891,39527:21929,39528:21895,39529:21928,39530:21978,39531:21957,39532:21983,39533:21956,39534:21980,39535:21988,39536:21972,39537:22036,39538:22007,39539:22038,39540:22014,39541:22013,39542:22043,39543:22009,39544:22094,39545:22096,39546:29151,39547:22068,39548:22070,39549:22066,39550:22072,39552:22123,39553:22116,39554:22063,39555:22124,39556:22122,39557:22150,39558:22144,39559:22154,39560:22176,39561:22164,39562:22159,39563:22181,39564:22190,39565:22198,39566:22196,39567:22210,39568:22204,39569:22209,39570:22211,39571:22208,39572:22216,39573:22222,39574:22225,39575:22227,39576:22231,39577:22254,39578:22265,39579:22272,39580:22271,39581:22276,39582:22281,39583:22280,39584:22283,39585:22285,39586:22291,39587:22296,39588:22294,39589:21959,39590:22300,39591:22310,39592:22327,39593:22328,39594:22350,39595:22331,39596:22336,39597:22351,39598:22377,39599:22464,39600:22408,39601:22369,39602:22399,39603:22409,39604:22419,39605:22432,39606:22451,39607:22436,39608:22442,39609:22448,39610:22467,39611:22470,39612:22484,39613:22482,39614:22483,39615:22538,39616:22486,39617:22499,39618:22539,39619:22553,39620:22557,39621:22642,39622:22561,39623:22626,39624:22603,39625:22640,39626:27584,39627:22610,39628:22589,39629:22649,39630:22661,39631:22713,39632:22687,39633:22699,39634:22714,39635:22750,39636:22715,39637:22712,39638:22702,39639:22725,39640:22739,39641:22737,39642:22743,39643:22745,39644:22744,39645:22757,39646:22748,39647:22756,39648:22751,39649:22767,39650:22778,39651:22777,39652:22779,39653:22780,39654:22781,39655:22786,39656:22794,39657:22800,39658:22811,39659:26790,39660:22821,39661:22828,39662:22829,39663:22834,39664:22840,39665:22846,39666:31442,39667:22869,39668:22864,39669:22862,39670:22874,39671:22872,39672:22882,39673:22880,39674:22887,39675:22892,39676:22889,39744:22904,39745:22913,39746:22941,39747:20318,39748:20395,39749:22947,39750:22962,39751:22982,39752:23016,39753:23004,39754:22925,39755:23001,39756:23002,39757:23077,39758:23071,39759:23057,39760:23068,39761:23049,39762:23066,39763:23104,39764:23148,39765:23113,39766:23093,39767:23094,39768:23138,39769:23146,39770:23194,39771:23228,39772:23230,39773:23243,39774:23234,39775:23229,39776:23267,39777:23255,39778:23270,39779:23273,39780:23254,39781:23290,39782:23291,39783:23308,39784:23307,39785:23318,39786:23346,39787:23248,39788:23338,39789:23350,39790:23358,39791:23363,39792:23365,39793:23360,39794:23377,39795:23381,39796:23386,39797:23387,39798:23397,39799:23401,39800:23408,39801:23411,39802:23413,39803:23416,39804:25992,39805:23418,39806:23424,39808:23427,39809:23462,39810:23480,39811:23491,39812:23495,39813:23497,39814:23508,39815:23504,39816:23524,39817:23526,39818:23522,39819:23518,39820:23525,39821:23531,39822:23536,39823:23542,39824:23539,39825:23557,39826:23559,39827:23560,39828:23565,39829:23571,39830:23584,39831:23586,39832:23592,39833:23608,39834:23609,39835:23617,39836:23622,39837:23630,39838:23635,39839:23632,39840:23631,39841:23409,39842:23660,39843:23662,39844:20066,39845:23670,39846:23673,39847:23692,39848:23697,39849:23700,39850:22939,39851:23723,39852:23739,39853:23734,39854:23740,39855:23735,39856:23749,39857:23742,39858:23751,39859:23769,39860:23785,39861:23805,39862:23802,39863:23789,39864:23948,39865:23786,39866:23819,39867:23829,39868:23831,39869:23900,39870:23839,39871:23835,39872:23825,39873:23828,39874:23842,39875:23834,39876:23833,39877:23832,39878:23884,39879:23890,39880:23886,39881:23883,39882:23916,39883:23923,39884:23926,39885:23943,39886:23940,39887:23938,39888:23970,39889:23965,39890:23980,39891:23982,39892:23997,39893:23952,39894:23991,39895:23996,39896:24009,39897:24013,39898:24019,39899:24018,39900:24022,39901:24027,39902:24043,39903:24050,39904:24053,39905:24075,39906:24090,39907:24089,39908:24081,39909:24091,39910:24118,39911:24119,39912:24132,39913:24131,39914:24128,39915:24142,39916:24151,39917:24148,39918:24159,39919:24162,39920:24164,39921:24135,39922:24181,39923:24182,39924:24186,39925:40636,39926:24191,39927:24224,39928:24257,39929:24258,39930:24264,39931:24272,39932:24271,4e4:24278,40001:24291,40002:24285,40003:24282,40004:24283,40005:24290,40006:24289,40007:24296,40008:24297,40009:24300,40010:24305,40011:24307,40012:24304,40013:24308,40014:24312,40015:24318,40016:24323,40017:24329,40018:24413,40019:24412,40020:24331,40021:24337,40022:24342,40023:24361,40024:24365,40025:24376,40026:24385,40027:24392,40028:24396,40029:24398,40030:24367,40031:24401,40032:24406,40033:24407,40034:24409,40035:24417,40036:24429,40037:24435,40038:24439,40039:24451,40040:24450,40041:24447,40042:24458,40043:24456,40044:24465,40045:24455,40046:24478,40047:24473,40048:24472,40049:24480,40050:24488,40051:24493,40052:24508,40053:24534,40054:24571,40055:24548,40056:24568,40057:24561,40058:24541,40059:24755,40060:24575,40061:24609,40062:24672,40064:24601,40065:24592,40066:24617,40067:24590,40068:24625,40069:24603,40070:24597,40071:24619,40072:24614,40073:24591,40074:24634,40075:24666,40076:24641,40077:24682,40078:24695,40079:24671,40080:24650,40081:24646,40082:24653,40083:24675,40084:24643,40085:24676,40086:24642,40087:24684,40088:24683,40089:24665,40090:24705,40091:24717,40092:24807,40093:24707,40094:24730,40095:24708,40096:24731,40097:24726,40098:24727,40099:24722,40100:24743,40101:24715,40102:24801,40103:24760,40104:24800,40105:24787,40106:24756,40107:24560,40108:24765,40109:24774,40110:24757,40111:24792,40112:24909,40113:24853,40114:24838,40115:24822,40116:24823,40117:24832,40118:24820,40119:24826,40120:24835,40121:24865,40122:24827,40123:24817,40124:24845,40125:24846,40126:24903,40127:24894,40128:24872,40129:24871,40130:24906,40131:24895,40132:24892,40133:24876,40134:24884,40135:24893,40136:24898,40137:24900,40138:24947,40139:24951,40140:24920,40141:24921,40142:24922,40143:24939,40144:24948,40145:24943,40146:24933,40147:24945,40148:24927,40149:24925,40150:24915,40151:24949,40152:24985,40153:24982,40154:24967,40155:25004,40156:24980,40157:24986,40158:24970,40159:24977,40160:25003,40161:25006,40162:25036,40163:25034,40164:25033,40165:25079,40166:25032,40167:25027,40168:25030,40169:25018,40170:25035,40171:32633,40172:25037,40173:25062,40174:25059,40175:25078,40176:25082,40177:25076,40178:25087,40179:25085,40180:25084,40181:25086,40182:25088,40183:25096,40184:25097,40185:25101,40186:25100,40187:25108,40188:25115,40256:25118,40257:25121,40258:25130,40259:25134,40260:25136,40261:25138,40262:25139,40263:25153,40264:25166,40265:25182,40266:25187,40267:25179,40268:25184,40269:25192,40270:25212,40271:25218,40272:25225,40273:25214,40274:25234,40275:25235,40276:25238,40277:25300,40278:25219,40279:25236,40280:25303,40281:25297,40282:25275,40283:25295,40284:25343,40285:25286,40286:25812,40287:25288,40288:25308,40289:25292,40290:25290,40291:25282,40292:25287,40293:25243,40294:25289,40295:25356,40296:25326,40297:25329,40298:25383,40299:25346,40300:25352,40301:25327,40302:25333,40303:25424,40304:25406,40305:25421,40306:25628,40307:25423,40308:25494,40309:25486,40310:25472,40311:25515,40312:25462,40313:25507,40314:25487,40315:25481,40316:25503,40317:25525,40318:25451,40320:25449,40321:25534,40322:25577,40323:25536,40324:25542,40325:25571,40326:25545,40327:25554,40328:25590,40329:25540,40330:25622,40331:25652,40332:25606,40333:25619,40334:25638,40335:25654,40336:25885,40337:25623,40338:25640,40339:25615,40340:25703,40341:25711,40342:25718,40343:25678,40344:25898,40345:25749,40346:25747,40347:25765,40348:25769,40349:25736,40350:25788,40351:25818,40352:25810,40353:25797,40354:25799,40355:25787,40356:25816,40357:25794,40358:25841,40359:25831,40360:33289,40361:25824,40362:25825,40363:25260,40364:25827,40365:25839,40366:25900,40367:25846,40368:25844,40369:25842,40370:25850,40371:25856,40372:25853,40373:25880,40374:25884,40375:25861,40376:25892,40377:25891,40378:25899,40379:25908,40380:25909,40381:25911,40382:25910,40383:25912,40384:30027,40385:25928,40386:25942,40387:25941,40388:25933,40389:25944,40390:25950,40391:25949,40392:25970,40393:25976,40394:25986,40395:25987,40396:35722,40397:26011,40398:26015,40399:26027,40400:26039,40401:26051,40402:26054,40403:26049,40404:26052,40405:26060,40406:26066,40407:26075,40408:26073,40409:26080,40410:26081,40411:26097,40412:26482,40413:26122,40414:26115,40415:26107,40416:26483,40417:26165,40418:26166,40419:26164,40420:26140,40421:26191,40422:26180,40423:26185,40424:26177,40425:26206,40426:26205,40427:26212,40428:26215,40429:26216,40430:26207,40431:26210,40432:26224,40433:26243,40434:26248,40435:26254,40436:26249,40437:26244,40438:26264,40439:26269,40440:26305,40441:26297,40442:26313,40443:26302,40444:26300,40512:26308,40513:26296,40514:26326,40515:26330,40516:26336,40517:26175,40518:26342,40519:26345,40520:26352,40521:26357,40522:26359,40523:26383,40524:26390,40525:26398,40526:26406,40527:26407,40528:38712,40529:26414,40530:26431,40531:26422,40532:26433,40533:26424,40534:26423,40535:26438,40536:26462,40537:26464,40538:26457,40539:26467,40540:26468,40541:26505,40542:26480,40543:26537,40544:26492,40545:26474,40546:26508,40547:26507,40548:26534,40549:26529,40550:26501,40551:26551,40552:26607,40553:26548,40554:26604,40555:26547,40556:26601,40557:26552,40558:26596,40559:26590,40560:26589,40561:26594,40562:26606,40563:26553,40564:26574,40565:26566,40566:26599,40567:27292,40568:26654,40569:26694,40570:26665,40571:26688,40572:26701,40573:26674,40574:26702,40576:26803,40577:26667,40578:26713,40579:26723,40580:26743,40581:26751,40582:26783,40583:26767,40584:26797,40585:26772,40586:26781,40587:26779,40588:26755,40589:27310,40590:26809,40591:26740,40592:26805,40593:26784,40594:26810,40595:26895,40596:26765,40597:26750,40598:26881,40599:26826,40600:26888,40601:26840,40602:26914,40603:26918,40604:26849,40605:26892,40606:26829,40607:26836,40608:26855,40609:26837,40610:26934,40611:26898,40612:26884,40613:26839,40614:26851,40615:26917,40616:26873,40617:26848,40618:26863,40619:26920,40620:26922,40621:26906,40622:26915,40623:26913,40624:26822,40625:27001,40626:26999,40627:26972,40628:27e3,40629:26987,40630:26964,40631:27006,40632:26990,40633:26937,40634:26996,40635:26941,40636:26969,40637:26928,40638:26977,40639:26974,40640:26973,40641:27009,40642:26986,40643:27058,40644:27054,40645:27088,40646:27071,40647:27073,40648:27091,40649:27070,40650:27086,40651:23528,40652:27082,40653:27101,40654:27067,40655:27075,40656:27047,40657:27182,40658:27025,40659:27040,40660:27036,40661:27029,40662:27060,40663:27102,40664:27112,40665:27138,40666:27163,40667:27135,40668:27402,40669:27129,40670:27122,40671:27111,40672:27141,40673:27057,40674:27166,40675:27117,40676:27156,40677:27115,40678:27146,40679:27154,40680:27329,40681:27171,40682:27155,40683:27204,40684:27148,40685:27250,40686:27190,40687:27256,40688:27207,40689:27234,40690:27225,40691:27238,40692:27208,40693:27192,40694:27170,40695:27280,40696:27277,40697:27296,40698:27268,40699:27298,40700:27299,40768:27287,40769:34327,40770:27323,40771:27331,40772:27330,40773:27320,40774:27315,40775:27308,40776:27358,40777:27345,40778:27359,40779:27306,40780:27354,40781:27370,40782:27387,40783:27397,40784:34326,40785:27386,40786:27410,40787:27414,40788:39729,40789:27423,40790:27448,40791:27447,40792:30428,40793:27449,40794:39150,40795:27463,40796:27459,40797:27465,40798:27472,40799:27481,40800:27476,40801:27483,40802:27487,40803:27489,40804:27512,40805:27513,40806:27519,40807:27520,40808:27524,40809:27523,40810:27533,40811:27544,40812:27541,40813:27550,40814:27556,40815:27562,40816:27563,40817:27567,40818:27570,40819:27569,40820:27571,40821:27575,40822:27580,40823:27590,40824:27595,40825:27603,40826:27615,40827:27628,40828:27627,40829:27635,40830:27631,40832:40638,40833:27656,40834:27667,40835:27668,40836:27675,40837:27684,40838:27683,40839:27742,40840:27733,40841:27746,40842:27754,40843:27778,40844:27789,40845:27802,40846:27777,40847:27803,40848:27774,40849:27752,40850:27763,40851:27794,40852:27792,40853:27844,40854:27889,40855:27859,40856:27837,40857:27863,40858:27845,40859:27869,40860:27822,40861:27825,40862:27838,40863:27834,40864:27867,40865:27887,40866:27865,40867:27882,40868:27935,40869:34893,40870:27958,40871:27947,40872:27965,40873:27960,40874:27929,40875:27957,40876:27955,40877:27922,40878:27916,40879:28003,40880:28051,40881:28004,40882:27994,40883:28025,40884:27993,40885:28046,40886:28053,40887:28644,40888:28037,40889:28153,40890:28181,40891:28170,40892:28085,40893:28103,40894:28134,40895:28088,40896:28102,40897:28140,40898:28126,40899:28108,40900:28136,40901:28114,40902:28101,40903:28154,40904:28121,40905:28132,40906:28117,40907:28138,40908:28142,40909:28205,40910:28270,40911:28206,40912:28185,40913:28274,40914:28255,40915:28222,40916:28195,40917:28267,40918:28203,40919:28278,40920:28237,40921:28191,40922:28227,40923:28218,40924:28238,40925:28196,40926:28415,40927:28189,40928:28216,40929:28290,40930:28330,40931:28312,40932:28361,40933:28343,40934:28371,40935:28349,40936:28335,40937:28356,40938:28338,40939:28372,40940:28373,40941:28303,40942:28325,40943:28354,40944:28319,40945:28481,40946:28433,40947:28748,40948:28396,40949:28408,40950:28414,40951:28479,40952:28402,40953:28465,40954:28399,40955:28466,40956:28364,161:65377,162:65378,163:65379,164:65380,165:65381,166:65382,167:65383,168:65384,169:65385,170:65386,171:65387,172:65388,173:65389,174:65390,175:65391,176:65392,177:65393,178:65394,179:65395,180:65396,181:65397,182:65398,183:65399,184:65400,185:65401,186:65402,187:65403,188:65404,189:65405,190:65406,191:65407,192:65408,193:65409,194:65410,195:65411,196:65412,197:65413,198:65414,199:65415,200:65416,201:65417,202:65418,203:65419,204:65420,205:65421,206:65422,207:65423,208:65424,209:65425,210:65426,211:65427,212:65428,213:65429,214:65430,215:65431,216:65432,217:65433,218:65434,219:65435,220:65436,221:65437,222:65438,223:65439,57408:28478,57409:28435,57410:28407,57411:28550,57412:28538,57413:28536,57414:28545,57415:28544,57416:28527,57417:28507,57418:28659,57419:28525,57420:28546,57421:28540,57422:28504,57423:28558,57424:28561,57425:28610,57426:28518,57427:28595,57428:28579,57429:28577,57430:28580,57431:28601,57432:28614,57433:28586,57434:28639,57435:28629,57436:28652,57437:28628,57438:28632,57439:28657,57440:28654,57441:28635,57442:28681,57443:28683,57444:28666,57445:28689,57446:28673,57447:28687,57448:28670,57449:28699,57450:28698,57451:28532,57452:28701,57453:28696,57454:28703,57455:28720,57456:28734,57457:28722,57458:28753,57459:28771,57460:28825,57461:28818,57462:28847,57463:28913,57464:28844,57465:28856,57466:28851,57467:28846,57468:28895,57469:28875,57470:28893,57472:28889,57473:28937,57474:28925,57475:28956,57476:28953,57477:29029,57478:29013,57479:29064,57480:29030,57481:29026,57482:29004,57483:29014,57484:29036,57485:29071,57486:29179,57487:29060,57488:29077,57489:29096,57490:29100,57491:29143,57492:29113,57493:29118,57494:29138,57495:29129,57496:29140,57497:29134,57498:29152,57499:29164,57500:29159,57501:29173,57502:29180,57503:29177,57504:29183,57505:29197,57506:29200,57507:29211,57508:29224,57509:29229,57510:29228,57511:29232,57512:29234,57513:29243,57514:29244,57515:29247,57516:29248,57517:29254,57518:29259,57519:29272,57520:29300,57521:29310,57522:29314,57523:29313,57524:29319,57525:29330,57526:29334,57527:29346,57528:29351,57529:29369,57530:29362,57531:29379,57532:29382,57533:29380,57534:29390,57535:29394,57536:29410,57537:29408,57538:29409,57539:29433,57540:29431,57541:20495,57542:29463,57543:29450,57544:29468,57545:29462,57546:29469,57547:29492,57548:29487,57549:29481,57550:29477,57551:29502,57552:29518,57553:29519,57554:40664,57555:29527,57556:29546,57557:29544,57558:29552,57559:29560,57560:29557,57561:29563,57562:29562,57563:29640,57564:29619,57565:29646,57566:29627,57567:29632,57568:29669,57569:29678,57570:29662,57571:29858,57572:29701,57573:29807,57574:29733,57575:29688,57576:29746,57577:29754,57578:29781,57579:29759,57580:29791,57581:29785,57582:29761,57583:29788,57584:29801,57585:29808,57586:29795,57587:29802,57588:29814,57589:29822,57590:29835,57591:29854,57592:29863,57593:29898,57594:29903,57595:29908,57596:29681,57664:29920,57665:29923,57666:29927,57667:29929,57668:29934,57669:29938,57670:29936,57671:29937,57672:29944,57673:29943,57674:29956,57675:29955,57676:29957,57677:29964,57678:29966,57679:29965,57680:29973,57681:29971,57682:29982,57683:29990,57684:29996,57685:30012,57686:30020,57687:30029,57688:30026,57689:30025,57690:30043,57691:30022,57692:30042,57693:30057,57694:30052,57695:30055,57696:30059,57697:30061,57698:30072,57699:30070,57700:30086,57701:30087,57702:30068,57703:30090,57704:30089,57705:30082,57706:30100,57707:30106,57708:30109,57709:30117,57710:30115,57711:30146,57712:30131,57713:30147,57714:30133,57715:30141,57716:30136,57717:30140,57718:30129,57719:30157,57720:30154,57721:30162,57722:30169,57723:30179,57724:30174,57725:30206,57726:30207,57728:30204,57729:30209,57730:30192,57731:30202,57732:30194,57733:30195,57734:30219,57735:30221,57736:30217,57737:30239,57738:30247,57739:30240,57740:30241,57741:30242,57742:30244,57743:30260,57744:30256,57745:30267,57746:30279,57747:30280,57748:30278,57749:30300,57750:30296,57751:30305,57752:30306,57753:30312,57754:30313,57755:30314,57756:30311,57757:30316,57758:30320,57759:30322,57760:30326,57761:30328,57762:30332,57763:30336,57764:30339,57765:30344,57766:30347,57767:30350,57768:30358,57769:30355,57770:30361,57771:30362,57772:30384,57773:30388,57774:30392,57775:30393,57776:30394,57777:30402,57778:30413,57779:30422,57780:30418,57781:30430,57782:30433,57783:30437,57784:30439,57785:30442,57786:34351,57787:30459,57788:30472,57789:30471,57790:30468,57791:30505,57792:30500,57793:30494,57794:30501,57795:30502,57796:30491,57797:30519,57798:30520,57799:30535,57800:30554,57801:30568,57802:30571,57803:30555,57804:30565,57805:30591,57806:30590,57807:30585,57808:30606,57809:30603,57810:30609,57811:30624,57812:30622,57813:30640,57814:30646,57815:30649,57816:30655,57817:30652,57818:30653,57819:30651,57820:30663,57821:30669,57822:30679,57823:30682,57824:30684,57825:30691,57826:30702,57827:30716,57828:30732,57829:30738,57830:31014,57831:30752,57832:31018,57833:30789,57834:30862,57835:30836,57836:30854,57837:30844,57838:30874,57839:30860,57840:30883,57841:30901,57842:30890,57843:30895,57844:30929,57845:30918,57846:30923,57847:30932,57848:30910,57849:30908,57850:30917,57851:30922,57852:30956,57920:30951,57921:30938,57922:30973,57923:30964,57924:30983,57925:30994,57926:30993,57927:31001,57928:31020,57929:31019,57930:31040,57931:31072,57932:31063,57933:31071,57934:31066,57935:31061,57936:31059,57937:31098,57938:31103,57939:31114,57940:31133,57941:31143,57942:40779,57943:31146,57944:31150,57945:31155,57946:31161,57947:31162,57948:31177,57949:31189,57950:31207,57951:31212,57952:31201,57953:31203,57954:31240,57955:31245,57956:31256,57957:31257,57958:31264,57959:31263,57960:31104,57961:31281,57962:31291,57963:31294,57964:31287,57965:31299,57966:31319,57967:31305,57968:31329,57969:31330,57970:31337,57971:40861,57972:31344,57973:31353,57974:31357,57975:31368,57976:31383,57977:31381,57978:31384,57979:31382,57980:31401,57981:31432,57982:31408,57984:31414,57985:31429,57986:31428,57987:31423,57988:36995,57989:31431,57990:31434,57991:31437,57992:31439,57993:31445,57994:31443,57995:31449,57996:31450,57997:31453,57998:31457,57999:31458,58e3:31462,58001:31469,58002:31472,58003:31490,58004:31503,58005:31498,58006:31494,58007:31539,58008:31512,58009:31513,58010:31518,58011:31541,58012:31528,58013:31542,58014:31568,58015:31610,58016:31492,58017:31565,58018:31499,58019:31564,58020:31557,58021:31605,58022:31589,58023:31604,58024:31591,58025:31600,58026:31601,58027:31596,58028:31598,58029:31645,58030:31640,58031:31647,58032:31629,58033:31644,58034:31642,58035:31627,58036:31634,58037:31631,58038:31581,58039:31641,58040:31691,58041:31681,58042:31692,58043:31695,58044:31668,58045:31686,58046:31709,58047:31721,58048:31761,58049:31764,58050:31718,58051:31717,58052:31840,58053:31744,58054:31751,58055:31763,58056:31731,58057:31735,58058:31767,58059:31757,58060:31734,58061:31779,58062:31783,58063:31786,58064:31775,58065:31799,58066:31787,58067:31805,58068:31820,58069:31811,58070:31828,58071:31823,58072:31808,58073:31824,58074:31832,58075:31839,58076:31844,58077:31830,58078:31845,58079:31852,58080:31861,58081:31875,58082:31888,58083:31908,58084:31917,58085:31906,58086:31915,58087:31905,58088:31912,58089:31923,58090:31922,58091:31921,58092:31918,58093:31929,58094:31933,58095:31936,58096:31941,58097:31938,58098:31960,58099:31954,58100:31964,58101:31970,58102:39739,58103:31983,58104:31986,58105:31988,58106:31990,58107:31994,58108:32006,58176:32002,58177:32028,58178:32021,58179:32010,58180:32069,58181:32075,58182:32046,58183:32050,58184:32063,58185:32053,58186:32070,58187:32115,58188:32086,58189:32078,58190:32114,58191:32104,58192:32110,58193:32079,58194:32099,58195:32147,58196:32137,58197:32091,58198:32143,58199:32125,58200:32155,58201:32186,58202:32174,58203:32163,58204:32181,58205:32199,58206:32189,58207:32171,58208:32317,58209:32162,58210:32175,58211:32220,58212:32184,58213:32159,58214:32176,58215:32216,58216:32221,58217:32228,58218:32222,58219:32251,58220:32242,58221:32225,58222:32261,58223:32266,58224:32291,58225:32289,58226:32274,58227:32305,58228:32287,58229:32265,58230:32267,58231:32290,58232:32326,58233:32358,58234:32315,58235:32309,58236:32313,58237:32323,58238:32311,58240:32306,58241:32314,58242:32359,58243:32349,58244:32342,58245:32350,58246:32345,58247:32346,58248:32377,58249:32362,58250:32361,58251:32380,58252:32379,58253:32387,58254:32213,58255:32381,58256:36782,58257:32383,58258:32392,58259:32393,58260:32396,58261:32402,58262:32400,58263:32403,58264:32404,58265:32406,58266:32398,58267:32411,58268:32412,58269:32568,58270:32570,58271:32581,58272:32588,58273:32589,58274:32590,58275:32592,58276:32593,58277:32597,58278:32596,58279:32600,58280:32607,58281:32608,58282:32616,58283:32617,58284:32615,58285:32632,58286:32642,58287:32646,58288:32643,58289:32648,58290:32647,58291:32652,58292:32660,58293:32670,58294:32669,58295:32666,58296:32675,58297:32687,58298:32690,58299:32697,58300:32686,58301:32694,58302:32696,58303:35697,58304:32709,58305:32710,58306:32714,58307:32725,58308:32724,58309:32737,58310:32742,58311:32745,58312:32755,58313:32761,58314:39132,58315:32774,58316:32772,58317:32779,58318:32786,58319:32792,58320:32793,58321:32796,58322:32801,58323:32808,58324:32831,58325:32827,58326:32842,58327:32838,58328:32850,58329:32856,58330:32858,58331:32863,58332:32866,58333:32872,58334:32883,58335:32882,58336:32880,58337:32886,58338:32889,58339:32893,58340:32895,58341:32900,58342:32902,58343:32901,58344:32923,58345:32915,58346:32922,58347:32941,58348:20880,58349:32940,58350:32987,58351:32997,58352:32985,58353:32989,58354:32964,58355:32986,58356:32982,58357:33033,58358:33007,58359:33009,58360:33051,58361:33065,58362:33059,58363:33071,58364:33099,58432:38539,58433:33094,58434:33086,58435:33107,58436:33105,58437:33020,58438:33137,58439:33134,58440:33125,58441:33126,58442:33140,58443:33155,58444:33160,58445:33162,58446:33152,58447:33154,58448:33184,58449:33173,58450:33188,58451:33187,58452:33119,58453:33171,58454:33193,58455:33200,58456:33205,58457:33214,58458:33208,58459:33213,58460:33216,58461:33218,58462:33210,58463:33225,58464:33229,58465:33233,58466:33241,58467:33240,58468:33224,58469:33242,58470:33247,58471:33248,58472:33255,58473:33274,58474:33275,58475:33278,58476:33281,58477:33282,58478:33285,58479:33287,58480:33290,58481:33293,58482:33296,58483:33302,58484:33321,58485:33323,58486:33336,58487:33331,58488:33344,58489:33369,58490:33368,58491:33373,58492:33370,58493:33375,58494:33380,58496:33378,58497:33384,58498:33386,58499:33387,58500:33326,58501:33393,58502:33399,58503:33400,58504:33406,58505:33421,58506:33426,58507:33451,58508:33439,58509:33467,58510:33452,58511:33505,58512:33507,58513:33503,58514:33490,58515:33524,58516:33523,58517:33530,58518:33683,58519:33539,58520:33531,58521:33529,58522:33502,58523:33542,58524:33500,58525:33545,58526:33497,58527:33589,58528:33588,58529:33558,58530:33586,58531:33585,58532:33600,58533:33593,58534:33616,58535:33605,58536:33583,58537:33579,58538:33559,58539:33560,58540:33669,58541:33690,58542:33706,58543:33695,58544:33698,58545:33686,58546:33571,58547:33678,58548:33671,58549:33674,58550:33660,58551:33717,58552:33651,58553:33653,58554:33696,58555:33673,58556:33704,58557:33780,58558:33811,58559:33771,58560:33742,58561:33789,58562:33795,58563:33752,58564:33803,58565:33729,58566:33783,58567:33799,58568:33760,58569:33778,58570:33805,58571:33826,58572:33824,58573:33725,58574:33848,58575:34054,58576:33787,58577:33901,58578:33834,58579:33852,58580:34138,58581:33924,58582:33911,58583:33899,58584:33965,58585:33902,58586:33922,58587:33897,58588:33862,58589:33836,58590:33903,58591:33913,58592:33845,58593:33994,58594:33890,58595:33977,58596:33983,58597:33951,58598:34009,58599:33997,58600:33979,58601:34010,58602:34e3,58603:33985,58604:33990,58605:34006,58606:33953,58607:34081,58608:34047,58609:34036,58610:34071,58611:34072,58612:34092,58613:34079,58614:34069,58615:34068,58616:34044,58617:34112,58618:34147,58619:34136,58620:34120,58688:34113,58689:34306,58690:34123,58691:34133,58692:34176,58693:34212,58694:34184,58695:34193,58696:34186,58697:34216,58698:34157,58699:34196,58700:34203,58701:34282,58702:34183,58703:34204,58704:34167,58705:34174,58706:34192,58707:34249,58708:34234,58709:34255,58710:34233,58711:34256,58712:34261,58713:34269,58714:34277,58715:34268,58716:34297,58717:34314,58718:34323,58719:34315,58720:34302,58721:34298,58722:34310,58723:34338,58724:34330,58725:34352,58726:34367,58727:34381,58728:20053,58729:34388,58730:34399,58731:34407,58732:34417,58733:34451,58734:34467,58735:34473,58736:34474,58737:34443,58738:34444,58739:34486,58740:34479,58741:34500,58742:34502,58743:34480,58744:34505,58745:34851,58746:34475,58747:34516,58748:34526,58749:34537,58750:34540,58752:34527,58753:34523,58754:34543,58755:34578,58756:34566,58757:34568,58758:34560,58759:34563,58760:34555,58761:34577,58762:34569,58763:34573,58764:34553,58765:34570,58766:34612,58767:34623,58768:34615,58769:34619,58770:34597,58771:34601,58772:34586,58773:34656,58774:34655,58775:34680,58776:34636,58777:34638,58778:34676,58779:34647,58780:34664,58781:34670,58782:34649,58783:34643,58784:34659,58785:34666,58786:34821,58787:34722,58788:34719,58789:34690,58790:34735,58791:34763,58792:34749,58793:34752,58794:34768,58795:38614,58796:34731,58797:34756,58798:34739,58799:34759,58800:34758,58801:34747,58802:34799,58803:34802,58804:34784,58805:34831,58806:34829,58807:34814,58808:34806,58809:34807,58810:34830,58811:34770,58812:34833,58813:34838,58814:34837,58815:34850,58816:34849,58817:34865,58818:34870,58819:34873,58820:34855,58821:34875,58822:34884,58823:34882,58824:34898,58825:34905,58826:34910,58827:34914,58828:34923,58829:34945,58830:34942,58831:34974,58832:34933,58833:34941,58834:34997,58835:34930,58836:34946,58837:34967,58838:34962,58839:34990,58840:34969,58841:34978,58842:34957,58843:34980,58844:34992,58845:35007,58846:34993,58847:35011,58848:35012,58849:35028,58850:35032,58851:35033,58852:35037,58853:35065,58854:35074,58855:35068,58856:35060,58857:35048,58858:35058,58859:35076,58860:35084,58861:35082,58862:35091,58863:35139,58864:35102,58865:35109,58866:35114,58867:35115,58868:35137,58869:35140,58870:35131,58871:35126,58872:35128,58873:35148,58874:35101,58875:35168,58876:35166,58944:35174,58945:35172,58946:35181,58947:35178,58948:35183,58949:35188,58950:35191,58951:35198,58952:35203,58953:35208,58954:35210,58955:35219,58956:35224,58957:35233,58958:35241,58959:35238,58960:35244,58961:35247,58962:35250,58963:35258,58964:35261,58965:35263,58966:35264,58967:35290,58968:35292,58969:35293,58970:35303,58971:35316,58972:35320,58973:35331,58974:35350,58975:35344,58976:35340,58977:35355,58978:35357,58979:35365,58980:35382,58981:35393,58982:35419,58983:35410,58984:35398,58985:35400,58986:35452,58987:35437,58988:35436,58989:35426,58990:35461,58991:35458,58992:35460,58993:35496,58994:35489,58995:35473,58996:35493,58997:35494,58998:35482,58999:35491,59e3:35524,59001:35533,59002:35522,59003:35546,59004:35563,59005:35571,59006:35559,59008:35556,59009:35569,59010:35604,59011:35552,59012:35554,59013:35575,59014:35550,59015:35547,59016:35596,59017:35591,59018:35610,59019:35553,59020:35606,59021:35600,59022:35607,59023:35616,59024:35635,59025:38827,59026:35622,59027:35627,59028:35646,59029:35624,59030:35649,59031:35660,59032:35663,59033:35662,59034:35657,59035:35670,59036:35675,59037:35674,59038:35691,59039:35679,59040:35692,59041:35695,59042:35700,59043:35709,59044:35712,59045:35724,59046:35726,59047:35730,59048:35731,59049:35734,59050:35737,59051:35738,59052:35898,59053:35905,59054:35903,59055:35912,59056:35916,59057:35918,59058:35920,59059:35925,59060:35938,59061:35948,59062:35960,59063:35962,59064:35970,59065:35977,59066:35973,59067:35978,59068:35981,59069:35982,59070:35988,59071:35964,59072:35992,59073:25117,59074:36013,59075:36010,59076:36029,59077:36018,59078:36019,59079:36014,59080:36022,59081:36040,59082:36033,59083:36068,59084:36067,59085:36058,59086:36093,59087:36090,59088:36091,59089:36100,59090:36101,59091:36106,59092:36103,59093:36111,59094:36109,59095:36112,59096:40782,59097:36115,59098:36045,59099:36116,59100:36118,59101:36199,59102:36205,59103:36209,59104:36211,59105:36225,59106:36249,59107:36290,59108:36286,59109:36282,59110:36303,59111:36314,59112:36310,59113:36300,59114:36315,59115:36299,59116:36330,59117:36331,59118:36319,59119:36323,59120:36348,59121:36360,59122:36361,59123:36351,59124:36381,59125:36382,59126:36368,59127:36383,59128:36418,59129:36405,59130:36400,59131:36404,59132:36426,59200:36423,59201:36425,59202:36428,59203:36432,59204:36424,59205:36441,59206:36452,59207:36448,59208:36394,59209:36451,59210:36437,59211:36470,59212:36466,59213:36476,59214:36481,59215:36487,59216:36485,59217:36484,59218:36491,59219:36490,59220:36499,59221:36497,59222:36500,59223:36505,59224:36522,59225:36513,59226:36524,59227:36528,59228:36550,59229:36529,59230:36542,59231:36549,59232:36552,59233:36555,59234:36571,59235:36579,59236:36604,59237:36603,59238:36587,59239:36606,59240:36618,59241:36613,59242:36629,59243:36626,59244:36633,59245:36627,59246:36636,59247:36639,59248:36635,59249:36620,59250:36646,59251:36659,59252:36667,59253:36665,59254:36677,59255:36674,59256:36670,59257:36684,59258:36681,59259:36678,59260:36686,59261:36695,59262:36700,59264:36706,59265:36707,59266:36708,59267:36764,59268:36767,59269:36771,59270:36781,59271:36783,59272:36791,59273:36826,59274:36837,59275:36834,59276:36842,59277:36847,59278:36999,59279:36852,59280:36869,59281:36857,59282:36858,59283:36881,59284:36885,59285:36897,59286:36877,59287:36894,59288:36886,59289:36875,59290:36903,59291:36918,59292:36917,59293:36921,59294:36856,59295:36943,59296:36944,59297:36945,59298:36946,59299:36878,59300:36937,59301:36926,59302:36950,59303:36952,59304:36958,59305:36968,59306:36975,59307:36982,59308:38568,59309:36978,59310:36994,59311:36989,59312:36993,59313:36992,59314:37002,59315:37001,59316:37007,59317:37032,59318:37039,59319:37041,59320:37045,59321:37090,59322:37092,59323:25160,59324:37083,59325:37122,59326:37138,59327:37145,59328:37170,59329:37168,59330:37194,59331:37206,59332:37208,59333:37219,59334:37221,59335:37225,59336:37235,59337:37234,59338:37259,59339:37257,59340:37250,59341:37282,59342:37291,59343:37295,59344:37290,59345:37301,59346:37300,59347:37306,59348:37312,59349:37313,59350:37321,59351:37323,59352:37328,59353:37334,59354:37343,59355:37345,59356:37339,59357:37372,59358:37365,59359:37366,59360:37406,59361:37375,59362:37396,59363:37420,59364:37397,59365:37393,59366:37470,59367:37463,59368:37445,59369:37449,59370:37476,59371:37448,59372:37525,59373:37439,59374:37451,59375:37456,59376:37532,59377:37526,59378:37523,59379:37531,59380:37466,59381:37583,59382:37561,59383:37559,59384:37609,59385:37647,59386:37626,59387:37700,59388:37678,59456:37657,59457:37666,59458:37658,59459:37667,59460:37690,59461:37685,59462:37691,59463:37724,59464:37728,59465:37756,59466:37742,59467:37718,59468:37808,59469:37804,59470:37805,59471:37780,59472:37817,59473:37846,59474:37847,59475:37864,59476:37861,59477:37848,59478:37827,59479:37853,59480:37840,59481:37832,59482:37860,59483:37914,59484:37908,59485:37907,59486:37891,59487:37895,59488:37904,59489:37942,59490:37931,59491:37941,59492:37921,59493:37946,59494:37953,59495:37970,59496:37956,59497:37979,59498:37984,59499:37986,59500:37982,59501:37994,59502:37417,59503:38e3,59504:38005,59505:38007,59506:38013,59507:37978,59508:38012,59509:38014,59510:38017,59511:38015,59512:38274,59513:38279,59514:38282,59515:38292,59516:38294,59517:38296,59518:38297,59520:38304,59521:38312,59522:38311,59523:38317,59524:38332,59525:38331,59526:38329,59527:38334,59528:38346,59529:28662,59530:38339,59531:38349,59532:38348,59533:38357,59534:38356,59535:38358,59536:38364,59537:38369,59538:38373,59539:38370,59540:38433,59541:38440,59542:38446,59543:38447,59544:38466,59545:38476,59546:38479,59547:38475,59548:38519,59549:38492,59550:38494,59551:38493,59552:38495,59553:38502,59554:38514,59555:38508,59556:38541,59557:38552,59558:38549,59559:38551,59560:38570,59561:38567,59562:38577,59563:38578,59564:38576,59565:38580,59566:38582,59567:38584,59568:38585,59569:38606,59570:38603,59571:38601,59572:38605,59573:35149,59574:38620,59575:38669,59576:38613,59577:38649,59578:38660,59579:38662,59580:38664,59581:38675,59582:38670,59583:38673,59584:38671,59585:38678,59586:38681,59587:38692,59588:38698,59589:38704,59590:38713,59591:38717,59592:38718,59593:38724,59594:38726,59595:38728,59596:38722,59597:38729,59598:38748,59599:38752,59600:38756,59601:38758,59602:38760,59603:21202,59604:38763,59605:38769,59606:38777,59607:38789,59608:38780,59609:38785,59610:38778,59611:38790,59612:38795,59613:38799,59614:38800,59615:38812,59616:38824,59617:38822,59618:38819,59619:38835,59620:38836,59621:38851,59622:38854,59623:38856,59624:38859,59625:38876,59626:38893,59627:40783,59628:38898,59629:31455,59630:38902,59631:38901,59632:38927,59633:38924,59634:38968,59635:38948,59636:38945,59637:38967,59638:38973,59639:38982,59640:38991,59641:38987,59642:39019,59643:39023,59644:39024,59712:39025,59713:39028,59714:39027,59715:39082,59716:39087,59717:39089,59718:39094,59719:39108,59720:39107,59721:39110,59722:39145,59723:39147,59724:39171,59725:39177,59726:39186,59727:39188,59728:39192,59729:39201,59730:39197,59731:39198,59732:39204,59733:39200,59734:39212,59735:39214,59736:39229,59737:39230,59738:39234,59739:39241,59740:39237,59741:39248,59742:39243,59743:39249,59744:39250,59745:39244,59746:39253,59747:39319,59748:39320,59749:39333,59750:39341,59751:39342,59752:39356,59753:39391,59754:39387,59755:39389,59756:39384,59757:39377,59758:39405,59759:39406,59760:39409,59761:39410,59762:39419,59763:39416,59764:39425,59765:39439,59766:39429,59767:39394,59768:39449,59769:39467,59770:39479,59771:39493,59772:39490,59773:39488,59774:39491,59776:39486,59777:39509,59778:39501,59779:39515,59780:39511,59781:39519,59782:39522,59783:39525,59784:39524,59785:39529,59786:39531,59787:39530,59788:39597,59789:39600,59790:39612,59791:39616,59792:39631,59793:39633,59794:39635,59795:39636,59796:39646,59797:39647,59798:39650,59799:39651,59800:39654,59801:39663,59802:39659,59803:39662,59804:39668,59805:39665,59806:39671,59807:39675,59808:39686,59809:39704,59810:39706,59811:39711,59812:39714,59813:39715,59814:39717,59815:39719,59816:39720,59817:39721,59818:39722,59819:39726,59820:39727,59821:39730,59822:39748,59823:39747,59824:39759,59825:39757,59826:39758,59827:39761,59828:39768,59829:39796,59830:39827,59831:39811,59832:39825,59833:39830,59834:39831,59835:39839,59836:39840,59837:39848,59838:39860,59839:39872,59840:39882,59841:39865,59842:39878,59843:39887,59844:39889,59845:39890,59846:39907,59847:39906,59848:39908,59849:39892,59850:39905,59851:39994,59852:39922,59853:39921,59854:39920,59855:39957,59856:39956,59857:39945,59858:39955,59859:39948,59860:39942,59861:39944,59862:39954,59863:39946,59864:39940,59865:39982,59866:39963,59867:39973,59868:39972,59869:39969,59870:39984,59871:40007,59872:39986,59873:40006,59874:39998,59875:40026,59876:40032,59877:40039,59878:40054,59879:40056,59880:40167,59881:40172,59882:40176,59883:40201,59884:40200,59885:40171,59886:40195,59887:40198,59888:40234,59889:40230,59890:40367,59891:40227,59892:40223,59893:40260,59894:40213,59895:40210,59896:40257,59897:40255,59898:40254,59899:40262,59900:40264,59968:40285,59969:40286,59970:40292,59971:40273,59972:40272,59973:40281,59974:40306,59975:40329,59976:40327,59977:40363,59978:40303,59979:40314,59980:40346,59981:40356,59982:40361,59983:40370,59984:40388,59985:40385,59986:40379,59987:40376,59988:40378,59989:40390,59990:40399,59991:40386,59992:40409,59993:40403,59994:40440,59995:40422,59996:40429,59997:40431,59998:40445,59999:40474,6e4:40475,60001:40478,60002:40565,60003:40569,60004:40573,60005:40577,60006:40584,60007:40587,60008:40588,60009:40594,60010:40597,60011:40593,60012:40605,60013:40613,60014:40617,60015:40632,60016:40618,60017:40621,60018:38753,60019:40652,60020:40654,60021:40655,60022:40656,60023:40660,60024:40668,60025:40670,60026:40669,60027:40672,60028:40677,60029:40680,60030:40687,60032:40692,60033:40694,60034:40695,60035:40697,60036:40699,60037:40700,60038:40701,60039:40711,60040:40712,60041:30391,60042:40725,60043:40737,60044:40748,60045:40766,60046:40778,60047:40786,60048:40788,60049:40803,60050:40799,60051:40800,60052:40801,60053:40806,60054:40807,60055:40812,60056:40810,60057:40823,60058:40818,60059:40822,60060:40853,60061:40860,60062:40864,60063:22575,60064:27079,60065:36953,60066:29796,60067:20956,60068:29081}},function(i,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=t(1),r=t(2);function s(l,u,h,d){var f;u.degree()<h.degree()&&(f=[h,u],u=f[0],h=f[1]);for(var x=u,g=h,p=l.zero,m=l.one;g.degree()>=d/2;){var v=x,E=p;if(x=g,p=m,x.isZero())return null;g=v;for(var y=l.zero,w=x.getCoefficient(x.degree()),A=l.inverse(w);g.degree()>=x.degree()&&!g.isZero();){var b=g.degree()-x.degree(),D=l.multiply(g.getCoefficient(g.degree()),A);y=y.addOrSubtract(l.buildMonomial(b,D)),g=g.addOrSubtract(x.multiplyByMonomial(b,D))}if(m=y.multiplyPoly(p).addOrSubtract(E),g.degree()>=x.degree())return null}var C=m.getCoefficient(0);if(C===0)return null;var _=l.inverse(C);return[m.multiply(_),g.multiply(_)]}function o(l,u){var h=u.degree();if(h===1)return[u.getCoefficient(1)];for(var d=new Array(h),f=0,x=1;x<l.size&&f<h;x++)u.evaluateAt(x)===0&&(d[f]=l.inverse(x),f++);return f!==h?null:d}function a(l,u,h){for(var d=h.length,f=new Array(d),x=0;x<d;x++){for(var g=l.inverse(h[x]),p=1,m=0;m<d;m++)x!==m&&(p=l.multiply(p,n.addOrSubtractGF(1,l.multiply(h[m],g))));f[x]=l.multiply(u.evaluateAt(g),l.inverse(p)),l.generatorBase!==0&&(f[x]=l.multiply(f[x],g))}return f}function c(l,u){var h=new Uint8ClampedArray(l.length);h.set(l);for(var d=new n.default(285,256,0),f=new r.default(d,h),x=new Uint8ClampedArray(u),g=!1,p=0;p<u;p++){var m=f.evaluateAt(d.exp(p+d.generatorBase));x[x.length-1-p]=m,m!==0&&(g=!0)}if(!g)return h;var v=new r.default(d,x),E=s(d,d.buildMonomial(u,1),v,u);if(E===null)return null;var y=o(d,E[0]);if(y==null)return null;for(var w=a(d,E[1],y),A=0;A<y.length;A++){var b=h.length-1-d.log(y[A]);if(b<0)return null;h[b]=n.addOrSubtractGF(h[b],w[A])}return h}e.decode=c},function(i,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VERSIONS=[{infoBits:null,versionNumber:1,alignmentPatternCenters:[],errorCorrectionLevels:[{ecCodewordsPerBlock:7,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:10,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:16}]},{ecCodewordsPerBlock:13,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:13}]},{ecCodewordsPerBlock:17,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:9}]}]},{infoBits:null,versionNumber:2,alignmentPatternCenters:[6,18],errorCorrectionLevels:[{ecCodewordsPerBlock:10,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:34}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:28}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:22}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:16}]}]},{infoBits:null,versionNumber:3,alignmentPatternCenters:[6,22],errorCorrectionLevels:[{ecCodewordsPerBlock:15,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:55}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:13}]}]},{infoBits:null,versionNumber:4,alignmentPatternCenters:[6,26],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:80}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:32}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:9}]}]},{infoBits:null,versionNumber:5,alignmentPatternCenters:[6,30],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:43}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:15},{numBlocks:2,dataCodewordsPerBlock:16}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:11},{numBlocks:2,dataCodewordsPerBlock:12}]}]},{infoBits:null,versionNumber:6,alignmentPatternCenters:[6,34],errorCorrectionLevels:[{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:68}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:27}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:15}]}]},{infoBits:31892,versionNumber:7,alignmentPatternCenters:[6,22,38],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:78}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:31}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:4,dataCodewordsPerBlock:15}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:13},{numBlocks:1,dataCodewordsPerBlock:14}]}]},{infoBits:34236,versionNumber:8,alignmentPatternCenters:[6,24,42],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:97}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:38},{numBlocks:2,dataCodewordsPerBlock:39}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:18},{numBlocks:2,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:14},{numBlocks:2,dataCodewordsPerBlock:15}]}]},{infoBits:39577,versionNumber:9,alignmentPatternCenters:[6,26,46],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:36},{numBlocks:2,dataCodewordsPerBlock:37}]},{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:16},{numBlocks:4,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:12},{numBlocks:4,dataCodewordsPerBlock:13}]}]},{infoBits:42195,versionNumber:10,alignmentPatternCenters:[6,28,50],errorCorrectionLevels:[{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:68},{numBlocks:2,dataCodewordsPerBlock:69}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:43},{numBlocks:1,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:19},{numBlocks:2,dataCodewordsPerBlock:20}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:15},{numBlocks:2,dataCodewordsPerBlock:16}]}]},{infoBits:48118,versionNumber:11,alignmentPatternCenters:[6,30,54],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:81}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:50},{numBlocks:4,dataCodewordsPerBlock:51}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:22},{numBlocks:4,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:12},{numBlocks:8,dataCodewordsPerBlock:13}]}]},{infoBits:51042,versionNumber:12,alignmentPatternCenters:[6,32,58],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:92},{numBlocks:2,dataCodewordsPerBlock:93}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:36},{numBlocks:2,dataCodewordsPerBlock:37}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:20},{numBlocks:6,dataCodewordsPerBlock:21}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:14},{numBlocks:4,dataCodewordsPerBlock:15}]}]},{infoBits:55367,versionNumber:13,alignmentPatternCenters:[6,34,62],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:107}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:37},{numBlocks:1,dataCodewordsPerBlock:38}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:20},{numBlocks:4,dataCodewordsPerBlock:21}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:11},{numBlocks:4,dataCodewordsPerBlock:12}]}]},{infoBits:58893,versionNumber:14,alignmentPatternCenters:[6,26,46,66],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:115},{numBlocks:1,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:40},{numBlocks:5,dataCodewordsPerBlock:41}]},{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:16},{numBlocks:5,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:12},{numBlocks:5,dataCodewordsPerBlock:13}]}]},{infoBits:63784,versionNumber:15,alignmentPatternCenters:[6,26,48,70],errorCorrectionLevels:[{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:87},{numBlocks:1,dataCodewordsPerBlock:88}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:41},{numBlocks:5,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:24},{numBlocks:7,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:12},{numBlocks:7,dataCodewordsPerBlock:13}]}]},{infoBits:68472,versionNumber:16,alignmentPatternCenters:[6,26,50,74],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:98},{numBlocks:1,dataCodewordsPerBlock:99}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:45},{numBlocks:3,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:19},{numBlocks:2,dataCodewordsPerBlock:20}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:15},{numBlocks:13,dataCodewordsPerBlock:16}]}]},{infoBits:70749,versionNumber:17,alignmentPatternCenters:[6,30,54,78],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:107},{numBlocks:5,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:46},{numBlocks:1,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:22},{numBlocks:15,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:17,dataCodewordsPerBlock:15}]}]},{infoBits:76311,versionNumber:18,alignmentPatternCenters:[6,30,56,82],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:120},{numBlocks:1,dataCodewordsPerBlock:121}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:9,dataCodewordsPerBlock:43},{numBlocks:4,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:22},{numBlocks:1,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:19,dataCodewordsPerBlock:15}]}]},{infoBits:79154,versionNumber:19,alignmentPatternCenters:[6,30,58,86],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:113},{numBlocks:4,dataCodewordsPerBlock:114}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:44},{numBlocks:11,dataCodewordsPerBlock:45}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:21},{numBlocks:4,dataCodewordsPerBlock:22}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:9,dataCodewordsPerBlock:13},{numBlocks:16,dataCodewordsPerBlock:14}]}]},{infoBits:84390,versionNumber:20,alignmentPatternCenters:[6,34,62,90],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:107},{numBlocks:5,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:41},{numBlocks:13,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:24},{numBlocks:5,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:15},{numBlocks:10,dataCodewordsPerBlock:16}]}]},{infoBits:87683,versionNumber:21,alignmentPatternCenters:[6,28,50,72,94],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:116},{numBlocks:4,dataCodewordsPerBlock:117}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:22},{numBlocks:6,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:16},{numBlocks:6,dataCodewordsPerBlock:17}]}]},{infoBits:92361,versionNumber:22,alignmentPatternCenters:[6,26,50,74,98],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:111},{numBlocks:7,dataCodewordsPerBlock:112}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:24},{numBlocks:16,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:34,dataCodewordsPerBlock:13}]}]},{infoBits:96236,versionNumber:23,alignmentPatternCenters:[6,30,54,74,102],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:121},{numBlocks:5,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:47},{numBlocks:14,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:16,dataCodewordsPerBlock:15},{numBlocks:14,dataCodewordsPerBlock:16}]}]},{infoBits:102084,versionNumber:24,alignmentPatternCenters:[6,28,54,80,106],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:117},{numBlocks:4,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:45},{numBlocks:14,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:24},{numBlocks:16,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:30,dataCodewordsPerBlock:16},{numBlocks:2,dataCodewordsPerBlock:17}]}]},{infoBits:102881,versionNumber:25,alignmentPatternCenters:[6,32,58,84,110],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:106},{numBlocks:4,dataCodewordsPerBlock:107}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:47},{numBlocks:13,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:24},{numBlocks:22,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:15},{numBlocks:13,dataCodewordsPerBlock:16}]}]},{infoBits:110507,versionNumber:26,alignmentPatternCenters:[6,30,58,86,114],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:114},{numBlocks:2,dataCodewordsPerBlock:115}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:46},{numBlocks:4,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:28,dataCodewordsPerBlock:22},{numBlocks:6,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:33,dataCodewordsPerBlock:16},{numBlocks:4,dataCodewordsPerBlock:17}]}]},{infoBits:110734,versionNumber:27,alignmentPatternCenters:[6,34,62,90,118],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:122},{numBlocks:4,dataCodewordsPerBlock:123}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:45},{numBlocks:3,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:23},{numBlocks:26,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:15},{numBlocks:28,dataCodewordsPerBlock:16}]}]},{infoBits:117786,versionNumber:28,alignmentPatternCenters:[6,26,50,74,98,122],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:117},{numBlocks:10,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:45},{numBlocks:23,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:24},{numBlocks:31,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:15},{numBlocks:31,dataCodewordsPerBlock:16}]}]},{infoBits:119615,versionNumber:29,alignmentPatternCenters:[6,30,54,78,102,126],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:116},{numBlocks:7,dataCodewordsPerBlock:117}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:21,dataCodewordsPerBlock:45},{numBlocks:7,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:23},{numBlocks:37,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:15},{numBlocks:26,dataCodewordsPerBlock:16}]}]},{infoBits:126325,versionNumber:30,alignmentPatternCenters:[6,26,52,78,104,130],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:115},{numBlocks:10,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:47},{numBlocks:10,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:24},{numBlocks:25,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:23,dataCodewordsPerBlock:15},{numBlocks:25,dataCodewordsPerBlock:16}]}]},{infoBits:127568,versionNumber:31,alignmentPatternCenters:[6,30,56,82,108,134],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:115},{numBlocks:3,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:46},{numBlocks:29,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:42,dataCodewordsPerBlock:24},{numBlocks:1,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:23,dataCodewordsPerBlock:15},{numBlocks:28,dataCodewordsPerBlock:16}]}]},{infoBits:133589,versionNumber:32,alignmentPatternCenters:[6,34,60,86,112,138],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:115}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:46},{numBlocks:23,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:24},{numBlocks:35,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:15},{numBlocks:35,dataCodewordsPerBlock:16}]}]},{infoBits:136944,versionNumber:33,alignmentPatternCenters:[6,30,58,86,114,142],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:115},{numBlocks:1,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:14,dataCodewordsPerBlock:46},{numBlocks:21,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:29,dataCodewordsPerBlock:24},{numBlocks:19,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:15},{numBlocks:46,dataCodewordsPerBlock:16}]}]},{infoBits:141498,versionNumber:34,alignmentPatternCenters:[6,34,62,90,118,146],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:115},{numBlocks:6,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:14,dataCodewordsPerBlock:46},{numBlocks:23,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:44,dataCodewordsPerBlock:24},{numBlocks:7,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:59,dataCodewordsPerBlock:16},{numBlocks:1,dataCodewordsPerBlock:17}]}]},{infoBits:145311,versionNumber:35,alignmentPatternCenters:[6,30,54,78,102,126,150],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:121},{numBlocks:7,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:47},{numBlocks:26,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:39,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:15},{numBlocks:41,dataCodewordsPerBlock:16}]}]},{infoBits:150283,versionNumber:36,alignmentPatternCenters:[6,24,50,76,102,128,154],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:121},{numBlocks:14,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:47},{numBlocks:34,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:46,dataCodewordsPerBlock:24},{numBlocks:10,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:15},{numBlocks:64,dataCodewordsPerBlock:16}]}]},{infoBits:152622,versionNumber:37,alignmentPatternCenters:[6,28,54,80,106,132,158],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:122},{numBlocks:4,dataCodewordsPerBlock:123}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:29,dataCodewordsPerBlock:46},{numBlocks:14,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:49,dataCodewordsPerBlock:24},{numBlocks:10,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:24,dataCodewordsPerBlock:15},{numBlocks:46,dataCodewordsPerBlock:16}]}]},{infoBits:158308,versionNumber:38,alignmentPatternCenters:[6,32,58,84,110,136,162],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:122},{numBlocks:18,dataCodewordsPerBlock:123}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:46},{numBlocks:32,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:48,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:42,dataCodewordsPerBlock:15},{numBlocks:32,dataCodewordsPerBlock:16}]}]},{infoBits:161089,versionNumber:39,alignmentPatternCenters:[6,26,54,82,110,138,166],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:20,dataCodewordsPerBlock:117},{numBlocks:4,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:40,dataCodewordsPerBlock:47},{numBlocks:7,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:43,dataCodewordsPerBlock:24},{numBlocks:22,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:15},{numBlocks:67,dataCodewordsPerBlock:16}]}]},{infoBits:167017,versionNumber:40,alignmentPatternCenters:[6,30,58,86,114,142,170],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:118},{numBlocks:6,dataCodewordsPerBlock:119}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:18,dataCodewordsPerBlock:47},{numBlocks:31,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:34,dataCodewordsPerBlock:24},{numBlocks:34,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:20,dataCodewordsPerBlock:15},{numBlocks:61,dataCodewordsPerBlock:16}]}]}]},function(i,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=t(0);function r(c,l,u,h){var d=c.x-l.x+u.x-h.x,f=c.y-l.y+u.y-h.y;if(d===0&&f===0)return{a11:l.x-c.x,a12:l.y-c.y,a13:0,a21:u.x-l.x,a22:u.y-l.y,a23:0,a31:c.x,a32:c.y,a33:1};var x=l.x-u.x,g=h.x-u.x,p=l.y-u.y,m=h.y-u.y,v=x*m-g*p,E=(d*m-g*f)/v,y=(x*f-d*p)/v;return{a11:l.x-c.x+E*l.x,a12:l.y-c.y+E*l.y,a13:E,a21:h.x-c.x+y*h.x,a22:h.y-c.y+y*h.y,a23:y,a31:c.x,a32:c.y,a33:1}}function s(c,l,u,h){var d=r(c,l,u,h);return{a11:d.a22*d.a33-d.a23*d.a32,a12:d.a13*d.a32-d.a12*d.a33,a13:d.a12*d.a23-d.a13*d.a22,a21:d.a23*d.a31-d.a21*d.a33,a22:d.a11*d.a33-d.a13*d.a31,a23:d.a13*d.a21-d.a11*d.a23,a31:d.a21*d.a32-d.a22*d.a31,a32:d.a12*d.a31-d.a11*d.a32,a33:d.a11*d.a22-d.a12*d.a21}}function o(c,l){return{a11:c.a11*l.a11+c.a21*l.a12+c.a31*l.a13,a12:c.a12*l.a11+c.a22*l.a12+c.a32*l.a13,a13:c.a13*l.a11+c.a23*l.a12+c.a33*l.a13,a21:c.a11*l.a21+c.a21*l.a22+c.a31*l.a23,a22:c.a12*l.a21+c.a22*l.a22+c.a32*l.a23,a23:c.a13*l.a21+c.a23*l.a22+c.a33*l.a23,a31:c.a11*l.a31+c.a21*l.a32+c.a31*l.a33,a32:c.a12*l.a31+c.a22*l.a32+c.a32*l.a33,a33:c.a13*l.a31+c.a23*l.a32+c.a33*l.a33}}function a(c,l){for(var u=s({x:3.5,y:3.5},{x:l.dimension-3.5,y:3.5},{x:l.dimension-6.5,y:l.dimension-6.5},{x:3.5,y:l.dimension-3.5}),h=r(l.topLeft,l.topRight,l.alignmentPattern,l.bottomLeft),d=o(h,u),f=n.BitMatrix.createEmpty(l.dimension,l.dimension),x=function(y,w){var A=d.a13*y+d.a23*w+d.a33;return{x:(d.a11*y+d.a21*w+d.a31)/A,y:(d.a12*y+d.a22*w+d.a32)/A}},g=0;g<l.dimension;g++)for(var p=0;p<l.dimension;p++){var m=p+.5,v=g+.5,E=x(m,v);f.set(p,g,c.get(Math.floor(E.x),Math.floor(E.y)))}return{matrix:f,mappingFunction:x}}e.extract=a},function(i,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=4,r=.5,s=1.5,o=function(m,v){return Math.sqrt(Math.pow(v.x-m.x,2)+Math.pow(v.y-m.y,2))};function a(m){return m.reduce(function(v,E){return v+E})}function c(m,v,E){var y,w,A,b,D=o(m,v),C=o(v,E),_=o(m,E),M,B,F;return C>=D&&C>=_?(y=[v,m,E],M=y[0],B=y[1],F=y[2]):_>=C&&_>=D?(w=[m,v,E],M=w[0],B=w[1],F=w[2]):(A=[m,E,v],M=A[0],B=A[1],F=A[2]),(F.x-B.x)*(M.y-B.y)-(F.y-B.y)*(M.x-B.x)<0&&(b=[F,M],M=b[0],F=b[1]),{bottomLeft:M,topLeft:B,topRight:F}}function l(m,v,E,y){var w=(a(h(m,E,y,5))/7+a(h(m,v,y,5))/7+a(h(E,m,y,5))/7+a(h(v,m,y,5))/7)/4;if(w<1)throw new Error("Invalid module size");var A=Math.round(o(m,v)/w),b=Math.round(o(m,E)/w),D=Math.floor((A+b)/2)+7;switch(D%4){case 0:D++;break;case 2:D--;break}return{dimension:D,moduleSize:w}}function u(m,v,E,y){var w=[{x:Math.floor(m.x),y:Math.floor(m.y)}],A=Math.abs(v.y-m.y)>Math.abs(v.x-m.x),b,D,C,_;A?(b=Math.floor(m.y),D=Math.floor(m.x),C=Math.floor(v.y),_=Math.floor(v.x)):(b=Math.floor(m.x),D=Math.floor(m.y),C=Math.floor(v.x),_=Math.floor(v.y));for(var M=Math.abs(C-b),B=Math.abs(_-D),F=Math.floor(-M/2),N=b<C?1:-1,L=D<_?1:-1,Z=!0,Q=b,j=D;Q!==C+N;Q+=N){var W=A?j:Q,ie=A?Q:j;if(E.get(W,ie)!==Z&&(Z=!Z,w.push({x:W,y:ie}),w.length===y+1))break;if(F+=B,F>0){if(j===_)break;j+=L,F-=M}}for(var ue=[],de=0;de<y;de++)w[de]&&w[de+1]?ue.push(o(w[de],w[de+1])):ue.push(0);return ue}function h(m,v,E,y){var w,A=v.y-m.y,b=v.x-m.x,D=u(m,v,E,Math.ceil(y/2)),C=u(m,{x:m.x-b,y:m.y-A},E,Math.ceil(y/2)),_=D.shift()+C.shift()-1;return(w=C.concat(_)).concat.apply(w,D)}function d(m,v){var E=a(m)/a(v),y=0;return v.forEach(function(w,A){y+=Math.pow(m[A]-w*E,2)}),{averageSize:E,error:y}}function f(m,v,E){try{var y=h(m,{x:-1,y:m.y},E,v.length),w=h(m,{x:m.x,y:-1},E,v.length),A={x:Math.max(0,m.x-m.y)-1,y:Math.max(0,m.y-m.x)-1},b=h(m,A,E,v.length),D={x:Math.min(E.width,m.x+m.y)+1,y:Math.min(E.height,m.y+m.x)+1},C=h(m,D,E,v.length),_=d(y,v),M=d(w,v),B=d(b,v),F=d(C,v),N=Math.sqrt(_.error*_.error+M.error*M.error+B.error*B.error+F.error*F.error),L=(_.averageSize+M.averageSize+B.averageSize+F.averageSize)/4,Z=(Math.pow(_.averageSize-L,2)+Math.pow(M.averageSize-L,2)+Math.pow(B.averageSize-L,2)+Math.pow(F.averageSize-L,2))/L;return N+Z}catch{return 1/0}}function x(m,v){for(var E=Math.round(v.x);m.get(E,Math.round(v.y));)E--;for(var y=Math.round(v.x);m.get(y,Math.round(v.y));)y++;for(var w=(E+y)/2,A=Math.round(v.y);m.get(Math.round(w),A);)A--;for(var b=Math.round(v.y);m.get(Math.round(w),b);)b++;var D=(A+b)/2;return{x:w,y:D}}function g(m){for(var v=[],E=[],y=[],w=[],A=function(W){for(var ie=0,ue=!1,de=[0,0,0,0,0],$e=function(O){var z=m.get(O,W);if(z===ue)ie++;else{de=[de[1],de[2],de[3],de[4],ie],ie=1,ue=z;var R=a(de)/7,K=Math.abs(de[0]-R)<R&&Math.abs(de[1]-R)<R&&Math.abs(de[2]-3*R)<3*R&&Math.abs(de[3]-R)<R&&Math.abs(de[4]-R)<R&&!z,$=a(de.slice(-3))/3,P=Math.abs(de[2]-$)<$&&Math.abs(de[3]-$)<$&&Math.abs(de[4]-$)<$&&z;if(K){var fe=O-de[3]-de[4],oe=fe-de[2],De={startX:oe,endX:fe,y:W},ge=E.filter(function(Te){return oe>=Te.bottom.startX&&oe<=Te.bottom.endX||fe>=Te.bottom.startX&&oe<=Te.bottom.endX||oe<=Te.bottom.startX&&fe>=Te.bottom.endX&&de[2]/(Te.bottom.endX-Te.bottom.startX)<s&&de[2]/(Te.bottom.endX-Te.bottom.startX)>r});ge.length>0?ge[0].bottom=De:E.push({top:De,bottom:De})}if(P){var he=O-de[4],Be=he-de[3],De={startX:Be,y:W,endX:he},ge=w.filter(function(I){return Be>=I.bottom.startX&&Be<=I.bottom.endX||he>=I.bottom.startX&&Be<=I.bottom.endX||Be<=I.bottom.startX&&he>=I.bottom.endX&&de[2]/(I.bottom.endX-I.bottom.startX)<s&&de[2]/(I.bottom.endX-I.bottom.startX)>r});ge.length>0?ge[0].bottom=De:w.push({top:De,bottom:De})}}},X=-1;X<=m.width;X++)$e(X);v.push.apply(v,E.filter(function(O){return O.bottom.y!==W&&O.bottom.y-O.top.y>=2})),E=E.filter(function(O){return O.bottom.y===W}),y.push.apply(y,w.filter(function(O){return O.bottom.y!==W})),w=w.filter(function(O){return O.bottom.y===W})},b=0;b<=m.height;b++)A(b);v.push.apply(v,E.filter(function(W){return W.bottom.y-W.top.y>=2})),y.push.apply(y,w);var D=v.filter(function(W){return W.bottom.y-W.top.y>=2}).map(function(W){var ie=(W.top.startX+W.top.endX+W.bottom.startX+W.bottom.endX)/4,ue=(W.top.y+W.bottom.y+1)/2;if(m.get(Math.round(ie),Math.round(ue))){var de=[W.top.endX-W.top.startX,W.bottom.endX-W.bottom.startX,W.bottom.y-W.top.y+1],$e=a(de)/de.length,X=f({x:Math.round(ie),y:Math.round(ue)},[1,1,3,1,1],m);return{score:X,x:ie,y:ue,size:$e}}}).filter(function(W){return!!W}).sort(function(W,ie){return W.score-ie.score}).map(function(W,ie,ue){if(ie>n)return null;var de=ue.filter(function(X,O){return ie!==O}).map(function(X){return{x:X.x,y:X.y,score:X.score+Math.pow(X.size-W.size,2)/W.size,size:X.size}}).sort(function(X,O){return X.score-O.score});if(de.length<2)return null;var $e=W.score+de[0].score+de[1].score;return{points:[W].concat(de.slice(0,2)),score:$e}}).filter(function(W){return!!W}).sort(function(W,ie){return W.score-ie.score});if(D.length===0)return null;var C=c(D[0].points[0],D[0].points[1],D[0].points[2]),_=C.topRight,M=C.topLeft,B=C.bottomLeft,F=p(m,y,_,M,B),N=[];F&&N.push({alignmentPattern:{x:F.alignmentPattern.x,y:F.alignmentPattern.y},bottomLeft:{x:B.x,y:B.y},dimension:F.dimension,topLeft:{x:M.x,y:M.y},topRight:{x:_.x,y:_.y}});var L=x(m,_),Z=x(m,M),Q=x(m,B),j=p(m,y,L,Z,Q);return j&&N.push({alignmentPattern:{x:j.alignmentPattern.x,y:j.alignmentPattern.y},bottomLeft:{x:Q.x,y:Q.y},topLeft:{x:Z.x,y:Z.y},topRight:{x:L.x,y:L.y},dimension:j.dimension}),N.length===0?null:N}e.locate=g;function p(m,v,E,y,w){var A,b,D;try{A=l(y,E,w,m),b=A.dimension,D=A.moduleSize}catch{return null}var C={x:E.x-y.x+w.x,y:E.y-y.y+w.y},_=(o(y,w)+o(y,E))/2/D,M=1-3/_,B={x:y.x+M*(C.x-y.x),y:y.y+M*(C.y-y.y)},F=v.map(function(L){var Z=(L.top.startX+L.top.endX+L.bottom.startX+L.bottom.endX)/4,Q=(L.top.y+L.bottom.y+1)/2;if(m.get(Math.floor(Z),Math.floor(Q))){var j=[L.top.endX-L.top.startX,L.bottom.endX-L.bottom.startX,L.bottom.y-L.top.y+1],W=a(j)/j.length,ie=f({x:Math.floor(Z),y:Math.floor(Q)},[1,1,1],m),ue=ie+o({x:Z,y:Q},B);return{x:Z,y:Q,score:ue}}}).filter(function(L){return!!L}).sort(function(L,Z){return L.score-Z.score}),N=_>=15&&F.length?F[0]:B;return{alignmentPattern:N,dimension:b}}}]).default})});var g9=Uy((x9,m9)=>{"use strict";var p9=function(){var i=function(v,E){var y=236,w=17,A=v,b=t[E],D=null,C=0,_=null,M=[],B={},F=function(O,z){C=A*4+17,D=function(R){for(var K=new Array(R),$=0;$<R;$+=1){K[$]=new Array(R);for(var P=0;P<R;P+=1)K[$][P]=null}return K}(C),N(0,0),N(C-7,0),N(0,C-7),Q(),Z(),W(O,z),A>=7&&j(O),_==null&&(_=de(A,b,M)),ie(_,z)},N=function(O,z){for(var R=-1;R<=7;R+=1)if(!(O+R<=-1||C<=O+R))for(var K=-1;K<=7;K+=1)z+K<=-1||C<=z+K||(0<=R&&R<=6&&(K==0||K==6)||0<=K&&K<=6&&(R==0||R==6)||2<=R&&R<=4&&2<=K&&K<=4?D[O+R][z+K]=!0:D[O+R][z+K]=!1)},L=function(){for(var O=0,z=0,R=0;R<8;R+=1){F(!0,R);var K=r.getLostPoint(B);(R==0||O>K)&&(O=K,z=R)}return z},Z=function(){for(var O=8;O<C-8;O+=1)D[O][6]==null&&(D[O][6]=O%2==0);for(var z=8;z<C-8;z+=1)D[6][z]==null&&(D[6][z]=z%2==0)},Q=function(){for(var O=r.getPatternPosition(A),z=0;z<O.length;z+=1)for(var R=0;R<O.length;R+=1){var K=O[z],$=O[R];if(D[K][$]==null)for(var P=-2;P<=2;P+=1)for(var fe=-2;fe<=2;fe+=1)P==-2||P==2||fe==-2||fe==2||P==0&&fe==0?D[K+P][$+fe]=!0:D[K+P][$+fe]=!1}},j=function(O){for(var z=r.getBCHTypeNumber(A),R=0;R<18;R+=1){var K=!O&&(z>>R&1)==1;D[Math.floor(R/3)][R%3+C-8-3]=K}for(var R=0;R<18;R+=1){var K=!O&&(z>>R&1)==1;D[R%3+C-8-3][Math.floor(R/3)]=K}},W=function(O,z){for(var R=b<<3|z,K=r.getBCHTypeInfo(R),$=0;$<15;$+=1){var P=!O&&(K>>$&1)==1;$<6?D[$][8]=P:$<8?D[$+1][8]=P:D[C-15+$][8]=P}for(var $=0;$<15;$+=1){var P=!O&&(K>>$&1)==1;$<8?D[8][C-$-1]=P:$<9?D[8][15-$-1+1]=P:D[8][15-$-1]=P}D[C-8][8]=!O},ie=function(O,z){for(var R=-1,K=C-1,$=7,P=0,fe=r.getMaskFunction(z),oe=C-1;oe>0;oe-=2)for(oe==6&&(oe-=1);;){for(var De=0;De<2;De+=1)if(D[K][oe-De]==null){var ge=!1;P<O.length&&(ge=(O[P]>>>$&1)==1);var he=fe(K,oe-De);he&&(ge=!ge),D[K][oe-De]=ge,$-=1,$==-1&&(P+=1,$=7)}if(K+=R,K<0||C<=K){K-=R,R=-R;break}}},ue=function(O,z){for(var R=0,K=0,$=0,P=new Array(z.length),fe=new Array(z.length),oe=0;oe<z.length;oe+=1){var De=z[oe].dataCount,ge=z[oe].totalCount-De;K=Math.max(K,De),$=Math.max($,ge),P[oe]=new Array(De);for(var he=0;he<P[oe].length;he+=1)P[oe][he]=255&O.getBuffer()[he+R];R+=De;var Be=r.getErrorCorrectPolynomial(ge),Te=o(P[oe],Be.getLength()-1),Wt=Te.mod(Be);fe[oe]=new Array(Be.getLength()-1);for(var he=0;he<fe[oe].length;he+=1){var I=he+Wt.getLength()-fe[oe].length;fe[oe][he]=I>=0?Wt.getAt(I):0}}for(var S=0,he=0;he<z.length;he+=1)S+=z[he].totalCount;for(var te=new Array(S),se=0,he=0;he<K;he+=1)for(var oe=0;oe<z.length;oe+=1)he<P[oe].length&&(te[se]=P[oe][he],se+=1);for(var he=0;he<$;he+=1)for(var oe=0;oe<z.length;oe+=1)he<fe[oe].length&&(te[se]=fe[oe][he],se+=1);return te},de=function(O,z,R){for(var K=a.getRSBlocks(O,z),$=c(),P=0;P<R.length;P+=1){var fe=R[P];$.put(fe.getMode(),4),$.put(fe.getLength(),r.getLengthInBits(fe.getMode(),O)),fe.write($)}for(var oe=0,P=0;P<K.length;P+=1)oe+=K[P].dataCount;if($.getLengthInBits()>oe*8)throw"code length overflow. ("+$.getLengthInBits()+">"+oe*8+")";for($.getLengthInBits()+4<=oe*8&&$.put(0,4);$.getLengthInBits()%8!=0;)$.putBit(!1);for(;!($.getLengthInBits()>=oe*8||($.put(y,8),$.getLengthInBits()>=oe*8));)$.put(w,8);return ue($,K)};B.addData=function(O,z){z=z||"Byte";var R=null;switch(z){case"Numeric":R=l(O);break;case"Alphanumeric":R=u(O);break;case"Byte":R=h(O);break;case"Kanji":R=d(O);break;default:throw"mode:"+z}M.push(R),_=null},B.isDark=function(O,z){if(O<0||C<=O||z<0||C<=z)throw O+","+z;return D[O][z]},B.getModuleCount=function(){return C},B.make=function(){if(A<1){for(var O=1;O<40;O++){for(var z=a.getRSBlocks(O,b),R=c(),K=0;K<M.length;K++){var $=M[K];R.put($.getMode(),4),R.put($.getLength(),r.getLengthInBits($.getMode(),O)),$.write(R)}for(var P=0,K=0;K<z.length;K++)P+=z[K].dataCount;if(R.getLengthInBits()<=P*8)break}A=O}F(!1,L())},B.createTableTag=function(O,z){O=O||2,z=typeof z>"u"?O*4:z;var R="";R+='<table style="',R+=" border-width: 0px; border-style: none;",R+=" border-collapse: collapse;",R+=" padding: 0px; margin: "+z+"px;",R+='">',R+="<tbody>";for(var K=0;K<B.getModuleCount();K+=1){R+="<tr>";for(var $=0;$<B.getModuleCount();$+=1)R+='<td style="',R+=" border-width: 0px; border-style: none;",R+=" border-collapse: collapse;",R+=" padding: 0px; margin: 0px;",R+=" width: "+O+"px;",R+=" height: "+O+"px;",R+=" background-color: ",R+=B.isDark(K,$)?"#000000":"#ffffff",R+=";",R+='"/>';R+="</tr>"}return R+="</tbody>",R+="</table>",R},B.createSvgTag=function(O,z,R,K){var $={};typeof arguments[0]=="object"&&($=arguments[0],O=$.cellSize,z=$.margin,R=$.alt,K=$.title),O=O||2,z=typeof z>"u"?O*4:z,R=typeof R=="string"?{text:R}:R||{},R.text=R.text||null,R.id=R.text?R.id||"qrcode-description":null,K=typeof K=="string"?{text:K}:K||{},K.text=K.text||null,K.id=K.text?K.id||"qrcode-title":null;var P=B.getModuleCount()*O+z*2,fe,oe,De,ge,he="",Be;for(Be="l"+O+",0 0,"+O+" -"+O+",0 0,-"+O+"z ",he+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',he+=$.scalable?"":' width="'+P+'px" height="'+P+'px"',he+=' viewBox="0 0 '+P+" "+P+'" ',he+=' preserveAspectRatio="xMinYMin meet"',he+=K.text||R.text?' role="img" aria-labelledby="'+$e([K.id,R.id].join(" ").trim())+'"':"",he+=">",he+=K.text?'<title id="'+$e(K.id)+'">'+$e(K.text)+"</title>":"",he+=R.text?'<description id="'+$e(R.id)+'">'+$e(R.text)+"</description>":"",he+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',he+='<path d="',De=0;De<B.getModuleCount();De+=1)for(ge=De*O+z,fe=0;fe<B.getModuleCount();fe+=1)B.isDark(De,fe)&&(oe=fe*O+z,he+="M"+oe+","+ge+Be);return he+='" stroke="transparent" fill="black"/>',he+="</svg>",he},B.createDataURL=function(O,z){O=O||2,z=typeof z>"u"?O*4:z;var R=B.getModuleCount()*O+z*2,K=z,$=R-z;return m(R,R,function(P,fe){if(K<=P&&P<$&&K<=fe&&fe<$){var oe=Math.floor((P-K)/O),De=Math.floor((fe-K)/O);return B.isDark(De,oe)?0:1}else return 1})},B.createImgTag=function(O,z,R){O=O||2,z=typeof z>"u"?O*4:z;var K=B.getModuleCount()*O+z*2,$="";return $+="<img",$+=' src="',$+=B.createDataURL(O,z),$+='"',$+=' width="',$+=K,$+='"',$+=' height="',$+=K,$+='"',R&&($+=' alt="',$+=$e(R),$+='"'),$+="/>",$};var $e=function(O){for(var z="",R=0;R<O.length;R+=1){var K=O.charAt(R);switch(K){case"<":z+="&lt;";break;case">":z+="&gt;";break;case"&":z+="&amp;";break;case'"':z+="&quot;";break;default:z+=K;break}}return z},X=function(O){var z=1;O=typeof O>"u"?z*2:O;var R=B.getModuleCount()*z+O*2,K=O,$=R-O,P,fe,oe,De,ge,he={"\u2588\u2588":"\u2588","\u2588 ":"\u2580"," \u2588":"\u2584","  ":" "},Be={"\u2588\u2588":"\u2580","\u2588 ":"\u2580"," \u2588":" ","  ":" "},Te="";for(P=0;P<R;P+=2){for(oe=Math.floor((P-K)/z),De=Math.floor((P+1-K)/z),fe=0;fe<R;fe+=1)ge="\u2588",K<=fe&&fe<$&&K<=P&&P<$&&B.isDark(oe,Math.floor((fe-K)/z))&&(ge=" "),K<=fe&&fe<$&&K<=P+1&&P+1<$&&B.isDark(De,Math.floor((fe-K)/z))?ge+=" ":ge+="\u2588",Te+=O<1&&P+1>=$?Be[ge]:he[ge];Te+=`
`}return R%2&&O>0?Te.substring(0,Te.length-R-1)+Array(R+1).join("\u2580"):Te.substring(0,Te.length-1)};return B.createASCII=function(O,z){if(O=O||1,O<2)return X(z);O-=1,z=typeof z>"u"?O*2:z;var R=B.getModuleCount()*O+z*2,K=z,$=R-z,P,fe,oe,De,ge=Array(O+1).join("\u2588\u2588"),he=Array(O+1).join("  "),Be="",Te="";for(P=0;P<R;P+=1){for(oe=Math.floor((P-K)/O),Te="",fe=0;fe<R;fe+=1)De=1,K<=fe&&fe<$&&K<=P&&P<$&&B.isDark(oe,Math.floor((fe-K)/O))&&(De=0),Te+=De?ge:he;for(oe=0;oe<O;oe+=1)Be+=Te+`
`}return Be.substring(0,Be.length-1)},B.renderTo2dContext=function(O,z){z=z||2;for(var R=B.getModuleCount(),K=0;K<R;K++)for(var $=0;$<R;$++)O.fillStyle=B.isDark(K,$)?"black":"white",O.fillRect(K*z,$*z,z,z)},B};i.stringToBytesFuncs={default:function(v){for(var E=[],y=0;y<v.length;y+=1){var w=v.charCodeAt(y);E.push(w&255)}return E}},i.stringToBytes=i.stringToBytesFuncs.default,i.createStringToBytes=function(v,E){var y=function(){for(var A=g(v),b=function(){var Z=A.read();if(Z==-1)throw"eof";return Z},D=0,C={};;){var _=A.read();if(_==-1)break;var M=b(),B=b(),F=b(),N=String.fromCharCode(_<<8|M),L=B<<8|F;C[N]=L,D+=1}if(D!=E)throw D+" != "+E;return C}(),w=63;return function(A){for(var b=[],D=0;D<A.length;D+=1){var C=A.charCodeAt(D);if(C<128)b.push(C);else{var _=y[A.charAt(D)];typeof _=="number"?(_&255)==_?b.push(_):(b.push(_>>>8),b.push(_&255)):b.push(w)}}return b}};var e={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},t={L:1,M:0,Q:3,H:2},n={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},r=function(){var v=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],E=1335,y=7973,w=21522,A={},b=function(D){for(var C=0;D!=0;)C+=1,D>>>=1;return C};return A.getBCHTypeInfo=function(D){for(var C=D<<10;b(C)-b(E)>=0;)C^=E<<b(C)-b(E);return(D<<10|C)^w},A.getBCHTypeNumber=function(D){for(var C=D<<12;b(C)-b(y)>=0;)C^=y<<b(C)-b(y);return D<<12|C},A.getPatternPosition=function(D){return v[D-1]},A.getMaskFunction=function(D){switch(D){case n.PATTERN000:return function(C,_){return(C+_)%2==0};case n.PATTERN001:return function(C,_){return C%2==0};case n.PATTERN010:return function(C,_){return _%3==0};case n.PATTERN011:return function(C,_){return(C+_)%3==0};case n.PATTERN100:return function(C,_){return(Math.floor(C/2)+Math.floor(_/3))%2==0};case n.PATTERN101:return function(C,_){return C*_%2+C*_%3==0};case n.PATTERN110:return function(C,_){return(C*_%2+C*_%3)%2==0};case n.PATTERN111:return function(C,_){return(C*_%3+(C+_)%2)%2==0};default:throw"bad maskPattern:"+D}},A.getErrorCorrectPolynomial=function(D){for(var C=o([1],0),_=0;_<D;_+=1)C=C.multiply(o([1,s.gexp(_)],0));return C},A.getLengthInBits=function(D,C){if(1<=C&&C<10)switch(D){case e.MODE_NUMBER:return 10;case e.MODE_ALPHA_NUM:return 9;case e.MODE_8BIT_BYTE:return 8;case e.MODE_KANJI:return 8;default:throw"mode:"+D}else if(C<27)switch(D){case e.MODE_NUMBER:return 12;case e.MODE_ALPHA_NUM:return 11;case e.MODE_8BIT_BYTE:return 16;case e.MODE_KANJI:return 10;default:throw"mode:"+D}else if(C<41)switch(D){case e.MODE_NUMBER:return 14;case e.MODE_ALPHA_NUM:return 13;case e.MODE_8BIT_BYTE:return 16;case e.MODE_KANJI:return 12;default:throw"mode:"+D}else throw"type:"+C},A.getLostPoint=function(D){for(var C=D.getModuleCount(),_=0,M=0;M<C;M+=1)for(var B=0;B<C;B+=1){for(var F=0,N=D.isDark(M,B),L=-1;L<=1;L+=1)if(!(M+L<0||C<=M+L))for(var Z=-1;Z<=1;Z+=1)B+Z<0||C<=B+Z||L==0&&Z==0||N==D.isDark(M+L,B+Z)&&(F+=1);F>5&&(_+=3+F-5)}for(var M=0;M<C-1;M+=1)for(var B=0;B<C-1;B+=1){var Q=0;D.isDark(M,B)&&(Q+=1),D.isDark(M+1,B)&&(Q+=1),D.isDark(M,B+1)&&(Q+=1),D.isDark(M+1,B+1)&&(Q+=1),(Q==0||Q==4)&&(_+=3)}for(var M=0;M<C;M+=1)for(var B=0;B<C-6;B+=1)D.isDark(M,B)&&!D.isDark(M,B+1)&&D.isDark(M,B+2)&&D.isDark(M,B+3)&&D.isDark(M,B+4)&&!D.isDark(M,B+5)&&D.isDark(M,B+6)&&(_+=40);for(var B=0;B<C;B+=1)for(var M=0;M<C-6;M+=1)D.isDark(M,B)&&!D.isDark(M+1,B)&&D.isDark(M+2,B)&&D.isDark(M+3,B)&&D.isDark(M+4,B)&&!D.isDark(M+5,B)&&D.isDark(M+6,B)&&(_+=40);for(var j=0,B=0;B<C;B+=1)for(var M=0;M<C;M+=1)D.isDark(M,B)&&(j+=1);var W=Math.abs(100*j/C/C-50)/5;return _+=W*10,_},A}(),s=function(){for(var v=new Array(256),E=new Array(256),y=0;y<8;y+=1)v[y]=1<<y;for(var y=8;y<256;y+=1)v[y]=v[y-4]^v[y-5]^v[y-6]^v[y-8];for(var y=0;y<255;y+=1)E[v[y]]=y;var w={};return w.glog=function(A){if(A<1)throw"glog("+A+")";return E[A]},w.gexp=function(A){for(;A<0;)A+=255;for(;A>=256;)A-=255;return v[A]},w}();function o(v,E){if(typeof v.length>"u")throw v.length+"/"+E;var y=function(){for(var A=0;A<v.length&&v[A]==0;)A+=1;for(var b=new Array(v.length-A+E),D=0;D<v.length-A;D+=1)b[D]=v[D+A];return b}(),w={};return w.getAt=function(A){return y[A]},w.getLength=function(){return y.length},w.multiply=function(A){for(var b=new Array(w.getLength()+A.getLength()-1),D=0;D<w.getLength();D+=1)for(var C=0;C<A.getLength();C+=1)b[D+C]^=s.gexp(s.glog(w.getAt(D))+s.glog(A.getAt(C)));return o(b,0)},w.mod=function(A){if(w.getLength()-A.getLength()<0)return w;for(var b=s.glog(w.getAt(0))-s.glog(A.getAt(0)),D=new Array(w.getLength()),C=0;C<w.getLength();C+=1)D[C]=w.getAt(C);for(var C=0;C<A.getLength();C+=1)D[C]^=s.gexp(s.glog(A.getAt(C))+b);return o(D,0).mod(A)},w}var a=function(){var v=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],E=function(A,b){var D={};return D.totalCount=A,D.dataCount=b,D},y={},w=function(A,b){switch(b){case t.L:return v[(A-1)*4+0];case t.M:return v[(A-1)*4+1];case t.Q:return v[(A-1)*4+2];case t.H:return v[(A-1)*4+3];default:return}};return y.getRSBlocks=function(A,b){var D=w(A,b);if(typeof D>"u")throw"bad rs block @ typeNumber:"+A+"/errorCorrectionLevel:"+b;for(var C=D.length/3,_=[],M=0;M<C;M+=1)for(var B=D[M*3+0],F=D[M*3+1],N=D[M*3+2],L=0;L<B;L+=1)_.push(E(F,N));return _},y}(),c=function(){var v=[],E=0,y={};return y.getBuffer=function(){return v},y.getAt=function(w){var A=Math.floor(w/8);return(v[A]>>>7-w%8&1)==1},y.put=function(w,A){for(var b=0;b<A;b+=1)y.putBit((w>>>A-b-1&1)==1)},y.getLengthInBits=function(){return E},y.putBit=function(w){var A=Math.floor(E/8);v.length<=A&&v.push(0),w&&(v[A]|=128>>>E%8),E+=1},y},l=function(v){var E=e.MODE_NUMBER,y=v,w={};w.getMode=function(){return E},w.getLength=function(D){return y.length},w.write=function(D){for(var C=y,_=0;_+2<C.length;)D.put(A(C.substring(_,_+3)),10),_+=3;_<C.length&&(C.length-_==1?D.put(A(C.substring(_,_+1)),4):C.length-_==2&&D.put(A(C.substring(_,_+2)),7))};var A=function(D){for(var C=0,_=0;_<D.length;_+=1)C=C*10+b(D.charAt(_));return C},b=function(D){if("0"<=D&&D<="9")return D.charCodeAt(0)-48;throw"illegal char :"+D};return w},u=function(v){var E=e.MODE_ALPHA_NUM,y=v,w={};w.getMode=function(){return E},w.getLength=function(b){return y.length},w.write=function(b){for(var D=y,C=0;C+1<D.length;)b.put(A(D.charAt(C))*45+A(D.charAt(C+1)),11),C+=2;C<D.length&&b.put(A(D.charAt(C)),6)};var A=function(b){if("0"<=b&&b<="9")return b.charCodeAt(0)-48;if("A"<=b&&b<="Z")return b.charCodeAt(0)-65+10;switch(b){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+b}};return w},h=function(v){var E=e.MODE_8BIT_BYTE,y=v,w=i.stringToBytes(v),A={};return A.getMode=function(){return E},A.getLength=function(b){return w.length},A.write=function(b){for(var D=0;D<w.length;D+=1)b.put(w[D],8)},A},d=function(v){var E=e.MODE_KANJI,y=v,w=i.stringToBytesFuncs.SJIS;if(!w)throw"sjis not supported.";(function(D,C){var _=w(D);if(_.length!=2||(_[0]<<8|_[1])!=C)throw"sjis not supported."})("\u53CB",38726);var A=w(v),b={};return b.getMode=function(){return E},b.getLength=function(D){return~~(A.length/2)},b.write=function(D){for(var C=A,_=0;_+1<C.length;){var M=(255&C[_])<<8|255&C[_+1];if(33088<=M&&M<=40956)M-=33088;else if(57408<=M&&M<=60351)M-=49472;else throw"illegal char at "+(_+1)+"/"+M;M=(M>>>8&255)*192+(M&255),D.put(M,13),_+=2}if(_<C.length)throw"illegal char at "+(_+1)},b},f=function(){var v=[],E={};return E.writeByte=function(y){v.push(y&255)},E.writeShort=function(y){E.writeByte(y),E.writeByte(y>>>8)},E.writeBytes=function(y,w,A){w=w||0,A=A||y.length;for(var b=0;b<A;b+=1)E.writeByte(y[b+w])},E.writeString=function(y){for(var w=0;w<y.length;w+=1)E.writeByte(y.charCodeAt(w))},E.toByteArray=function(){return v},E.toString=function(){var y="";y+="[";for(var w=0;w<v.length;w+=1)w>0&&(y+=","),y+=v[w];return y+="]",y},E},x=function(){var v=0,E=0,y=0,w="",A={},b=function(C){w+=String.fromCharCode(D(C&63))},D=function(C){if(!(C<0)){if(C<26)return 65+C;if(C<52)return 97+(C-26);if(C<62)return 48+(C-52);if(C==62)return 43;if(C==63)return 47}throw"n:"+C};return A.writeByte=function(C){for(v=v<<8|C&255,E+=8,y+=1;E>=6;)b(v>>>E-6),E-=6},A.flush=function(){if(E>0&&(b(v<<6-E),v=0,E=0),y%3!=0)for(var C=3-y%3,_=0;_<C;_+=1)w+="="},A.toString=function(){return w},A},g=function(v){var E=v,y=0,w=0,A=0,b={};b.read=function(){for(;A<8;){if(y>=E.length){if(A==0)return-1;throw"unexpected end of file./"+A}var C=E.charAt(y);if(y+=1,C=="=")return A=0,-1;if(C.match(/^\s$/))continue;w=w<<6|D(C.charCodeAt(0)),A+=6}var _=w>>>A-8&255;return A-=8,_};var D=function(C){if(65<=C&&C<=90)return C-65;if(97<=C&&C<=122)return C-97+26;if(48<=C&&C<=57)return C-48+52;if(C==43)return 62;if(C==47)return 63;throw"c:"+C};return b},p=function(v,E){var y=v,w=E,A=new Array(v*E),b={};b.setPixel=function(M,B,F){A[B*y+M]=F},b.write=function(M){M.writeString("GIF87a"),M.writeShort(y),M.writeShort(w),M.writeByte(128),M.writeByte(0),M.writeByte(0),M.writeByte(0),M.writeByte(0),M.writeByte(0),M.writeByte(255),M.writeByte(255),M.writeByte(255),M.writeString(","),M.writeShort(0),M.writeShort(0),M.writeShort(y),M.writeShort(w),M.writeByte(0);var B=2,F=C(B);M.writeByte(B);for(var N=0;F.length-N>255;)M.writeByte(255),M.writeBytes(F,N,255),N+=255;M.writeByte(F.length-N),M.writeBytes(F,N,F.length-N),M.writeByte(0),M.writeString(";")};var D=function(M){var B=M,F=0,N=0,L={};return L.write=function(Z,Q){if(Z>>>Q)throw"length over";for(;F+Q>=8;)B.writeByte(255&(Z<<F|N)),Q-=8-F,Z>>>=8-F,N=0,F=0;N=Z<<F|N,F=F+Q},L.flush=function(){F>0&&B.writeByte(N)},L},C=function(M){for(var B=1<<M,F=(1<<M)+1,N=M+1,L=_(),Z=0;Z<B;Z+=1)L.add(String.fromCharCode(Z));L.add(String.fromCharCode(B)),L.add(String.fromCharCode(F));var Q=f(),j=D(Q);j.write(B,N);var W=0,ie=String.fromCharCode(A[W]);for(W+=1;W<A.length;){var ue=String.fromCharCode(A[W]);W+=1,L.contains(ie+ue)?ie=ie+ue:(j.write(L.indexOf(ie),N),L.size()<4095&&(L.size()==1<<N&&(N+=1),L.add(ie+ue)),ie=ue)}return j.write(L.indexOf(ie),N),j.write(F,N),j.flush(),Q.toByteArray()},_=function(){var M={},B=0,F={};return F.add=function(N){if(F.contains(N))throw"dup key:"+N;M[N]=B,B+=1},F.size=function(){return B},F.indexOf=function(N){return M[N]},F.contains=function(N){return typeof M[N]<"u"},F};return b},m=function(v,E,y){for(var w=p(v,E),A=0;A<E;A+=1)for(var b=0;b<v;b+=1)w.setPixel(b,A,y(b,A));var D=f();w.write(D);for(var C=x(),_=D.toByteArray(),M=0;M<_.length;M+=1)C.writeByte(_[M]);return C.flush(),"data:image/gif;base64,"+C};return i}();(function(){p9.stringToBytesFuncs["UTF-8"]=function(i){function e(t){for(var n=[],r=0;r<t.length;r++){var s=t.charCodeAt(r);s<128?n.push(s):s<2048?n.push(192|s>>6,128|s&63):s<55296||s>=57344?n.push(224|s>>12,128|s>>6&63,128|s&63):(r++,s=65536+((s&1023)<<10|t.charCodeAt(r)&1023),n.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63))}return n}return e(i)}})();(function(i){typeof define=="function"&&define.amd?define([],i):typeof x9=="object"&&(m9.exports=i())})(function(){return p9})});var zy=null;var xp=1,Hy=Symbol("SIGNAL");function St(i){let e=zy;return zy=i,e}var jy={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function L9(i){if(!(vp(i)&&!i.dirty)&&!(!i.dirty&&i.lastCleanEpoch===xp)){if(!i.producerMustRecompute(i)&&!mp(i)){i.dirty=!1,i.lastCleanEpoch=xp;return}i.producerRecomputeValue(i),i.dirty=!1,i.lastCleanEpoch=xp}}function Gy(i){return i&&(i.nextProducerIndex=0),St(i)}function Wy(i,e){if(St(e),!(!i||i.producerNode===void 0||i.producerIndexOfThis===void 0||i.producerLastReadVersion===void 0)){if(vp(i))for(let t=i.nextProducerIndex;t<i.producerNode.length;t++)gp(i.producerNode[t],i.producerIndexOfThis[t]);for(;i.producerNode.length>i.nextProducerIndex;)i.producerNode.pop(),i.producerLastReadVersion.pop(),i.producerIndexOfThis.pop()}}function mp(i){ph(i);for(let e=0;e<i.producerNode.length;e++){let t=i.producerNode[e],n=i.producerLastReadVersion[e];if(n!==t.version||(L9(t),n!==t.version))return!0}return!1}function $y(i){if(ph(i),vp(i))for(let e=0;e<i.producerNode.length;e++)gp(i.producerNode[e],i.producerIndexOfThis[e]);i.producerNode.length=i.producerLastReadVersion.length=i.producerIndexOfThis.length=0,i.liveConsumerNode&&(i.liveConsumerNode.length=i.liveConsumerIndexOfThis.length=0)}function gp(i,e){if(U9(i),ph(i),i.liveConsumerNode.length===1)for(let n=0;n<i.producerNode.length;n++)gp(i.producerNode[n],i.producerIndexOfThis[n]);let t=i.liveConsumerNode.length-1;if(i.liveConsumerNode[e]=i.liveConsumerNode[t],i.liveConsumerIndexOfThis[e]=i.liveConsumerIndexOfThis[t],i.liveConsumerNode.length--,i.liveConsumerIndexOfThis.length--,e<i.liveConsumerNode.length){let n=i.liveConsumerIndexOfThis[e],r=i.liveConsumerNode[e];ph(r),r.producerIndexOfThis[n]=e}}function vp(i){return i.consumerIsAlwaysLive||(i?.liveConsumerNode?.length??0)>0}function ph(i){i.producerNode??=[],i.producerIndexOfThis??=[],i.producerLastReadVersion??=[]}function U9(i){i.liveConsumerNode??=[],i.liveConsumerIndexOfThis??=[]}function V9(){throw new Error}var z9=V9;function Xy(i){z9=i}function Ye(i){return typeof i=="function"}function ua(i){let t=i(n=>{Error.call(n),n.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var xh=ua(i=>function(t){i(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((n,r)=>`${r+1}) ${n.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function gl(i,e){if(i){let t=i.indexOf(e);0<=t&&i.splice(t,1)}}var vn=class i{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:n}=this;if(Ye(n))try{n()}catch(s){e=s instanceof xh?s.errors:[s]}let{_finalizers:r}=this;if(r){this._finalizers=null;for(let s of r)try{qy(s)}catch(o){e=e??[],o instanceof xh?e=[...e,...o.errors]:e.push(o)}}if(e)throw new xh(e)}}add(e){var t;if(e&&e!==this)if(this.closed)qy(e);else{if(e instanceof i){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&gl(t,e)}remove(e){let{_finalizers:t}=this;t&&gl(t,e),e instanceof i&&e._removeParent(this)}};vn.EMPTY=(()=>{let i=new vn;return i.closed=!0,i})();var Ep=vn.EMPTY;function mh(i){return i instanceof vn||i&&"closed"in i&&Ye(i.remove)&&Ye(i.add)&&Ye(i.unsubscribe)}function qy(i){Ye(i)?i():i.unsubscribe()}var Ui={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var ha={setTimeout(i,e,...t){let{delegate:n}=ha;return n?.setTimeout?n.setTimeout(i,e,...t):setTimeout(i,e,...t)},clearTimeout(i){let{delegate:e}=ha;return(e?.clearTimeout||clearTimeout)(i)},delegate:void 0};function gh(i){ha.setTimeout(()=>{let{onUnhandledError:e}=Ui;if(e)e(i);else throw i})}function vl(){}var Yy=yp("C",void 0,void 0);function Zy(i){return yp("E",void 0,i)}function Ky(i){return yp("N",i,void 0)}function yp(i,e,t){return{kind:i,value:e,error:t}}var co=null;function da(i){if(Ui.useDeprecatedSynchronousErrorHandling){let e=!co;if(e&&(co={errorThrown:!1,error:null}),i(),e){let{errorThrown:t,error:n}=co;if(co=null,t)throw n}}else i()}function Jy(i){Ui.useDeprecatedSynchronousErrorHandling&&co&&(co.errorThrown=!0,co.error=i)}var lo=class extends vn{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,mh(e)&&e.add(this)):this.destination=G9}static create(e,t,n){return new fa(e,t,n)}next(e){this.isStopped?_p(Ky(e),this):this._next(e)}error(e){this.isStopped?_p(Zy(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?_p(Yy,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},H9=Function.prototype.bind;function Cp(i,e){return H9.call(i,e)}var Ap=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(n){vh(n)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(n){vh(n)}else vh(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){vh(t)}}},fa=class extends lo{constructor(e,t,n){super();let r;if(Ye(e)||!e)r={next:e??void 0,error:t??void 0,complete:n??void 0};else{let s;this&&Ui.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&Cp(e.next,s),error:e.error&&Cp(e.error,s),complete:e.complete&&Cp(e.complete,s)}):r=e}this.destination=new Ap(r)}};function vh(i){Ui.useDeprecatedSynchronousErrorHandling?Jy(i):gh(i)}function j9(i){throw i}function _p(i,e){let{onStoppedNotification:t}=Ui;t&&ha.setTimeout(()=>t(i,e))}var G9={closed:!0,next:vl,error:j9,complete:vl};var pa=typeof Symbol=="function"&&Symbol.observable||"@@observable";function ci(i){return i}function wp(...i){return bp(i)}function bp(i){return i.length===0?ci:i.length===1?i[0]:function(t){return i.reduce((n,r)=>r(n),t)}}var Rt=(()=>{class i{constructor(t){t&&(this._subscribe=t)}lift(t){let n=new i;return n.source=this,n.operator=t,n}subscribe(t,n,r){let s=$9(t)?t:new fa(t,n,r);return da(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(n){t.error(n)}}forEach(t,n){return n=Qy(n),new n((r,s)=>{let o=new fa({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(t){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(t)}[pa](){return this}pipe(...t){return bp(t)(this)}toPromise(t){return t=Qy(t),new t((n,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>n(s))})}}return i.create=e=>new i(e),i})();function Qy(i){var e;return(e=i??Ui.Promise)!==null&&e!==void 0?e:Promise}function W9(i){return i&&Ye(i.next)&&Ye(i.error)&&Ye(i.complete)}function $9(i){return i&&i instanceof lo||W9(i)&&mh(i)}function Dp(i){return Ye(i?.lift)}function mt(i){return e=>{if(Dp(e))return e.lift(function(t){try{return i(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function gt(i,e,t,n,r){return new Sp(i,e,t,n,r)}var Sp=class extends lo{constructor(e,t,n,r,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=r?function(a){try{r(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=n?function(){try{n()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function xa(){return mt((i,e)=>{let t=null;i._refCount++;let n=gt(e,void 0,void 0,void 0,()=>{if(!i||i._refCount<=0||0<--i._refCount){t=null;return}let r=i._connection,s=t;t=null,r&&(!s||r===s)&&r.unsubscribe(),e.unsubscribe()});i.subscribe(n),n.closed||(t=i.connect())})}var ma=class extends Rt{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Dp(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new vn;let t=this.getSubject();e.add(this.source.subscribe(gt(t,void 0,()=>{this._teardown(),t.complete()},n=>{this._teardown(),t.error(n)},()=>this._teardown()))),e.closed&&(this._connection=null,e=vn.EMPTY)}return e}refCount(){return xa()(this)}};var eC=ua(i=>function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var $n=(()=>{class i extends Rt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let n=new Eh(this,this);return n.operator=t,n}_throwIfClosed(){if(this.closed)throw new eC}next(t){da(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let n of this.currentObservers)n.next(t)}})}error(t){da(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:n}=this;for(;n.length;)n.shift().error(t)}})}complete(){da(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:n,isStopped:r,observers:s}=this;return n||r?Ep:(this.currentObservers=null,s.push(t),new vn(()=>{this.currentObservers=null,gl(s,t)}))}_checkFinalizedStatuses(t){let{hasError:n,thrownError:r,isStopped:s}=this;n?t.error(r):s&&t.complete()}asObservable(){let t=new Rt;return t.source=this,t}}return i.create=(e,t)=>new Eh(e,t),i})(),Eh=class extends $n{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.next)===null||n===void 0||n.call(t,e)}error(e){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.error)===null||n===void 0||n.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,n;return(n=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&n!==void 0?n:Ep}};var Dn=class extends $n{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:n}=this;if(e)throw t;return this._throwIfClosed(),n}next(e){super.next(this._value=e)}};var li=new Rt(i=>i.complete());function tC(i){return i&&Ye(i.schedule)}function nC(i){return i[i.length-1]}function iC(i){return Ye(nC(i))?i.pop():void 0}function xs(i){return tC(nC(i))?i.pop():void 0}function sC(i,e,t,n){function r(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):r(u.value).then(a,c)}l((n=n.apply(i,e||[])).next())})}function rC(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function uo(i){return this instanceof uo?(this.v=i,this):new uo(i)}function oC(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(i,e||[]),r,s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(d){n[d]&&(r[d]=function(f){return new Promise(function(x,g){s.push([d,f,x,g])>1||a(d,f)})})}function a(d,f){try{c(n[d](f))}catch(x){h(s[0][3],x)}}function c(d){d.value instanceof uo?Promise.resolve(d.value.v).then(l,u):h(s[0][2],d)}function l(d){a("next",d)}function u(d){a("throw",d)}function h(d,f){d(f),s.shift(),s.length&&a(s[0][0],s[0][1])}}function aC(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof rC=="function"?rC(i):i[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=i[s]&&function(o){return new Promise(function(a,c){o=i[s](o),r(a,c,o.done,o.value)})}}function r(s,o,a,c){Promise.resolve(c).then(function(l){s({value:l,done:a})},o)}}var yh=i=>i&&typeof i.length=="number"&&typeof i!="function";function Ch(i){return Ye(i?.then)}function _h(i){return Ye(i[pa])}function Ah(i){return Symbol.asyncIterator&&Ye(i?.[Symbol.asyncIterator])}function wh(i){return new TypeError(`You provided ${i!==null&&typeof i=="object"?"an invalid object":`'${i}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function X9(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var bh=X9();function Dh(i){return Ye(i?.[bh])}function Sh(i){return oC(this,arguments,function*(){let t=i.getReader();try{for(;;){let{value:n,done:r}=yield uo(t.read());if(r)return yield uo(void 0);yield yield uo(n)}}finally{t.releaseLock()}})}function Mh(i){return Ye(i?.getReader)}function An(i){if(i instanceof Rt)return i;if(i!=null){if(_h(i))return q9(i);if(yh(i))return Y9(i);if(Ch(i))return Z9(i);if(Ah(i))return cC(i);if(Dh(i))return K9(i);if(Mh(i))return J9(i)}throw wh(i)}function q9(i){return new Rt(e=>{let t=i[pa]();if(Ye(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Y9(i){return new Rt(e=>{for(let t=0;t<i.length&&!e.closed;t++)e.next(i[t]);e.complete()})}function Z9(i){return new Rt(e=>{i.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,gh)})}function K9(i){return new Rt(e=>{for(let t of i)if(e.next(t),e.closed)return;e.complete()})}function cC(i){return new Rt(e=>{Q9(i,e).catch(t=>e.error(t))})}function J9(i){return cC(Sh(i))}function Q9(i,e){var t,n,r,s;return sC(this,void 0,void 0,function*(){try{for(t=aC(i);n=yield t.next(),!n.done;){let o=n.value;if(e.next(o),e.closed)return}}catch(o){r={error:o}}finally{try{n&&!n.done&&(s=t.return)&&(yield s.call(t))}finally{if(r)throw r.error}}e.complete()})}function ni(i,e,t,n=0,r=!1){let s=e.schedule(function(){t(),r?i.add(this.schedule(null,n)):this.unsubscribe()},n);if(i.add(s),!r)return s}function Th(i,e=0){return mt((t,n)=>{t.subscribe(gt(n,r=>ni(n,i,()=>n.next(r),e),()=>ni(n,i,()=>n.complete(),e),r=>ni(n,i,()=>n.error(r),e)))})}function Fh(i,e=0){return mt((t,n)=>{n.add(i.schedule(()=>t.subscribe(n),e))})}function lC(i,e){return An(i).pipe(Fh(e),Th(e))}function uC(i,e){return An(i).pipe(Fh(e),Th(e))}function hC(i,e){return new Rt(t=>{let n=0;return e.schedule(function(){n===i.length?t.complete():(t.next(i[n++]),t.closed||this.schedule())})})}function dC(i,e){return new Rt(t=>{let n;return ni(t,e,()=>{n=i[bh](),ni(t,e,()=>{let r,s;try{({value:r,done:s}=n.next())}catch(o){t.error(o);return}s?t.complete():t.next(r)},0,!0)}),()=>Ye(n?.return)&&n.return()})}function Bh(i,e){if(!i)throw new Error("Iterable cannot be null");return new Rt(t=>{ni(t,e,()=>{let n=i[Symbol.asyncIterator]();ni(t,e,()=>{n.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function fC(i,e){return Bh(Sh(i),e)}function pC(i,e){if(i!=null){if(_h(i))return lC(i,e);if(yh(i))return hC(i,e);if(Ch(i))return uC(i,e);if(Ah(i))return Bh(i,e);if(Dh(i))return dC(i,e);if(Mh(i))return fC(i,e)}throw wh(i)}function En(i,e){return e?pC(i,e):An(i)}function Je(...i){let e=xs(i);return En(i,e)}function ga(i,e){let t=Ye(i)?i:()=>i,n=r=>r.error(t());return new Rt(e?r=>e.schedule(n,0,r):n)}function Mp(i){return!!i&&(i instanceof Rt||Ye(i.lift)&&Ye(i.subscribe))}var Vr=ua(i=>function(){i(this),this.name="EmptyError",this.message="no elements in sequence"});function vt(i,e){return mt((t,n)=>{let r=0;t.subscribe(gt(n,s=>{n.next(i.call(e,s,r++))}))})}var{isArray:e2}=Array;function t2(i,e){return e2(e)?i(...e):i(e)}function xC(i){return vt(e=>t2(i,e))}var{isArray:n2}=Array,{getPrototypeOf:i2,prototype:r2,keys:s2}=Object;function mC(i){if(i.length===1){let e=i[0];if(n2(e))return{args:e,keys:null};if(o2(e)){let t=s2(e);return{args:t.map(n=>e[n]),keys:t}}}return{args:i,keys:null}}function o2(i){return i&&typeof i=="object"&&i2(i)===r2}function gC(i,e){return i.reduce((t,n,r)=>(t[n]=e[r],t),{})}function Ih(...i){let e=xs(i),t=iC(i),{args:n,keys:r}=mC(i);if(n.length===0)return En([],e);let s=new Rt(a2(n,e,r?o=>gC(r,o):ci));return t?s.pipe(xC(t)):s}function a2(i,e,t=ci){return n=>{vC(e,()=>{let{length:r}=i,s=new Array(r),o=r,a=r;for(let c=0;c<r;c++)vC(e,()=>{let l=En(i[c],e),u=!1;l.subscribe(gt(n,h=>{s[c]=h,u||(u=!0,a--),a||n.next(t(s.slice()))},()=>{--o||n.complete()}))},n)},n)}}function vC(i,e,t){i?ni(t,i,e):e()}function EC(i,e,t,n,r,s,o,a){let c=[],l=0,u=0,h=!1,d=()=>{h&&!c.length&&!l&&e.complete()},f=g=>l<n?x(g):c.push(g),x=g=>{s&&e.next(g),l++;let p=!1;An(t(g,u++)).subscribe(gt(e,m=>{r?.(m),s?f(m):e.next(m)},()=>{p=!0},void 0,()=>{if(p)try{for(l--;c.length&&l<n;){let m=c.shift();o?ni(e,o,()=>x(m)):x(m)}d()}catch(m){e.error(m)}}))};return i.subscribe(gt(e,f,()=>{h=!0,d()})),()=>{a?.()}}function yn(i,e,t=1/0){return Ye(e)?yn((n,r)=>vt((s,o)=>e(n,s,r,o))(An(i(n,r))),t):(typeof e=="number"&&(t=e),mt((n,r)=>EC(n,r,i,t)))}function Tp(i=1/0){return yn(ci,i)}function yC(){return Tp(1)}function va(...i){return yC()(En(i,xs(i)))}function Ph(i){return new Rt(e=>{An(i()).subscribe(e)})}function Vi(i,e){return mt((t,n)=>{let r=0;t.subscribe(gt(n,s=>i.call(e,s,r++)&&n.next(s)))})}function ms(i){return mt((e,t)=>{let n=null,r=!1,s;n=e.subscribe(gt(t,void 0,void 0,o=>{s=An(i(o,ms(i)(e))),n?(n.unsubscribe(),n=null,s.subscribe(t)):r=!0})),r&&(n.unsubscribe(),n=null,s.subscribe(t))})}function CC(i,e,t,n,r){return(s,o)=>{let a=t,c=e,l=0;s.subscribe(gt(o,u=>{let h=l++;c=a?i(c,u,h):(a=!0,u),n&&o.next(c)},r&&(()=>{a&&o.next(c),o.complete()})))}}function Ea(i,e){return Ye(e)?yn(i,e,1):yn(i,1)}function gs(i){return mt((e,t)=>{let n=!1;e.subscribe(gt(t,r=>{n=!0,t.next(r)},()=>{n||t.next(i),t.complete()}))})}function zr(i){return i<=0?()=>li:mt((e,t)=>{let n=0;e.subscribe(gt(t,r=>{++n<=i&&(t.next(r),i<=n&&t.complete())}))})}function Fp(i){return vt(()=>i)}function Rh(i=c2){return mt((e,t)=>{let n=!1;e.subscribe(gt(t,r=>{n=!0,t.next(r)},()=>n?t.complete():t.error(i())))})}function c2(){return new Vr}function El(i){return mt((e,t)=>{try{e.subscribe(t)}finally{t.add(i)}})}function fr(i,e){let t=arguments.length>=2;return n=>n.pipe(i?Vi((r,s)=>i(r,s,n)):ci,zr(1),t?gs(e):Rh(()=>new Vr))}function ya(i){return i<=0?()=>li:mt((e,t)=>{let n=[];e.subscribe(gt(t,r=>{n.push(r),i<n.length&&n.shift()},()=>{for(let r of n)t.next(r);t.complete()},void 0,()=>{n=null}))})}function Bp(i,e){let t=arguments.length>=2;return n=>n.pipe(i?Vi((r,s)=>i(r,s,n)):ci,ya(1),t?gs(e):Rh(()=>new Vr))}function Ip(i,e){return mt(CC(i,e,arguments.length>=2,!0))}function Pp(...i){let e=xs(i);return mt((t,n)=>{(e?va(i,t,e):va(i,t)).subscribe(n)})}function zi(i,e){return mt((t,n)=>{let r=null,s=0,o=!1,a=()=>o&&!r&&n.complete();t.subscribe(gt(n,c=>{r?.unsubscribe();let l=0,u=s++;An(i(c,u)).subscribe(r=gt(n,h=>n.next(e?e(c,h,u,l++):h),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function Rp(i){return mt((e,t)=>{An(i).subscribe(gt(t,()=>t.complete(),vl)),!t.closed&&e.subscribe(t)})}function Sn(i,e,t){let n=Ye(i)||e||t?{next:i,error:e,complete:t}:i;return n?mt((r,s)=>{var o;(o=n.subscribe)===null||o===void 0||o.call(n);let a=!0;r.subscribe(gt(s,c=>{var l;(l=n.next)===null||l===void 0||l.call(n,c),s.next(c)},()=>{var c;a=!1,(c=n.complete)===null||c===void 0||c.call(n),s.complete()},c=>{var l;a=!1,(l=n.error)===null||l===void 0||l.call(n,c),s.error(c)},()=>{var c,l;a&&((c=n.unsubscribe)===null||c===void 0||c.call(n)),(l=n.finalize)===null||l===void 0||l.call(n)}))}):ci}var s_="https://g.co/ng/security#xss",je=class extends Error{constructor(e,t){super(Lx(e,t)),this.code=e}};function Lx(i,e){return`${`NG0${Math.abs(i)}`}${e?": "+e:""}`}function ad(i){return{toString:i}.toString()}var Oh="__parameters__";function l2(i){return function(...t){if(i){let n=i(...t);for(let r in n)this[r]=n[r]}}}function o_(i,e,t){return ad(()=>{let n=l2(e);function r(...s){if(this instanceof r)return n.apply(this,s),this;let o=new r(...s);return a.annotation=o,a;function a(c,l,u){let h=c.hasOwnProperty(Oh)?c[Oh]:Object.defineProperty(c,Oh,{value:[]})[Oh];for(;h.length<=u;)h.push(null);return(h[u]=h[u]||[]).push(o),c}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=i,r.annotationCls=r,r})}var yl=globalThis;function kt(i){for(let e in i)if(i[e]===kt)return e;throw Error("Could not find renamed property on target object.")}function Xn(i){if(typeof i=="string")return i;if(Array.isArray(i))return"["+i.map(Xn).join(", ")+"]";if(i==null)return""+i;if(i.overriddenName)return`${i.overriddenName}`;if(i.name)return`${i.name}`;let e=i.toString();if(e==null)return""+e;let t=e.indexOf(`
`);return t===-1?e:e.substring(0,t)}function _C(i,e){return i==null||i===""?e===null?"":e:e==null||e===""?i:i+" "+e}var u2=kt({__forward_ref__:kt});function a_(i){return i.__forward_ref__=a_,i.toString=function(){return Xn(this())},i}function yi(i){return c_(i)?i():i}function c_(i){return typeof i=="function"&&i.hasOwnProperty(u2)&&i.__forward_ref__===a_}function Le(i){return{token:i.token,providedIn:i.providedIn||null,factory:i.factory,value:void 0}}function cd(i){return AC(i,u_)||AC(i,h_)}function l_(i){return cd(i)!==null}function AC(i,e){return i.hasOwnProperty(e)?i[e]:null}function h2(i){let e=i&&(i[u_]||i[h_]);return e||null}function wC(i){return i&&(i.hasOwnProperty(bC)||i.hasOwnProperty(d2))?i[bC]:null}var u_=kt({\u0275prov:kt}),bC=kt({\u0275inj:kt}),h_=kt({ngInjectableDef:kt}),d2=kt({ngInjectorDef:kt}),Et=class{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=Le({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function d_(i){return i&&!!i.\u0275providers}var f2=kt({\u0275cmp:kt}),p2=kt({\u0275dir:kt}),x2=kt({\u0275pipe:kt}),m2=kt({\u0275mod:kt}),jh=kt({\u0275fac:kt}),Cl=kt({__NG_ELEMENT_ID__:kt}),DC=kt({__NG_ENV_ID__:kt});function Ux(i){return typeof i=="string"?i:i==null?"":String(i)}function g2(i){return typeof i=="function"?i.name||i.toString():typeof i=="object"&&i!=null&&typeof i.type=="function"?i.type.name||i.type.toString():Ux(i)}function v2(i,e){let t=e?`. Dependency path: ${e.join(" > ")} > ${i}`:"";throw new je(-200,i)}function Vx(i,e){throw new je(-201,!1)}var ht=function(i){return i[i.Default=0]="Default",i[i.Host=1]="Host",i[i.Self=2]="Self",i[i.SkipSelf=4]="SkipSelf",i[i.Optional=8]="Optional",i}(ht||{}),qp;function f_(){return qp}function Ei(i){let e=qp;return qp=i,e}function p_(i,e,t){let n=cd(i);if(n&&n.providedIn=="root")return n.value===void 0?n.value=n.factory():n.value;if(t&ht.Optional)return null;if(e!==void 0)return e;Vx(i,"Injector")}var E2={},_l=E2,Yp="__NG_DI_FLAG__",Gh="ngTempTokenPath",y2="ngTokenPath",C2=/\n/gm,_2="\u0275",SC="__source",wa;function A2(){return wa}function vs(i){let e=wa;return wa=i,e}function w2(i,e=ht.Default){if(wa===void 0)throw new je(-203,!1);return wa===null?p_(i,void 0,e):wa.get(i,e&ht.Optional?null:void 0,e)}function nt(i,e=ht.Default){return(f_()||w2)(yi(i),e)}function Se(i,e=ht.Default){return nt(i,ld(e))}function ld(i){return typeof i>"u"||typeof i=="number"?i:0|(i.optional&&8)|(i.host&&1)|(i.self&&2)|(i.skipSelf&&4)}function Zp(i){let e=[];for(let t=0;t<i.length;t++){let n=yi(i[t]);if(Array.isArray(n)){if(n.length===0)throw new je(900,!1);let r,s=ht.Default;for(let o=0;o<n.length;o++){let a=n[o],c=b2(a);typeof c=="number"?c===-1?r=a.token:s|=c:r=a}e.push(nt(r,s))}else e.push(nt(n))}return e}function x_(i,e){return i[Yp]=e,i.prototype[Yp]=e,i}function b2(i){return i[Yp]}function D2(i,e,t,n){let r=i[Gh];throw e[SC]&&r.unshift(e[SC]),i.message=S2(`
`+i.message,r,t,n),i[y2]=r,i[Gh]=null,i}function S2(i,e,t,n=null){i=i&&i.charAt(0)===`
`&&i.charAt(1)==_2?i.slice(2):i;let r=Xn(e);if(Array.isArray(e))r=e.map(Xn).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Xn(a)))}r=`{${s.join(", ")}}`}return`${t}${n?"("+n+")":""}[${r}]: ${i.replace(C2,`
  `)}`}var zx=x_(o_("Optional"),8);var m_=x_(o_("SkipSelf"),4);function Sa(i,e){let t=i.hasOwnProperty(jh);return t?i[jh]:null}function M2(i,e,t){if(i.length!==e.length)return!1;for(let n=0;n<i.length;n++){let r=i[n],s=e[n];if(t&&(r=t(r),s=t(s)),s!==r)return!1}return!0}function T2(i){return i.flat(Number.POSITIVE_INFINITY)}function Hx(i,e){i.forEach(t=>Array.isArray(t)?Hx(t,e):e(t))}function g_(i,e,t){e>=i.length?i.push(t):i.splice(e,0,t)}function Wh(i,e){return e>=i.length-1?i.pop():i.splice(e,1)[0]}function F2(i,e,t,n){let r=i.length;if(r==e)i.push(t,n);else if(r===1)i.push(n,i[0]),i[0]=t;else{for(r--,i.push(i[r-1],i[r]);r>e;){let s=r-2;i[r]=i[s],r--}i[e]=t,i[e+1]=n}}function B2(i,e,t){let n=Rl(i,e);return n>=0?i[n|1]=t:(n=~n,F2(i,n,e,t)),n}function Op(i,e){let t=Rl(i,e);if(t>=0)return i[t|1]}function Rl(i,e){return I2(i,e,1)}function I2(i,e,t){let n=0,r=i.length>>t;for(;r!==n;){let s=n+(r-n>>1),o=i[s<<t];if(e===o)return s<<t;o>e?r=s:n=s+1}return~(r<<t)}var Al={},fo=[],Ma=new Et(""),v_=new Et("",-1),E_=new Et(""),$h=class{get(e,t=_l){if(t===_l){let n=new Error(`NullInjectorError: No provider for ${Xn(e)}!`);throw n.name="NullInjectorError",n}return t}},y_=function(i){return i[i.OnPush=0]="OnPush",i[i.Default=1]="Default",i}(y_||{}),mr=function(i){return i[i.Emulated=0]="Emulated",i[i.None=2]="None",i[i.ShadowDom=3]="ShadowDom",i}(mr||{}),ys=function(i){return i[i.None=0]="None",i[i.SignalBased=1]="SignalBased",i[i.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",i}(ys||{});function P2(i,e,t){let n=i.length;for(;;){let r=i.indexOf(e,t);if(r===-1)return r;if(r===0||i.charCodeAt(r-1)<=32){let s=e.length;if(r+s===n||i.charCodeAt(r+s)<=32)return r}t=r+1}}function Kp(i,e,t){let n=0;for(;n<t.length;){let r=t[n];if(typeof r=="number"){if(r!==0)break;n++;let s=t[n++],o=t[n++],a=t[n++];i.setAttribute(e,o,a,s)}else{let s=r,o=t[++n];O2(s)?i.setProperty(e,s,o):i.setAttribute(e,s,o),n++}}return n}function R2(i){return i===3||i===4||i===6}function O2(i){return i.charCodeAt(0)===64}function jx(i,e){if(!(e===null||e.length===0))if(i===null||i.length===0)i=e.slice();else{let t=-1;for(let n=0;n<e.length;n++){let r=e[n];typeof r=="number"?t=r:t===0||(t===-1||t===2?MC(i,t,r,null,e[++n]):MC(i,t,r,null,null))}}return i}function MC(i,e,t,n,r){let s=0,o=i.length;if(e===-1)o=-1;else for(;s<i.length;){let a=i[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<i.length;){let a=i[s];if(typeof a=="number")break;if(a===t){if(n===null){r!==null&&(i[s+1]=r);return}else if(n===i[s+1]){i[s+2]=r;return}}s++,n!==null&&s++,r!==null&&s++}o!==-1&&(i.splice(o,0,e),s=o+1),i.splice(s++,0,t),n!==null&&i.splice(s++,0,n),r!==null&&i.splice(s++,0,r)}var C_="ng-template";function k2(i,e,t,n){let r=0;if(n){for(;r<e.length&&typeof e[r]=="string";r+=2)if(e[r]==="class"&&P2(e[r+1].toLowerCase(),t,0)!==-1)return!0}else if(Gx(i))return!1;if(r=e.indexOf(1,r),r>-1){let s;for(;++r<e.length&&typeof(s=e[r])=="string";)if(s.toLowerCase()===t)return!0}return!1}function Gx(i){return i.type===4&&i.value!==C_}function N2(i,e,t){let n=i.type===4&&!t?C_:i.value;return e===n}function L2(i,e,t){let n=4,r=i.attrs,s=r!==null?z2(r):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!Hi(n)&&!Hi(c))return!1;if(o&&Hi(c))continue;o=!1,n=c|n&1;continue}if(!o)if(n&4){if(n=2|n&1,c!==""&&!N2(i,c,t)||c===""&&e.length===1){if(Hi(n))return!1;o=!0}}else if(n&8){if(r===null||!k2(i,r,c,t)){if(Hi(n))return!1;o=!0}}else{let l=e[++a],u=U2(c,r,Gx(i),t);if(u===-1){if(Hi(n))return!1;o=!0;continue}if(l!==""){let h;if(u>s?h="":h=r[u+1].toLowerCase(),n&2&&l!==h){if(Hi(n))return!1;o=!0}}}}return Hi(n)||o}function Hi(i){return(i&1)===0}function U2(i,e,t,n){if(e===null)return-1;let r=0;if(n||!t){let s=!1;for(;r<e.length;){let o=e[r];if(o===i)return r;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++r];for(;typeof a=="string";)a=e[++r];continue}else{if(o===4)break;if(o===0){r+=4;continue}}r+=s?1:2}return-1}else return H2(e,i)}function V2(i,e,t=!1){for(let n=0;n<e.length;n++)if(L2(i,e[n],t))return!0;return!1}function z2(i){for(let e=0;e<i.length;e++){let t=i[e];if(R2(t))return e}return i.length}function H2(i,e){let t=i.indexOf(4);if(t>-1)for(t++;t<i.length;){let n=i[t];if(typeof n=="number")return-1;if(n===e)return t;t++}return-1}function TC(i,e){return i?":not("+e.trim()+")":e}function j2(i){let e=i[0],t=1,n=2,r="",s=!1;for(;t<i.length;){let o=i[t];if(typeof o=="string")if(n&2){let a=i[++t];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else n&8?r+="."+o:n&4&&(r+=" "+o);else r!==""&&!Hi(o)&&(e+=TC(s,r),r=""),n=o,s=s||!Hi(n);t++}return r!==""&&(e+=TC(s,r)),e}function G2(i){return i.map(j2).join(",")}function W2(i){let e=[],t=[],n=1,r=2;for(;n<i.length;){let s=i[n];if(typeof s=="string")r===2?s!==""&&e.push(s,i[++n]):r===8&&t.push(s);else{if(!Hi(r))break;r=s}n++}return{attrs:e,classes:t}}function Qt(i){return ad(()=>{let e=D_(i),t=on(Me({},e),{decls:i.decls,vars:i.vars,template:i.template,consts:i.consts||null,ngContentSelectors:i.ngContentSelectors,onPush:i.changeDetection===y_.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&i.dependencies||null,getStandaloneInjector:null,signals:i.signals??!1,data:i.data||{},encapsulation:i.encapsulation||mr.Emulated,styles:i.styles||fo,_:null,schemas:i.schemas||null,tView:null,id:""});S_(t);let n=i.dependencies;return t.directiveDefs=BC(n,!1),t.pipeDefs=BC(n,!0),t.id=q2(t),t})}function $2(i){return po(i)||__(i)}function X2(i){return i!==null}function FC(i,e){if(i==null)return Al;let t={};for(let n in i)if(i.hasOwnProperty(n)){let r=i[n],s,o,a=ys.None;Array.isArray(r)?(a=r[0],s=r[1],o=r[2]??s):(s=r,o=r),e?(t[s]=a!==ys.None?[n,a]:n,e[s]=o):t[s]=n}return t}function Ol(i){return ad(()=>{let e=D_(i);return S_(e),e})}function po(i){return i[f2]||null}function __(i){return i[p2]||null}function A_(i){return i[x2]||null}function w_(i){let e=po(i)||__(i)||A_(i);return e!==null?e.standalone:!1}function b_(i,e){let t=i[m2]||null;if(!t&&e===!0)throw new Error(`Type ${Xn(i)} does not have '\u0275mod' property.`);return t}function D_(i){let e={};return{type:i.type,providersResolver:null,factory:null,hostBindings:i.hostBindings||null,hostVars:i.hostVars||0,hostAttrs:i.hostAttrs||null,contentQueries:i.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:i.inputs||Al,exportAs:i.exportAs||null,standalone:i.standalone===!0,signals:i.signals===!0,selectors:i.selectors||fo,viewQuery:i.viewQuery||null,features:i.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:FC(i.inputs,e),outputs:FC(i.outputs),debugInfo:null}}function S_(i){i.features?.forEach(e=>e(i))}function BC(i,e){if(!i)return null;let t=e?A_:$2;return()=>(typeof i=="function"?i():i).map(n=>t(n)).filter(X2)}function q2(i){let e=0,t=[i.selectors,i.ngContentSelectors,i.hostVars,i.hostAttrs,i.consts,i.vars,i.decls,i.encapsulation,i.standalone,i.signals,i.exportAs,JSON.stringify(i.inputs),JSON.stringify(i.outputs),Object.getOwnPropertyNames(i.type.prototype),!!i.contentQueries,!!i.viewQuery].join("|");for(let r of t)e=Math.imul(31,e)+r.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function ud(i){return{\u0275providers:i}}function Y2(...i){return{\u0275providers:M_(!0,i),\u0275fromNgModule:!0}}function M_(i,...e){let t=[],n=new Set,r,s=o=>{t.push(o)};return Hx(e,o=>{let a=o;Jp(a,s,[],n)&&(r||=[],r.push(a))}),r!==void 0&&T_(r,s),t}function T_(i,e){for(let t=0;t<i.length;t++){let{ngModule:n,providers:r}=i[t];Wx(r,s=>{e(s,n)})}}function Jp(i,e,t,n){if(i=yi(i),!i)return!1;let r=null,s=wC(i),o=!s&&po(i);if(!s&&!o){let c=i.ngModule;if(s=wC(c),s)r=c;else return!1}else{if(o&&!o.standalone)return!1;r=i}let a=n.has(r);if(o){if(a)return!1;if(n.add(r),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let l of c)Jp(l,e,t,n)}}else if(s){if(s.imports!=null&&!a){n.add(r);let l;try{Hx(s.imports,u=>{Jp(u,e,t,n)&&(l||=[],l.push(u))})}finally{}l!==void 0&&T_(l,e)}if(!a){let l=Sa(r)||(()=>new r);e({provide:r,useFactory:l,deps:fo},r),e({provide:E_,useValue:r,multi:!0},r),e({provide:Ma,useValue:()=>nt(r),multi:!0},r)}let c=s.providers;if(c!=null&&!a){let l=i;Wx(c,u=>{e(u,l)})}}else return!1;return r!==i&&i.providers!==void 0}function Wx(i,e){for(let t of i)d_(t)&&(t=t.\u0275providers),Array.isArray(t)?Wx(t,e):e(t)}var Z2=kt({provide:String,useValue:kt});function F_(i){return i!==null&&typeof i=="object"&&Z2 in i}function K2(i){return!!(i&&i.useExisting)}function J2(i){return!!(i&&i.useFactory)}function Qp(i){return typeof i=="function"}var hd=new Et(""),Nh={},Q2={},kp;function $x(){return kp===void 0&&(kp=new $h),kp}var Ci=class{},wl=class extends Ci{get destroyed(){return this._destroyed}constructor(e,t,n,r){super(),this.parent=t,this.source=n,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,tx(e,o=>this.processProvider(o)),this.records.set(v_,Ca(void 0,this)),r.has("environment")&&this.records.set(Ci,Ca(void 0,this));let s=this.records.get(hd);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(E_,fo,ht.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=St(null);try{for(let n of this._ngOnDestroyHooks)n.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let n of t)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),St(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let t=vs(this),n=Ei(void 0),r;try{return e()}finally{vs(t),Ei(n)}}get(e,t=_l,n=ht.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(DC))return e[DC](this);n=ld(n);let r,s=vs(this),o=Ei(void 0);try{if(!(n&ht.SkipSelf)){let c=this.records.get(e);if(c===void 0){let l=sT(e)&&cd(e);l&&this.injectableDefInScope(l)?c=Ca(ex(e),Nh):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=n&ht.Self?$x():this.parent;return t=n&ht.Optional&&t===_l?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[Gh]=a[Gh]||[]).unshift(Xn(e)),s)throw a;return D2(a,e,"R3InjectorError",this.source)}else throw a}finally{Ei(o),vs(s)}}resolveInjectorInitializers(){let e=St(null),t=vs(this),n=Ei(void 0),r;try{let s=this.get(Ma,fo,ht.Self);for(let o of s)o()}finally{vs(t),Ei(n),St(e)}}toString(){let e=[],t=this.records;for(let n of t.keys())e.push(Xn(n));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new je(205,!1)}processProvider(e){e=yi(e);let t=Qp(e)?e:yi(e&&e.provide),n=tT(e);if(!Qp(e)&&e.multi===!0){let r=this.records.get(t);r||(r=Ca(void 0,Nh,!0),r.factory=()=>Zp(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,n)}hydrate(e,t){let n=St(null);try{return t.value===Nh&&(t.value=Q2,t.value=t.factory()),typeof t.value=="object"&&t.value&&rT(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{St(n)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=yi(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function ex(i){let e=cd(i),t=e!==null?e.factory:Sa(i);if(t!==null)return t;if(i instanceof Et)throw new je(204,!1);if(i instanceof Function)return eT(i);throw new je(204,!1)}function eT(i){if(i.length>0)throw new je(204,!1);let t=h2(i);return t!==null?()=>t.factory(i):()=>new i}function tT(i){if(F_(i))return Ca(void 0,i.useValue);{let e=nT(i);return Ca(e,Nh)}}function nT(i,e,t){let n;if(Qp(i)){let r=yi(i);return Sa(r)||ex(r)}else if(F_(i))n=()=>yi(i.useValue);else if(J2(i))n=()=>i.useFactory(...Zp(i.deps||[]));else if(K2(i))n=()=>nt(yi(i.useExisting));else{let r=yi(i&&(i.useClass||i.provide));if(iT(i))n=()=>new r(...Zp(i.deps));else return Sa(r)||ex(r)}return n}function Ca(i,e,t=!1){return{factory:i,value:e,multi:t?[]:void 0}}function iT(i){return!!i.deps}function rT(i){return i!==null&&typeof i=="object"&&typeof i.ngOnDestroy=="function"}function sT(i){return typeof i=="function"||typeof i=="object"&&i instanceof Et}function tx(i,e){for(let t of i)Array.isArray(t)?tx(t,e):t&&d_(t)?tx(t.\u0275providers,e):e(t)}function Co(i,e){i instanceof wl&&i.assertNotDestroyed();let t,n=vs(i),r=Ei(void 0);try{return e()}finally{vs(n),Ei(r)}}function oT(){return f_()!==void 0||A2()!=null}function aT(i){return typeof i=="function"}var $r=0,dt=1,ze=2,Mn=3,ji=4,$i=5,Xh=6,bl=7,Gi=8,Ta=9,Wi=10,Ln=11,Dl=12,IC=13,Ra=14,gr=15,kl=16,_a=17,Hr=18,dd=19,B_=20,Es=21,Np=22,xo=23,jr=25,I_=1;var mo=7,qh=8,Fa=9,ui=10,Xx=function(i){return i[i.None=0]="None",i[i.HasTransplantedViews=2]="HasTransplantedViews",i}(Xx||{});function ba(i){return Array.isArray(i)&&typeof i[I_]=="object"}function Xr(i){return Array.isArray(i)&&i[I_]===!0}function qx(i){return(i.flags&4)!==0}function fd(i){return i.componentOffset>-1}function pd(i){return(i.flags&1)===1}function Nl(i){return!!i.template}function cT(i){return(i[ze]&512)!==0}var nx=class{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}};function P_(i,e,t,n){e!==null?e.applyValueToInputSignal(e,n):i[t]=n}function xd(){return R_}function R_(i){return i.type.prototype.ngOnChanges&&(i.setInput=uT),lT}xd.ngInherit=!0;function lT(){let i=k_(this),e=i?.current;if(e){let t=i.previous;if(t===Al)i.previous=e;else for(let n in e)t[n]=e[n];i.current=null,this.ngOnChanges(e)}}function uT(i,e,t,n,r){let s=this.declaredInputs[n],o=k_(i)||hT(i,{previous:Al,current:null}),a=o.current||(o.current={}),c=o.previous,l=c[s];a[s]=new nx(l&&l.currentValue,t,c===Al),P_(i,e,r,t)}var O_="__ngSimpleChanges__";function k_(i){return i[O_]||null}function hT(i,e){return i[O_]=e}var PC=null;var pr=function(i,e,t){PC?.(i,e,t)},N_="svg",dT="math",fT=!1;function pT(){return fT}function vr(i){for(;Array.isArray(i);)i=i[$r];return i}function L_(i,e){return vr(e[i])}function Xi(i,e){return vr(e[i.index])}function U_(i,e){return i.data[e]}function _o(i,e){let t=e[i];return ba(t)?t:t[$r]}function xT(i){return(i[ze]&4)===4}function Yx(i){return(i[ze]&128)===128}function mT(i){return Xr(i[Mn])}function Ba(i,e){return e==null?null:i[e]}function V_(i){i[_a]=0}function gT(i){i[ze]&1024||(i[ze]|=1024,Yx(i)&&Sl(i))}function vT(i,e){for(;i>0;)e=e[Ra],i--;return e}function Zx(i){return!!(i[ze]&9216||i[xo]?.dirty)}function ix(i){i[Wi].changeDetectionScheduler?.notify(1),Zx(i)?Sl(i):i[ze]&64&&(pT()?(i[ze]|=1024,Sl(i)):i[Wi].changeDetectionScheduler?.notify())}function Sl(i){i[Wi].changeDetectionScheduler?.notify();let e=Ml(i);for(;e!==null&&!(e[ze]&8192||(e[ze]|=8192,!Yx(e)));)e=Ml(e)}function z_(i,e){if((i[ze]&256)===256)throw new je(911,!1);i[Es]===null&&(i[Es]=[]),i[Es].push(e)}function ET(i,e){if(i[Es]===null)return;let t=i[Es].indexOf(e);t!==-1&&i[Es].splice(t,1)}function Ml(i){let e=i[Mn];return Xr(e)?e[Mn]:e}var it={lFrame:Y_(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function yT(){return it.lFrame.elementDepthCount}function CT(){it.lFrame.elementDepthCount++}function _T(){it.lFrame.elementDepthCount--}function H_(){return it.bindingsEnabled}function AT(){return it.skipHydrationRootTNode!==null}function wT(i){return it.skipHydrationRootTNode===i}function bT(){it.skipHydrationRootTNode=null}function Xt(){return it.lFrame.lView}function _i(){return it.lFrame.tView}function zt(i){return it.lFrame.contextLView=i,i[Gi]}function Ht(i){return it.lFrame.contextLView=null,i}function qi(){let i=j_();for(;i!==null&&i.type===64;)i=i.parent;return i}function j_(){return it.lFrame.currentTNode}function DT(){let i=it.lFrame,e=i.currentTNode;return i.isParent?e:e.parent}function Ao(i,e){let t=it.lFrame;t.currentTNode=i,t.isParent=e}function Kx(){return it.lFrame.isParent}function G_(){it.lFrame.isParent=!1}function ST(){let i=it.lFrame,e=i.bindingRootIndex;return e===-1&&(e=i.bindingRootIndex=i.tView.bindingStartIndex),e}function MT(i){return it.lFrame.bindingIndex=i}function W_(){return it.lFrame.bindingIndex++}function TT(i){let e=it.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+i,t}function FT(){return it.lFrame.inI18n}function BT(i,e){let t=it.lFrame;t.bindingIndex=t.bindingRootIndex=i,rx(e)}function IT(){return it.lFrame.currentDirectiveIndex}function rx(i){it.lFrame.currentDirectiveIndex=i}function PT(i){let e=it.lFrame.currentDirectiveIndex;return e===-1?null:i[e]}function $_(){return it.lFrame.currentQueryIndex}function Jx(i){it.lFrame.currentQueryIndex=i}function RT(i){let e=i[dt];return e.type===2?e.declTNode:e.type===1?i[$i]:null}function X_(i,e,t){if(t&ht.SkipSelf){let r=e,s=i;for(;r=r.parent,r===null&&!(t&ht.Host);)if(r=RT(s),r===null||(s=s[Ra],r.type&10))break;if(r===null)return!1;e=r,i=s}let n=it.lFrame=q_();return n.currentTNode=e,n.lView=i,!0}function Qx(i){let e=q_(),t=i[dt];it.lFrame=e,e.currentTNode=t.firstChild,e.lView=i,e.tView=t,e.contextLView=i,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function q_(){let i=it.lFrame,e=i===null?null:i.child;return e===null?Y_(i):e}function Y_(i){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:i,child:null,inI18n:!1};return i!==null&&(i.child=e),e}function Z_(){let i=it.lFrame;return it.lFrame=i.parent,i.currentTNode=null,i.lView=null,i}var K_=Z_;function em(){let i=Z_();i.isParent=!0,i.tView=null,i.selectedIndex=-1,i.contextLView=null,i.elementDepthCount=0,i.currentDirectiveIndex=-1,i.currentNamespace=null,i.bindingRootIndex=-1,i.bindingIndex=-1,i.currentQueryIndex=0}function OT(i){return(it.lFrame.contextLView=vT(i,it.lFrame.contextLView))[Gi]}function Oa(){return it.lFrame.selectedIndex}function go(i){it.lFrame.selectedIndex=i}function kT(){let i=it.lFrame;return U_(i.tView,i.selectedIndex)}function Ll(){it.lFrame.currentNamespace=N_}function Ul(){NT()}function NT(){it.lFrame.currentNamespace=null}function LT(){return it.lFrame.currentNamespace}var J_=!0;function md(){return J_}function gd(i){J_=i}function UT(i,e,t){let{ngOnChanges:n,ngOnInit:r,ngDoCheck:s}=e.type.prototype;if(n){let o=R_(e);(t.preOrderHooks??=[]).push(i,o),(t.preOrderCheckHooks??=[]).push(i,o)}r&&(t.preOrderHooks??=[]).push(0-i,r),s&&((t.preOrderHooks??=[]).push(i,s),(t.preOrderCheckHooks??=[]).push(i,s))}function vd(i,e){for(let t=e.directiveStart,n=e.directiveEnd;t<n;t++){let s=i.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:l,ngOnDestroy:u}=s;o&&(i.contentHooks??=[]).push(-t,o),a&&((i.contentHooks??=[]).push(t,a),(i.contentCheckHooks??=[]).push(t,a)),c&&(i.viewHooks??=[]).push(-t,c),l&&((i.viewHooks??=[]).push(t,l),(i.viewCheckHooks??=[]).push(t,l)),u!=null&&(i.destroyHooks??=[]).push(t,u)}}function Lh(i,e,t){Q_(i,e,3,t)}function Uh(i,e,t,n){(i[ze]&3)===t&&Q_(i,e,t,n)}function Lp(i,e){let t=i[ze];(t&3)===e&&(t&=16383,t+=1,i[ze]=t)}function Q_(i,e,t,n){let r=n!==void 0?i[_a]&65535:0,s=n??-1,o=e.length-1,a=0;for(let c=r;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],n!=null&&a>=n)break}else e[c]<0&&(i[_a]+=65536),(a<s||s==-1)&&(VT(i,t,e,c),i[_a]=(i[_a]&4294901760)+c+2),c++}function RC(i,e){pr(4,i,e);let t=St(null);try{e.call(i)}finally{St(t),pr(5,i,e)}}function VT(i,e,t,n){let r=t[n]<0,s=t[n+1],o=r?-t[n]:t[n],a=i[o];r?i[ze]>>14<i[_a]>>16&&(i[ze]&3)===e&&(i[ze]+=16384,RC(a,s)):RC(a,s)}var Da=-1,Tl=class{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}};function zT(i){return i instanceof Tl}function HT(i){return(i.flags&8)!==0}function jT(i){return(i.flags&16)!==0}function e1(i){return i!==Da}function Yh(i){return i&32767}function GT(i){return i>>16}function Zh(i,e){let t=GT(i),n=e;for(;t>0;)n=n[Ra],t--;return n}var sx=!0;function OC(i){let e=sx;return sx=i,e}var WT=256,t1=WT-1,n1=5,$T=0,xr={};function XT(i,e,t){let n;typeof t=="string"?n=t.charCodeAt(0)||0:t.hasOwnProperty(Cl)&&(n=t[Cl]),n==null&&(n=t[Cl]=$T++);let r=n&t1,s=1<<r;e.data[i+(r>>n1)]|=s}function i1(i,e){let t=r1(i,e);if(t!==-1)return t;let n=e[dt];n.firstCreatePass&&(i.injectorIndex=e.length,Up(n.data,i),Up(e,null),Up(n.blueprint,null));let r=tm(i,e),s=i.injectorIndex;if(e1(r)){let o=Yh(r),a=Zh(r,e),c=a[dt].data;for(let l=0;l<8;l++)e[s+l]=a[o+l]|c[o+l]}return e[s+8]=r,s}function Up(i,e){i.push(0,0,0,0,0,0,0,0,e)}function r1(i,e){return i.injectorIndex===-1||i.parent&&i.parent.injectorIndex===i.injectorIndex||e[i.injectorIndex+8]===null?-1:i.injectorIndex}function tm(i,e){if(i.parent&&i.parent.injectorIndex!==-1)return i.parent.injectorIndex;let t=0,n=null,r=e;for(;r!==null;){if(n=l1(r),n===null)return Da;if(t++,r=r[Ra],n.injectorIndex!==-1)return n.injectorIndex|t<<16}return Da}function qT(i,e,t){XT(i,e,t)}function s1(i,e,t){if(t&ht.Optional||i!==void 0)return i;Vx(e,"NodeInjector")}function o1(i,e,t,n){if(t&ht.Optional&&n===void 0&&(n=null),!(t&(ht.Self|ht.Host))){let r=i[Ta],s=Ei(void 0);try{return r?r.get(e,n,t&ht.Optional):p_(e,n,t&ht.Optional)}finally{Ei(s)}}return s1(n,e,t)}function a1(i,e,t,n=ht.Default,r){if(i!==null){if(e[ze]&2048&&!(n&ht.Self)){let o=JT(i,e,t,n,xr);if(o!==xr)return o}let s=c1(i,e,t,n,xr);if(s!==xr)return s}return o1(e,t,n,r)}function c1(i,e,t,n,r){let s=ZT(t);if(typeof s=="function"){if(!X_(e,i,n))return n&ht.Host?s1(r,t,n):o1(e,t,n,r);try{let o;if(o=s(n),o==null&&!(n&ht.Optional))Vx(t);else return o}finally{K_()}}else if(typeof s=="number"){let o=null,a=r1(i,e),c=Da,l=n&ht.Host?e[gr][$i]:null;for((a===-1||n&ht.SkipSelf)&&(c=a===-1?tm(i,e):e[a+8],c===Da||!NC(n,!1)?a=-1:(o=e[dt],a=Yh(c),e=Zh(c,e)));a!==-1;){let u=e[dt];if(kC(s,a,u.data)){let h=YT(a,e,t,o,n,l);if(h!==xr)return h}c=e[a+8],c!==Da&&NC(n,e[dt].data[a+8]===l)&&kC(s,a,e)?(o=u,a=Yh(c),e=Zh(c,e)):a=-1}}return r}function YT(i,e,t,n,r,s){let o=e[dt],a=o.data[i+8],c=n==null?fd(a)&&sx:n!=o&&(a.type&3)!==0,l=r&ht.Host&&s===a,u=Vh(a,o,t,c,l);return u!==null?Ia(e,o,u,a):xr}function Vh(i,e,t,n,r){let s=i.providerIndexes,o=e.data,a=s&1048575,c=i.directiveStart,l=i.directiveEnd,u=s>>20,h=n?a:a+u,d=r?a+u:l;for(let f=h;f<d;f++){let x=o[f];if(f<c&&t===x||f>=c&&x.type===t)return f}if(r){let f=o[c];if(f&&Nl(f)&&f.type===t)return c}return null}function Ia(i,e,t,n){let r=i[t],s=e.data;if(zT(r)){let o=r;o.resolving&&v2(g2(s[t]));let a=OC(o.canSeeViewProviders);o.resolving=!0;let c,l=o.injectImpl?Ei(o.injectImpl):null,u=X_(i,n,ht.Default);try{r=i[t]=o.factory(void 0,s,i,n),e.firstCreatePass&&t>=n.directiveStart&&UT(t,s[t],e)}finally{l!==null&&Ei(l),OC(a),o.resolving=!1,K_()}}return r}function ZT(i){if(typeof i=="string")return i.charCodeAt(0)||0;let e=i.hasOwnProperty(Cl)?i[Cl]:void 0;return typeof e=="number"?e>=0?e&t1:KT:e}function kC(i,e,t){let n=1<<i;return!!(t[e+(i>>n1)]&n)}function NC(i,e){return!(i&ht.Self)&&!(i&ht.Host&&e)}var ho=class{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,n){return a1(this._tNode,this._lView,e,ld(n),t)}};function KT(){return new ho(qi(),Xt())}function nm(i){return ad(()=>{let e=i.prototype.constructor,t=e[jh]||ox(e),n=Object.prototype,r=Object.getPrototypeOf(i.prototype).constructor;for(;r&&r!==n;){let s=r[jh]||ox(r);if(s&&s!==t)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function ox(i){return c_(i)?()=>{let e=ox(yi(i));return e&&e()}:Sa(i)}function JT(i,e,t,n,r){let s=i,o=e;for(;s!==null&&o!==null&&o[ze]&2048&&!(o[ze]&512);){let a=c1(s,o,t,n|ht.Self,xr);if(a!==xr)return a;let c=s.parent;if(!c){let l=o[B_];if(l){let u=l.get(t,xr,n);if(u!==xr)return u}c=l1(o),o=o[Ra]}s=c}return r}function l1(i){let e=i[dt],t=e.type;return t===2?e.declTNode:t===1?i[$i]:null}function LC(i,e=null,t=null,n){let r=u1(i,e,t,n);return r.resolveInjectorInitializers(),r}function u1(i,e=null,t=null,n,r=new Set){let s=[t||fo,Y2(i)];return n=n||(typeof i=="object"?void 0:Xn(i)),new wl(s,e||$x(),n||null,r)}var Vl=(()=>{let e=class e{static create(n,r){if(Array.isArray(n))return LC({name:""},r,n,"");{let s=n.name??"";return LC({name:s},n.parent,n.providers,s)}}};e.THROW_IF_NOT_FOUND=_l,e.NULL=new $h,e.\u0275prov=Le({token:e,providedIn:"any",factory:()=>nt(v_)}),e.__NG_ELEMENT_ID__=-1;let i=e;return i})();var QT="ngOriginalError";function Vp(i){return i[QT]}var Gr=class{constructor(){this._console=console}handleError(e){let t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&Vp(e);for(;t&&Vp(t);)t=Vp(t);return t||null}},h1=new Et("",{providedIn:"root",factory:()=>Se(Gr).handleError.bind(void 0)}),d1=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=e8,e.__NG_ENV_ID__=n=>n;let i=e;return i})(),ax=class extends d1{constructor(e){super(),this._lView=e}onDestroy(e){return z_(this._lView,e),()=>ET(this._lView,e)}};function e8(){return new ax(Xt())}function t8(){return ka(qi(),Xt())}function ka(i,e){return new wo(Xi(i,e))}var wo=(()=>{let e=class e{constructor(n){this.nativeElement=n}};e.__NG_ELEMENT_ID__=t8;let i=e;return i})();function n8(i){return i instanceof wo?i.nativeElement:i}var cx=class extends $n{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,oT()&&(this.destroyRef=Se(d1,{optional:!0})??void 0)}emit(e){let t=St(null);try{super.next(e)}finally{St(t)}}subscribe(e,t,n){let r=e,s=t||(()=>null),o=n;if(e&&typeof e=="object"){let c=e;r=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=zp(s),r&&(r=zp(r)),o&&(o=zp(o)));let a=super.subscribe({next:r,error:s,complete:o});return e instanceof vn&&e.add(a),a}};function zp(i){return e=>{setTimeout(i,void 0,e)}}var Bt=cx;function i8(){return this._results[Symbol.iterator]()}var lx=class i{get changes(){return this._changes??=new Bt}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;let t=i.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=i8)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;let n=T2(e);(this._changesDetected=!M2(this._results,n,t))&&(this._results=n,this.length=n.length,this.last=n[this.length-1],this.first=n[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}};function f1(i){return(i.flags&128)===128}var p1=new Map,r8=0;function s8(){return r8++}function o8(i){p1.set(i[dd],i)}function a8(i){p1.delete(i[dd])}var UC="__ngContext__";function Cs(i,e){ba(e)?(i[UC]=e[dd],o8(e)):i[UC]=e}function x1(i){return g1(i[Dl])}function m1(i){return g1(i[ji])}function g1(i){for(;i!==null&&!Xr(i);)i=i[ji];return i}var ux;function v1(i){ux=i}function c8(){if(ux!==void 0)return ux;if(typeof document<"u")return document;throw new je(210,!1)}var im=new Et("",{providedIn:"root",factory:()=>l8}),l8="ng",rm=new Et(""),Na=new Et("",{providedIn:"platform",factory:()=>"unknown"});var sm=new Et("",{providedIn:"root",factory:()=>c8().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var u8="h",h8="b";var d8=()=>null;function om(i,e,t=!1){return d8(i,e,t)}var E1=!1,f8=new Et("",{providedIn:"root",factory:()=>E1});var Kh=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${s_})`}};function Ed(i){return i instanceof Kh?i.changingThisBreaksApplicationSecurity:i}function y1(i,e){let t=p8(i);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${s_})`)}return t===e}function p8(i){return i instanceof Kh&&i.getTypeName()||null}var x8=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function C1(i){return i=String(i),i.match(x8)?i:"unsafe:"+i}var am=function(i){return i[i.NONE=0]="NONE",i[i.HTML=1]="HTML",i[i.STYLE=2]="STYLE",i[i.SCRIPT=3]="SCRIPT",i[i.URL=4]="URL",i[i.RESOURCE_URL=5]="RESOURCE_URL",i}(am||{});function Yi(i){let e=m8();return e?e.sanitize(am.URL,i)||"":y1(i,"URL")?Ed(i):C1(Ux(i))}function m8(){let i=Xt();return i&&i[Wi].sanitizer}var g8=/^>|^->|<!--|-->|--!>|<!-$/g,v8=/(<|>)/g,E8="\u200B$1\u200B";function y8(i){return i.replace(g8,e=>e.replace(v8,E8))}function _1(i){return i instanceof Function?i():i}var Wr=function(i){return i[i.Important=1]="Important",i[i.DashCase=2]="DashCase",i}(Wr||{}),C8;function cm(i,e){return C8(i,e)}function Aa(i,e,t,n,r){if(n!=null){let s,o=!1;Xr(n)?s=n:ba(n)&&(o=!0,n=n[$r]);let a=vr(n);i===0&&t!==null?r==null?S1(e,t,a):Jh(e,t,a,r||null,!0):i===1&&t!==null?Jh(e,t,a,r||null,!0):i===2?U8(e,a,o):i===3&&e.destroyNode(a),s!=null&&z8(e,i,s,t,r)}}function _8(i,e){return i.createText(e)}function A8(i,e,t){i.setValue(e,t)}function w8(i,e){return i.createComment(y8(e))}function A1(i,e,t){return i.createElement(e,t)}function b8(i,e){w1(i,e),e[$r]=null,e[$i]=null}function D8(i,e,t,n,r,s){n[$r]=r,n[$i]=e,Cd(i,n,t,1,r,s)}function w1(i,e){e[Wi].changeDetectionScheduler?.notify(1),Cd(i,e,e[Ln],2,null,null)}function S8(i){let e=i[Dl];if(!e)return Hp(i[dt],i);for(;e;){let t=null;if(ba(e))t=e[Dl];else{let n=e[ui];n&&(t=n)}if(!t){for(;e&&!e[ji]&&e!==i;)ba(e)&&Hp(e[dt],e),e=e[Mn];e===null&&(e=i),ba(e)&&Hp(e[dt],e),t=e&&e[ji]}e=t}}function M8(i,e,t,n){let r=ui+n,s=t.length;n>0&&(t[r-1][ji]=e),n<s-ui?(e[ji]=t[r],g_(t,ui+n,e)):(t.push(e),e[ji]=null),e[Mn]=t;let o=e[kl];o!==null&&t!==o&&T8(o,e);let a=e[Hr];a!==null&&a.insertView(i),ix(e),e[ze]|=128}function T8(i,e){let t=i[Fa],r=e[Mn][Mn][gr];e[gr]!==r&&(i[ze]|=Xx.HasTransplantedViews),t===null?i[Fa]=[e]:t.push(e)}function b1(i,e){let t=i[Fa],n=t.indexOf(e);t.splice(n,1)}function hx(i,e){if(i.length<=ui)return;let t=ui+e,n=i[t];if(n){let r=n[kl];r!==null&&r!==i&&b1(r,n),e>0&&(i[t-1][ji]=n[ji]);let s=Wh(i,ui+e);b8(n[dt],n);let o=s[Hr];o!==null&&o.detachView(s[dt]),n[Mn]=null,n[ji]=null,n[ze]&=-129}return n}function D1(i,e){if(!(e[ze]&256)){let t=e[Ln];t.destroyNode&&Cd(i,e,t,3,null,null),S8(e)}}function Hp(i,e){if(e[ze]&256)return;let t=St(null);try{e[ze]&=-129,e[ze]|=256,e[xo]&&$y(e[xo]),B8(i,e),F8(i,e),e[dt].type===1&&e[Ln].destroy();let n=e[kl];if(n!==null&&Xr(e[Mn])){n!==e[Mn]&&b1(n,e);let r=e[Hr];r!==null&&r.detachView(i)}a8(e)}finally{St(t)}}function F8(i,e){let t=i.cleanup,n=e[bl];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let o=t[s+3];o>=0?n[o]():n[-o].unsubscribe(),s+=2}else{let o=n[t[s+1]];t[s].call(o)}n!==null&&(e[bl]=null);let r=e[Es];if(r!==null){e[Es]=null;for(let s=0;s<r.length;s++){let o=r[s];o()}}}function B8(i,e){let t;if(i!=null&&(t=i.destroyHooks)!=null)for(let n=0;n<t.length;n+=2){let r=e[t[n]];if(!(r instanceof Tl)){let s=t[n+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=r[s[o]],c=s[o+1];pr(4,a,c);try{c.call(a)}finally{pr(5,a,c)}}else{pr(4,r,s);try{s.call(r)}finally{pr(5,r,s)}}}}}function I8(i,e,t){return P8(i,e.parent,t)}function P8(i,e,t){let n=e;for(;n!==null&&n.type&40;)e=n,n=e.parent;if(n===null)return t[$r];{let{componentOffset:r}=n;if(r>-1){let{encapsulation:s}=i.data[n.directiveStart+r];if(s===mr.None||s===mr.Emulated)return null}return Xi(n,t)}}function Jh(i,e,t,n,r){i.insertBefore(e,t,n,r)}function S1(i,e,t){i.appendChild(e,t)}function VC(i,e,t,n,r){n!==null?Jh(i,e,t,n,r):S1(i,e,t)}function R8(i,e,t,n){i.removeChild(e,t,n)}function lm(i,e){return i.parentNode(e)}function O8(i,e){return i.nextSibling(e)}function k8(i,e,t){return L8(i,e,t)}function N8(i,e,t){return i.type&40?Xi(i,t):null}var L8=N8,zC;function yd(i,e,t,n){let r=I8(i,n,e),s=e[Ln],o=n.parent||e[$i],a=k8(o,n,e);if(r!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)VC(s,r,t[c],a,!1);else VC(s,r,t,a,!1);zC!==void 0&&zC(s,n,e,t,r)}function zh(i,e){if(e!==null){let t=e.type;if(t&3)return Xi(e,i);if(t&4)return dx(-1,i[e.index]);if(t&8){let n=e.child;if(n!==null)return zh(i,n);{let r=i[e.index];return Xr(r)?dx(-1,r):vr(r)}}else{if(t&32)return cm(e,i)()||vr(i[e.index]);{let n=M1(i,e);if(n!==null){if(Array.isArray(n))return n[0];let r=Ml(i[gr]);return zh(r,n)}else return zh(i,e.next)}}}return null}function M1(i,e){if(e!==null){let n=i[gr][$i],r=e.projection;return n.projection[r]}return null}function dx(i,e){let t=ui+i+1;if(t<e.length){let n=e[t],r=n[dt].firstChild;if(r!==null)return zh(n,r)}return e[mo]}function U8(i,e,t){let n=lm(i,e);n&&R8(i,n,e,t)}function um(i,e,t,n,r,s,o){for(;t!=null;){let a=n[t.index],c=t.type;if(o&&e===0&&(a&&Cs(vr(a),n),t.flags|=2),(t.flags&32)!==32)if(c&8)um(i,e,t.child,n,r,s,!1),Aa(e,i,r,a,s);else if(c&32){let l=cm(t,n),u;for(;u=l();)Aa(e,i,r,u,s);Aa(e,i,r,a,s)}else c&16?V8(i,e,n,t,r,s):Aa(e,i,r,a,s);t=o?t.projectionNext:t.next}}function Cd(i,e,t,n,r,s){um(t,n,i.firstChild,e,r,s,!1)}function V8(i,e,t,n,r,s){let o=t[gr],c=o[$i].projection[n.projection];if(Array.isArray(c))for(let l=0;l<c.length;l++){let u=c[l];Aa(e,i,r,u,s)}else{let l=c,u=o[Mn];f1(n)&&(l.flags|=128),um(i,e,l,u,r,s,!0)}}function z8(i,e,t,n,r){let s=t[mo],o=vr(t);s!==o&&Aa(e,i,n,s,r);for(let a=ui;a<t.length;a++){let c=t[a];Cd(c[dt],c,i,e,n,s)}}function H8(i,e,t,n,r){if(e)r?i.addClass(t,n):i.removeClass(t,n);else{let s=n.indexOf("-")===-1?void 0:Wr.DashCase;r==null?i.removeStyle(t,n,s):(typeof r=="string"&&r.endsWith("!important")&&(r=r.slice(0,-10),s|=Wr.Important),i.setStyle(t,n,r,s))}}function j8(i,e,t){i.setAttribute(e,"style",t)}function T1(i,e,t){t===""?i.removeAttribute(e,"class"):i.setAttribute(e,"class",t)}function F1(i,e,t){let{mergedAttrs:n,classes:r,styles:s}=t;n!==null&&Kp(i,e,n),r!==null&&T1(i,e,r),s!==null&&j8(i,e,s)}var bo={};function me(i=1){B1(_i(),Xt(),Oa()+i,!1)}function B1(i,e,t,n){if(!n)if((e[ze]&3)===3){let s=i.preOrderCheckHooks;s!==null&&Lh(e,s,t)}else{let s=i.preOrderHooks;s!==null&&Uh(e,s,0,t)}go(t)}function en(i,e=ht.Default){let t=Xt();if(t===null)return nt(i,e);let n=qi();return a1(n,t,yi(i),e)}function I1(i,e,t,n,r,s){let o=St(null);try{let a=null;r&ys.SignalBased&&(a=e[n][Hy]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),r&ys.HasDecoratorInputTransform&&(s=i.inputTransforms[n].call(e,s)),i.setInput!==null?i.setInput(e,a,s,t,n):P_(e,a,n,s)}finally{St(o)}}function G8(i,e){let t=i.hostBindingOpCodes;if(t!==null)try{for(let n=0;n<t.length;n++){let r=t[n];if(r<0)go(~r);else{let s=r,o=t[++n],a=t[++n];BT(o,s);let c=e[s];a(2,c)}}}finally{go(-1)}}function _d(i,e,t,n,r,s,o,a,c,l,u){let h=e.blueprint.slice();return h[$r]=r,h[ze]=n|4|128|8|64,(l!==null||i&&i[ze]&2048)&&(h[ze]|=2048),V_(h),h[Mn]=h[Ra]=i,h[Gi]=t,h[Wi]=o||i&&i[Wi],h[Ln]=a||i&&i[Ln],h[Ta]=c||i&&i[Ta]||null,h[$i]=s,h[dd]=s8(),h[Xh]=u,h[B_]=l,h[gr]=e.type==2?i[gr]:h,h}function zl(i,e,t,n,r){let s=i.data[e];if(s===null)s=W8(i,e,t,n,r),FT()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=n,s.attrs=r;let o=DT();s.injectorIndex=o===null?-1:o.injectorIndex}return Ao(s,!0),s}function W8(i,e,t,n,r){let s=j_(),o=Kx(),a=o?s:s&&s.parent,c=i.data[e]=K8(i,a,t,e,n,r);return i.firstChild===null&&(i.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function P1(i,e,t,n){if(t===0)return-1;let r=e.length;for(let s=0;s<t;s++)e.push(n),i.blueprint.push(n),i.data.push(null);return r}function R1(i,e,t,n,r){let s=Oa(),o=n&2;try{go(-1),o&&e.length>jr&&B1(i,e,jr,!1),pr(o?2:0,r),t(n,r)}finally{go(s),pr(o?3:1,r)}}function hm(i,e,t){if(qx(e)){let n=St(null);try{let r=e.directiveStart,s=e.directiveEnd;for(let o=r;o<s;o++){let a=i.data[o];if(a.contentQueries){let c=t[o];a.contentQueries(1,c,o)}}}finally{St(n)}}}function dm(i,e,t){H_()&&(rF(i,e,t,Xi(t,e)),(t.flags&64)===64&&N1(i,e,t))}function fm(i,e,t=Xi){let n=e.localNames;if(n!==null){let r=e.index+1;for(let s=0;s<n.length;s+=2){let o=n[s+1],a=o===-1?t(e,i):i[o];i[r++]=a}}}function O1(i){let e=i.tView;return e===null||e.incompleteFirstPass?i.tView=pm(1,null,i.template,i.decls,i.vars,i.directiveDefs,i.pipeDefs,i.viewQuery,i.schemas,i.consts,i.id):e}function pm(i,e,t,n,r,s,o,a,c,l,u){let h=jr+n,d=h+r,f=$8(h,d),x=typeof l=="function"?l():l;return f[dt]={type:i,blueprint:f,template:t,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:d,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:x,incompleteFirstPass:!1,ssrId:u}}function $8(i,e){let t=[];for(let n=0;n<e;n++)t.push(n<i?null:bo);return t}function X8(i,e,t,n){let s=n.get(f8,E1)||t===mr.ShadowDom,o=i.selectRootElement(e,s);return q8(o),o}function q8(i){Y8(i)}var Y8=()=>null;function Z8(i,e,t,n){let r=V1(e);r.push(t),i.firstCreatePass&&z1(i).push(n,r.length-1)}function K8(i,e,t,n,r,s){let o=e?e.injectorIndex:-1,a=0;return AT()&&(a|=128),{type:t,index:n,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function HC(i,e,t,n,r){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;n??={};let a,c=ys.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let l=s;if(r!==null){if(!r.hasOwnProperty(s))continue;l=r[s]}i===0?jC(n,t,l,a,c):jC(n,t,l,a)}return n}function jC(i,e,t,n,r){let s;i.hasOwnProperty(t)?(s=i[t]).push(e,n):s=i[t]=[e,n],r!==void 0&&s.push(r)}function J8(i,e,t){let n=e.directiveStart,r=e.directiveEnd,s=i.data,o=e.attrs,a=[],c=null,l=null;for(let u=n;u<r;u++){let h=s[u],d=t?t.get(h):null,f=d?d.inputs:null,x=d?d.outputs:null;c=HC(0,h.inputs,u,c,f),l=HC(1,h.outputs,u,l,x);let g=c!==null&&o!==null&&!Gx(e)?fF(c,u,o):null;a.push(g)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=l}function Q8(i){return i==="class"?"className":i==="for"?"htmlFor":i==="formaction"?"formAction":i==="innerHtml"?"innerHTML":i==="readonly"?"readOnly":i==="tabindex"?"tabIndex":i}function eF(i,e,t,n,r,s,o,a){let c=Xi(e,t),l=e.inputs,u;!a&&l!=null&&(u=l[n])?(mm(i,t,u,n,r),fd(e)&&tF(t,e.index)):e.type&3?(n=Q8(n),r=o!=null?o(r,e.value||"",n):r,s.setProperty(c,n,r)):e.type&12}function tF(i,e){let t=_o(e,i);t[ze]&16||(t[ze]|=64)}function xm(i,e,t,n){if(H_()){let r=n===null?null:{"":-1},s=oF(i,t),o,a;s===null?o=a=null:[o,a]=s,o!==null&&k1(i,e,t,o,r,a),r&&aF(t,n,r)}t.mergedAttrs=jx(t.mergedAttrs,t.attrs)}function k1(i,e,t,n,r,s){for(let l=0;l<n.length;l++)qT(i1(t,e),i,n[l].type);lF(t,i.data.length,n.length);for(let l=0;l<n.length;l++){let u=n[l];u.providersResolver&&u.providersResolver(u)}let o=!1,a=!1,c=P1(i,e,n.length,null);for(let l=0;l<n.length;l++){let u=n[l];t.mergedAttrs=jx(t.mergedAttrs,u.hostAttrs),uF(i,t,e,c,u),cF(c,u,r),u.contentQueries!==null&&(t.flags|=4),(u.hostBindings!==null||u.hostAttrs!==null||u.hostVars!==0)&&(t.flags|=64);let h=u.type.prototype;!o&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((i.preOrderHooks??=[]).push(t.index),o=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((i.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}J8(i,t,s)}function nF(i,e,t,n,r){let s=r.hostBindings;if(s){let o=i.hostBindingOpCodes;o===null&&(o=i.hostBindingOpCodes=[]);let a=~e.index;iF(o)!=a&&o.push(a),o.push(t,n,s)}}function iF(i){let e=i.length;for(;e>0;){let t=i[--e];if(typeof t=="number"&&t<0)return t}return 0}function rF(i,e,t,n){let r=t.directiveStart,s=t.directiveEnd;fd(t)&&hF(e,t,i.data[r+t.componentOffset]),i.firstCreatePass||i1(t,e),Cs(n,e);let o=t.initialInputs;for(let a=r;a<s;a++){let c=i.data[a],l=Ia(e,i,a,t);if(Cs(l,e),o!==null&&dF(e,a-r,l,c,t,o),Nl(c)){let u=_o(t.index,e);u[Gi]=Ia(e,i,a,t)}}}function N1(i,e,t){let n=t.directiveStart,r=t.directiveEnd,s=t.index,o=IT();try{go(s);for(let a=n;a<r;a++){let c=i.data[a],l=e[a];rx(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&sF(c,l)}}finally{go(-1),rx(o)}}function sF(i,e){i.hostBindings!==null&&i.hostBindings(1,e)}function oF(i,e){let t=i.directiveRegistry,n=null,r=null;if(t)for(let s=0;s<t.length;s++){let o=t[s];if(V2(e,o.selectors,!1))if(n||(n=[]),Nl(o))if(o.findHostDirectiveDefs!==null){let a=[];r=r||new Map,o.findHostDirectiveDefs(o,a,r),n.unshift(...a,o);let c=a.length;fx(i,e,c)}else n.unshift(o),fx(i,e,0);else r=r||new Map,o.findHostDirectiveDefs?.(o,n,r),n.push(o)}return n===null?null:[n,r]}function fx(i,e,t){e.componentOffset=t,(i.components??=[]).push(e.index)}function aF(i,e,t){if(e){let n=i.localNames=[];for(let r=0;r<e.length;r+=2){let s=t[e[r+1]];if(s==null)throw new je(-301,!1);n.push(e[r],s)}}}function cF(i,e,t){if(t){if(e.exportAs)for(let n=0;n<e.exportAs.length;n++)t[e.exportAs[n]]=i;Nl(e)&&(t[""]=i)}}function lF(i,e,t){i.flags|=1,i.directiveStart=e,i.directiveEnd=e+t,i.providerIndexes=e}function uF(i,e,t,n,r){i.data[n]=r;let s=r.factory||(r.factory=Sa(r.type,!0)),o=new Tl(s,Nl(r),en);i.blueprint[n]=o,t[n]=o,nF(i,e,n,P1(i,t,r.hostVars,bo),r)}function hF(i,e,t){let n=Xi(e,i),r=O1(t),s=i[Wi].rendererFactory,o=16;t.signals?o=4096:t.onPush&&(o=64);let a=Ad(i,_d(i,r,null,o,n,e,null,s.createRenderer(n,t),null,null,null));i[e.index]=a}function dF(i,e,t,n,r,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],l=o[a++],u=o[a++],h=o[a++];I1(n,t,c,l,u,h)}}function fF(i,e,t){let n=null,r=0;for(;r<t.length;){let s=t[r];if(s===0){r+=4;continue}else if(s===5){r+=2;continue}if(typeof s=="number")break;if(i.hasOwnProperty(s)){n===null&&(n=[]);let o=i[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){n.push(s,o[a+1],o[a+2],t[r+1]);break}}r+=2}return n}function L1(i,e,t,n){return[i,!0,0,e,null,n,null,t,null,null]}function U1(i,e){let t=i.contentQueries;if(t!==null){let n=St(null);try{for(let r=0;r<t.length;r+=2){let s=t[r],o=t[r+1];if(o!==-1){let a=i.data[o];Jx(s),a.contentQueries(2,e[o],o)}}}finally{St(n)}}}function Ad(i,e){return i[Dl]?i[IC][ji]=e:i[Dl]=e,i[IC]=e,e}function px(i,e,t){Jx(0);let n=St(null);try{e(i,t)}finally{St(n)}}function V1(i){return i[bl]||(i[bl]=[])}function z1(i){return i.cleanup||(i.cleanup=[])}function H1(i,e){let t=i[Ta],n=t?t.get(Gr,null):null;n&&n.handleError(e)}function mm(i,e,t,n,r){for(let s=0;s<t.length;){let o=t[s++],a=t[s++],c=t[s++],l=e[o],u=i.data[o];I1(u,l,n,a,c,r)}}function pF(i,e,t){let n=L_(e,i);A8(i[Ln],n,t)}function xF(i,e){let t=_o(e,i),n=t[dt];mF(n,t);let r=t[$r];r!==null&&t[Xh]===null&&(t[Xh]=om(r,t[Ta])),gm(n,t,t[Gi])}function mF(i,e){for(let t=e.length;t<i.blueprint.length;t++)e.push(i.blueprint[t])}function gm(i,e,t){Qx(e);try{let n=i.viewQuery;n!==null&&px(1,n,t);let r=i.template;r!==null&&R1(i,e,r,1,t),i.firstCreatePass&&(i.firstCreatePass=!1),e[Hr]?.finishViewCreation(i),i.staticContentQueries&&U1(i,e),i.staticViewQueries&&px(2,i.viewQuery,t);let s=i.components;s!==null&&gF(e,s)}catch(n){throw i.firstCreatePass&&(i.incompleteFirstPass=!0,i.firstCreatePass=!1),n}finally{e[ze]&=-5,em()}}function gF(i,e){for(let t=0;t<e.length;t++)xF(i,e[t])}function vF(i,e,t,n){let r=St(null);try{let s=e.tView,a=i[ze]&4096?4096:16,c=_d(i,s,t,a,null,e,null,null,n?.injector??null,n?.embeddedViewInjector??null,n?.dehydratedView??null),l=i[e.index];c[kl]=l;let u=i[Hr];return u!==null&&(c[Hr]=u.createEmbeddedView(s)),gm(s,c,t),c}finally{St(r)}}function GC(i,e){return!e||e.firstChild===null||f1(i)}function EF(i,e,t,n=!0){let r=e[dt];if(M8(r,e,i,t),n){let o=dx(t,i),a=e[Ln],c=lm(a,i[mo]);c!==null&&D8(r,i[$i],a,e,c,o)}let s=e[Xh];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function Qh(i,e,t,n,r=!1){for(;t!==null;){let s=e[t.index];s!==null&&n.push(vr(s)),Xr(s)&&yF(s,n);let o=t.type;if(o&8)Qh(i,e,t.child,n);else if(o&32){let a=cm(t,e),c;for(;c=a();)n.push(c)}else if(o&16){let a=M1(e,t);if(Array.isArray(a))n.push(...a);else{let c=Ml(e[gr]);Qh(c[dt],c,a,n,!0)}}t=r?t.projectionNext:t.next}return n}function yF(i,e){for(let t=ui;t<i.length;t++){let n=i[t],r=n[dt].firstChild;r!==null&&Qh(n[dt],n,r,e)}i[mo]!==i[$r]&&e.push(i[mo])}var j1=[];function CF(i){return i[xo]??_F(i)}function _F(i){let e=j1.pop()??Object.create(wF);return e.lView=i,e}function AF(i){i.lView[xo]!==i&&(i.lView=null,j1.push(i))}var wF=on(Me({},jy),{consumerIsAlwaysLive:!0,consumerMarkedDirty:i=>{Sl(i.lView)},consumerOnSignalRead(){this.lView[xo]=this}}),G1=100;function W1(i,e=!0,t=0){let n=i[Wi],r=n.rendererFactory,s=!1;s||r.begin?.();try{bF(i,t)}catch(o){throw e&&H1(i,o),o}finally{s||(r.end?.(),n.inlineEffectRunner?.flush())}}function bF(i,e){xx(i,e);let t=0;for(;Zx(i);){if(t===G1)throw new je(103,!1);t++,xx(i,1)}}function DF(i,e,t,n){let r=e[ze];if((r&256)===256)return;let s=!1;!s&&e[Wi].inlineEffectRunner?.flush(),Qx(e);let o=null,a=null;!s&&SF(i)&&(a=CF(e),o=Gy(a));try{V_(e),MT(i.bindingStartIndex),t!==null&&R1(i,e,t,2,n);let c=(r&3)===3;if(!s)if(c){let h=i.preOrderCheckHooks;h!==null&&Lh(e,h,null)}else{let h=i.preOrderHooks;h!==null&&Uh(e,h,0,null),Lp(e,0)}if(MF(e),$1(e,0),i.contentQueries!==null&&U1(i,e),!s)if(c){let h=i.contentCheckHooks;h!==null&&Lh(e,h)}else{let h=i.contentHooks;h!==null&&Uh(e,h,1),Lp(e,1)}G8(i,e);let l=i.components;l!==null&&q1(e,l,0);let u=i.viewQuery;if(u!==null&&px(2,u,n),!s)if(c){let h=i.viewCheckHooks;h!==null&&Lh(e,h)}else{let h=i.viewHooks;h!==null&&Uh(e,h,2),Lp(e,2)}if(i.firstUpdatePass===!0&&(i.firstUpdatePass=!1),e[Np]){for(let h of e[Np])h();e[Np]=null}s||(e[ze]&=-73)}catch(c){throw Sl(e),c}finally{a!==null&&(Wy(a,o),AF(a)),em()}}function SF(i){return i.type!==2}function $1(i,e){for(let t=x1(i);t!==null;t=m1(t))for(let n=ui;n<t.length;n++){let r=t[n];X1(r,e)}}function MF(i){for(let e=x1(i);e!==null;e=m1(e)){if(!(e[ze]&Xx.HasTransplantedViews))continue;let t=e[Fa];for(let n=0;n<t.length;n++){let r=t[n],s=r[Mn];gT(r)}}}function TF(i,e,t){let n=_o(e,i);X1(n,t)}function X1(i,e){Yx(i)&&xx(i,e)}function xx(i,e){let n=i[dt],r=i[ze],s=i[xo],o=!!(e===0&&r&16);if(o||=!!(r&64&&e===0),o||=!!(r&1024),o||=!!(s?.dirty&&mp(s)),s&&(s.dirty=!1),i[ze]&=-9217,o)DF(n,i,n.template,i[Gi]);else if(r&8192){$1(i,1);let a=n.components;a!==null&&q1(i,a,1)}}function q1(i,e,t){for(let n=0;n<e.length;n++)TF(i,e[n],t)}function vm(i){for(i[Wi].changeDetectionScheduler?.notify();i;){i[ze]|=64;let e=Ml(i);if(cT(i)&&!e)return i;i=e}return null}var vo=class{get rootNodes(){let e=this._lView,t=e[dt];return Qh(t,e,t.firstChild,[])}constructor(e,t,n=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=n,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Gi]}set context(e){this._lView[Gi]=e}get destroyed(){return(this._lView[ze]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Mn];if(Xr(e)){let t=e[qh],n=t?t.indexOf(this):-1;n>-1&&(hx(e,n),Wh(t,n))}this._attachedToViewContainer=!1}D1(this._lView[dt],this._lView)}onDestroy(e){z_(this._lView,e)}markForCheck(){vm(this._cdRefInjectingView||this._lView)}detach(){this._lView[ze]&=-129}reattach(){ix(this._lView),this._lView[ze]|=128}detectChanges(){this._lView[ze]|=1024,W1(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new je(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,w1(this._lView[dt],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new je(902,!1);this._appRef=e,ix(this._lView)}},Eo=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=IF;let i=e;return i})(),FF=Eo,BF=class extends FF{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,n){let r=vF(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:n});return new vo(r)}};function IF(){return Em(qi(),Xt())}function Em(i,e){return i.type&4?new BF(e,i,ka(i,e)):null}var ZW=new RegExp(`^(\\d+)*(${h8}|${u8})*(.*)`);var PF=()=>null;function WC(i,e){return PF(i,e)}var mx=class{},gx=class{},ed=class{};function RF(i){let e=Error(`No component factory found for ${Xn(i)}.`);return e[OF]=i,e}var OF="ngComponent";var vx=class{resolveComponentFactory(e){throw RF(e)}},wd=(()=>{let e=class e{};e.NULL=new vx;let i=e;return i})(),Fl=class{};var kF=(()=>{let e=class e{};e.\u0275prov=Le({token:e,providedIn:"root",factory:()=>null});let i=e;return i})(),jp={};var $C=new Set;function Y1(i){$C.has(i)||($C.add(i),performance?.mark?.("mark_feature_usage",{detail:{feature:i}}))}function XC(...i){}function NF(){let i=typeof yl.requestAnimationFrame=="function",e=yl[i?"requestAnimationFrame":"setTimeout"],t=yl[i?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){let n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);let r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}var fn=class i{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Bt(!1),this.onMicrotaskEmpty=new Bt(!1),this.onStable=new Bt(!1),this.onError=new Bt(!1),typeof Zone>"u")throw new je(908,!1);Zone.assertZonePatched();let r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!n&&t,r.shouldCoalesceRunChangeDetection=n,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=NF().nativeRequestAnimationFrame,VF(r)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!i.isInAngularZone())throw new je(909,!1)}static assertNotInAngularZone(){if(i.isInAngularZone())throw new je(909,!1)}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,r){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,e,LF,XC,XC);try{return s.runTask(o,t,n)}finally{s.cancelTask(o)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}},LF={};function ym(i){if(i._nesting==0&&!i.hasPendingMicrotasks&&!i.isStable)try{i._nesting++,i.onMicrotaskEmpty.emit(null)}finally{if(i._nesting--,!i.hasPendingMicrotasks)try{i.runOutsideAngular(()=>i.onStable.emit(null))}finally{i.isStable=!0}}}function UF(i){i.isCheckStableRunning||i.lastRequestAnimationFrameId!==-1||(i.lastRequestAnimationFrameId=i.nativeRequestAnimationFrame.call(yl,()=>{i.fakeTopEventTask||(i.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{i.lastRequestAnimationFrameId=-1,Ex(i),i.isCheckStableRunning=!0,ym(i),i.isCheckStableRunning=!1},void 0,()=>{},()=>{})),i.fakeTopEventTask.invoke()}),Ex(i))}function VF(i){let e=()=>{UF(i)};i._inner=i._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,n,r,s,o,a)=>{if(zF(a))return t.invokeTask(r,s,o,a);try{return qC(i),t.invokeTask(r,s,o,a)}finally{(i.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||i.shouldCoalesceRunChangeDetection)&&e(),YC(i)}},onInvoke:(t,n,r,s,o,a,c)=>{try{return qC(i),t.invoke(r,s,o,a,c)}finally{i.shouldCoalesceRunChangeDetection&&e(),YC(i)}},onHasTask:(t,n,r,s)=>{t.hasTask(r,s),n===r&&(s.change=="microTask"?(i._hasPendingMicrotasks=s.microTask,Ex(i),ym(i)):s.change=="macroTask"&&(i.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,n,r,s)=>(t.handleError(r,s),i.runOutsideAngular(()=>i.onError.emit(s)),!1)})}function Ex(i){i._hasPendingMicrotasks||(i.shouldCoalesceEventChangeDetection||i.shouldCoalesceRunChangeDetection)&&i.lastRequestAnimationFrameId!==-1?i.hasPendingMicrotasks=!0:i.hasPendingMicrotasks=!1}function qC(i){i._nesting++,i.isStable&&(i.isStable=!1,i.onUnstable.emit(null))}function YC(i){i._nesting--,ym(i)}function zF(i){return!Array.isArray(i)||i.length!==1?!1:i[0].data?.__ignore_ng_zone__===!0}var Z1=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let n=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let r of n)r()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=Le({token:e,providedIn:"root",factory:()=>new e});let i=e;return i})();function td(i,e,t){let n=t?i.styles:null,r=t?i.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)r=_C(r,a);else if(s==2){let c=a,l=e[++o];n=_C(n,c+": "+l+";")}}t?i.styles=n:i.stylesWithoutHost=n,t?i.classes=r:i.classesWithoutHost=r}var nd=class extends wd{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=po(e);return new Bl(t,this.ngModule)}};function ZC(i){let e=[];for(let t in i){if(!i.hasOwnProperty(t))continue;let n=i[t];n!==void 0&&e.push({propName:Array.isArray(n)?n[0]:n,templateName:t})}return e}function HF(i){let e=i.toLowerCase();return e==="svg"?N_:e==="math"?dT:null}var yx=class{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,n){n=ld(n);let r=this.injector.get(e,jp,n);return r!==jp||t===jp?r:this.parentInjector.get(e,t,n)}},Bl=class extends ed{get inputs(){let e=this.componentDef,t=e.inputTransforms,n=ZC(e.inputs);if(t!==null)for(let r of n)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return n}get outputs(){return ZC(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=G2(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,n,r){let s=St(null);try{r=r||this.ngModule;let o=r instanceof Ci?r:r?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new yx(e,o):e,c=a.get(Fl,null);if(c===null)throw new je(407,!1);let l=a.get(kF,null),u=a.get(Z1,null),h=a.get(mx,null),d={rendererFactory:c,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:u,changeDetectionScheduler:h},f=c.createRenderer(null,this.componentDef),x=this.componentDef.selectors[0][0]||"div",g=n?X8(f,n,this.componentDef.encapsulation,a):A1(f,x,HF(x)),p=512;this.componentDef.signals?p|=4096:this.componentDef.onPush||(p|=16);let m=null;g!==null&&(m=om(g,a,!0));let v=pm(0,null,null,1,0,null,null,null,null,null,null),E=_d(null,v,null,p,null,null,d,f,a,null,m);Qx(E);let y,w;try{let A=this.componentDef,b,D=null;A.findHostDirectiveDefs?(b=[],D=new Map,A.findHostDirectiveDefs(A,b,D),b.push(A)):b=[A];let C=jF(E,g),_=GF(C,g,A,b,E,d,f);w=U_(v,jr),g&&XF(f,A,g,n),t!==void 0&&qF(w,this.ngContentSelectors,t),y=$F(_,A,b,D,E,[YF]),gm(v,E,null)}finally{em()}return new Cx(this.componentType,y,ka(w,E),E,w)}finally{St(s)}}},Cx=class extends gx{constructor(e,t,n,r,s){super(),this.location=n,this._rootLView=r,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new vo(r,void 0,!1),this.componentType=e}setInput(e,t){let n=this._tNode.inputs,r;if(n!==null&&(r=n[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let s=this._rootLView;mm(s[dt],s,r,e,t),this.previousInputValues.set(e,t);let o=_o(this._tNode.index,s);vm(o)}}get injector(){return new ho(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function jF(i,e){let t=i[dt],n=jr;return i[n]=e,zl(t,n,2,"#host",null)}function GF(i,e,t,n,r,s,o){let a=r[dt];WF(n,i,e,o);let c=null;e!==null&&(c=om(e,r[Ta]));let l=s.rendererFactory.createRenderer(e,t),u=16;t.signals?u=4096:t.onPush&&(u=64);let h=_d(r,O1(t),null,u,r[i.index],i,s,l,null,null,c);return a.firstCreatePass&&fx(a,i,n.length-1),Ad(r,h),r[i.index]=h}function WF(i,e,t,n){for(let r of i)e.mergedAttrs=jx(e.mergedAttrs,r.hostAttrs);e.mergedAttrs!==null&&(td(e,e.mergedAttrs,!0),t!==null&&F1(n,t,e))}function $F(i,e,t,n,r,s){let o=qi(),a=r[dt],c=Xi(o,r);k1(a,r,o,t,null,n);for(let u=0;u<t.length;u++){let h=o.directiveStart+u,d=Ia(r,a,h,o);Cs(d,r)}N1(a,r,o),c&&Cs(c,r);let l=Ia(r,a,o.directiveStart+o.componentOffset,o);if(i[Gi]=r[Gi]=l,s!==null)for(let u of s)u(l,e);return hm(a,o,r),l}function XF(i,e,t,n){if(n)Kp(i,t,["ng-version","17.3.6"]);else{let{attrs:r,classes:s}=W2(e.selectors[0]);r&&Kp(i,t,r),s&&s.length>0&&T1(i,t,s.join(" "))}}function qF(i,e,t){let n=i.projection=[];for(let r=0;r<e.length;r++){let s=t[r];n.push(s!=null?Array.from(s):null)}}function YF(){let i=qi();vd(Xt()[dt],i)}var As=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=ZF;let i=e;return i})();function ZF(){let i=qi();return J1(i,Xt())}var KF=As,K1=class extends KF{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return ka(this._hostTNode,this._hostLView)}get injector(){return new ho(this._hostTNode,this._hostLView)}get parentInjector(){let e=tm(this._hostTNode,this._hostLView);if(e1(e)){let t=Zh(e,this._hostLView),n=Yh(e),r=t[dt].data[n+8];return new ho(r,t)}else return new ho(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=KC(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-ui}createEmbeddedView(e,t,n){let r,s;typeof n=="number"?r=n:n!=null&&(r=n.index,s=n.injector);let o=WC(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,r,GC(this._hostTNode,o)),a}createComponent(e,t,n,r,s){let o=e&&!aT(e),a;if(o)a=t;else{let x=t||{};a=x.index,n=x.injector,r=x.projectableNodes,s=x.environmentInjector||x.ngModuleRef}let c=o?e:new Bl(po(e)),l=n||this.parentInjector;if(!s&&c.ngModule==null){let g=(o?l:this.parentInjector).get(Ci,null);g&&(s=g)}let u=po(c.componentType??{}),h=WC(this._lContainer,u?.id??null),d=h?.firstChild??null,f=c.create(l,r,d,s);return this.insertImpl(f.hostView,a,GC(this._hostTNode,h)),f}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,n){let r=e._lView;if(mT(r)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=r[Mn],l=new K1(c,c[$i],c[Mn]);l.detach(l.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return EF(o,r,s,n),e.attachToViewContainerRef(),g_(Gp(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=KC(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),n=hx(this._lContainer,t);n&&(Wh(Gp(this._lContainer),t),D1(n[dt],n))}detach(e){let t=this._adjustIndex(e,-1),n=hx(this._lContainer,t);return n&&Wh(Gp(this._lContainer),t)!=null?new vo(n):null}_adjustIndex(e,t=0){return e??this.length+t}};function KC(i){return i[qh]}function Gp(i){return i[qh]||(i[qh]=[])}function J1(i,e){let t,n=e[i.index];return Xr(n)?t=n:(t=L1(n,e,null,i),e[i.index]=t,Ad(e,t)),QF(t,e,i,n),new K1(t,i,e)}function JF(i,e){let t=i[Ln],n=t.createComment(""),r=Xi(e,i),s=lm(t,r);return Jh(t,s,n,O8(t,r),!1),n}var QF=nB,eB=()=>!1;function tB(i,e,t){return eB(i,e,t)}function nB(i,e,t,n){if(i[mo])return;let r;t.type&8?r=vr(n):r=JF(e,t),i[mo]=r}var _x=class i{constructor(e){this.queryList=e,this.matches=null}clone(){return new i(this.queryList)}setDirty(){this.queryList.setDirty()}},Ax=class i{constructor(e=[]){this.queries=e}createEmbeddedView(e){let t=e.queries;if(t!==null){let n=e.contentQueries!==null?e.contentQueries[0]:t.length,r=[];for(let s=0;s<n;s++){let o=t.getByIndex(s),a=this.queries[o.indexInDeclarationView];r.push(a.clone())}return new i(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)Cm(e,t).matches!==null&&this.queries[t].setDirty()}},wx=class{constructor(e,t,n=null){this.flags=t,this.read=n,typeof e=="string"?this.predicate=uB(e):this.predicate=e}},bx=class i{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){let r=t!==null?t.length:0,s=this.getByIndex(n).embeddedTView(e,r);s&&(s.indexInDeclarationView=n,t!==null?t.push(s):t=[s])}return t!==null?new i(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},Dx=class i{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new i(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,n=e.parent;for(;n!==null&&n.type&8&&n.index!==t;)n=n.parent;return t===(n!==null?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){let n=this.metadata.predicate;if(Array.isArray(n))for(let r=0;r<n.length;r++){let s=n[r];this.matchTNodeWithReadOption(e,t,iB(t,s)),this.matchTNodeWithReadOption(e,t,Vh(t,e,s,!1,!1))}else n===Eo?t.type&4&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Vh(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(n!==null){let r=this.metadata.read;if(r!==null)if(r===wo||r===As||r===Eo&&t.type&4)this.addMatch(t.index,-2);else{let s=Vh(t,e,r,!1,!1);s!==null&&this.addMatch(t.index,s)}else this.addMatch(t.index,n)}}addMatch(e,t){this.matches===null?this.matches=[e,t]:this.matches.push(e,t)}};function iB(i,e){let t=i.localNames;if(t!==null){for(let n=0;n<t.length;n+=2)if(t[n]===e)return t[n+1]}return null}function rB(i,e){return i.type&11?ka(i,e):i.type&4?Em(i,e):null}function sB(i,e,t,n){return t===-1?rB(e,i):t===-2?oB(i,e,n):Ia(i,i[dt],t,e)}function oB(i,e,t){if(t===wo)return ka(e,i);if(t===Eo)return Em(e,i);if(t===As)return J1(e,i)}function Q1(i,e,t,n){let r=e[Hr].queries[n];if(r.matches===null){let s=i.data,o=t.matches,a=[];for(let c=0;o!==null&&c<o.length;c+=2){let l=o[c];if(l<0)a.push(null);else{let u=s[l];a.push(sB(e,u,o[c+1],t.metadata.read))}}r.matches=a}return r.matches}function Sx(i,e,t,n){let r=i.queries.getByIndex(t),s=r.matches;if(s!==null){let o=Q1(i,e,r,t);for(let a=0;a<s.length;a+=2){let c=s[a];if(c>0)n.push(o[a/2]);else{let l=s[a+1],u=e[-c];for(let h=ui;h<u.length;h++){let d=u[h];d[kl]===d[Mn]&&Sx(d[dt],d,l,n)}if(u[Fa]!==null){let h=u[Fa];for(let d=0;d<h.length;d++){let f=h[d];Sx(f[dt],f,l,n)}}}}}return n}function aB(i,e){return i[Hr].queries[e].queryList}function cB(i,e,t){let n=new lx((t&4)===4);return Z8(i,e,n,n.destroy),(e[Hr]??=new Ax).queries.push(new _x(n))-1}function lB(i,e,t){let n=_i();return n.firstCreatePass&&(hB(n,new wx(i,e,t),-1),(e&2)===2&&(n.staticViewQueries=!0)),cB(n,Xt(),e)}function uB(i){return i.split(",").map(e=>e.trim())}function hB(i,e,t){i.queries===null&&(i.queries=new bx),i.queries.track(new Dx(e,t))}function Cm(i,e){return i.queries.getByIndex(e)}function dB(i,e){let t=i[dt],n=Cm(t,e);return n.crossesNgTemplate?Sx(t,i,e,[]):Q1(t,i,n,e)}var _s=class{},Il=class{};var Mx=class extends _s{constructor(e,t,n){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new nd(this);let r=b_(e);this._bootstrapComponents=_1(r.bootstrap),this._r3Injector=u1(e,t,[{provide:_s,useValue:this},{provide:wd,useValue:this.componentFactoryResolver},...n],Xn(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Tx=class extends Il{constructor(e){super(),this.moduleType=e}create(e){return new Mx(this.moduleType,e,[])}};var id=class extends _s{constructor(e){super(),this.componentFactoryResolver=new nd(this),this.instance=null;let t=new wl([...e.providers,{provide:_s,useValue:this},{provide:wd,useValue:this.componentFactoryResolver}],e.parent||$x(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function _m(i,e,t=null){return new id({providers:i,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var bd=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Dn(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let n=this.taskId++;return this.pendingTasks.add(n),n}remove(n){this.pendingTasks.delete(n),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function eA(i){return pB(i)?Array.isArray(i)||!(i instanceof Map)&&Symbol.iterator in i:!1}function fB(i,e){if(Array.isArray(i))for(let t=0;t<i.length;t++)e(i[t]);else{let t=i[Symbol.iterator](),n;for(;!(n=t.next()).done;)e(n.value)}}function pB(i){return i!==null&&(typeof i=="function"||typeof i=="object")}function xB(i,e,t){return i[e]=t}function Dd(i,e,t){let n=i[e];return Object.is(n,t)?!1:(i[e]=t,!0)}function mB(i){return(i.flags&32)===32}function gB(i,e,t,n,r,s,o,a,c){let l=e.consts,u=zl(e,i,4,o||null,Ba(l,a));xm(e,t,u,Ba(l,c)),vd(e,u);let h=u.tView=pm(2,u,n,r,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,l,null);return e.queries!==null&&(e.queries.template(e,u),h.queries=e.queries.embeddedTView(u)),u}function tn(i,e,t,n,r,s,o,a){let c=Xt(),l=_i(),u=i+jr,h=l.firstCreatePass?gB(u,l,c,e,t,n,r,s,o):l.data[u];Ao(h,!1);let d=vB(l,c,h,i);md()&&yd(l,c,d,h),Cs(d,c);let f=L1(d,c,d,h);return c[u]=f,Ad(c,f),tB(f,h,c),pd(h)&&dm(l,c,h),o!=null&&fm(c,h,a),tn}var vB=EB;function EB(i,e,t,n){return gd(!0),e[Ln].createComment("")}function yB(i,e,t,n){return Dd(i,W_(),t)?e+Ux(t)+n:bo}function kh(i,e){return i<<17|e<<2}function yo(i){return i>>17&32767}function CB(i){return(i&2)==2}function _B(i,e){return i&131071|e<<17}function Fx(i){return i|2}function Pa(i){return(i&131068)>>2}function Wp(i,e){return i&-131069|e<<2}function AB(i){return(i&1)===1}function Bx(i){return i|1}function wB(i,e,t,n,r,s){let o=s?e.classBindings:e.styleBindings,a=yo(o),c=Pa(o);i[n]=t;let l=!1,u;if(Array.isArray(t)){let h=t;u=h[1],(u===null||Rl(h,u)>0)&&(l=!0)}else u=t;if(r)if(c!==0){let d=yo(i[a+1]);i[n+1]=kh(d,a),d!==0&&(i[d+1]=Wp(i[d+1],n)),i[a+1]=_B(i[a+1],n)}else i[n+1]=kh(a,0),a!==0&&(i[a+1]=Wp(i[a+1],n)),a=n;else i[n+1]=kh(c,0),a===0?a=n:i[c+1]=Wp(i[c+1],n),c=n;l&&(i[n+1]=Fx(i[n+1])),JC(i,u,n,!0),JC(i,u,n,!1),bB(e,u,i,n,s),o=kh(a,c),s?e.classBindings=o:e.styleBindings=o}function bB(i,e,t,n,r){let s=r?i.residualClasses:i.residualStyles;s!=null&&typeof e=="string"&&Rl(s,e)>=0&&(t[n+1]=Bx(t[n+1]))}function JC(i,e,t,n){let r=i[t+1],s=e===null,o=n?yo(r):Pa(r),a=!1;for(;o!==0&&(a===!1||s);){let c=i[o],l=i[o+1];DB(c,e)&&(a=!0,i[o+1]=n?Bx(l):Fx(l)),o=n?yo(l):Pa(l)}a&&(i[t+1]=n?Fx(r):Bx(r))}function DB(i,e){return i===null||e==null||(Array.isArray(i)?i[1]:i)===e?!0:Array.isArray(i)&&typeof e=="string"?Rl(i,e)>=0:!1}function ke(i,e,t){let n=Xt(),r=W_();if(Dd(n,r,e)){let s=_i(),o=kT();eF(s,o,n,i,e,n[Ln],t,!1)}return ke}function QC(i,e,t,n,r){let s=e.inputs,o=r?"class":"style";mm(i,t,s[o],o,n)}function yt(i,e,t){return SB(i,e,t,!1),yt}function SB(i,e,t,n){let r=Xt(),s=_i(),o=TT(2);if(s.firstUpdatePass&&TB(s,i,o,n),e!==bo&&Dd(r,o,e)){let a=s.data[Oa()];RB(s,a,r,r[Ln],i,r[o+1]=OB(e,t),n,o)}}function MB(i,e){return e>=i.expandoStartIndex}function TB(i,e,t,n){let r=i.data;if(r[t+1]===null){let s=r[Oa()],o=MB(i,t);kB(s,n)&&e===null&&!o&&(e=!1),e=FB(r,s,e,n),wB(r,s,e,t,o,n)}}function FB(i,e,t,n){let r=PT(i),s=n?e.residualClasses:e.residualStyles;if(r===null)(n?e.classBindings:e.styleBindings)===0&&(t=$p(null,i,e,t,n),t=Pl(t,e.attrs,n),s=null);else{let o=e.directiveStylingLast;if(o===-1||i[o]!==r)if(t=$p(r,i,e,t,n),s===null){let c=BB(i,e,n);c!==void 0&&Array.isArray(c)&&(c=$p(null,i,e,c[1],n),c=Pl(c,e.attrs,n),IB(i,e,n,c))}else s=PB(i,e,n)}return s!==void 0&&(n?e.residualClasses=s:e.residualStyles=s),t}function BB(i,e,t){let n=t?e.classBindings:e.styleBindings;if(Pa(n)!==0)return i[yo(n)]}function IB(i,e,t,n){let r=t?e.classBindings:e.styleBindings;i[yo(r)]=n}function PB(i,e,t){let n,r=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<r;s++){let o=i[s].hostAttrs;n=Pl(n,o,t)}return Pl(n,e.attrs,t)}function $p(i,e,t,n,r){let s=null,o=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<o&&(s=e[a],n=Pl(n,s.hostAttrs,r),s!==i);)a++;return i!==null&&(t.directiveStylingLast=a),n}function Pl(i,e,t){let n=t?1:2,r=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?r=o:r===n&&(Array.isArray(i)||(i=i===void 0?[]:["",i]),B2(i,o,t?!0:e[++s]))}return i===void 0?null:i}function RB(i,e,t,n,r,s,o,a){if(!(e.type&3))return;let c=i.data,l=c[a+1],u=AB(l)?e_(c,e,t,r,Pa(l),o):void 0;if(!rd(u)){rd(s)||CB(l)&&(s=e_(c,null,t,r,a,o));let h=L_(Oa(),t);H8(n,o,h,r,s)}}function e_(i,e,t,n,r,s){let o=e===null,a;for(;r>0;){let c=i[r],l=Array.isArray(c),u=l?c[1]:c,h=u===null,d=t[r+1];d===bo&&(d=h?fo:void 0);let f=h?Op(d,n):u===n?d:void 0;if(l&&!rd(f)&&(f=Op(c,n)),rd(f)&&(a=f,o))return a;let x=i[r+1];r=o?yo(x):Pa(x)}if(e!==null){let c=s?e.residualClasses:e.residualStyles;c!=null&&(a=Op(c,n))}return a}function rd(i){return i!==void 0}function OB(i,e){return i==null||i===""||(typeof e=="string"?i=i+e:typeof i=="object"&&(i=Xn(Ed(i)))),i}function kB(i,e){return(i.flags&(e?8:16))!==0}function NB(i,e,t,n,r,s){let o=e.consts,a=Ba(o,r),c=zl(e,i,2,n,a);return xm(e,t,c,Ba(o,s)),c.attrs!==null&&td(c,c.attrs,!1),c.mergedAttrs!==null&&td(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function be(i,e,t,n){let r=Xt(),s=_i(),o=jr+i,a=r[Ln],c=s.firstCreatePass?NB(o,s,r,e,t,n):s.data[o],l=LB(s,r,c,a,e,i);r[o]=l;let u=pd(c);return Ao(c,!0),F1(a,l,c),!mB(c)&&md()&&yd(s,r,l,c),yT()===0&&Cs(l,r),CT(),u&&(dm(s,r,c),hm(s,c,r)),n!==null&&fm(r,c),be}function Ie(){let i=qi();Kx()?G_():(i=i.parent,Ao(i,!1));let e=i;wT(e)&&bT(),_T();let t=_i();return t.firstCreatePass&&(vd(t,i),qx(i)&&t.queries.elementEnd(i)),e.classesWithoutHost!=null&&HT(e)&&QC(t,e,Xt(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&jT(e)&&QC(t,e,Xt(),e.stylesWithoutHost,!1),Ie}function Ct(i,e,t,n){return be(i,e,t,n),Ie(),Ct}var LB=(i,e,t,n,r,s)=>(gd(!0),A1(n,r,LT()));function UB(i,e,t,n,r){let s=e.consts,o=Ba(s,n),a=zl(e,i,8,"ng-container",o);o!==null&&td(a,o,!0);let c=Ba(s,r);return xm(e,t,a,c),e.queries!==null&&e.queries.elementStart(e,a),a}function Do(i,e,t){let n=Xt(),r=_i(),s=i+jr,o=r.firstCreatePass?UB(s,r,n,e,t):r.data[s];Ao(o,!0);let a=VB(r,n,o,i);return n[s]=a,md()&&yd(r,n,a,o),Cs(a,n),pd(o)&&(dm(r,n,o),hm(r,o,n)),t!=null&&fm(n,o),Do}function So(){let i=qi(),e=_i();return Kx()?G_():(i=i.parent,Ao(i,!1)),e.firstCreatePass&&(vd(e,i),qx(i)&&e.queries.elementEnd(i)),So}var VB=(i,e,t,n)=>(gd(!0),w8(e[Ln],""));function qn(){return Xt()}var sd="en-US";var zB=sd;function HB(i){typeof i=="string"&&(zB=i.toLowerCase().replace(/_/g,"-"))}function Nt(i,e,t,n){let r=Xt(),s=_i(),o=qi();return GB(s,r,r[Ln],o,i,e,n),Nt}function jB(i,e,t,n){let r=i.cleanup;if(r!=null)for(let s=0;s<r.length-1;s+=2){let o=r[s];if(o===t&&r[s+1]===n){let a=e[bl],c=r[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function GB(i,e,t,n,r,s,o){let a=pd(n),l=i.firstCreatePass&&z1(i),u=e[Gi],h=V1(e),d=!0;if(n.type&3||o){let g=Xi(n,e),p=o?o(g):g,m=h.length,v=o?y=>o(vr(y[n.index])):n.index,E=null;if(!o&&a&&(E=jB(i,e,r,n.index)),E!==null){let y=E.__ngLastListenerFn__||E;y.__ngNextListenerFn__=s,E.__ngLastListenerFn__=s,d=!1}else{s=n_(n,e,u,s,!1);let y=t.listen(p,r,s);h.push(s,y),l&&l.push(r,v,m,m+1)}}else s=n_(n,e,u,s,!1);let f=n.outputs,x;if(d&&f!==null&&(x=f[r])){let g=x.length;if(g)for(let p=0;p<g;p+=2){let m=x[p],v=x[p+1],w=e[m][v].subscribe(s),A=h.length;h.push(s,w),l&&l.push(r,n.index,A,-(A+1))}}}function t_(i,e,t,n){let r=St(null);try{return pr(6,e,t),t(n)!==!1}catch(s){return H1(i,s),!1}finally{pr(7,e,t),St(r)}}function n_(i,e,t,n,r){return function s(o){if(o===Function)return n;let a=i.componentOffset>-1?_o(i.index,e):e;vm(a);let c=t_(e,t,n,o),l=s.__ngNextListenerFn__;for(;l;)c=t_(e,t,l,o)&&c,l=l.__ngNextListenerFn__;return r&&c===!1&&o.preventDefault(),c}}function Xe(i=1){return OT(i)}function jt(i,e,t){lB(i,e,t)}function Lt(i){let e=Xt(),t=_i(),n=$_();Jx(n+1);let r=Cm(t,n);if(i.dirty&&xT(e)===((r.metadata.flags&2)===2)){if(r.matches===null)i.reset([]);else{let s=dB(e,n);i.reset(s,n8),i.notifyOnChanges()}return!0}return!1}function Ut(){return aB(Xt(),$_())}function Zi(i,e=""){let t=Xt(),n=_i(),r=i+jr,s=n.firstCreatePass?zl(n,r,1,e,null):n.data[r],o=WB(n,t,s,e,i);t[r]=o,md()&&yd(n,t,o,s),Ao(s,!1)}var WB=(i,e,t,n,r)=>(gd(!0),_8(e[Ln],n));function Hl(i){return Er("",i,""),Hl}function Er(i,e,t){let n=Xt(),r=yB(n,i,e,t);return r!==bo&&pF(n,Oa(),r),Er}var $B=(()=>{let e=class e{constructor(n){this._injector=n,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){let r=M_(!1,n.type),s=r.length>0?_m([r],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,s)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(let n of this.cachedInjectors.values())n!==null&&n.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=Le({token:e,providedIn:"environment",factory:()=>new e(nt(Ci))});let i=e;return i})();function nn(i){Y1("NgStandalone"),i.getStandaloneInjector=e=>e.get($B).getOrCreateStandaloneInjector(i)}function tA(i,e,t,n){return qB(Xt(),ST(),i,e,t,n)}function XB(i,e){let t=i[e];return t===bo?void 0:t}function qB(i,e,t,n,r,s){let o=e+t;return Dd(i,o,r)?xB(i,o+1,s?n.call(s,r):n(r)):XB(i,o+1)}var Sd=(()=>{let e=class e{log(n){console.log(n)}warn(n){console.warn(n)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"platform"});let i=e;return i})();var nA=new Et("");function jl(i){return!!i&&typeof i.then=="function"}function iA(i){return!!i&&typeof i.subscribe=="function"}var rA=new Et(""),sA=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r}),this.appInits=Se(rA,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let n=[];for(let s of this.appInits){let o=s();if(jl(o))n.push(o);else if(iA(o)){let a=new Promise((c,l)=>{o.subscribe({complete:c,error:l})});n.push(a)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{r()}).catch(s=>{this.reject(s)}),n.length===0&&r(),this.initialized=!0}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),Am=new Et("");function YB(){Xy(()=>{throw new je(600,!1)})}function ZB(i){return i.isBoundToModule}function KB(i,e,t){try{let n=t();return jl(n)?n.catch(r=>{throw e.runOutsideAngular(()=>i.handleError(r)),r}):n}catch(n){throw e.runOutsideAngular(()=>i.handleError(n)),n}}var Gl=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=Se(h1),this.afterRenderEffectManager=Se(Z1),this.externalTestViews=new Set,this.beforeRender=new $n,this.afterTick=new $n,this.componentTypes=[],this.components=[],this.isStable=Se(bd).hasPendingTasks.pipe(vt(n=>!n)),this._injector=Se(Ci)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(n,r){let s=n instanceof ed;if(!this._injector.get(sA).done){let f=!s&&w_(n),x=!1;throw new je(405,x)}let a;s?a=n:a=this._injector.get(wd).resolveComponentFactory(n),this.componentTypes.push(a.componentType);let c=ZB(a)?void 0:this._injector.get(_s),l=r||a.selector,u=a.create(Vl.NULL,[],l,c),h=u.location.nativeElement,d=u.injector.get(nA,null);return d?.registerApplication(h),u.onDestroy(()=>{this.detachView(u.hostView),Xp(this.components,u),d?.unregisterApplication(h)}),this._loadComponent(u),u}tick(){this._tick(!0)}_tick(n){if(this._runningTick)throw new je(101,!1);let r=St(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(n)}catch(s){this.internalErrorHandler(s)}finally{this.afterTick.next(),this._runningTick=!1,St(r)}}detectChangesInAttachedViews(n){let r=0,s=this.afterRenderEffectManager;for(;;){if(r===G1)throw new je(103,!1);if(n){let o=r===0;this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:c}of this._views)JB(a,o,c)}if(r++,s.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Ix(o))&&(s.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>Ix(o))))break}}attachView(n){let r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){let r=n;Xp(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView),this.tick(),this.components.push(n);let r=this._injector.get(Am,[]);[...this._bootstrapListeners,...r].forEach(s=>s(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>Xp(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new je(406,!1);let n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function Xp(i,e){let t=i.indexOf(e);t>-1&&i.splice(t,1)}function JB(i,e,t){!e&&!Ix(i)||QB(i,t,e)}function Ix(i){return Zx(i)}function QB(i,e,t){let n;t?(n=0,i[ze]|=1024):i[ze]&64?n=0:n=1,W1(i,e,n)}var Px=class{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},wm=(()=>{let e=class e{compileModuleSync(n){return new Tx(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){let r=this.compileModuleSync(n),s=b_(n),o=_1(s.declarations).reduce((a,c)=>{let l=po(c);return l&&a.push(new Bl(l)),a},[]);return new Px(r,o)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var e5=(()=>{let e=class e{constructor(){this.zone=Se(fn),this.applicationRef=Se(Gl)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function t5(i){return[{provide:fn,useFactory:i},{provide:Ma,multi:!0,useFactory:()=>{let e=Se(e5,{optional:!0});return()=>e.initialize()}},{provide:Ma,multi:!0,useFactory:()=>{let e=Se(s5);return()=>{e.initialize()}}},{provide:h1,useFactory:n5}]}function n5(){let i=Se(fn),e=Se(Gr);return t=>i.runOutsideAngular(()=>e.handleError(t))}function i5(i){let e=t5(()=>new fn(r5(i)));return ud([[],e])}function r5(i){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:i?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:i?.runCoalescing??!1}}var s5=(()=>{let e=class e{constructor(){this.subscription=new vn,this.initialized=!1,this.zone=Se(fn),this.pendingTasks=Se(bd)}initialize(){if(this.initialized)return;this.initialized=!0;let n=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(n=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{fn.assertNotInAngularZone(),queueMicrotask(()=>{n!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(n),n=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{fn.assertInAngularZone(),n??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function o5(){return typeof $localize<"u"&&$localize.locale||sd}var bm=new Et("",{providedIn:"root",factory:()=>Se(bm,ht.Optional|ht.SkipSelf)||o5()});var oA=new Et("");var Hh=null;function a5(i=[],e){return Vl.create({name:e,providers:[{provide:hd,useValue:"platform"},{provide:oA,useValue:new Set([()=>Hh=null])},...i]})}function c5(i=[]){if(Hh)return Hh;let e=a5(i);return Hh=e,YB(),l5(e),e}function l5(i){i.get(rm,null)?.forEach(t=>t())}var Wl=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=u5;let i=e;return i})();function u5(i){return h5(qi(),Xt(),(i&16)===16)}function h5(i,e,t){if(fd(i)&&!t){let n=_o(i.index,e);return new vo(n,n)}else if(i.type&47){let n=e[gr];return new vo(n,e)}return null}var Rx=class{constructor(){}supports(e){return eA(e)}create(e){return new Ox(e)}},d5=(i,e)=>e,Ox=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||d5}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,n=this._removalsHead,r=0,s=null;for(;t||n;){let o=!n||t&&t.currentIndex<i_(n,r,s)?t:n,a=i_(o,r,s),c=o.currentIndex;if(o===n)r--,n=n._nextRemoved;else if(t=t._next,o.previousIndex==null)r++;else{s||(s=[]);let l=a-r,u=c-r;if(l!=u){for(let d=0;d<l;d++){let f=d<s.length?s[d]:s[d]=0,x=f+d;u<=x&&x<l&&(s[d]=f+1)}let h=o.previousIndex;s[h]=u-l}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!eA(e))throw new je(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,n=!1,r,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,s,o,a),n=!0):(n&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)),t=t._next}else r=0,fB(e,a=>{o=this._trackByFn(r,a),t===null||!Object.is(t.trackById,o)?(t=this._mismatch(t,a,o,r),n=!0):(n&&(t=this._verifyReinsertion(t,a,o,r)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,n,r){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(n,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,r)):(e=this._linkedRecords===null?null:this._linkedRecords.get(n,r),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,r)):e=this._addAfter(new kx(t,n),s,r)),e}_verifyReinsertion(e,t,n,r){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(n,null);return s!==null?e=this._reinsertAfter(s,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,n){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let r=e._prevRemoved,s=e._nextRemoved;return r===null?this._removalsHead=s:r._nextRemoved=s,s===null?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}_moveAfter(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}_addAfter(e,t,n){return this._insertAfter(e,t,n),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,n){let r=t===null?this._itHead:t._next;return e._next=r,e._prev=t,r===null?this._itTail=e:r._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new od),this._linkedRecords.put(e),e.currentIndex=n,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,n=e._next;return t===null?this._itHead=n:t._next=n,n===null?this._itTail=t:n._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new od),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},kx=class{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},Nx=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let n;for(n=this._head;n!==null;n=n._nextDup)if((t===null||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}remove(e){let t=e._prevDup,n=e._nextDup;return t===null?this._head=n:t._nextDup=n,n===null?this._tail=t:n._prevDup=t,this._head===null}},od=class{constructor(){this.map=new Map}put(e){let t=e.trackById,n=this.map.get(t);n||(n=new Nx,this.map.set(t,n)),n.add(e)}get(e,t){let n=e,r=this.map.get(n);return r?r.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function i_(i,e,t){let n=i.previousIndex;if(n===null)return n;let r=0;return t&&n<t.length&&(r=t[n]),n+e+r}function r_(){return new Dm([new Rx])}var Dm=(()=>{let e=class e{constructor(n){this.factories=n}static create(n,r){if(r!=null){let s=r.factories.slice();n=n.concat(s)}return new e(n)}static extend(n){return{provide:e,useFactory:r=>e.create(n,r||r_()),deps:[[e,new m_,new zx]]}}find(n){let r=this.factories.find(s=>s.supports(n));if(r!=null)return r;throw new je(901,!1)}};e.\u0275prov=Le({token:e,providedIn:"root",factory:r_});let i=e;return i})();function aA(i){try{let{rootComponent:e,appProviders:t,platformProviders:n}=i,r=c5(n),s=[i5(),...t||[]],a=new id({providers:s,parent:r,debugName:"",runEnvironmentInitializers:!1}).injector,c=a.get(fn);return c.run(()=>{a.resolveInjectorInitializers();let l=a.get(Gr,null),u;c.runOutsideAngular(()=>{u=c.onError.subscribe({next:f=>{l.handleError(f)}})});let h=()=>a.destroy(),d=r.get(oA);return d.add(h),a.onDestroy(()=>{u.unsubscribe(),d.delete(h)}),KB(l,c,()=>{let f=a.get(sA);return f.runInitializers(),f.donePromise.then(()=>{let x=a.get(bm,sd);HB(x||sd);let g=a.get(Gl);return e!==void 0&&g.bootstrap(e),g})})})}catch(e){return Promise.reject(e)}}var mA=null;function La(){return mA}function gA(i){mA??=i}var Md=class{};var Ai=new Et(""),vA=(()=>{let e=class e{historyGo(n){throw new Error("")}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Le({token:e,factory:()=>Se(m5),providedIn:"platform"});let i=e;return i})();var m5=(()=>{let e=class e extends vA{constructor(){super(),this._doc=Se(Ai),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return La().getBaseHref(this._doc)}onPopState(n){let r=La().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",n,!1),()=>r.removeEventListener("popstate",n)}onHashChange(n){let r=La().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",n,!1),()=>r.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,r,s){this._history.pushState(n,r,s)}replaceState(n,r,s){this._history.replaceState(n,r,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Le({token:e,factory:()=>new e,providedIn:"platform"});let i=e;return i})();function EA(i,e){if(i.length==0)return e;if(e.length==0)return i;let t=0;return i.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?i+e.substring(1):t==1?i+e:i+"/"+e}function cA(i){let e=i.match(/#|\?|$/),t=e&&e.index||i.length,n=t-(i[t-1]==="/"?1:0);return i.slice(0,n)+i.slice(t)}function Mo(i){return i&&i[0]!=="?"?"?"+i:i}var Fd=(()=>{let e=class e{historyGo(n){throw new Error("")}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Le({token:e,factory:()=>Se(yA),providedIn:"root"});let i=e;return i})(),g5=new Et(""),yA=(()=>{let e=class e extends Fd{constructor(n,r){super(),this._platformLocation=n,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??Se(Ai).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return EA(this._baseHref,n)}path(n=!1){let r=this._platformLocation.pathname+Mo(this._platformLocation.search),s=this._platformLocation.hash;return s&&n?`${r}${s}`:r}pushState(n,r,s,o){let a=this.prepareExternalUrl(s+Mo(o));this._platformLocation.pushState(n,r,a)}replaceState(n,r,s,o){let a=this.prepareExternalUrl(s+Mo(o));this._platformLocation.replaceState(n,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}};e.\u0275fac=function(r){return new(r||e)(nt(vA),nt(g5,8))},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var $l=(()=>{let e=class e{constructor(n){this._subject=new Bt,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=n;let r=this._locationStrategy.getBaseHref();this._basePath=y5(cA(lA(r))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,r=""){return this.path()==this.normalize(n+Mo(r))}normalize(n){return e.stripTrailingSlash(E5(this._basePath,lA(n)))}prepareExternalUrl(n){return n&&n[0]!=="/"&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,r="",s=null){this._locationStrategy.pushState(s,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Mo(r)),s)}replaceState(n,r="",s=null){this._locationStrategy.replaceState(s,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Mo(r)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",r){this._urlChangeListeners.forEach(s=>s(n,r))}subscribe(n,r,s){return this._subject.subscribe({next:n,error:r,complete:s})}};e.normalizeQueryParams=Mo,e.joinWithSlash=EA,e.stripTrailingSlash=cA,e.\u0275fac=function(r){return new(r||e)(nt(Fd))},e.\u0275prov=Le({token:e,factory:()=>v5(),providedIn:"root"});let i=e;return i})();function v5(){return new $l(nt(Fd))}function E5(i,e){if(!i||!e.startsWith(i))return e;let t=e.substring(i.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function lA(i){return i.replace(/\/index.html$/,"")}function y5(i){if(new RegExp("^(https?:)?//").test(i)){let[,t]=i.split(/\/\/[^\/]+/);return t}return i}function CA(i,e){e=encodeURIComponent(e);for(let t of i.split(";")){let n=t.indexOf("="),[r,s]=n==-1?[t,""]:[t.slice(0,n),t.slice(n+1)];if(r.trim()===e)return decodeURIComponent(s)}return null}var Sm=class{constructor(e,t,n,r){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=r}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},yr=(()=>{let e=class e{set ngForOf(n){this._ngForOf=n,this._ngForOfDirty=!0}set ngForTrackBy(n){this._trackByFn=n}get ngForTrackBy(){return this._trackByFn}constructor(n,r,s){this._viewContainer=n,this._template=r,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(n){n&&(this._template=n)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let n=this._ngForOf;if(!this._differ&&n)if(0)try{}catch{}else this._differ=this._differs.find(n).create(this.ngForTrackBy)}if(this._differ){let n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}_applyChanges(n){let r=this._viewContainer;n.forEachOperation((s,o,a)=>{if(s.previousIndex==null)r.createEmbeddedView(this._template,new Sm(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)r.remove(o===null?void 0:o);else if(o!==null){let c=r.get(o);r.move(c,a),uA(c,s)}});for(let s=0,o=r.length;s<o;s++){let c=r.get(s).context;c.index=s,c.count=o,c.ngForOf=this._ngForOf}n.forEachIdentityChange(s=>{let o=r.get(s.currentIndex);uA(o,s)})}static ngTemplateContextGuard(n,r){return!0}};e.\u0275fac=function(r){return new(r||e)(en(As),en(Eo),en(Dm))},e.\u0275dir=Ol({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let i=e;return i})();function uA(i,e){i.context.$implicit=e.item}var Cr=(()=>{let e=class e{constructor(n,r){this._viewContainer=n,this._context=new Mm,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){hA("ngIfThen",n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){hA("ngIfElse",n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(n,r){return!0}};e.\u0275fac=function(r){return new(r||e)(en(As),en(Eo))},e.\u0275dir=Ol({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let i=e;return i})(),Mm=class{constructor(){this.$implicit=null,this.ngIf=null}};function hA(i,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${i} must be a TemplateRef, but received '${Xn(e)}'.`)}var _A="browser",C5="server";function Tm(i){return i===C5}var Td=class{};var Im=class extends Md{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Pm=class i extends Im{static makeCurrent(){gA(new i)}onAndCancel(e,t,n){return e.addEventListener(t,n),()=>{e.removeEventListener(t,n)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=_5();return t==null?null:A5(t)}resetBaseElement(){Xl=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return CA(document.cookie,e)}},Xl=null;function _5(){return Xl=Xl||document.querySelector("base"),Xl?Xl.getAttribute("href"):null}function A5(i){return new URL(i,document.baseURI).pathname}var w5=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Le({token:e,factory:e.\u0275fac});let i=e;return i})(),Rm=new Et(""),DA=(()=>{let e=class e{constructor(n,r){this._zone=r,this._eventNameToPlugin=new Map,n.forEach(s=>{s.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,r,s){return this._findPluginFor(r).addEventListener(n,r,s)}getZone(){return this._zone}_findPluginFor(n){let r=this._eventNameToPlugin.get(n);if(r)return r;if(r=this._plugins.find(o=>o.supports(n)),!r)throw new je(5101,!1);return this._eventNameToPlugin.set(n,r),r}};e.\u0275fac=function(r){return new(r||e)(nt(Rm),nt(fn))},e.\u0275prov=Le({token:e,factory:e.\u0275fac});let i=e;return i})(),Bd=class{constructor(e){this._doc=e}},Fm="ng-app-id",SA=(()=>{let e=class e{constructor(n,r,s,o={}){this.doc=n,this.appId=r,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Tm(o),this.resetHostNodes()}addStyles(n){for(let r of n)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(n){for(let r of n)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let n=this.styleNodesInDOM;n&&(n.forEach(r=>r.remove()),n.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(let r of this.getAllStyles())this.addStyleToHost(n,r)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(let r of this.hostNodes)this.addStyleToHost(r,n)}onStyleRemoved(n){let r=this.styleRef;r.get(n)?.elements?.forEach(s=>s.remove()),r.delete(n)}collectServerRenderedStyles(){let n=this.doc.head?.querySelectorAll(`style[${Fm}="${this.appId}"]`);if(n?.length){let r=new Map;return n.forEach(s=>{s.textContent!=null&&r.set(s.textContent,s)}),r}return null}changeUsageCount(n,r){let s=this.styleRef;if(s.has(n)){let o=s.get(n);return o.usage+=r,o.usage}return s.set(n,{usage:r,elements:[]}),r}getStyleElement(n,r){let s=this.styleNodesInDOM,o=s?.get(r);if(o?.parentNode===n)return s.delete(r),o.removeAttribute(Fm),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=r,this.platformIsServer&&a.setAttribute(Fm,this.appId),n.appendChild(a),a}}addStyleToHost(n,r){let s=this.getStyleElement(n,r),o=this.styleRef,a=o.get(r)?.elements;a?a.push(s):o.set(r,{elements:[s],usage:1})}resetHostNodes(){let n=this.hostNodes;n.clear(),n.add(this.doc.head)}};e.\u0275fac=function(r){return new(r||e)(nt(Ai),nt(im),nt(sm,8),nt(Na))},e.\u0275prov=Le({token:e,factory:e.\u0275fac});let i=e;return i})(),Bm={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},km=/%COMP%/g,MA="%COMP%",b5=`_nghost-${MA}`,D5=`_ngcontent-${MA}`,S5=!0,M5=new Et("",{providedIn:"root",factory:()=>S5});function T5(i){return D5.replace(km,i)}function F5(i){return b5.replace(km,i)}function TA(i,e){return e.map(t=>t.replace(km,i))}var AA=(()=>{let e=class e{constructor(n,r,s,o,a,c,l,u=null){this.eventManager=n,this.sharedStylesHost=r,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=Tm(c),this.defaultRenderer=new ql(n,a,l,this.platformIsServer)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===mr.ShadowDom&&(r=on(Me({},r),{encapsulation:mr.Emulated}));let s=this.getOrCreateRenderer(n,r);return s instanceof Id?s.applyToHost(n):s instanceof Yl&&s.applyStyles(),s}getOrCreateRenderer(n,r){let s=this.rendererByCompId,o=s.get(r.id);if(!o){let a=this.doc,c=this.ngZone,l=this.eventManager,u=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,d=this.platformIsServer;switch(r.encapsulation){case mr.Emulated:o=new Id(l,u,r,this.appId,h,a,c,d);break;case mr.ShadowDom:return new Om(l,u,n,r,a,c,this.nonce,d);default:o=new Yl(l,u,r,h,a,c,d);break}s.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(r){return new(r||e)(nt(DA),nt(SA),nt(im),nt(M5),nt(Ai),nt(Na),nt(fn),nt(sm))},e.\u0275prov=Le({token:e,factory:e.\u0275fac});let i=e;return i})(),ql=class{constructor(e,t,n,r){this.eventManager=e,this.doc=t,this.ngZone=n,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(Bm[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(wA(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(wA(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n=typeof e=="string"?this.doc.querySelector(e):e;if(!n)throw new je(-5104,!1);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,r){if(r){t=r+":"+t;let s=Bm[r];s?e.setAttributeNS(s,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){let r=Bm[n];r?e.removeAttributeNS(r,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,r){r&(Wr.DashCase|Wr.Important)?e.style.setProperty(t,n,r&Wr.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&Wr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e!=null&&(e[t]=n)}setValue(e,t){e.nodeValue=t}listen(e,t,n){if(typeof e=="string"&&(e=La().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(n))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function wA(i){return i.tagName==="TEMPLATE"&&i.content!==void 0}var Om=class extends ql{constructor(e,t,n,r,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=TA(r.id,r.styles);for(let u of l){let h=document.createElement("style");a&&h.setAttribute("nonce",a),h.textContent=u,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Yl=class extends ql{constructor(e,t,n,r,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=c?TA(c,n.styles):n.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Id=class extends Yl{constructor(e,t,n,r,s,o,a,c){let l=r+"-"+n.id;super(e,t,n,s,o,a,c,l),this.contentAttr=T5(l),this.hostAttr=F5(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}},B5=(()=>{let e=class e extends Bd{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,s){return n.addEventListener(r,s,!1),()=>this.removeEventListener(n,r,s)}removeEventListener(n,r,s){return n.removeEventListener(r,s)}};e.\u0275fac=function(r){return new(r||e)(nt(Ai))},e.\u0275prov=Le({token:e,factory:e.\u0275fac});let i=e;return i})(),bA=["alt","control","meta","shift"],I5={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},P5={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey},R5=(()=>{let e=class e extends Bd{constructor(n){super(n)}supports(n){return e.parseEventName(n)!=null}addEventListener(n,r,s){let o=e.parseEventName(r),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>La().onAndCancel(n,o.domEventName,a))}static parseEventName(n){let r=n.toLowerCase().split("."),s=r.shift();if(r.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(r.pop()),a="",c=r.indexOf("code");if(c>-1&&(r.splice(c,1),a="code."),bA.forEach(u=>{let h=r.indexOf(u);h>-1&&(r.splice(h,1),a+=u+".")}),a+=o,r.length!=0||o.length===0)return null;let l={};return l.domEventName=s,l.fullKey=a,l}static matchEventFullKeyCode(n,r){let s=I5[n.key]||n.key,o="";return r.indexOf("code.")>-1&&(s=n.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),bA.forEach(a=>{if(a!==s){let c=P5[a];c(n)&&(o+=a+".")}}),o+=s,o===r)}static eventCallback(n,r,s){return o=>{e.matchEventFullKeyCode(o,n)&&s.runGuarded(()=>r(o))}}static _normalizeKey(n){return n==="esc"?"escape":n}};e.\u0275fac=function(r){return new(r||e)(nt(Ai))},e.\u0275prov=Le({token:e,factory:e.\u0275fac});let i=e;return i})();function FA(i,e){return aA(Me({rootComponent:i},O5(e)))}function O5(i){return{appProviders:[...V5,...i?.providers??[]],platformProviders:U5}}function k5(){Pm.makeCurrent()}function N5(){return new Gr}function L5(){return v1(document),document}var U5=[{provide:Na,useValue:_A},{provide:rm,useValue:k5,multi:!0},{provide:Ai,useFactory:L5,deps:[]}];var V5=[{provide:hd,useValue:"root"},{provide:Gr,useFactory:N5,deps:[]},{provide:Rm,useClass:B5,multi:!0,deps:[Ai,fn,Na]},{provide:Rm,useClass:R5,multi:!0,deps:[Ai]},AA,SA,DA,{provide:Fl,useExisting:AA},{provide:Td,useClass:w5,deps:[]},[]];var BA=(()=>{let e=class e{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}};e.\u0275fac=function(r){return new(r||e)(nt(Ai))},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var et="primary",uu=Symbol("RouteTitle"),zm=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function ja(i){return new zm(i)}function H5(i,e,t){let n=t.path.split("/");if(n.length>i.length||t.pathMatch==="full"&&(e.hasChildren()||n.length<i.length))return null;let r={};for(let s=0;s<n.length;s++){let o=n[s],a=i[s];if(o.startsWith(":"))r[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:i.slice(0,n.length),posParams:r}}function j5(i,e){if(i.length!==e.length)return!1;for(let t=0;t<i.length;++t)if(!_r(i[t],e[t]))return!1;return!0}function _r(i,e){let t=i?Hm(i):void 0,n=e?Hm(e):void 0;if(!t||!n||t.length!=n.length)return!1;let r;for(let s=0;s<t.length;s++)if(r=t[s],!NA(i[r],e[r]))return!1;return!0}function Hm(i){return[...Object.keys(i),...Object.getOwnPropertySymbols(i)]}function NA(i,e){if(Array.isArray(i)&&Array.isArray(e)){if(i.length!==e.length)return!1;let t=[...i].sort(),n=[...e].sort();return t.every((r,s)=>n[s]===r)}else return i===e}function LA(i){return i.length>0?i[i.length-1]:null}function Ds(i){return Mp(i)?i:jl(i)?En(Promise.resolve(i)):Je(i)}var G5={exact:VA,subset:zA},UA={exact:W5,subset:$5,ignored:()=>!0};function IA(i,e,t){return G5[t.paths](i.root,e.root,t.matrixParams)&&UA[t.queryParams](i.queryParams,e.queryParams)&&!(t.fragment==="exact"&&i.fragment!==e.fragment)}function W5(i,e){return _r(i,e)}function VA(i,e,t){if(!Fo(i.segments,e.segments)||!Od(i.segments,e.segments,t)||i.numberOfChildren!==e.numberOfChildren)return!1;for(let n in e.children)if(!i.children[n]||!VA(i.children[n],e.children[n],t))return!1;return!0}function $5(i,e){return Object.keys(e).length<=Object.keys(i).length&&Object.keys(e).every(t=>NA(i[t],e[t]))}function zA(i,e,t){return HA(i,e,e.segments,t)}function HA(i,e,t,n){if(i.segments.length>t.length){let r=i.segments.slice(0,t.length);return!(!Fo(r,t)||e.hasChildren()||!Od(r,t,n))}else if(i.segments.length===t.length){if(!Fo(i.segments,t)||!Od(i.segments,t,n))return!1;for(let r in e.children)if(!i.children[r]||!zA(i.children[r],e.children[r],n))return!1;return!0}else{let r=t.slice(0,i.segments.length),s=t.slice(i.segments.length);return!Fo(i.segments,r)||!Od(i.segments,r,n)||!i.children[et]?!1:HA(i.children[et],e,s,n)}}function Od(i,e,t){return e.every((n,r)=>UA[t](i[r].parameters,n.parameters))}var ws=class{constructor(e=new Tt([],{}),t={},n=null){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap??=ja(this.queryParams),this._queryParamMap}toString(){return Y5.serialize(this)}},Tt=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return kd(this)}},To=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=ja(this.parameters),this._parameterMap}toString(){return GA(this)}};function X5(i,e){return Fo(i,e)&&i.every((t,n)=>_r(t.parameters,e[n].parameters))}function Fo(i,e){return i.length!==e.length?!1:i.every((t,n)=>t.path===e[n].path)}function q5(i,e){let t=[];return Object.entries(i.children).forEach(([n,r])=>{n===et&&(t=t.concat(e(r,n)))}),Object.entries(i.children).forEach(([n,r])=>{n!==et&&(t=t.concat(e(r,n)))}),t}var pg=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Le({token:e,factory:()=>new Ld,providedIn:"root"});let i=e;return i})(),Ld=class{parse(e){let t=new Gm(e);return new ws(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Zl(e.root,!0)}`,n=J5(e.queryParams),r=typeof e.fragment=="string"?`#${Z5(e.fragment)}`:"";return`${t}${n}${r}`}},Y5=new Ld;function kd(i){return i.segments.map(e=>GA(e)).join("/")}function Zl(i,e){if(!i.hasChildren())return kd(i);if(e){let t=i.children[et]?Zl(i.children[et],!1):"",n=[];return Object.entries(i.children).forEach(([r,s])=>{r!==et&&n.push(`${r}:${Zl(s,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}else{let t=q5(i,(n,r)=>r===et?[Zl(i.children[et],!1)]:[`${r}:${Zl(n,!1)}`]);return Object.keys(i.children).length===1&&i.children[et]!=null?`${kd(i)}/${t[0]}`:`${kd(i)}/(${t.join("//")})`}}function jA(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Pd(i){return jA(i).replace(/%3B/gi,";")}function Z5(i){return encodeURI(i)}function jm(i){return jA(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Nd(i){return decodeURIComponent(i)}function PA(i){return Nd(i.replace(/\+/g,"%20"))}function GA(i){return`${jm(i.path)}${K5(i.parameters)}`}function K5(i){return Object.entries(i).map(([e,t])=>`;${jm(e)}=${jm(t)}`).join("")}function J5(i){let e=Object.entries(i).map(([t,n])=>Array.isArray(n)?n.map(r=>`${Pd(t)}=${Pd(r)}`).join("&"):`${Pd(t)}=${Pd(n)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var Q5=/^[^\/()?;#]+/;function Nm(i){let e=i.match(Q5);return e?e[0]:""}var e3=/^[^\/()?;=#]+/;function t3(i){let e=i.match(e3);return e?e[0]:""}var n3=/^[^=?&#]+/;function i3(i){let e=i.match(n3);return e?e[0]:""}var r3=/^[^&#]+/;function s3(i){let e=i.match(r3);return e?e[0]:""}var Gm=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Tt([],{}):new Tt([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[et]=new Tt(e,t)),n}parseSegment(){let e=Nm(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new je(4009,!1);return this.capture(e),new To(Nd(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=t3(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){let r=Nm(this.remaining);r&&(n=r,this.capture(n))}e[Nd(t)]=Nd(n)}parseQueryParam(e){let t=i3(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){let o=s3(this.remaining);o&&(n=o,this.capture(n))}let r=PA(t),s=PA(n);if(e.hasOwnProperty(r)){let o=e[r];Array.isArray(o)||(o=[o],e[r]=o),o.push(s)}else e[r]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let n=Nm(this.remaining),r=this.remaining[n.length];if(r!=="/"&&r!==")"&&r!==";")throw new je(4010,!1);let s;n.indexOf(":")>-1?(s=n.slice(0,n.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=et);let o=this.parseChildren();t[s]=Object.keys(o).length===1?o[et]:new Tt([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new je(4011,!1)}};function WA(i){return i.segments.length>0?new Tt([],{[et]:i}):i}function $A(i){let e={};for(let[n,r]of Object.entries(i.children)){let s=$A(r);if(n===et&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[n]=s)}let t=new Tt(i.segments,e);return o3(t)}function o3(i){if(i.numberOfChildren===1&&i.children[et]){let e=i.children[et];return new Tt(i.segments.concat(e.segments),e.children)}return i}function Ga(i){return i instanceof ws}function a3(i,e,t=null,n=null){let r=XA(i);return qA(r,e,t,n)}function XA(i){let e;function t(s){let o={};for(let c of s.children){let l=t(c);o[c.outlet]=l}let a=new Tt(s.url,o);return s===i&&(e=a),a}let n=t(i.root),r=WA(n);return e??r}function qA(i,e,t,n){let r=i;for(;r.parent;)r=r.parent;if(e.length===0)return Lm(r,r,r,t,n);let s=c3(e);if(s.toRoot())return Lm(r,r,new Tt([],{}),t,n);let o=l3(s,r,i),a=o.processChildren?Ql(o.segmentGroup,o.index,s.commands):ZA(o.segmentGroup,o.index,s.commands);return Lm(r,o.segmentGroup,a,t,n)}function Ud(i){return typeof i=="object"&&i!=null&&!i.outlets&&!i.segmentPath}function nu(i){return typeof i=="object"&&i!=null&&i.outlets}function Lm(i,e,t,n,r){let s={};n&&Object.entries(n).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(u=>`${u}`):`${l}`});let o;i===e?o=t:o=YA(i,e,t);let a=WA($A(o));return new ws(a,s,r)}function YA(i,e,t){let n={};return Object.entries(i.children).forEach(([r,s])=>{s===e?n[r]=t:n[r]=YA(s,e,t)}),new Tt(i.segments,n)}var Vd=class{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&Ud(n[0]))throw new je(4003,!1);let r=n.find(nu);if(r&&r!==LA(n))throw new je(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function c3(i){if(typeof i[0]=="string"&&i.length===1&&i[0]==="/")return new Vd(!0,0,i);let e=0,t=!1,n=i.reduce((r,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...r,{outlets:a}]}if(s.segmentPath)return[...r,s.segmentPath]}return typeof s!="string"?[...r,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&r.push(a))}),r):[...r,s]},[]);return new Vd(t,e,n)}var za=class{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}};function l3(i,e,t){if(i.isAbsolute)return new za(e,!0,0);if(!t)return new za(e,!1,NaN);if(t.parent===null)return new za(t,!0,0);let n=Ud(i.commands[0])?0:1,r=t.segments.length-1+n;return u3(t,r,i.numberOfDoubleDots)}function u3(i,e,t){let n=i,r=e,s=t;for(;s>r;){if(s-=r,n=n.parent,!n)throw new je(4005,!1);r=n.segments.length}return new za(n,!1,r-s)}function h3(i){return nu(i[0])?i[0].outlets:{[et]:i}}function ZA(i,e,t){if(i??=new Tt([],{}),i.segments.length===0&&i.hasChildren())return Ql(i,e,t);let n=d3(i,e,t),r=t.slice(n.commandIndex);if(n.match&&n.pathIndex<i.segments.length){let s=new Tt(i.segments.slice(0,n.pathIndex),{});return s.children[et]=new Tt(i.segments.slice(n.pathIndex),i.children),Ql(s,0,r)}else return n.match&&r.length===0?new Tt(i.segments,{}):n.match&&!i.hasChildren()?Wm(i,e,t):n.match?Ql(i,0,r):Wm(i,e,t)}function Ql(i,e,t){if(t.length===0)return new Tt(i.segments,{});{let n=h3(t),r={};if(Object.keys(n).some(s=>s!==et)&&i.children[et]&&i.numberOfChildren===1&&i.children[et].segments.length===0){let s=Ql(i.children[et],e,t);return new Tt(i.segments,s.children)}return Object.entries(n).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(r[s]=ZA(i.children[s],e,o))}),Object.entries(i.children).forEach(([s,o])=>{n[s]===void 0&&(r[s]=o)}),new Tt(i.segments,r)}}function d3(i,e,t){let n=0,r=e,s={match:!1,pathIndex:0,commandIndex:0};for(;r<i.segments.length;){if(n>=t.length)return s;let o=i.segments[r],a=t[n];if(nu(a))break;let c=`${a}`,l=n<t.length-1?t[n+1]:null;if(r>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!OA(c,l,o))return s;n+=2}else{if(!OA(c,{},o))return s;n++}r++}return{match:!0,pathIndex:r,commandIndex:n}}function Wm(i,e,t){let n=i.segments.slice(0,e),r=0;for(;r<t.length;){let s=t[r];if(nu(s)){let c=f3(s.outlets);return new Tt(n,c)}if(r===0&&Ud(t[0])){let c=i.segments[e];n.push(new To(c.path,RA(t[0]))),r++;continue}let o=nu(s)?s.outlets[et]:`${s}`,a=r<t.length-1?t[r+1]:null;o&&a&&Ud(a)?(n.push(new To(o,RA(a))),r+=2):(n.push(new To(o,{})),r++)}return new Tt(n,{})}function f3(i){let e={};return Object.entries(i).forEach(([t,n])=>{typeof n=="string"&&(n=[n]),n!==null&&(e[t]=Wm(new Tt([],{}),0,n))}),e}function RA(i){let e={};return Object.entries(i).forEach(([t,n])=>e[t]=`${n}`),e}function OA(i,e,t){return i==t.path&&_r(e,t.parameters)}var eu="imperative",Fn=function(i){return i[i.NavigationStart=0]="NavigationStart",i[i.NavigationEnd=1]="NavigationEnd",i[i.NavigationCancel=2]="NavigationCancel",i[i.NavigationError=3]="NavigationError",i[i.RoutesRecognized=4]="RoutesRecognized",i[i.ResolveStart=5]="ResolveStart",i[i.ResolveEnd=6]="ResolveEnd",i[i.GuardsCheckStart=7]="GuardsCheckStart",i[i.GuardsCheckEnd=8]="GuardsCheckEnd",i[i.RouteConfigLoadStart=9]="RouteConfigLoadStart",i[i.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",i[i.ChildActivationStart=11]="ChildActivationStart",i[i.ChildActivationEnd=12]="ChildActivationEnd",i[i.ActivationStart=13]="ActivationStart",i[i.ActivationEnd=14]="ActivationEnd",i[i.Scroll=15]="Scroll",i[i.NavigationSkipped=16]="NavigationSkipped",i}(Fn||{}),wi=class{constructor(e,t){this.id=e,this.url=t}},iu=class extends wi{constructor(e,t,n="imperative",r=null){super(e,t),this.type=Fn.NavigationStart,this.navigationTrigger=n,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Bo=class extends wi{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n,this.type=Fn.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},di=function(i){return i[i.Redirect=0]="Redirect",i[i.SupersededByNewNavigation=1]="SupersededByNewNavigation",i[i.NoDataFromResolver=2]="NoDataFromResolver",i[i.GuardRejected=3]="GuardRejected",i}(di||{}),$m=function(i){return i[i.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",i[i.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",i}($m||{}),bs=class extends wi{constructor(e,t,n,r){super(e,t),this.reason=n,this.code=r,this.type=Fn.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Io=class extends wi{constructor(e,t,n,r){super(e,t),this.reason=n,this.code=r,this.type=Fn.NavigationSkipped}},ru=class extends wi{constructor(e,t,n,r){super(e,t),this.error=n,this.target=r,this.type=Fn.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},zd=class extends wi{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=Fn.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Xm=class extends wi{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=Fn.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},qm=class extends wi{constructor(e,t,n,r,s){super(e,t),this.urlAfterRedirects=n,this.state=r,this.shouldActivate=s,this.type=Fn.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Ym=class extends wi{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=Fn.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Zm=class extends wi{constructor(e,t,n,r){super(e,t),this.urlAfterRedirects=n,this.state=r,this.type=Fn.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Km=class{constructor(e){this.route=e,this.type=Fn.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Jm=class{constructor(e){this.route=e,this.type=Fn.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Qm=class{constructor(e){this.snapshot=e,this.type=Fn.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},eg=class{constructor(e){this.snapshot=e,this.type=Fn.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},tg=class{constructor(e){this.snapshot=e,this.type=Fn.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ng=class{constructor(e){this.snapshot=e,this.type=Fn.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var su=class{},ou=class{constructor(e){this.url=e}};var ig=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Xd,this.attachRef=null}},Xd=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(n,r){let s=this.getOrCreateContext(n);s.outlet=r,this.contexts.set(n,s)}onChildOutletDestroyed(n){let r=this.getContext(n);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let r=this.getContext(n);return r||(r=new ig,this.contexts.set(n,r)),r}getContext(n){return this.contexts.get(n)||null}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),Hd=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=rg(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){let t=rg(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=sg(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return sg(e,this._root).map(t=>t.value)}};function rg(i,e){if(i===e.value)return e;for(let t of e.children){let n=rg(i,t);if(n)return n}return null}function sg(i,e){if(i===e.value)return[e];for(let t of e.children){let n=sg(i,t);if(n.length)return n.unshift(e),n}return[]}var hi=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Va(i){let e={};return i&&i.children.forEach(t=>e[t.value.outlet]=t),e}var jd=class extends Hd{constructor(e,t){super(e),this.snapshot=t,mg(this,e)}toString(){return this.snapshot.toString()}};function KA(i){let e=p3(i),t=new Dn([new To("",{})]),n=new Dn({}),r=new Dn({}),s=new Dn({}),o=new Dn(""),a=new Ar(t,n,s,o,r,et,i,e.root);return a.snapshot=e.root,new jd(new hi(a,[]),e)}function p3(i){let e={},t={},n={},r="",s=new au([],e,n,r,t,et,i,null,{});return new Gd("",new hi(s,[]))}var Ar=class{constructor(e,t,n,r,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=n,this.fragmentSubject=r,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(vt(l=>l[uu]))??Je(void 0),this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(vt(e=>ja(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(vt(e=>ja(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function xg(i,e,t="emptyOnly"){let n,{routeConfig:r}=i;return e!==null&&(t==="always"||r?.path===""||!e.component&&!e.routeConfig?.loadComponent)?n={params:Me(Me({},e.params),i.params),data:Me(Me({},e.data),i.data),resolve:Me(Me(Me(Me({},i.data),e.data),r?.data),i._resolvedData)}:n={params:Me({},i.params),data:Me({},i.data),resolve:Me(Me({},i.data),i._resolvedData??{})},r&&QA(r)&&(n.resolve[uu]=r.title),n}var au=class{get title(){return this.data?.[uu]}constructor(e,t,n,r,s,o,a,c,l){this.url=e,this.params=t,this.queryParams=n,this.fragment=r,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=ja(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=ja(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(n=>n.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Gd=class extends Hd{constructor(e,t){super(t),this.url=e,mg(this,t)}toString(){return JA(this._root)}};function mg(i,e){e.value._routerState=i,e.children.forEach(t=>mg(i,t))}function JA(i){let e=i.children.length>0?` { ${i.children.map(JA).join(", ")} } `:"";return`${i.value}${e}`}function Um(i){if(i.snapshot){let e=i.snapshot,t=i._futureSnapshot;i.snapshot=t,_r(e.queryParams,t.queryParams)||i.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&i.fragmentSubject.next(t.fragment),_r(e.params,t.params)||i.paramsSubject.next(t.params),j5(e.url,t.url)||i.urlSubject.next(t.url),_r(e.data,t.data)||i.dataSubject.next(t.data)}else i.snapshot=i._futureSnapshot,i.dataSubject.next(i._futureSnapshot.data)}function og(i,e){let t=_r(i.params,e.params)&&X5(i.url,e.url),n=!i.parent!=!e.parent;return t&&!n&&(!i.parent||og(i.parent,e.parent))}function QA(i){return typeof i.title=="string"||i.title===null}var x3=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=et,this.activateEvents=new Bt,this.deactivateEvents=new Bt,this.attachEvents=new Bt,this.detachEvents=new Bt,this.parentContexts=Se(Xd),this.location=Se(As),this.changeDetector=Se(Wl),this.environmentInjector=Se(Ci),this.inputBinder=Se(gg,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){let{firstChange:r,previousValue:s}=n.name;if(r)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new je(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new je(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new je(4012,!1);this.location.detach();let n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,r){this.activated=n,this._activatedRoute=r,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){let n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,r){if(this.isActivated)throw new je(4013,!1);this._activatedRoute=n;let s=this.location,a=n.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new ag(n,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:l,environmentInjector:r??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275dir=Ol({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[xd]});let i=e;return i})(),ag=class i{__ngOutletInjector(e){return new i(this.route,this.childContexts,e)}constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===Ar?this.route:e===Xd?this.childContexts:this.parent.get(e,t)}},gg=new Et("");function m3(i,e,t){let n=cu(i,e._root,t?t._root:void 0);return new jd(n,e)}function cu(i,e,t){if(t&&i.shouldReuseRoute(e.value,t.value.snapshot)){let n=t.value;n._futureSnapshot=e.value;let r=g3(i,e,t);return new hi(n,r)}else{if(i.shouldAttach(e.value)){let s=i.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>cu(i,a)),o}}let n=v3(e.value),r=e.children.map(s=>cu(i,s));return new hi(n,r)}}function g3(i,e,t){return e.children.map(n=>{for(let r of t.children)if(i.shouldReuseRoute(n.value,r.value.snapshot))return cu(i,n,r);return cu(i,n)})}function v3(i){return new Ar(new Dn(i.url),new Dn(i.params),new Dn(i.queryParams),new Dn(i.fragment),new Dn(i.data),i.outlet,i.component,i)}var ew="ngNavigationCancelingError";function tw(i,e){let{redirectTo:t,navigationBehaviorOptions:n}=Ga(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=nw(!1,di.Redirect);return r.url=t,r.navigationBehaviorOptions=n,r}function nw(i,e){let t=new Error(`NavigationCancelingError: ${i||""}`);return t[ew]=!0,t.cancellationCode=e,t}function E3(i){return iw(i)&&Ga(i.url)}function iw(i){return!!i&&i[ew]}var y3=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=Qt({type:e,selectors:[["ng-component"]],standalone:!0,features:[nn],decls:1,vars:0,template:function(r,s){r&1&&Ct(0,"router-outlet")},dependencies:[x3],encapsulation:2});let i=e;return i})();function C3(i,e){return i.providers&&!i._injector&&(i._injector=_m(i.providers,e,`Route: ${i.path}`)),i._injector??e}function vg(i){let e=i.children&&i.children.map(vg),t=e?on(Me({},i),{children:e}):Me({},i);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==et&&(t.component=y3),t}function wr(i){return i.outlet||et}function _3(i,e){let t=i.filter(n=>wr(n)===e);return t.push(...i.filter(n=>wr(n)!==e)),t}function hu(i){if(!i)return null;if(i.routeConfig?._injector)return i.routeConfig._injector;for(let e=i.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var A3=(i,e,t,n)=>vt(r=>(new cg(e,r.targetRouterState,r.currentRouterState,t,n).activate(i),r)),cg=class{constructor(e,t,n,r,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=r,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),Um(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){let r=Va(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,r[o],n),delete r[o]}),Object.values(r).forEach(s=>{this.deactivateRouteAndItsChildren(s,n)})}deactivateRoutes(e,t,n){let r=e.value,s=t?t.value:null;if(r===s)if(r.component){let o=n.getContext(r.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,n);else s&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=Va(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);if(n&&n.outlet){let o=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let n=t.getContext(e.value.outlet),r=n&&e.value.component?n.children:t,s=Va(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,r);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(e,t,n){let r=Va(t);e.children.forEach(s=>{this.activateRoutes(s,r[s.value.outlet],n),this.forwardEvent(new ng(s.value.snapshot))}),e.children.length&&this.forwardEvent(new eg(e.value.snapshot))}activateRoutes(e,t,n){let r=e.value,s=t?t.value:null;if(Um(r),r===s)if(r.component){let o=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,n);else if(r.component){let o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Um(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=hu(r.snapshot);o.attachRef=null,o.route=r,o.injector=a,o.outlet&&o.outlet.activateWith(r,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}},Wd=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Ha=class{constructor(e,t){this.component=e,this.route=t}};function w3(i,e,t){let n=i._root,r=e?e._root:null;return Kl(n,r,t,[n.value])}function b3(i){let e=i.routeConfig?i.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:i,guards:e}}function $a(i,e){let t=Symbol(),n=e.get(i,t);return n===t?typeof i=="function"&&!l_(i)?i:e.get(i):n}function Kl(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=Va(e);return i.children.forEach(o=>{D3(o,s[o.value.outlet],t,n.concat([o.value]),r),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>tu(a,t.getContext(o),r)),r}function D3(i,e,t,n,r={canDeactivateChecks:[],canActivateChecks:[]}){let s=i.value,o=e?e.value:null,a=t?t.getContext(i.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=S3(o,s,s.routeConfig.runGuardsAndResolvers);c?r.canActivateChecks.push(new Wd(n)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Kl(i,e,a?a.children:null,n,r):Kl(i,e,t,n,r),c&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Ha(a.outlet.component,o))}else o&&tu(e,a,r),r.canActivateChecks.push(new Wd(n)),s.component?Kl(i,null,a?a.children:null,n,r):Kl(i,null,t,n,r);return r}function S3(i,e,t){if(typeof t=="function")return t(i,e);switch(t){case"pathParamsChange":return!Fo(i.url,e.url);case"pathParamsOrQueryParamsChange":return!Fo(i.url,e.url)||!_r(i.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!og(i,e)||!_r(i.queryParams,e.queryParams);case"paramsChange":default:return!og(i,e)}}function tu(i,e,t){let n=Va(i),r=i.value;Object.entries(n).forEach(([s,o])=>{r.component?e?tu(o,e.children.getContext(s),t):tu(o,null,t):tu(o,e,t)}),r.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Ha(e.outlet.component,r)):t.canDeactivateChecks.push(new Ha(null,r)):t.canDeactivateChecks.push(new Ha(null,r))}function du(i){return typeof i=="function"}function M3(i){return typeof i=="boolean"}function T3(i){return i&&du(i.canLoad)}function F3(i){return i&&du(i.canActivate)}function B3(i){return i&&du(i.canActivateChild)}function I3(i){return i&&du(i.canDeactivate)}function P3(i){return i&&du(i.canMatch)}function rw(i){return i instanceof Vr||i?.name==="EmptyError"}var Rd=Symbol("INITIAL_VALUE");function Wa(){return zi(i=>Ih(i.map(e=>e.pipe(zr(1),Pp(Rd)))).pipe(vt(e=>{for(let t of e)if(t!==!0){if(t===Rd)return Rd;if(t===!1||t instanceof ws)return t}return!0}),Vi(e=>e!==Rd),zr(1)))}function R3(i,e){return yn(t=>{let{targetSnapshot:n,currentSnapshot:r,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?Je(on(Me({},t),{guardsResult:!0})):O3(o,n,r,i).pipe(yn(a=>a&&M3(a)?k3(n,s,i,e):Je(a)),vt(a=>on(Me({},t),{guardsResult:a})))})}function O3(i,e,t,n){return En(i).pipe(yn(r=>z3(r.component,r.route,t,e,n)),fr(r=>r!==!0,!0))}function k3(i,e,t,n){return En(e).pipe(Ea(r=>va(L3(r.route.parent,n),N3(r.route,n),V3(i,r.path,t),U3(i,r.route,t))),fr(r=>r!==!0,!0))}function N3(i,e){return i!==null&&e&&e(new tg(i)),Je(!0)}function L3(i,e){return i!==null&&e&&e(new Qm(i)),Je(!0)}function U3(i,e,t){let n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||n.length===0)return Je(!0);let r=n.map(s=>Ph(()=>{let o=hu(e)??t,a=$a(s,o),c=F3(a)?a.canActivate(e,i):Co(o,()=>a(e,i));return Ds(c).pipe(fr())}));return Je(r).pipe(Wa())}function V3(i,e,t){let n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>b3(o)).filter(o=>o!==null).map(o=>Ph(()=>{let a=o.guards.map(c=>{let l=hu(o.node)??t,u=$a(c,l),h=B3(u)?u.canActivateChild(n,i):Co(l,()=>u(n,i));return Ds(h).pipe(fr())});return Je(a).pipe(Wa())}));return Je(s).pipe(Wa())}function z3(i,e,t,n,r){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return Je(!0);let o=s.map(a=>{let c=hu(e)??r,l=$a(a,c),u=I3(l)?l.canDeactivate(i,e,t,n):Co(c,()=>l(i,e,t,n));return Ds(u).pipe(fr())});return Je(o).pipe(Wa())}function H3(i,e,t,n){let r=e.canLoad;if(r===void 0||r.length===0)return Je(!0);let s=r.map(o=>{let a=$a(o,i),c=T3(a)?a.canLoad(e,t):Co(i,()=>a(e,t));return Ds(c)});return Je(s).pipe(Wa(),sw(n))}function sw(i){return wp(Sn(e=>{if(Ga(e))throw tw(i,e)}),vt(e=>e===!0))}function j3(i,e,t,n){let r=e.canMatch;if(!r||r.length===0)return Je(!0);let s=r.map(o=>{let a=$a(o,i),c=P3(a)?a.canMatch(e,t):Co(i,()=>a(e,t));return Ds(c)});return Je(s).pipe(Wa(),sw(n))}var lu=class{constructor(e){this.segmentGroup=e||null}},$d=class extends Error{constructor(e){super(),this.urlTree=e}};function Ua(i){return ga(new lu(i))}function G3(i){return ga(new je(4e3,!1))}function W3(i){return ga(nw(!1,di.GuardRejected))}var lg=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let n=[],r=t.root;for(;;){if(n=n.concat(r.segments),r.numberOfChildren===0)return Je(n);if(r.numberOfChildren>1||!r.children[et])return G3(e.redirectTo);r=r.children[et]}}applyRedirectCommands(e,t,n){let r=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,n);if(t.startsWith("/"))throw new $d(r);return r}applyRedirectCreateUrlTree(e,t,n,r){let s=this.createSegmentGroup(e,t.root,n,r);return new ws(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let n={};return Object.entries(e).forEach(([r,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);n[r]=t[a]}else n[r]=s}),n}createSegmentGroup(e,t,n,r){let s=this.createSegments(e,t.segments,n,r),o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,n,r)}),new Tt(s,o)}createSegments(e,t,n,r){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,r):this.findOrReturn(s,n))}findPosParam(e,t,n){let r=n[t.path.substring(1)];if(!r)throw new je(4001,!1);return r}findOrReturn(e,t){let n=0;for(let r of t){if(r.path===e.path)return t.splice(n),r;n++}return e}},ug={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function $3(i,e,t,n,r){let s=Eg(i,e,t);return s.matched?(n=C3(e,n),j3(n,e,t,r).pipe(vt(o=>o===!0?s:Me({},ug)))):Je(s)}function Eg(i,e,t){if(e.path==="**")return X3(t);if(e.path==="")return e.pathMatch==="full"&&(i.hasChildren()||t.length>0)?Me({},ug):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let r=(e.matcher||H5)(t,i,e);if(!r)return Me({},ug);let s={};Object.entries(r.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=r.consumed.length>0?Me(Me({},s),r.consumed[r.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:o,positionalParamSegments:r.posParams??{}}}function X3(i){return{matched:!0,parameters:i.length>0?LA(i).parameters:{},consumedSegments:i,remainingSegments:[],positionalParamSegments:{}}}function kA(i,e,t,n){return t.length>0&&Z3(i,t,n)?{segmentGroup:new Tt(e,Y3(n,new Tt(t,i.children))),slicedSegments:[]}:t.length===0&&K3(i,t,n)?{segmentGroup:new Tt(i.segments,q3(i,t,n,i.children)),slicedSegments:t}:{segmentGroup:new Tt(i.segments,i.children),slicedSegments:t}}function q3(i,e,t,n){let r={};for(let s of t)if(qd(i,e,s)&&!n[wr(s)]){let o=new Tt([],{});r[wr(s)]=o}return Me(Me({},n),r)}function Y3(i,e){let t={};t[et]=e;for(let n of i)if(n.path===""&&wr(n)!==et){let r=new Tt([],{});t[wr(n)]=r}return t}function Z3(i,e,t){return t.some(n=>qd(i,e,n)&&wr(n)!==et)}function K3(i,e,t){return t.some(n=>qd(i,e,n))}function qd(i,e,t){return(i.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function J3(i,e,t,n){return wr(i)!==n&&(n===et||!qd(e,t,i))?!1:Eg(e,i,t).matched}function Q3(i,e,t){return e.length===0&&!i.children[t]}var hg=class{};function eI(i,e,t,n,r,s,o="emptyOnly"){return new dg(i,e,t,n,r,o,s).recognize()}var tI=31,dg=class{constructor(e,t,n,r,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=n,this.config=r,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new lg(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new je(4002,`'${e.segmentGroup}'`)}recognize(){let e=kA(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(vt(t=>{let n=new au([],Object.freeze({}),Object.freeze(Me({},this.urlTree.queryParams)),this.urlTree.fragment,{},et,this.rootComponentType,null,{}),r=new hi(n,t),s=new Gd("",r),o=a3(n,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,et).pipe(ms(n=>{if(n instanceof $d)return this.urlTree=n.urlTree,this.match(n.urlTree.root);throw n instanceof lu?this.noMatchError(n):n}))}inheritParamsAndData(e,t){let n=e.value,r=xg(n,t,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),e.children.forEach(s=>this.inheritParamsAndData(s,n))}processSegmentGroup(e,t,n,r){return n.segments.length===0&&n.hasChildren()?this.processChildren(e,t,n):this.processSegment(e,t,n,n.segments,r,!0).pipe(vt(s=>s instanceof hi?[s]:[]))}processChildren(e,t,n){let r=[];for(let s of Object.keys(n.children))s==="primary"?r.unshift(s):r.push(s);return En(r).pipe(Ea(s=>{let o=n.children[s],a=_3(t,s);return this.processSegmentGroup(e,a,o,s)}),Ip((s,o)=>(s.push(...o),s)),gs(null),Bp(),yn(s=>{if(s===null)return Ua(n);let o=ow(s);return nI(o),Je(o)}))}processSegment(e,t,n,r,s,o){return En(t).pipe(Ea(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,n,r,s,o).pipe(ms(c=>{if(c instanceof lu)return Je(null);throw c}))),fr(a=>!!a),ms(a=>{if(rw(a))return Q3(n,r,s)?Je(new hg):Ua(n);throw a}))}processSegmentAgainstRoute(e,t,n,r,s,o,a){return J3(n,r,s,o)?n.redirectTo===void 0?this.matchSegmentAgainstRoute(e,r,n,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,r,t,n,s,o):Ua(r):Ua(r)}expandSegmentAgainstRouteUsingRedirect(e,t,n,r,s,o){let{matched:a,consumedSegments:c,positionalParamSegments:l,remainingSegments:u}=Eg(t,r,s);if(!a)return Ua(t);r.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>tI&&(this.allowRedirects=!1));let h=this.applyRedirects.applyRedirectCommands(c,r.redirectTo,l);return this.applyRedirects.lineralizeSegments(r,h).pipe(yn(d=>this.processSegment(e,n,t,d.concat(u),o,!1)))}matchSegmentAgainstRoute(e,t,n,r,s){let o=$3(t,n,r,e,this.urlSerializer);return n.path==="**"&&(t.children={}),o.pipe(zi(a=>a.matched?(e=n._injector??e,this.getChildConfig(e,n,r).pipe(zi(({routes:c})=>{let l=n._loadedInjector??e,{consumedSegments:u,remainingSegments:h,parameters:d}=a,f=new au(u,d,Object.freeze(Me({},this.urlTree.queryParams)),this.urlTree.fragment,rI(n),wr(n),n.component??n._loadedComponent??null,n,sI(n)),{segmentGroup:x,slicedSegments:g}=kA(t,u,h,c);if(g.length===0&&x.hasChildren())return this.processChildren(l,c,x).pipe(vt(m=>m===null?null:new hi(f,m)));if(c.length===0&&g.length===0)return Je(new hi(f,[]));let p=wr(n)===s;return this.processSegment(l,c,x,g,p?et:s,!0).pipe(vt(m=>new hi(f,m instanceof hi?[m]:[])))}))):Ua(t)))}getChildConfig(e,t,n){return t.children?Je({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?Je({routes:t._loadedRoutes,injector:t._loadedInjector}):H3(e,t,n,this.urlSerializer).pipe(yn(r=>r?this.configLoader.loadChildren(e,t).pipe(Sn(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):W3(t))):Je({routes:[],injector:e})}};function nI(i){i.sort((e,t)=>e.value.outlet===et?-1:t.value.outlet===et?1:e.value.outlet.localeCompare(t.value.outlet))}function iI(i){let e=i.value.routeConfig;return e&&e.path===""}function ow(i){let e=[],t=new Set;for(let n of i){if(!iI(n)){e.push(n);continue}let r=e.find(s=>n.value.routeConfig===s.value.routeConfig);r!==void 0?(r.children.push(...n.children),t.add(r)):e.push(n)}for(let n of t){let r=ow(n.children);e.push(new hi(n.value,r))}return e.filter(n=>!t.has(n))}function rI(i){return i.data||{}}function sI(i){return i.resolve||{}}function oI(i,e,t,n,r,s){return yn(o=>eI(i,e,t,n,o.extractedUrl,r,s).pipe(vt(({state:a,tree:c})=>on(Me({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function aI(i,e){return yn(t=>{let{targetSnapshot:n,guards:{canActivateChecks:r}}=t;if(!r.length)return Je(t);let s=new Set(r.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let l of aw(c))o.add(l);let a=0;return En(o).pipe(Ea(c=>s.has(c)?cI(c,n,i,e):(c.data=xg(c,c.parent,i).resolve,Je(void 0))),Sn(()=>a++),ya(1),yn(c=>a===o.size?Je(t):li))})}function aw(i){let e=i.children.map(t=>aw(t)).flat();return[i,...e]}function cI(i,e,t,n){let r=i.routeConfig,s=i._resolve;return r?.title!==void 0&&!QA(r)&&(s[uu]=r.title),lI(s,i,e,n).pipe(vt(o=>(i._resolvedData=o,i.data=xg(i,i.parent,t).resolve,null)))}function lI(i,e,t,n){let r=Hm(i);if(r.length===0)return Je({});let s={};return En(r).pipe(yn(o=>uI(i[o],e,t,n).pipe(fr(),Sn(a=>{s[o]=a}))),ya(1),Fp(s),ms(o=>rw(o)?li:ga(o)))}function uI(i,e,t,n){let r=hu(e)??n,s=$a(i,r),o=s.resolve?s.resolve(e,t):Co(r,()=>s(e,t));return Ds(o)}function Vm(i){return zi(e=>{let t=i(e);return t?En(t).pipe(vt(()=>e)):Je(e)})}var cw=(()=>{let e=class e{buildTitle(n){let r,s=n.root;for(;s!==void 0;)r=this.getResolvedTitleForRoute(s)??r,s=s.children.find(o=>o.outlet===et);return r}getResolvedTitleForRoute(n){return n.data[uu]}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Le({token:e,factory:()=>Se(hI),providedIn:"root"});let i=e;return i})(),hI=(()=>{let e=class e extends cw{constructor(n){super(),this.title=n}updateTitle(n){let r=this.buildTitle(n);r!==void 0&&this.title.setTitle(r)}};e.\u0275fac=function(r){return new(r||e)(nt(BA))},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),yg=new Et("",{providedIn:"root",factory:()=>({})}),Cg=new Et(""),dI=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Se(wm)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return Je(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);let r=Ds(n.loadComponent()).pipe(vt(lw),Sn(o=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=o}),El(()=>{this.componentLoaders.delete(n)})),s=new ma(r,()=>new $n).pipe(xa());return this.componentLoaders.set(n,s),s}loadChildren(n,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Je({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let o=fI(r,this.compiler,n,this.onLoadEndListener).pipe(El(()=>{this.childrenLoaders.delete(r)})),a=new ma(o,()=>new $n).pipe(xa());return this.childrenLoaders.set(r,a),a}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function fI(i,e,t,n){return Ds(i.loadChildren()).pipe(vt(lw),yn(r=>r instanceof Il||Array.isArray(r)?Je(r):En(e.compileModuleAsync(r))),vt(r=>{n&&n(i);let s,o,a=!1;return Array.isArray(r)?(o=r,a=!0):(s=r.create(t).injector,o=s.get(Cg,[],{optional:!0,self:!0}).flat()),{routes:o.map(vg),injector:s}}))}function pI(i){return i&&typeof i=="object"&&"default"in i}function lw(i){return pI(i)?i.default:i}var _g=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Le({token:e,factory:()=>Se(xI),providedIn:"root"});let i=e;return i})(),xI=(()=>{let e=class e{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,r){return n}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),mI=new Et("");var gI=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new $n,this.transitionAbortSubject=new $n,this.configLoader=Se(dI),this.environmentInjector=Se(Ci),this.urlSerializer=Se(pg),this.rootContexts=Se(Xd),this.location=Se($l),this.inputBindingEnabled=Se(gg,{optional:!0})!==null,this.titleStrategy=Se(cw),this.options=Se(yg,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=Se(_g),this.createViewTransition=Se(mI,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Je(void 0),this.rootComponentType=null;let n=s=>this.events.next(new Km(s)),r=s=>this.events.next(new Jm(s));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=n}complete(){this.transitions?.complete()}handleNavigationRequest(n){let r=++this.navigationId;this.transitions?.next(on(Me(Me({},this.transitions.value),n),{id:r}))}setupNavigations(n,r,s){return this.transitions=new Dn({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:eu,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Vi(o=>o.id!==0),vt(o=>on(Me({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),zi(o=>{let a=!1,c=!1;return Je(o).pipe(zi(l=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",di.SupersededByNewNavigation),li;this.currentTransition=o,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?on(Me({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let u=!n.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),h=l.extras.onSameUrlNavigation??n.onSameUrlNavigation;if(!u&&h!=="reload"){let d="";return this.events.next(new Io(l.id,this.urlSerializer.serialize(l.rawUrl),d,$m.IgnoredSameUrlNavigation)),l.resolve(null),li}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return Je(l).pipe(zi(d=>{let f=this.transitions?.getValue();return this.events.next(new iu(d.id,this.urlSerializer.serialize(d.extractedUrl),d.source,d.restoredState)),f!==this.transitions?.getValue()?li:Promise.resolve(d)}),oI(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,this.paramsInheritanceStrategy),Sn(d=>{o.targetSnapshot=d.targetSnapshot,o.urlAfterRedirects=d.urlAfterRedirects,this.currentNavigation=on(Me({},this.currentNavigation),{finalUrl:d.urlAfterRedirects});let f=new zd(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(f)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:d,extractedUrl:f,source:x,restoredState:g,extras:p}=l,m=new iu(d,this.urlSerializer.serialize(f),x,g);this.events.next(m);let v=KA(this.rootComponentType).snapshot;return this.currentTransition=o=on(Me({},l),{targetSnapshot:v,urlAfterRedirects:f,extras:on(Me({},p),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,Je(o)}else{let d="";return this.events.next(new Io(l.id,this.urlSerializer.serialize(l.extractedUrl),d,$m.IgnoredByUrlHandlingStrategy)),l.resolve(null),li}}),Sn(l=>{let u=new Xm(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}),vt(l=>(this.currentTransition=o=on(Me({},l),{guards:w3(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),o)),R3(this.environmentInjector,l=>this.events.next(l)),Sn(l=>{if(o.guardsResult=l.guardsResult,Ga(l.guardsResult))throw tw(this.urlSerializer,l.guardsResult);let u=new qm(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(u)}),Vi(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",di.GuardRejected),!1)),Vm(l=>{if(l.guards.canActivateChecks.length)return Je(l).pipe(Sn(u=>{let h=new Ym(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(h)}),zi(u=>{let h=!1;return Je(u).pipe(aI(this.paramsInheritanceStrategy,this.environmentInjector),Sn({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(u,"",di.NoDataFromResolver)}}))}),Sn(u=>{let h=new Zm(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(h)}))}),Vm(l=>{let u=h=>{let d=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&d.push(this.configLoader.loadComponent(h.routeConfig).pipe(Sn(f=>{h.component=f}),vt(()=>{})));for(let f of h.children)d.push(...u(f));return d};return Ih(u(l.targetSnapshot.root)).pipe(gs(null),zr(1))}),Vm(()=>this.afterPreactivation()),zi(()=>{let{currentSnapshot:l,targetSnapshot:u}=o,h=this.createViewTransition?.(this.environmentInjector,l.root,u.root);return h?En(h).pipe(vt(()=>o)):Je(o)}),vt(l=>{let u=m3(n.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=o=on(Me({},l),{targetRouterState:u}),this.currentNavigation.targetRouterState=u,o}),Sn(()=>{this.events.next(new su)}),A3(this.rootContexts,n.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),zr(1),Sn({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Bo(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),Rp(this.transitionAbortSubject.pipe(Sn(l=>{throw l}))),El(()=>{!a&&!c&&this.cancelNavigationTransition(o,"",di.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),ms(l=>{if(c=!0,iw(l))this.events.next(new bs(o.id,this.urlSerializer.serialize(o.extractedUrl),l.message,l.cancellationCode)),E3(l)?this.events.next(new ou(l.url)):o.resolve(!1);else{this.events.next(new ru(o.id,this.urlSerializer.serialize(o.extractedUrl),l,o.targetSnapshot??void 0));try{o.resolve(n.errorHandler(l))}catch(u){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(u)}}return li}))}))}cancelNavigationTransition(n,r,s){let o=new bs(n.id,this.urlSerializer.serialize(n.extractedUrl),r,s);this.events.next(o),n.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function vI(i){return i!==eu}var EI=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Le({token:e,factory:()=>Se(yI),providedIn:"root"});let i=e;return i})(),fg=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},yI=(()=>{let e=class e extends fg{};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=nm(e)))(s||e)}})(),e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),uw=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Le({token:e,factory:()=>Se(CI),providedIn:"root"});let i=e;return i})(),CI=(()=>{let e=class e extends uw{constructor(){super(...arguments),this.location=Se($l),this.urlSerializer=Se(pg),this.options=Se(yg,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=Se(_g),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new ws,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=KA(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(n){return this.location.subscribe(r=>{r.type==="popstate"&&n(r.url,r.state)})}handleRouterEvent(n,r){if(n instanceof iu)this.stateMemento=this.createStateMemento();else if(n instanceof Io)this.rawUrlTree=r.initialUrl;else if(n instanceof zd){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(s,r)}}else n instanceof su?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,r))):n instanceof bs&&(n.code===di.GuardRejected||n.code===di.NoDataFromResolver)?this.restoreHistory(r):n instanceof ru?this.restoreHistory(r,!0):n instanceof Bo&&(this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId)}setBrowserUrl(n,r){let s=this.urlSerializer.serialize(n);if(this.location.isCurrentPathEqualTo(s)||r.extras.replaceUrl){let o=this.browserPageId,a=Me(Me({},r.extras.state),this.generateNgRouterState(r.id,o));this.location.replaceState(s,"",a)}else{let o=Me(Me({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(n,r=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===n.finalUrl&&o===0&&(this.resetState(n),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,r){return this.canceledNavigationResolution==="computed"?{navigationId:n,\u0275routerPageId:r}:{navigationId:n}}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=nm(e)))(s||e)}})(),e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),Jl=function(i){return i[i.COMPLETE=0]="COMPLETE",i[i.FAILED=1]="FAILED",i[i.REDIRECTING=2]="REDIRECTING",i}(Jl||{});function _I(i,e){i.events.pipe(Vi(t=>t instanceof Bo||t instanceof bs||t instanceof ru||t instanceof Io),vt(t=>t instanceof Bo||t instanceof Io?Jl.COMPLETE:(t instanceof bs?t.code===di.Redirect||t.code===di.SupersededByNewNavigation:!1)?Jl.REDIRECTING:Jl.FAILED),Vi(t=>t!==Jl.REDIRECTING),zr(1)).subscribe(()=>{e()})}function AI(i){throw i}var wI={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},bI={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},hw=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=Se(Sd),this.stateManager=Se(uw),this.options=Se(yg,{optional:!0})||{},this.pendingTasks=Se(bd),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=Se(gI),this.urlSerializer=Se(pg),this.location=Se($l),this.urlHandlingStrategy=Se(_g),this._events=new $n,this.errorHandler=this.options.errorHandler||AI,this.navigated=!1,this.routeReuseStrategy=Se(EI),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=Se(Cg,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!Se(gg,{optional:!0}),this.eventsSubscription=new vn,this.isNgZoneEnabled=Se(fn)instanceof fn&&fn.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:n=>{this.console.warn(n)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let n=this.navigationTransitions.events.subscribe(r=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(r,o),r instanceof bs&&r.code!==di.Redirect&&r.code!==di.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Bo)this.navigated=!0;else if(r instanceof ou){let a=this.urlHandlingStrategy.merge(r.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||vI(s.source)};this.scheduleNavigation(a,eu,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}SI(r)&&this._events.next(r)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),eu,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((n,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(n,"popstate",r)},0)})}navigateToSyncWithBrowser(n,r,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let l=Me({},s);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(o.state=l)}let c=this.parseUrl(n);this.scheduleNavigation(c,r,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(vg),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,r={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:l}=r,u=l?this.currentUrlTree.fragment:a,h=null;switch(c){case"merge":h=Me(Me({},this.currentUrlTree.queryParams),o);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=o||null}h!==null&&(h=this.removeEmptyProps(h));let d;try{let f=s?s.snapshot:this.routerState.snapshot.root;d=XA(f)}catch{(typeof n[0]!="string"||!n[0].startsWith("/"))&&(n=[]),d=this.currentUrlTree.root}return qA(d,n,h,u??null)}navigateByUrl(n,r={skipLocationChange:!1}){let s=Ga(n)?n:this.parseUrl(n),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,eu,null,r)}navigate(n,r={skipLocationChange:!1}){return DI(n),this.navigateByUrl(this.createUrlTree(n,r),r)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){try{return this.urlSerializer.parse(n)}catch{return this.urlSerializer.parse("/")}}isActive(n,r){let s;if(r===!0?s=Me({},wI):r===!1?s=Me({},bI):s=r,Ga(n))return IA(this.currentUrlTree,n,s);let o=this.parseUrl(n);return IA(this.currentUrlTree,o,s)}removeEmptyProps(n){return Object.entries(n).reduce((r,[s,o])=>(o!=null&&(r[s]=o),r),{})}scheduleNavigation(n,r,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,l,u;a?(c=a.resolve,l=a.reject,u=a.promise):u=new Promise((d,f)=>{c=d,l=f});let h=this.pendingTasks.add();return _I(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:o,resolve:c,reject:l,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(d=>Promise.reject(d))}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function DI(i){for(let e=0;e<i.length;e++)if(i[e]==null)throw new je(4008,!1)}function SI(i){return!(i instanceof su)&&!(i instanceof ou)}var MI=new Et("");function dw(i,...e){return ud([{provide:Cg,multi:!0,useValue:i},[],{provide:Ar,useFactory:TI,deps:[hw]},{provide:Am,multi:!0,useFactory:FI},e.map(t=>t.\u0275providers)])}function TI(i){return i.routerState.root}function FI(){let i=Se(Vl);return e=>{let t=i.get(Gl);if(e!==t.components[0])return;let n=i.get(hw),r=i.get(BI);i.get(II)===1&&n.initialNavigation(),i.get(PI,null,ht.Optional)?.setUpPreloading(),i.get(MI,null,ht.Optional)?.init(),n.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var BI=new Et("",{factory:()=>new $n}),II=new Et("",{providedIn:"root",factory:()=>1});var PI=new Et("");var Hv="164";var RI=0,pw=1,OI=2;var Zb=1,kI=2,es=3,Mr=0,ri=1,ns=2,Os=0,fc=1,xw=2,mw=3,gw=4,NI=5,Vo=100,LI=101,UI=102,VI=103,zI=104,HI=200,jI=201,GI=202,WI=203,iv=204,rv=205,$I=206,XI=207,qI=208,YI=209,ZI=210,KI=211,JI=212,QI=213,eP=214,tP=0,nP=1,iP=2,Af=3,rP=4,sP=5,oP=6,aP=7,jv=0,cP=1,lP=2,ks=0,uP=1,hP=2,dP=3,fP=4,pP=5,xP=6,mP=7;var vw=300,gc=301,vc=302,sv=303,ov=304,Kf=306,Au=1e3,Ho=1001,av=1002,Si=1003,gP=1004;var Yd=1005;var er=1006,Ag=1007;var jo=1008;var Ns=1009,vP=1010,EP=1011,Kb=1012,Jb=1013,Ec=1014,Rs=1015,Jf=1016,Qb=1017,eD=1018,Bu=1020,yP=35902,CP=1021,_P=1022,Dr=1023,AP=1024,wP=1025,pc=1026,wu=1027,bP=1028,tD=1029,DP=1030,nD=1031,iD=1033,wg=33776,bg=33777,Dg=33778,Sg=33779,Ew=35840,yw=35841,Cw=35842,_w=35843,Aw=36196,ww=37492,bw=37496,Dw=37808,Sw=37809,Mw=37810,Tw=37811,Fw=37812,Bw=37813,Iw=37814,Pw=37815,Rw=37816,Ow=37817,kw=37818,Nw=37819,Lw=37820,Uw=37821,Mg=36492,Vw=36494,zw=36495,SP=36283,Hw=36284,jw=36285,Gw=36286;var wf=2300,bf=2301,Tg=2302,Ww=2400,$w=2401,Xw=2402;var MP=3200,TP=3201,rD=0,FP=1,Ps="",Di="srgb",Us="srgb-linear",Gv="display-p3",Qf="display-p3-linear",Df="linear",qt="srgb",Sf="rec709",Mf="p3";var Xa=7680;var qw=519,BP=512,IP=513,PP=514,sD=515,RP=516,OP=517,kP=518,NP=519,Yw=35044;var Zw="300 es",is=2e3,Tf=2001,Tr=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let r=this._listeners[e];if(r!==void 0){let s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let n=this._listeners[e.type];if(n!==void 0){e.target=this;let r=n.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}},Un=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],Kw=1234567,yu=Math.PI/180,bu=180/Math.PI;function Sc(){let i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Un[i&255]+Un[i>>8&255]+Un[i>>16&255]+Un[i>>24&255]+"-"+Un[e&255]+Un[e>>8&255]+"-"+Un[e>>16&15|64]+Un[e>>24&255]+"-"+Un[t&63|128]+Un[t>>8&255]+"-"+Un[t>>16&255]+Un[t>>24&255]+Un[n&255]+Un[n>>8&255]+Un[n>>16&255]+Un[n>>24&255]).toLowerCase()}function Bn(i,e,t){return Math.max(e,Math.min(t,i))}function Wv(i,e){return(i%e+e)%e}function LP(i,e,t,n,r){return n+(i-e)*(r-n)/(t-e)}function UP(i,e,t){return i!==e?(t-i)/(e-i):0}function Cu(i,e,t){return(1-t)*i+t*e}function VP(i,e,t,n){return Cu(i,e,1-Math.exp(-t*n))}function zP(i,e=1){return e-Math.abs(Wv(i,e*2)-e)}function HP(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function jP(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function GP(i,e){return i+Math.floor(Math.random()*(e-i+1))}function WP(i,e){return i+Math.random()*(e-i)}function $P(i){return i*(.5-Math.random())}function XP(i){i!==void 0&&(Kw=i);let e=Kw+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function qP(i){return i*yu}function YP(i){return i*bu}function ZP(i){return(i&i-1)===0&&i!==0}function KP(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function JP(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function QP(i,e,t,n,r){let s=Math.cos,o=Math.sin,a=s(t/2),c=o(t/2),l=s((e+n)/2),u=o((e+n)/2),h=s((e-n)/2),d=o((e-n)/2),f=s((n-e)/2),x=o((n-e)/2);switch(r){case"XYX":i.set(a*u,c*h,c*d,a*l);break;case"YZY":i.set(c*d,a*u,c*h,a*l);break;case"ZXZ":i.set(c*h,c*d,a*u,a*l);break;case"XZX":i.set(a*u,c*x,c*f,a*l);break;case"YXY":i.set(c*f,a*u,c*x,a*l);break;case"ZYZ":i.set(c*x,c*f,a*u,a*l);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function uc(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function Yn(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}var Kt={DEG2RAD:yu,RAD2DEG:bu,generateUUID:Sc,clamp:Bn,euclideanModulo:Wv,mapLinear:LP,inverseLerp:UP,lerp:Cu,damp:VP,pingpong:zP,smoothstep:HP,smootherstep:jP,randInt:GP,randFloat:WP,randFloatSpread:$P,seededRandom:XP,degToRad:qP,radToDeg:YP,isPowerOfTwo:ZP,ceilPowerOfTwo:KP,floorPowerOfTwo:JP,setQuaternionFromProperEuler:QP,normalize:Yn,denormalize:uc},We=class i{constructor(e=0,t=0){i.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let n=this.dot(e)/t;return Math.acos(Bn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*n-o*r+e.x,this.y=s*r+o*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},st=class i{constructor(e,t,n,r,s,o,a,c,l){i.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,o,a,c,l)}set(e,t,n,r,s,o,a,c,l){let u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=s,u[5]=c,u[6]=n,u[7]=o,u[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[3],c=n[6],l=n[1],u=n[4],h=n[7],d=n[2],f=n[5],x=n[8],g=r[0],p=r[3],m=r[6],v=r[1],E=r[4],y=r[7],w=r[2],A=r[5],b=r[8];return s[0]=o*g+a*v+c*w,s[3]=o*p+a*E+c*A,s[6]=o*m+a*y+c*b,s[1]=l*g+u*v+h*w,s[4]=l*p+u*E+h*A,s[7]=l*m+u*y+h*b,s[2]=d*g+f*v+x*w,s[5]=d*p+f*E+x*A,s[8]=d*m+f*y+x*b,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8];return t*o*u-t*a*l-n*s*u+n*a*c+r*s*l-r*o*c}invert(){let e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],h=u*o-a*l,d=a*c-u*s,f=l*s-o*c,x=t*h+n*d+r*f;if(x===0)return this.set(0,0,0,0,0,0,0,0,0);let g=1/x;return e[0]=h*g,e[1]=(r*l-u*n)*g,e[2]=(a*n-r*o)*g,e[3]=d*g,e[4]=(u*t-r*c)*g,e[5]=(r*s-a*t)*g,e[6]=f*g,e[7]=(n*c-l*t)*g,e[8]=(o*t-n*s)*g,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,o,a){let c=Math.cos(s),l=Math.sin(s);return this.set(n*c,n*l,-n*(c*o+l*a)+o+e,-r*l,r*c,-r*(-l*o+c*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(Fg.makeScale(e,t)),this}rotate(e){return this.premultiply(Fg.makeRotation(-e)),this}translate(e,t){return this.premultiply(Fg.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){let n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}},Fg=new st;function oD(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}function Du(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function e6(){let i=Du("canvas");return i.style.display="block",i}var Jw={};function t6(i){i in Jw||(Jw[i]=!0,console.warn(i))}var Qw=new st().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),eb=new st().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Zd={[Us]:{transfer:Df,primaries:Sf,toReference:i=>i,fromReference:i=>i},[Di]:{transfer:qt,primaries:Sf,toReference:i=>i.convertSRGBToLinear(),fromReference:i=>i.convertLinearToSRGB()},[Qf]:{transfer:Df,primaries:Mf,toReference:i=>i.applyMatrix3(eb),fromReference:i=>i.applyMatrix3(Qw)},[Gv]:{transfer:qt,primaries:Mf,toReference:i=>i.convertSRGBToLinear().applyMatrix3(eb),fromReference:i=>i.applyMatrix3(Qw).convertLinearToSRGB()}},n6=new Set([Us,Qf]),Ot={enabled:!0,_workingColorSpace:Us,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(i){if(!n6.has(i))throw new Error(`Unsupported working color space, "${i}".`);this._workingColorSpace=i},convert:function(i,e,t){if(this.enabled===!1||e===t||!e||!t)return i;let n=Zd[e].toReference,r=Zd[t].fromReference;return r(n(i))},fromWorkingColorSpace:function(i,e){return this.convert(i,this._workingColorSpace,e)},toWorkingColorSpace:function(i,e){return this.convert(i,e,this._workingColorSpace)},getPrimaries:function(i){return Zd[i].primaries},getTransfer:function(i){return i===Ps?Df:Zd[i].transfer}};function xc(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function Bg(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}var qa,cv=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{qa===void 0&&(qa=Du("canvas")),qa.width=e.width,qa.height=e.height;let n=qa.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=qa}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=Du("canvas");t.width=e.width,t.height=e.height;let n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);let r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=xc(s[o]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){let t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(xc(t[n]/255)*255):t[n]=xc(t[n]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},i6=0,Ff=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:i6++}),this.uuid=Sc(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(Ig(r[o].image)):s.push(Ig(r[o]))}else s=Ig(r);n.url=s}return t||(e.images[this.uuid]=n),n}};function Ig(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?cv.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var r6=0,Vs=(()=>{class i extends Tr{constructor(t=i.DEFAULT_IMAGE,n=i.DEFAULT_MAPPING,r=Ho,s=Ho,o=er,a=jo,c=Dr,l=Ns,u=i.DEFAULT_ANISOTROPY,h=Ps){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:r6++}),this.uuid=Sc(),this.name="",this.source=new Ff(t),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=r,this.wrapT=s,this.magFilter=o,this.minFilter=a,this.anisotropy=u,this.format=c,this.internalFormat=null,this.type=l,this.offset=new We(0,0),this.repeat=new We(1,1),this.center=new We(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new st,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=h,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){let n=t===void 0||typeof t=="string";if(!n&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];let r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),n||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==vw)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Au:t.x=t.x-Math.floor(t.x);break;case Ho:t.x=t.x<0?0:1;break;case av:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case Au:t.y=t.y-Math.floor(t.y);break;case Ho:t.y=t.y<0?0:1;break;case av:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){t===!0&&this.pmremVersion++}}return i.DEFAULT_IMAGE=null,i.DEFAULT_MAPPING=vw,i.DEFAULT_ANISOTROPY=1,i})(),Zt=class i{constructor(e=0,t=0,n=0,r=1){i.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,n=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,s,c=e.elements,l=c[0],u=c[4],h=c[8],d=c[1],f=c[5],x=c[9],g=c[2],p=c[6],m=c[10];if(Math.abs(u-d)<.01&&Math.abs(h-g)<.01&&Math.abs(x-p)<.01){if(Math.abs(u+d)<.1&&Math.abs(h+g)<.1&&Math.abs(x+p)<.1&&Math.abs(l+f+m-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let E=(l+1)/2,y=(f+1)/2,w=(m+1)/2,A=(u+d)/4,b=(h+g)/4,D=(x+p)/4;return E>y&&E>w?E<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(E),r=A/n,s=b/n):y>w?y<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(y),n=A/r,s=D/r):w<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(w),n=b/s,r=D/s),this.set(n,r,s,t),this}let v=Math.sqrt((p-x)*(p-x)+(h-g)*(h-g)+(d-u)*(d-u));return Math.abs(v)<.001&&(v=1),this.x=(p-x)/v,this.y=(h-g)/v,this.z=(d-u)/v,this.w=Math.acos((l+f+m-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},lv=class extends Tr{constructor(e=1,t=1,n={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Zt(0,0,e,t),this.scissorTest=!1,this.viewport=new Zt(0,0,e,t);let r={width:e,height:t,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:er,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},n);let s=new Vs(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);s.flipY=!1,s.generateMipmaps=n.generateMipmaps,s.internalFormat=n.internalFormat,this.textures=[];let o=n.count;for(let a=0;a<o;a++)this.textures[a]=s.clone(),this.textures[a].isRenderTargetTexture=!0;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,r=e.textures.length;n<r;n++)this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new Ff(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},rs=class extends lv{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}},Bf=class extends Vs{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=Si,this.minFilter=Si,this.wrapR=Ho,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};var uv=class extends Vs{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=Si,this.minFilter=Si,this.wrapR=Ho,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};var Ti=class{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,s,o,a){let c=n[r+0],l=n[r+1],u=n[r+2],h=n[r+3],d=s[o+0],f=s[o+1],x=s[o+2],g=s[o+3];if(a===0){e[t+0]=c,e[t+1]=l,e[t+2]=u,e[t+3]=h;return}if(a===1){e[t+0]=d,e[t+1]=f,e[t+2]=x,e[t+3]=g;return}if(h!==g||c!==d||l!==f||u!==x){let p=1-a,m=c*d+l*f+u*x+h*g,v=m>=0?1:-1,E=1-m*m;if(E>Number.EPSILON){let w=Math.sqrt(E),A=Math.atan2(w,m*v);p=Math.sin(p*A)/w,a=Math.sin(a*A)/w}let y=a*v;if(c=c*p+d*y,l=l*p+f*y,u=u*p+x*y,h=h*p+g*y,p===1-a){let w=1/Math.sqrt(c*c+l*l+u*u+h*h);c*=w,l*=w,u*=w,h*=w}}e[t]=c,e[t+1]=l,e[t+2]=u,e[t+3]=h}static multiplyQuaternionsFlat(e,t,n,r,s,o){let a=n[r],c=n[r+1],l=n[r+2],u=n[r+3],h=s[o],d=s[o+1],f=s[o+2],x=s[o+3];return e[t]=a*x+u*h+c*f-l*d,e[t+1]=c*x+u*d+l*h-a*f,e[t+2]=l*x+u*f+a*d-c*h,e[t+3]=u*x-a*h-c*d-l*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){let n=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,c=Math.sin,l=a(n/2),u=a(r/2),h=a(s/2),d=c(n/2),f=c(r/2),x=c(s/2);switch(o){case"XYZ":this._x=d*u*h+l*f*x,this._y=l*f*h-d*u*x,this._z=l*u*x+d*f*h,this._w=l*u*h-d*f*x;break;case"YXZ":this._x=d*u*h+l*f*x,this._y=l*f*h-d*u*x,this._z=l*u*x-d*f*h,this._w=l*u*h+d*f*x;break;case"ZXY":this._x=d*u*h-l*f*x,this._y=l*f*h+d*u*x,this._z=l*u*x+d*f*h,this._w=l*u*h-d*f*x;break;case"ZYX":this._x=d*u*h-l*f*x,this._y=l*f*h+d*u*x,this._z=l*u*x-d*f*h,this._w=l*u*h+d*f*x;break;case"YZX":this._x=d*u*h+l*f*x,this._y=l*f*h+d*u*x,this._z=l*u*x-d*f*h,this._w=l*u*h-d*f*x;break;case"XZY":this._x=d*u*h-l*f*x,this._y=l*f*h-d*u*x,this._z=l*u*x+d*f*h,this._w=l*u*h+d*f*x;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,n=t[0],r=t[4],s=t[8],o=t[1],a=t[5],c=t[9],l=t[2],u=t[6],h=t[10],d=n+a+h;if(d>0){let f=.5/Math.sqrt(d+1);this._w=.25/f,this._x=(u-c)*f,this._y=(s-l)*f,this._z=(o-r)*f}else if(n>a&&n>h){let f=2*Math.sqrt(1+n-a-h);this._w=(u-c)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+l)/f}else if(a>h){let f=2*Math.sqrt(1+a-n-h);this._w=(s-l)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(c+u)/f}else{let f=2*Math.sqrt(1+h-n-a);this._w=(o-r)/f,this._x=(s+l)/f,this._y=(c+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Bn(this.dot(e),-1,1)))}rotateTowards(e,t){let n=this.angleTo(e);if(n===0)return this;let r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let n=e._x,r=e._y,s=e._z,o=e._w,a=t._x,c=t._y,l=t._z,u=t._w;return this._x=n*u+o*a+r*l-s*c,this._y=r*u+o*c+s*a-n*l,this._z=s*u+o*l+n*c-r*a,this._w=o*u-n*a-r*c-s*l,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let n=this._x,r=this._y,s=this._z,o=this._w,a=o*e._w+n*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=s,this;let c=1-a*a;if(c<=Number.EPSILON){let f=1-t;return this._w=f*o+t*this._w,this._x=f*n+t*this._x,this._y=f*r+t*this._y,this._z=f*s+t*this._z,this.normalize(),this}let l=Math.sqrt(c),u=Math.atan2(l,a),h=Math.sin((1-t)*u)/l,d=Math.sin(t*u)/l;return this._w=o*h+this._w*d,this._x=n*h+this._x*d,this._y=r*h+this._y*d,this._z=s*h+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){let e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),s=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},k=class i{constructor(e=0,t=0,n=0){i.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(tb.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(tb.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,n=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*o,this}applyQuaternion(e){let t=this.x,n=this.y,r=this.z,s=e.x,o=e.y,a=e.z,c=e.w,l=2*(o*r-a*n),u=2*(a*t-s*r),h=2*(s*n-o*t);return this.x=t+c*l+o*h-a*u,this.y=n+c*u+a*l-s*h,this.z=r+c*h+s*u-o*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let n=e.x,r=e.y,s=e.z,o=t.x,a=t.y,c=t.z;return this.x=r*c-s*a,this.y=s*o-n*c,this.z=n*a-r*o,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return Pg.copy(this).projectOnVector(e),this.sub(Pg)}reflect(e){return this.sub(Pg.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let n=this.dot(e)/t;return Math.acos(Bn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){let r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},Pg=new k,tb=new Ti,ss=class{constructor(e=new k(1/0,1/0,1/0),t=new k(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Ki.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Ki.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let n=Ki.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let n=e.geometry;if(n!==void 0){let s=n.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,Ki):Ki.fromBufferAttribute(s,o),Ki.applyMatrix4(e.matrixWorld),this.expandByPoint(Ki);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Kd.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),Kd.copy(n.boundingBox)),Kd.applyMatrix4(e.matrixWorld),this.union(Kd)}let r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Ki),Ki.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(fu),Jd.subVectors(this.max,fu),Ya.subVectors(e.a,fu),Za.subVectors(e.b,fu),Ka.subVectors(e.c,fu),Ss.subVectors(Za,Ya),Ms.subVectors(Ka,Za),Po.subVectors(Ya,Ka);let t=[0,-Ss.z,Ss.y,0,-Ms.z,Ms.y,0,-Po.z,Po.y,Ss.z,0,-Ss.x,Ms.z,0,-Ms.x,Po.z,0,-Po.x,-Ss.y,Ss.x,0,-Ms.y,Ms.x,0,-Po.y,Po.x,0];return!Rg(t,Ya,Za,Ka,Jd)||(t=[1,0,0,0,1,0,0,0,1],!Rg(t,Ya,Za,Ka,Jd))?!1:(Qd.crossVectors(Ss,Ms),t=[Qd.x,Qd.y,Qd.z],Rg(t,Ya,Za,Ka,Jd))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Ki).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Ki).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(qr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),qr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),qr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),qr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),qr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),qr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),qr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),qr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(qr),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},qr=[new k,new k,new k,new k,new k,new k,new k,new k],Ki=new k,Kd=new ss,Ya=new k,Za=new k,Ka=new k,Ss=new k,Ms=new k,Po=new k,fu=new k,Jd=new k,Qd=new k,Ro=new k;function Rg(i,e,t,n,r){for(let s=0,o=i.length-3;s<=o;s+=3){Ro.fromArray(i,s);let a=r.x*Math.abs(Ro.x)+r.y*Math.abs(Ro.y)+r.z*Math.abs(Ro.z),c=e.dot(Ro),l=t.dot(Ro),u=n.dot(Ro);if(Math.max(-Math.max(c,l,u),Math.min(c,l,u))>a)return!1}return!0}var s6=new ss,pu=new k,Og=new k,os=class{constructor(e=new k,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let n=this.center;t!==void 0?n.copy(t):s6.setFromPoints(e).getCenter(n);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;pu.subVectors(e,this.center);let t=pu.lengthSq();if(t>this.radius*this.radius){let n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.addScaledVector(pu,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(Og.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(pu.copy(e.center).add(Og)),this.expandByPoint(pu.copy(e.center).sub(Og))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},Yr=new k,kg=new k,ef=new k,Ts=new k,Ng=new k,tf=new k,Lg=new k,yc=class{constructor(e=new k,t=new k(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Yr)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=Yr.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Yr.copy(this.origin).addScaledVector(this.direction,t),Yr.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){kg.copy(e).add(t).multiplyScalar(.5),ef.copy(t).sub(e).normalize(),Ts.copy(this.origin).sub(kg);let s=e.distanceTo(t)*.5,o=-this.direction.dot(ef),a=Ts.dot(this.direction),c=-Ts.dot(ef),l=Ts.lengthSq(),u=Math.abs(1-o*o),h,d,f,x;if(u>0)if(h=o*c-a,d=o*a-c,x=s*u,h>=0)if(d>=-x)if(d<=x){let g=1/u;h*=g,d*=g,f=h*(h+o*d+2*a)+d*(o*h+d+2*c)+l}else d=s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*c)+l;else d=-s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*c)+l;else d<=-x?(h=Math.max(0,-(-o*s+a)),d=h>0?-s:Math.min(Math.max(-s,-c),s),f=-h*h+d*(d+2*c)+l):d<=x?(h=0,d=Math.min(Math.max(-s,-c),s),f=d*(d+2*c)+l):(h=Math.max(0,-(o*s+a)),d=h>0?s:Math.min(Math.max(-s,-c),s),f=-h*h+d*(d+2*c)+l);else d=o>0?-s:s,h=Math.max(0,-(o*d+a)),f=-h*h+d*(d+2*c)+l;return n&&n.copy(this.origin).addScaledVector(this.direction,h),r&&r.copy(kg).addScaledVector(ef,d),f}intersectSphere(e,t){Yr.subVectors(e.center,this.origin);let n=Yr.dot(this.direction),r=Yr.dot(Yr)-n*n,s=e.radius*e.radius;if(r>s)return null;let o=Math.sqrt(s-r),a=n-o,c=n+o;return c<0?null:a<0?this.at(c,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){let n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,s,o,a,c,l=1/this.direction.x,u=1/this.direction.y,h=1/this.direction.z,d=this.origin;return l>=0?(n=(e.min.x-d.x)*l,r=(e.max.x-d.x)*l):(n=(e.max.x-d.x)*l,r=(e.min.x-d.x)*l),u>=0?(s=(e.min.y-d.y)*u,o=(e.max.y-d.y)*u):(s=(e.max.y-d.y)*u,o=(e.min.y-d.y)*u),n>o||s>r||((s>n||isNaN(n))&&(n=s),(o<r||isNaN(r))&&(r=o),h>=0?(a=(e.min.z-d.z)*h,c=(e.max.z-d.z)*h):(a=(e.max.z-d.z)*h,c=(e.min.z-d.z)*h),n>c||a>r)||((a>n||n!==n)&&(n=a),(c<r||r!==r)&&(r=c),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,Yr)!==null}intersectTriangle(e,t,n,r,s){Ng.subVectors(t,e),tf.subVectors(n,e),Lg.crossVectors(Ng,tf);let o=this.direction.dot(Lg),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Ts.subVectors(this.origin,e);let c=a*this.direction.dot(tf.crossVectors(Ts,tf));if(c<0)return null;let l=a*this.direction.dot(Ng.cross(Ts));if(l<0||c+l>o)return null;let u=-a*Ts.dot(Lg);return u<0?null:this.at(u/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},qe=class i{constructor(e,t,n,r,s,o,a,c,l,u,h,d,f,x,g,p){i.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,o,a,c,l,u,h,d,f,x,g,p)}set(e,t,n,r,s,o,a,c,l,u,h,d,f,x,g,p){let m=this.elements;return m[0]=e,m[4]=t,m[8]=n,m[12]=r,m[1]=s,m[5]=o,m[9]=a,m[13]=c,m[2]=l,m[6]=u,m[10]=h,m[14]=d,m[3]=f,m[7]=x,m[11]=g,m[15]=p,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new i().fromArray(this.elements)}copy(e){let t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){let t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,n=e.elements,r=1/Ja.setFromMatrixColumn(e,0).length(),s=1/Ja.setFromMatrixColumn(e,1).length(),o=1/Ja.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,n=e.x,r=e.y,s=e.z,o=Math.cos(n),a=Math.sin(n),c=Math.cos(r),l=Math.sin(r),u=Math.cos(s),h=Math.sin(s);if(e.order==="XYZ"){let d=o*u,f=o*h,x=a*u,g=a*h;t[0]=c*u,t[4]=-c*h,t[8]=l,t[1]=f+x*l,t[5]=d-g*l,t[9]=-a*c,t[2]=g-d*l,t[6]=x+f*l,t[10]=o*c}else if(e.order==="YXZ"){let d=c*u,f=c*h,x=l*u,g=l*h;t[0]=d+g*a,t[4]=x*a-f,t[8]=o*l,t[1]=o*h,t[5]=o*u,t[9]=-a,t[2]=f*a-x,t[6]=g+d*a,t[10]=o*c}else if(e.order==="ZXY"){let d=c*u,f=c*h,x=l*u,g=l*h;t[0]=d-g*a,t[4]=-o*h,t[8]=x+f*a,t[1]=f+x*a,t[5]=o*u,t[9]=g-d*a,t[2]=-o*l,t[6]=a,t[10]=o*c}else if(e.order==="ZYX"){let d=o*u,f=o*h,x=a*u,g=a*h;t[0]=c*u,t[4]=x*l-f,t[8]=d*l+g,t[1]=c*h,t[5]=g*l+d,t[9]=f*l-x,t[2]=-l,t[6]=a*c,t[10]=o*c}else if(e.order==="YZX"){let d=o*c,f=o*l,x=a*c,g=a*l;t[0]=c*u,t[4]=g-d*h,t[8]=x*h+f,t[1]=h,t[5]=o*u,t[9]=-a*u,t[2]=-l*u,t[6]=f*h+x,t[10]=d-g*h}else if(e.order==="XZY"){let d=o*c,f=o*l,x=a*c,g=a*l;t[0]=c*u,t[4]=-h,t[8]=l*u,t[1]=d*h+g,t[5]=o*u,t[9]=f*h-x,t[2]=x*h-f,t[6]=a*u,t[10]=g*h+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(o6,e,a6)}lookAt(e,t,n){let r=this.elements;return fi.subVectors(e,t),fi.lengthSq()===0&&(fi.z=1),fi.normalize(),Fs.crossVectors(n,fi),Fs.lengthSq()===0&&(Math.abs(n.z)===1?fi.x+=1e-4:fi.z+=1e-4,fi.normalize(),Fs.crossVectors(n,fi)),Fs.normalize(),nf.crossVectors(fi,Fs),r[0]=Fs.x,r[4]=nf.x,r[8]=fi.x,r[1]=Fs.y,r[5]=nf.y,r[9]=fi.y,r[2]=Fs.z,r[6]=nf.z,r[10]=fi.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let n=e.elements,r=t.elements,s=this.elements,o=n[0],a=n[4],c=n[8],l=n[12],u=n[1],h=n[5],d=n[9],f=n[13],x=n[2],g=n[6],p=n[10],m=n[14],v=n[3],E=n[7],y=n[11],w=n[15],A=r[0],b=r[4],D=r[8],C=r[12],_=r[1],M=r[5],B=r[9],F=r[13],N=r[2],L=r[6],Z=r[10],Q=r[14],j=r[3],W=r[7],ie=r[11],ue=r[15];return s[0]=o*A+a*_+c*N+l*j,s[4]=o*b+a*M+c*L+l*W,s[8]=o*D+a*B+c*Z+l*ie,s[12]=o*C+a*F+c*Q+l*ue,s[1]=u*A+h*_+d*N+f*j,s[5]=u*b+h*M+d*L+f*W,s[9]=u*D+h*B+d*Z+f*ie,s[13]=u*C+h*F+d*Q+f*ue,s[2]=x*A+g*_+p*N+m*j,s[6]=x*b+g*M+p*L+m*W,s[10]=x*D+g*B+p*Z+m*ie,s[14]=x*C+g*F+p*Q+m*ue,s[3]=v*A+E*_+y*N+w*j,s[7]=v*b+E*M+y*L+w*W,s[11]=v*D+E*B+y*Z+w*ie,s[15]=v*C+E*F+y*Q+w*ue,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],o=e[1],a=e[5],c=e[9],l=e[13],u=e[2],h=e[6],d=e[10],f=e[14],x=e[3],g=e[7],p=e[11],m=e[15];return x*(+s*c*h-r*l*h-s*a*d+n*l*d+r*a*f-n*c*f)+g*(+t*c*f-t*l*d+s*o*d-r*o*f+r*l*u-s*c*u)+p*(+t*l*h-t*a*f-s*o*h+n*o*f+s*a*u-n*l*u)+m*(-r*a*u-t*c*h+t*a*d+r*o*h-n*o*d+n*c*u)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){let r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){let e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],l=e[7],u=e[8],h=e[9],d=e[10],f=e[11],x=e[12],g=e[13],p=e[14],m=e[15],v=h*p*l-g*d*l+g*c*f-a*p*f-h*c*m+a*d*m,E=x*d*l-u*p*l-x*c*f+o*p*f+u*c*m-o*d*m,y=u*g*l-x*h*l+x*a*f-o*g*f-u*a*m+o*h*m,w=x*h*c-u*g*c-x*a*d+o*g*d+u*a*p-o*h*p,A=t*v+n*E+r*y+s*w;if(A===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let b=1/A;return e[0]=v*b,e[1]=(g*d*s-h*p*s-g*r*f+n*p*f+h*r*m-n*d*m)*b,e[2]=(a*p*s-g*c*s+g*r*l-n*p*l-a*r*m+n*c*m)*b,e[3]=(h*c*s-a*d*s-h*r*l+n*d*l+a*r*f-n*c*f)*b,e[4]=E*b,e[5]=(u*p*s-x*d*s+x*r*f-t*p*f-u*r*m+t*d*m)*b,e[6]=(x*c*s-o*p*s-x*r*l+t*p*l+o*r*m-t*c*m)*b,e[7]=(o*d*s-u*c*s+u*r*l-t*d*l-o*r*f+t*c*f)*b,e[8]=y*b,e[9]=(x*h*s-u*g*s-x*n*f+t*g*f+u*n*m-t*h*m)*b,e[10]=(o*g*s-x*a*s+x*n*l-t*g*l-o*n*m+t*a*m)*b,e[11]=(u*a*s-o*h*s-u*n*l+t*h*l+o*n*f-t*a*f)*b,e[12]=w*b,e[13]=(u*g*r-x*h*r+x*n*d-t*g*d-u*n*p+t*h*p)*b,e[14]=(x*a*r-o*g*r-x*n*c+t*g*c+o*n*p-t*a*p)*b,e[15]=(o*h*r-u*a*r+u*n*c-t*h*c-o*n*d+t*a*d)*b,this}scale(e){let t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let n=Math.cos(t),r=Math.sin(t),s=1-n,o=e.x,a=e.y,c=e.z,l=s*o,u=s*a;return this.set(l*o+n,l*a-r*c,l*c+r*a,0,l*a+r*c,u*a+n,u*c-r*o,0,l*c-r*a,u*c+r*o,s*c*c+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,o){return this.set(1,n,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){let r=this.elements,s=t._x,o=t._y,a=t._z,c=t._w,l=s+s,u=o+o,h=a+a,d=s*l,f=s*u,x=s*h,g=o*u,p=o*h,m=a*h,v=c*l,E=c*u,y=c*h,w=n.x,A=n.y,b=n.z;return r[0]=(1-(g+m))*w,r[1]=(f+y)*w,r[2]=(x-E)*w,r[3]=0,r[4]=(f-y)*A,r[5]=(1-(d+m))*A,r[6]=(p+v)*A,r[7]=0,r[8]=(x+E)*b,r[9]=(p-v)*b,r[10]=(1-(d+g))*b,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){let r=this.elements,s=Ja.set(r[0],r[1],r[2]).length(),o=Ja.set(r[4],r[5],r[6]).length(),a=Ja.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Ji.copy(this);let l=1/s,u=1/o,h=1/a;return Ji.elements[0]*=l,Ji.elements[1]*=l,Ji.elements[2]*=l,Ji.elements[4]*=u,Ji.elements[5]*=u,Ji.elements[6]*=u,Ji.elements[8]*=h,Ji.elements[9]*=h,Ji.elements[10]*=h,t.setFromRotationMatrix(Ji),n.x=s,n.y=o,n.z=a,this}makePerspective(e,t,n,r,s,o,a=is){let c=this.elements,l=2*s/(t-e),u=2*s/(n-r),h=(t+e)/(t-e),d=(n+r)/(n-r),f,x;if(a===is)f=-(o+s)/(o-s),x=-2*o*s/(o-s);else if(a===Tf)f=-o/(o-s),x=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return c[0]=l,c[4]=0,c[8]=h,c[12]=0,c[1]=0,c[5]=u,c[9]=d,c[13]=0,c[2]=0,c[6]=0,c[10]=f,c[14]=x,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,t,n,r,s,o,a=is){let c=this.elements,l=1/(t-e),u=1/(n-r),h=1/(o-s),d=(t+e)*l,f=(n+r)*u,x,g;if(a===is)x=(o+s)*h,g=-2*h;else if(a===Tf)x=s*h,g=-1*h;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return c[0]=2*l,c[4]=0,c[8]=0,c[12]=-d,c[1]=0,c[5]=2*u,c[9]=0,c[13]=-f,c[2]=0,c[6]=0,c[10]=g,c[14]=-x,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){let t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){let n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}},Ja=new k,Ji=new qe,o6=new k(0,0,0),a6=new k(1,1,1),Fs=new k,nf=new k,fi=new k,nb=new qe,ib=new Ti,Go=(()=>{class i{constructor(t=0,n=0,r=0,s=i.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=n,this._z=r,this._order=s}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,n,r,s=this._order){return this._x=t,this._y=n,this._z=r,this._order=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,n=this._order,r=!0){let s=t.elements,o=s[0],a=s[4],c=s[8],l=s[1],u=s[5],h=s[9],d=s[2],f=s[6],x=s[10];switch(n){case"XYZ":this._y=Math.asin(Bn(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-h,x),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Bn(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(c,x),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-d,o),this._z=0);break;case"ZXY":this._x=Math.asin(Bn(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-d,x),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(l,o));break;case"ZYX":this._y=Math.asin(-Bn(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(f,x),this._z=Math.atan2(l,o)):(this._x=0,this._z=Math.atan2(-a,u));break;case"YZX":this._z=Math.asin(Bn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,u),this._y=Math.atan2(-d,o)):(this._x=0,this._y=Math.atan2(c,x));break;case"XZY":this._z=Math.asin(-Bn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(c,o)):(this._x=Math.atan2(-h,x),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,r===!0&&this._onChangeCallback(),this}setFromQuaternion(t,n,r){return nb.makeRotationFromQuaternion(t),this.setFromRotationMatrix(nb,n,r)}setFromVector3(t,n=this._order){return this.set(t.x,t.y,t.z,n)}reorder(t){return ib.setFromEuler(this),this.setFromQuaternion(ib,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],n=0){return t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return i.DEFAULT_ORDER="XYZ",i})(),Su=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},c6=0,rb=new k,Qa=new Ti,Zr=new qe,rf=new k,xu=new k,l6=new k,u6=new Ti,sb=new k(1,0,0),ob=new k(0,1,0),ab=new k(0,0,1),cb={type:"added"},h6={type:"removed"},ec={type:"childadded",child:null},Ug={type:"childremoved",child:null},nr=(()=>{class i extends Tr{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:c6++}),this.uuid=Sc(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=i.DEFAULT_UP.clone();let t=new k,n=new Go,r=new Ti,s=new k(1,1,1);function o(){r.setFromEuler(n,!1)}function a(){n.setFromQuaternion(r,void 0,!1)}n._onChange(o),r._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new qe},normalMatrix:{value:new st}}),this.matrix=new qe,this.matrixWorld=new qe,this.matrixAutoUpdate=i.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=i.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Su,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,n){this.quaternion.setFromAxisAngle(t,n)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,n){return Qa.setFromAxisAngle(t,n),this.quaternion.multiply(Qa),this}rotateOnWorldAxis(t,n){return Qa.setFromAxisAngle(t,n),this.quaternion.premultiply(Qa),this}rotateX(t){return this.rotateOnAxis(sb,t)}rotateY(t){return this.rotateOnAxis(ob,t)}rotateZ(t){return this.rotateOnAxis(ab,t)}translateOnAxis(t,n){return rb.copy(t).applyQuaternion(this.quaternion),this.position.add(rb.multiplyScalar(n)),this}translateX(t){return this.translateOnAxis(sb,t)}translateY(t){return this.translateOnAxis(ob,t)}translateZ(t){return this.translateOnAxis(ab,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Zr.copy(this.matrixWorld).invert())}lookAt(t,n,r){t.isVector3?rf.copy(t):rf.set(t,n,r);let s=this.parent;this.updateWorldMatrix(!0,!1),xu.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Zr.lookAt(xu,rf,this.up):Zr.lookAt(rf,xu,this.up),this.quaternion.setFromRotationMatrix(Zr),s&&(Zr.extractRotation(s.matrixWorld),Qa.setFromRotationMatrix(Zr),this.quaternion.premultiply(Qa.invert()))}add(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(cb),ec.child=t,this.dispatchEvent(ec),ec.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}let n=this.children.indexOf(t);return n!==-1&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(h6),Ug.child=t,this.dispatchEvent(Ug),Ug.child=null),this}removeFromParent(){let t=this.parent;return t!==null&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),Zr.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),Zr.multiply(t.parent.matrixWorld)),t.applyMatrix4(Zr),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(cb),ec.child=t,this.dispatchEvent(ec),ec.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,n){if(this[t]===n)return this;for(let r=0,s=this.children.length;r<s;r++){let a=this.children[r].getObjectByProperty(t,n);if(a!==void 0)return a}}getObjectsByProperty(t,n,r=[]){this[t]===n&&r.push(this);let s=this.children;for(let o=0,a=s.length;o<a;o++)s[o].getObjectsByProperty(t,n,r);return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(xu,t,l6),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(xu,u6,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);let n=this.matrixWorld.elements;return t.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(t){t(this);let n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);let n=this.children;for(let r=0,s=n.length;r<s;r++)n[r].traverseVisible(t)}traverseAncestors(t){let n=this.parent;n!==null&&(t(n),n.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);let n=this.children;for(let r=0,s=n.length;r<s;r++){let o=n[r];(o.matrixWorldAutoUpdate===!0||t===!0)&&o.updateMatrixWorld(t)}}updateWorldMatrix(t,n){let r=this.parent;if(t===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),n===!0){let s=this.children;for(let o=0,a=s.length;o<a;o++){let c=s[o];c.matrixWorldAutoUpdate===!0&&c.updateWorldMatrix(!1,!0)}}}toJSON(t){let n=t===void 0||typeof t=="string",r={};n&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});let s={};s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.castShadow===!0&&(s.castShadow=!0),this.receiveShadow===!0&&(s.receiveShadow=!0),this.visible===!1&&(s.visible=!1),this.frustumCulled===!1&&(s.frustumCulled=!1),this.renderOrder!==0&&(s.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(s.userData=this.userData),s.layers=this.layers.mask,s.matrix=this.matrix.toArray(),s.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(s.matrixAutoUpdate=!1),this.isInstancedMesh&&(s.type="InstancedMesh",s.count=this.count,s.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(s.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(s.type="BatchedMesh",s.perObjectFrustumCulled=this.perObjectFrustumCulled,s.sortObjects=this.sortObjects,s.drawRanges=this._drawRanges,s.reservedRanges=this._reservedRanges,s.visibility=this._visibility,s.active=this._active,s.bounds=this._bounds.map(c=>({boxInitialized:c.boxInitialized,boxMin:c.box.min.toArray(),boxMax:c.box.max.toArray(),sphereInitialized:c.sphereInitialized,sphereRadius:c.sphere.radius,sphereCenter:c.sphere.center.toArray()})),s.maxGeometryCount=this._maxGeometryCount,s.maxVertexCount=this._maxVertexCount,s.maxIndexCount=this._maxIndexCount,s.geometryInitialized=this._geometryInitialized,s.geometryCount=this._geometryCount,s.matricesTexture=this._matricesTexture.toJSON(t),this.boundingSphere!==null&&(s.boundingSphere={center:s.boundingSphere.center.toArray(),radius:s.boundingSphere.radius}),this.boundingBox!==null&&(s.boundingBox={min:s.boundingBox.min.toArray(),max:s.boundingBox.max.toArray()}));function o(c,l){return c[l.uuid]===void 0&&(c[l.uuid]=l.toJSON(t)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?s.background=this.background.toJSON():this.background.isTexture&&(s.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(s.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){s.geometry=o(t.geometries,this.geometry);let c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){let l=c.shapes;if(Array.isArray(l))for(let u=0,h=l.length;u<h;u++){let d=l[u];o(t.shapes,d)}else o(t.shapes,l)}}if(this.isSkinnedMesh&&(s.bindMode=this.bindMode,s.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(o(t.skeletons,this.skeleton),s.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let c=[];for(let l=0,u=this.material.length;l<u;l++)c.push(o(t.materials,this.material[l]));s.material=c}else s.material=o(t.materials,this.material);if(this.children.length>0){s.children=[];for(let c=0;c<this.children.length;c++)s.children.push(this.children[c].toJSON(t).object)}if(this.animations.length>0){s.animations=[];for(let c=0;c<this.animations.length;c++){let l=this.animations[c];s.animations.push(o(t.animations,l))}}if(n){let c=a(t.geometries),l=a(t.materials),u=a(t.textures),h=a(t.images),d=a(t.shapes),f=a(t.skeletons),x=a(t.animations),g=a(t.nodes);c.length>0&&(r.geometries=c),l.length>0&&(r.materials=l),u.length>0&&(r.textures=u),h.length>0&&(r.images=h),d.length>0&&(r.shapes=d),f.length>0&&(r.skeletons=f),x.length>0&&(r.animations=x),g.length>0&&(r.nodes=g)}return r.object=s,r;function a(c){let l=[];for(let u in c){let h=c[u];delete h.metadata,l.push(h)}return l}}clone(t){return new this.constructor().copy(this,t)}copy(t,n=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),n===!0)for(let r=0;r<t.children.length;r++){let s=t.children[r];this.add(s.clone())}return this}}return i.DEFAULT_UP=new k(0,1,0),i.DEFAULT_MATRIX_AUTO_UPDATE=!0,i.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,i})(),Qi=new k,Kr=new k,Vg=new k,Jr=new k,tc=new k,nc=new k,lb=new k,zg=new k,Hg=new k,jg=new k,hc=class i{constructor(e=new k,t=new k,n=new k){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),Qi.subVectors(e,t),r.cross(Qi);let s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){Qi.subVectors(r,t),Kr.subVectors(n,t),Vg.subVectors(e,t);let o=Qi.dot(Qi),a=Qi.dot(Kr),c=Qi.dot(Vg),l=Kr.dot(Kr),u=Kr.dot(Vg),h=o*l-a*a;if(h===0)return s.set(0,0,0),null;let d=1/h,f=(l*c-a*u)*d,x=(o*u-a*c)*d;return s.set(1-f-x,x,f)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,Jr)===null?!1:Jr.x>=0&&Jr.y>=0&&Jr.x+Jr.y<=1}static getInterpolation(e,t,n,r,s,o,a,c){return this.getBarycoord(e,t,n,r,Jr)===null?(c.x=0,c.y=0,"z"in c&&(c.z=0),"w"in c&&(c.w=0),null):(c.setScalar(0),c.addScaledVector(s,Jr.x),c.addScaledVector(o,Jr.y),c.addScaledVector(a,Jr.z),c)}static isFrontFacing(e,t,n,r){return Qi.subVectors(n,t),Kr.subVectors(e,t),Qi.cross(Kr).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Qi.subVectors(this.c,this.b),Kr.subVectors(this.a,this.b),Qi.cross(Kr).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return i.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return i.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,s){return i.getInterpolation(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return i.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return i.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let n=this.a,r=this.b,s=this.c,o,a;tc.subVectors(r,n),nc.subVectors(s,n),zg.subVectors(e,n);let c=tc.dot(zg),l=nc.dot(zg);if(c<=0&&l<=0)return t.copy(n);Hg.subVectors(e,r);let u=tc.dot(Hg),h=nc.dot(Hg);if(u>=0&&h<=u)return t.copy(r);let d=c*h-u*l;if(d<=0&&c>=0&&u<=0)return o=c/(c-u),t.copy(n).addScaledVector(tc,o);jg.subVectors(e,s);let f=tc.dot(jg),x=nc.dot(jg);if(x>=0&&f<=x)return t.copy(s);let g=f*l-c*x;if(g<=0&&l>=0&&x<=0)return a=l/(l-x),t.copy(n).addScaledVector(nc,a);let p=u*x-f*h;if(p<=0&&h-u>=0&&f-x>=0)return lb.subVectors(s,r),a=(h-u)/(h-u+(f-x)),t.copy(r).addScaledVector(lb,a);let m=1/(p+g+d);return o=g*m,a=d*m,t.copy(n).addScaledVector(tc,o).addScaledVector(nc,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},aD={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Bs={h:0,s:0,l:0},sf={h:0,s:0,l:0};function Gg(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}var Ge=class{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){let r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Di){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Ot.toWorkingColorSpace(this,t),this}setRGB(e,t,n,r=Ot.workingColorSpace){return this.r=e,this.g=t,this.b=n,Ot.toWorkingColorSpace(this,r),this}setHSL(e,t,n,r=Ot.workingColorSpace){if(e=Wv(e,1),t=Bn(t,0,1),n=Bn(n,0,1),t===0)this.r=this.g=this.b=n;else{let s=n<=.5?n*(1+t):n+t-n*t,o=2*n-s;this.r=Gg(o,s,e+1/3),this.g=Gg(o,s,e),this.b=Gg(o,s,e-1/3)}return Ot.toWorkingColorSpace(this,r),this}setStyle(e,t=Di){function n(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s,o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return n(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){let s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Di){let n=aD[e.toLowerCase()];return n!==void 0?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=xc(e.r),this.g=xc(e.g),this.b=xc(e.b),this}copyLinearToSRGB(e){return this.r=Bg(e.r),this.g=Bg(e.g),this.b=Bg(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Di){return Ot.fromWorkingColorSpace(Vn.copy(this),e),Math.round(Bn(Vn.r*255,0,255))*65536+Math.round(Bn(Vn.g*255,0,255))*256+Math.round(Bn(Vn.b*255,0,255))}getHexString(e=Di){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Ot.workingColorSpace){Ot.fromWorkingColorSpace(Vn.copy(this),t);let n=Vn.r,r=Vn.g,s=Vn.b,o=Math.max(n,r,s),a=Math.min(n,r,s),c,l,u=(a+o)/2;if(a===o)c=0,l=0;else{let h=o-a;switch(l=u<=.5?h/(o+a):h/(2-o-a),o){case n:c=(r-s)/h+(r<s?6:0);break;case r:c=(s-n)/h+2;break;case s:c=(n-r)/h+4;break}c/=6}return e.h=c,e.s=l,e.l=u,e}getRGB(e,t=Ot.workingColorSpace){return Ot.fromWorkingColorSpace(Vn.copy(this),t),e.r=Vn.r,e.g=Vn.g,e.b=Vn.b,e}getStyle(e=Di){Ot.fromWorkingColorSpace(Vn.copy(this),e);let t=Vn.r,n=Vn.g,r=Vn.b;return e!==Di?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){return this.getHSL(Bs),this.setHSL(Bs.h+e,Bs.s+t,Bs.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Bs),e.getHSL(sf);let n=Cu(Bs.h,sf.h,t),r=Cu(Bs.s,sf.s,t),s=Cu(Bs.l,sf.l,t);return this.setHSL(n,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){let t=this.r,n=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*n+s[6]*r,this.g=s[1]*t+s[4]*n+s[7]*r,this.b=s[2]*t+s[5]*n+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}},Vn=new Ge;Ge.NAMES=aD;var d6=0,Fi=class extends Tr{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:d6++}),this.uuid=Sc(),this.name="",this.type="Material",this.blending=fc,this.side=Mr,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=iv,this.blendDst=rv,this.blendEquation=Vo,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Ge(0,0,0),this.blendAlpha=0,this.depthFunc=Af,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=qw,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Xa,this.stencilZFail=Xa,this.stencilZPass=Xa,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let n=e[t];if(n===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}let r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==fc&&(n.blending=this.blending),this.side!==Mr&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==iv&&(n.blendSrc=this.blendSrc),this.blendDst!==rv&&(n.blendDst=this.blendDst),this.blendEquation!==Vo&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==Af&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==qw&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Xa&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Xa&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Xa&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(s){let o=[];for(let a in s){let c=s[a];delete c.metadata,o.push(c)}return o}if(t){let s=r(e.textures),o=r(e.images);s.length>0&&(n.textures=s),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,n=null;if(t!==null){let r=t.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},If=class extends Fi{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ge(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Go,this.combine=jv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}};var pn=new k,of=new We,Mi=class{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=Yw,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=Rs,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return t6("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)of.fromBufferAttribute(this,t),of.applyMatrix3(e),this.setXY(t,of.x,of.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)pn.fromBufferAttribute(this,t),pn.applyMatrix3(e),this.setXYZ(t,pn.x,pn.y,pn.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)pn.fromBufferAttribute(this,t),pn.applyMatrix4(e),this.setXYZ(t,pn.x,pn.y,pn.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)pn.fromBufferAttribute(this,t),pn.applyNormalMatrix(e),this.setXYZ(t,pn.x,pn.y,pn.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)pn.fromBufferAttribute(this,t),pn.transformDirection(e),this.setXYZ(t,pn.x,pn.y,pn.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=uc(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=Yn(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=uc(t,this.array)),t}setX(e,t){return this.normalized&&(t=Yn(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=uc(t,this.array)),t}setY(e,t){return this.normalized&&(t=Yn(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=uc(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Yn(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=uc(t,this.array)),t}setW(e,t){return this.normalized&&(t=Yn(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=Yn(t,this.array),n=Yn(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=Yn(t,this.array),n=Yn(n,this.array),r=Yn(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=Yn(t,this.array),n=Yn(n,this.array),r=Yn(r,this.array),s=Yn(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Yw&&(e.usage=this.usage),e}};var Pf=class extends Mi{constructor(e,t,n){super(new Uint16Array(e),t,n)}};var Rf=class extends Mi{constructor(e,t,n){super(new Uint32Array(e),t,n)}};var xn=class extends Mi{constructor(e,t,n){super(new Float32Array(e),t,n)}},f6=0,bi=new qe,Wg=new nr,ic=new k,pi=new ss,mu=new ss,wn=new k,bn=class i extends Tr{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:f6++}),this.uuid=Sc(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(oD(e)?Rf:Pf)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let n=this.attributes.normal;if(n!==void 0){let s=new st().getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}let r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return bi.makeRotationFromQuaternion(e),this.applyMatrix4(bi),this}rotateX(e){return bi.makeRotationX(e),this.applyMatrix4(bi),this}rotateY(e){return bi.makeRotationY(e),this.applyMatrix4(bi),this}rotateZ(e){return bi.makeRotationZ(e),this.applyMatrix4(bi),this}translate(e,t,n){return bi.makeTranslation(e,t,n),this.applyMatrix4(bi),this}scale(e,t,n){return bi.makeScale(e,t,n),this.applyMatrix4(bi),this}lookAt(e){return Wg.lookAt(e),Wg.updateMatrix(),this.applyMatrix4(Wg.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(ic).negate(),this.translate(ic.x,ic.y,ic.z),this}setFromPoints(e){let t=[];for(let n=0,r=e.length;n<r;n++){let s=e[n];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new xn(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ss);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new k(-1/0,-1/0,-1/0),new k(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){let s=t[n];pi.setFromBufferAttribute(s),this.morphTargetsRelative?(wn.addVectors(this.boundingBox.min,pi.min),this.boundingBox.expandByPoint(wn),wn.addVectors(this.boundingBox.max,pi.max),this.boundingBox.expandByPoint(wn)):(this.boundingBox.expandByPoint(pi.min),this.boundingBox.expandByPoint(pi.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new os);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new k,1/0);return}if(e){let n=this.boundingSphere.center;if(pi.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){let a=t[s];mu.setFromBufferAttribute(a),this.morphTargetsRelative?(wn.addVectors(pi.min,mu.min),pi.expandByPoint(wn),wn.addVectors(pi.max,mu.max),pi.expandByPoint(wn)):(pi.expandByPoint(mu.min),pi.expandByPoint(mu.max))}pi.getCenter(n);let r=0;for(let s=0,o=e.count;s<o;s++)wn.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(wn));if(t)for(let s=0,o=t.length;s<o;s++){let a=t[s],c=this.morphTargetsRelative;for(let l=0,u=a.count;l<u;l++)wn.fromBufferAttribute(a,l),c&&(ic.fromBufferAttribute(e,l),wn.add(ic)),r=Math.max(r,n.distanceToSquared(wn))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let n=t.position,r=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Mi(new Float32Array(4*n.count),4));let o=this.getAttribute("tangent"),a=[],c=[];for(let D=0;D<n.count;D++)a[D]=new k,c[D]=new k;let l=new k,u=new k,h=new k,d=new We,f=new We,x=new We,g=new k,p=new k;function m(D,C,_){l.fromBufferAttribute(n,D),u.fromBufferAttribute(n,C),h.fromBufferAttribute(n,_),d.fromBufferAttribute(s,D),f.fromBufferAttribute(s,C),x.fromBufferAttribute(s,_),u.sub(l),h.sub(l),f.sub(d),x.sub(d);let M=1/(f.x*x.y-x.x*f.y);isFinite(M)&&(g.copy(u).multiplyScalar(x.y).addScaledVector(h,-f.y).multiplyScalar(M),p.copy(h).multiplyScalar(f.x).addScaledVector(u,-x.x).multiplyScalar(M),a[D].add(g),a[C].add(g),a[_].add(g),c[D].add(p),c[C].add(p),c[_].add(p))}let v=this.groups;v.length===0&&(v=[{start:0,count:e.count}]);for(let D=0,C=v.length;D<C;++D){let _=v[D],M=_.start,B=_.count;for(let F=M,N=M+B;F<N;F+=3)m(e.getX(F+0),e.getX(F+1),e.getX(F+2))}let E=new k,y=new k,w=new k,A=new k;function b(D){w.fromBufferAttribute(r,D),A.copy(w);let C=a[D];E.copy(C),E.sub(w.multiplyScalar(w.dot(C))).normalize(),y.crossVectors(A,C);let M=y.dot(c[D])<0?-1:1;o.setXYZW(D,E.x,E.y,E.z,M)}for(let D=0,C=v.length;D<C;++D){let _=v[D],M=_.start,B=_.count;for(let F=M,N=M+B;F<N;F+=3)b(e.getX(F+0)),b(e.getX(F+1)),b(e.getX(F+2))}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Mi(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let d=0,f=n.count;d<f;d++)n.setXYZ(d,0,0,0);let r=new k,s=new k,o=new k,a=new k,c=new k,l=new k,u=new k,h=new k;if(e)for(let d=0,f=e.count;d<f;d+=3){let x=e.getX(d+0),g=e.getX(d+1),p=e.getX(d+2);r.fromBufferAttribute(t,x),s.fromBufferAttribute(t,g),o.fromBufferAttribute(t,p),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),a.fromBufferAttribute(n,x),c.fromBufferAttribute(n,g),l.fromBufferAttribute(n,p),a.add(u),c.add(u),l.add(u),n.setXYZ(x,a.x,a.y,a.z),n.setXYZ(g,c.x,c.y,c.z),n.setXYZ(p,l.x,l.y,l.z)}else for(let d=0,f=t.count;d<f;d+=3)r.fromBufferAttribute(t,d+0),s.fromBufferAttribute(t,d+1),o.fromBufferAttribute(t,d+2),u.subVectors(o,s),h.subVectors(r,s),u.cross(h),n.setXYZ(d+0,u.x,u.y,u.z),n.setXYZ(d+1,u.x,u.y,u.z),n.setXYZ(d+2,u.x,u.y,u.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)wn.fromBufferAttribute(e,t),wn.normalize(),e.setXYZ(t,wn.x,wn.y,wn.z)}toNonIndexed(){function e(a,c){let l=a.array,u=a.itemSize,h=a.normalized,d=new l.constructor(c.length*u),f=0,x=0;for(let g=0,p=c.length;g<p;g++){a.isInterleavedBufferAttribute?f=c[g]*a.data.stride+a.offset:f=c[g]*u;for(let m=0;m<u;m++)d[x++]=l[f++]}return new Mi(d,u,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new i,n=this.index.array,r=this.attributes;for(let a in r){let c=r[a],l=e(c,n);t.setAttribute(a,l)}let s=this.morphAttributes;for(let a in s){let c=[],l=s[a];for(let u=0,h=l.length;u<h;u++){let d=l[u],f=e(d,n);c.push(f)}t.morphAttributes[a]=c}t.morphTargetsRelative=this.morphTargetsRelative;let o=this.groups;for(let a=0,c=o.length;a<c;a++){let l=o[a];t.addGroup(l.start,l.count,l.materialIndex)}return t}toJSON(){let e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let c=this.parameters;for(let l in c)c[l]!==void 0&&(e[l]=c[l]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let n=this.attributes;for(let c in n){let l=n[c];e.data.attributes[c]=l.toJSON(e.data)}let r={},s=!1;for(let c in this.morphAttributes){let l=this.morphAttributes[c],u=[];for(let h=0,d=l.length;h<d;h++){let f=l[h];u.push(f.toJSON(e.data))}u.length>0&&(r[c]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);let o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));let a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let n=e.index;n!==null&&this.setIndex(n.clone(t));let r=e.attributes;for(let l in r){let u=r[l];this.setAttribute(l,u.clone(t))}let s=e.morphAttributes;for(let l in s){let u=[],h=s[l];for(let d=0,f=h.length;d<f;d++)u.push(h[d].clone(t));this.morphAttributes[l]=u}this.morphTargetsRelative=e.morphTargetsRelative;let o=e.groups;for(let l=0,u=o.length;l<u;l++){let h=o[l];this.addGroup(h.start,h.count,h.materialIndex)}let a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());let c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}},ub=new qe,Oo=new yc,af=new os,hb=new k,rc=new k,sc=new k,oc=new k,$g=new k,cf=new k,lf=new We,uf=new We,hf=new We,db=new k,fb=new k,pb=new k,df=new k,ff=new k,ii=class extends nr{constructor(e=new bn,t=new If){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){let t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){let r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){let a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){let n=this.geometry,r=n.attributes.position,s=n.morphAttributes.position,o=n.morphTargetsRelative;t.fromBufferAttribute(r,e);let a=this.morphTargetInfluences;if(s&&a){cf.set(0,0,0);for(let c=0,l=s.length;c<l;c++){let u=a[c],h=s[c];u!==0&&($g.fromBufferAttribute(h,e),o?cf.addScaledVector($g,u):cf.addScaledVector($g.sub(t),u))}t.add(cf)}return t}raycast(e,t){let n=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),af.copy(n.boundingSphere),af.applyMatrix4(s),Oo.copy(e.ray).recast(e.near),!(af.containsPoint(Oo.origin)===!1&&(Oo.intersectSphere(af,hb)===null||Oo.origin.distanceToSquared(hb)>(e.far-e.near)**2))&&(ub.copy(s).invert(),Oo.copy(e.ray).applyMatrix4(ub),!(n.boundingBox!==null&&Oo.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,Oo)))}_computeIntersections(e,t,n){let r,s=this.geometry,o=this.material,a=s.index,c=s.attributes.position,l=s.attributes.uv,u=s.attributes.uv1,h=s.attributes.normal,d=s.groups,f=s.drawRange;if(a!==null)if(Array.isArray(o))for(let x=0,g=d.length;x<g;x++){let p=d[x],m=o[p.materialIndex],v=Math.max(p.start,f.start),E=Math.min(a.count,Math.min(p.start+p.count,f.start+f.count));for(let y=v,w=E;y<w;y+=3){let A=a.getX(y),b=a.getX(y+1),D=a.getX(y+2);r=pf(this,m,e,n,l,u,h,A,b,D),r&&(r.faceIndex=Math.floor(y/3),r.face.materialIndex=p.materialIndex,t.push(r))}}else{let x=Math.max(0,f.start),g=Math.min(a.count,f.start+f.count);for(let p=x,m=g;p<m;p+=3){let v=a.getX(p),E=a.getX(p+1),y=a.getX(p+2);r=pf(this,o,e,n,l,u,h,v,E,y),r&&(r.faceIndex=Math.floor(p/3),t.push(r))}}else if(c!==void 0)if(Array.isArray(o))for(let x=0,g=d.length;x<g;x++){let p=d[x],m=o[p.materialIndex],v=Math.max(p.start,f.start),E=Math.min(c.count,Math.min(p.start+p.count,f.start+f.count));for(let y=v,w=E;y<w;y+=3){let A=y,b=y+1,D=y+2;r=pf(this,m,e,n,l,u,h,A,b,D),r&&(r.faceIndex=Math.floor(y/3),r.face.materialIndex=p.materialIndex,t.push(r))}}else{let x=Math.max(0,f.start),g=Math.min(c.count,f.start+f.count);for(let p=x,m=g;p<m;p+=3){let v=p,E=p+1,y=p+2;r=pf(this,o,e,n,l,u,h,v,E,y),r&&(r.faceIndex=Math.floor(p/3),t.push(r))}}}};function p6(i,e,t,n,r,s,o,a){let c;if(e.side===ri?c=n.intersectTriangle(o,s,r,!0,a):c=n.intersectTriangle(r,s,o,e.side===Mr,a),c===null)return null;ff.copy(a),ff.applyMatrix4(i.matrixWorld);let l=t.ray.origin.distanceTo(ff);return l<t.near||l>t.far?null:{distance:l,point:ff.clone(),object:i}}function pf(i,e,t,n,r,s,o,a,c,l){i.getVertexPosition(a,rc),i.getVertexPosition(c,sc),i.getVertexPosition(l,oc);let u=p6(i,e,t,n,rc,sc,oc,df);if(u){r&&(lf.fromBufferAttribute(r,a),uf.fromBufferAttribute(r,c),hf.fromBufferAttribute(r,l),u.uv=hc.getInterpolation(df,rc,sc,oc,lf,uf,hf,new We)),s&&(lf.fromBufferAttribute(s,a),uf.fromBufferAttribute(s,c),hf.fromBufferAttribute(s,l),u.uv1=hc.getInterpolation(df,rc,sc,oc,lf,uf,hf,new We)),o&&(db.fromBufferAttribute(o,a),fb.fromBufferAttribute(o,c),pb.fromBufferAttribute(o,l),u.normal=hc.getInterpolation(df,rc,sc,oc,db,fb,pb,new k),u.normal.dot(n.direction)>0&&u.normal.multiplyScalar(-1));let h={a,b:c,c:l,normal:new k,materialIndex:0};hc.getNormal(rc,sc,oc,h.normal),u.face=h}return u}var Mu=class i extends bn{constructor(e=1,t=1,n=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:s,depthSegments:o};let a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);let c=[],l=[],u=[],h=[],d=0,f=0;x("z","y","x",-1,-1,n,t,e,o,s,0),x("z","y","x",1,-1,n,t,-e,o,s,1),x("x","z","y",1,1,e,n,t,r,o,2),x("x","z","y",1,-1,e,n,-t,r,o,3),x("x","y","z",1,-1,e,t,n,r,s,4),x("x","y","z",-1,-1,e,t,-n,r,s,5),this.setIndex(c),this.setAttribute("position",new xn(l,3)),this.setAttribute("normal",new xn(u,3)),this.setAttribute("uv",new xn(h,2));function x(g,p,m,v,E,y,w,A,b,D,C){let _=y/b,M=w/D,B=y/2,F=w/2,N=A/2,L=b+1,Z=D+1,Q=0,j=0,W=new k;for(let ie=0;ie<Z;ie++){let ue=ie*M-F;for(let de=0;de<L;de++){let $e=de*_-B;W[g]=$e*v,W[p]=ue*E,W[m]=N,l.push(W.x,W.y,W.z),W[g]=0,W[p]=0,W[m]=A>0?1:-1,u.push(W.x,W.y,W.z),h.push(de/b),h.push(1-ie/D),Q+=1}}for(let ie=0;ie<D;ie++)for(let ue=0;ue<b;ue++){let de=d+ue+L*ie,$e=d+ue+L*(ie+1),X=d+(ue+1)+L*(ie+1),O=d+(ue+1)+L*ie;c.push(de,$e,O),c.push($e,X,O),j+=6}a.addGroup(f,j,C),f+=j,d+=Q}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function Cc(i){let e={};for(let t in i){e[t]={};for(let n in i[t]){let r=i[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}function Zn(i){let e={};for(let t=0;t<i.length;t++){let n=Cc(i[t]);for(let r in n)e[r]=n[r]}return e}function x6(i){let e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}function cD(i){let e=i.getRenderTarget();return e===null?i.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Ot.workingColorSpace}var m6={clone:Cc,merge:Zn},g6=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,v6=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,Fr=class extends Fi{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=g6,this.fragmentShader=v6,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Cc(e.uniforms),this.uniformsGroups=x6(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let r in this.uniforms){let o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;let n={};for(let r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}},Of=class extends nr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new qe,this.projectionMatrix=new qe,this.projectionMatrixInverse=new qe,this.coordinateSystem=is}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},Is=new k,xb=new We,mb=new We,zn=class extends Of{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=bu*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(yu*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return bu*2*Math.atan(Math.tan(yu*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){Is.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Is.x,Is.y).multiplyScalar(-e/Is.z),Is.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Is.x,Is.y).multiplyScalar(-e/Is.z)}getViewSize(e,t){return this.getViewBounds(e,xb,mb),t.subVectors(mb,xb)}setViewOffset(e,t,n,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(yu*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,s=-.5*r,o=this.view;if(this.view!==null&&this.view.enabled){let c=o.fullWidth,l=o.fullHeight;s+=o.offsetX*r/c,t-=o.offsetY*n/l,r*=o.width/c,n*=o.height/l}let a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},ac=-90,cc=1,hv=class extends nr{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;let r=new zn(ac,cc,e,t);r.layers=this.layers,this.add(r);let s=new zn(ac,cc,e,t);s.layers=this.layers,this.add(s);let o=new zn(ac,cc,e,t);o.layers=this.layers,this.add(o);let a=new zn(ac,cc,e,t);a.layers=this.layers,this.add(a);let c=new zn(ac,cc,e,t);c.layers=this.layers,this.add(c);let l=new zn(ac,cc,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){let e=this.coordinateSystem,t=this.children.concat(),[n,r,s,o,a,c]=t;for(let l of t)this.remove(l);if(e===is)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),c.up.set(0,1,0),c.lookAt(0,0,-1);else if(e===Tf)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),c.up.set(0,-1,0),c.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(let l of t)this.add(l),l.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();let{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());let[s,o,a,c,l,u]=this.children,h=e.getRenderTarget(),d=e.getActiveCubeFace(),f=e.getActiveMipmapLevel(),x=e.xr.enabled;e.xr.enabled=!1;let g=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,s),e.setRenderTarget(n,1,r),e.render(t,o),e.setRenderTarget(n,2,r),e.render(t,a),e.setRenderTarget(n,3,r),e.render(t,c),e.setRenderTarget(n,4,r),e.render(t,l),n.texture.generateMipmaps=g,e.setRenderTarget(n,5,r),e.render(t,u),e.setRenderTarget(h,d,f),e.xr.enabled=x,n.texture.needsPMREMUpdate=!0}},kf=class extends Vs{constructor(e,t,n,r,s,o,a,c,l,u){e=e!==void 0?e:[],t=t!==void 0?t:gc,super(e,t,n,r,s,o,a,c,l,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},dv=class extends rs{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new kf(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:er}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new Mu(5,5,5),s=new Fr({name:"CubemapFromEquirect",uniforms:Cc(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:ri,blending:Os});s.uniforms.tEquirect.value=t;let o=new ii(r,s),a=t.minFilter;return t.minFilter===jo&&(t.minFilter=er),new hv(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,n,r){let s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,n,r);e.setRenderTarget(s)}},Xg=new k,E6=new k,y6=new st,ts=class{constructor(e=new k(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){let r=Xg.subVectors(n,t).cross(E6.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){let n=e.delta(Xg),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(n,s)}intersectsLine(e){let t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let n=t||y6.getNormalMatrix(e),r=this.coplanarPoint(Xg).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},ko=new os,xf=new k,Tu=class{constructor(e=new ts,t=new ts,n=new ts,r=new ts,s=new ts,o=new ts){this.planes=[e,t,n,r,s,o]}set(e,t,n,r,s,o){let a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){let t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=is){let n=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],c=r[3],l=r[4],u=r[5],h=r[6],d=r[7],f=r[8],x=r[9],g=r[10],p=r[11],m=r[12],v=r[13],E=r[14],y=r[15];if(n[0].setComponents(c-s,d-l,p-f,y-m).normalize(),n[1].setComponents(c+s,d+l,p+f,y+m).normalize(),n[2].setComponents(c+o,d+u,p+x,y+v).normalize(),n[3].setComponents(c-o,d-u,p-x,y-v).normalize(),n[4].setComponents(c-a,d-h,p-g,y-E).normalize(),t===is)n[5].setComponents(c+a,d+h,p+g,y+E).normalize();else if(t===Tf)n[5].setComponents(a,h,g,E).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),ko.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{let t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),ko.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(ko)}intersectsSprite(e){return ko.center.set(0,0,0),ko.radius=.7071067811865476,ko.applyMatrix4(e.matrixWorld),this.intersectsSphere(ko)}intersectsSphere(e){let t=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){let t=this.planes;for(let n=0;n<6;n++){let r=t[n];if(xf.x=r.normal.x>0?e.max.x:e.min.x,xf.y=r.normal.y>0?e.max.y:e.min.y,xf.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(xf)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function lD(){let i=null,e=!1,t=null,n=null;function r(s,o){t(s,o),n=i.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(n=i.requestAnimationFrame(r),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){i=s}}}function C6(i){let e=new WeakMap;function t(a,c){let l=a.array,u=a.usage,h=l.byteLength,d=i.createBuffer();i.bindBuffer(c,d),i.bufferData(c,l,u),a.onUploadCallback();let f;if(l instanceof Float32Array)f=i.FLOAT;else if(l instanceof Uint16Array)a.isFloat16BufferAttribute?f=i.HALF_FLOAT:f=i.UNSIGNED_SHORT;else if(l instanceof Int16Array)f=i.SHORT;else if(l instanceof Uint32Array)f=i.UNSIGNED_INT;else if(l instanceof Int32Array)f=i.INT;else if(l instanceof Int8Array)f=i.BYTE;else if(l instanceof Uint8Array)f=i.UNSIGNED_BYTE;else if(l instanceof Uint8ClampedArray)f=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+l);return{buffer:d,type:f,bytesPerElement:l.BYTES_PER_ELEMENT,version:a.version,size:h}}function n(a,c,l){let u=c.array,h=c._updateRange,d=c.updateRanges;if(i.bindBuffer(l,a),h.count===-1&&d.length===0&&i.bufferSubData(l,0,u),d.length!==0){for(let f=0,x=d.length;f<x;f++){let g=d[f];i.bufferSubData(l,g.start*u.BYTES_PER_ELEMENT,u,g.start,g.count)}c.clearUpdateRanges()}h.count!==-1&&(i.bufferSubData(l,h.offset*u.BYTES_PER_ELEMENT,u,h.offset,h.count),h.count=-1),c.onUploadCallback()}function r(a){return a.isInterleavedBufferAttribute&&(a=a.data),e.get(a)}function s(a){a.isInterleavedBufferAttribute&&(a=a.data);let c=e.get(a);c&&(i.deleteBuffer(c.buffer),e.delete(a))}function o(a,c){if(a.isGLBufferAttribute){let u=e.get(a);(!u||u.version<a.version)&&e.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version});return}a.isInterleavedBufferAttribute&&(a=a.data);let l=e.get(a);if(l===void 0)e.set(a,t(a,c));else if(l.version<a.version){if(l.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(l.buffer,a,c),l.version=a.version}}return{get:r,remove:s,update:o}}var Nf=class i extends bn{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};let s=e/2,o=t/2,a=Math.floor(n),c=Math.floor(r),l=a+1,u=c+1,h=e/a,d=t/c,f=[],x=[],g=[],p=[];for(let m=0;m<u;m++){let v=m*d-o;for(let E=0;E<l;E++){let y=E*h-s;x.push(y,-v,0),g.push(0,0,1),p.push(E/a),p.push(1-m/c)}}for(let m=0;m<c;m++)for(let v=0;v<a;v++){let E=v+l*m,y=v+l*(m+1),w=v+1+l*(m+1),A=v+1+l*m;f.push(E,y,A),f.push(y,w,A)}this.setIndex(f),this.setAttribute("position",new xn(x,3)),this.setAttribute("normal",new xn(g,3)),this.setAttribute("uv",new xn(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i(e.width,e.height,e.widthSegments,e.heightSegments)}},_6=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,A6=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,w6=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,b6=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,D6=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,S6=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,M6=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,T6=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,F6=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,B6=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,I6=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,P6=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,R6=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,O6=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,k6=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,N6=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,L6=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,U6=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,V6=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,z6=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,H6=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,j6=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,G6=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,W6=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,$6=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,X6=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,q6=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Y6=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,Z6=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,K6=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,J6="gl_FragColor = linearToOutputTexel( gl_FragColor );",Q6=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,eR=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,tR=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,nR=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,iR=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,rR=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,sR=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,oR=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,aR=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,cR=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,lR=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,uR=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,hR=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,dR=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,fR=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,pR=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,xR=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,mR=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,gR=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,vR=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,ER=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,yR=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,CR=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,_R=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,AR=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,wR=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,bR=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,DR=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,SR=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,MR=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,TR=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,FR=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,BR=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,IR=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,PR=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,RR=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[MORPHTARGETS_COUNT];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,OR=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,kR=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,NR=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
	#endif
	#ifdef MORPHTARGETS_TEXTURE
		#ifndef USE_INSTANCING_MORPH
			uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		#endif
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,LR=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,UR=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,VR=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,zR=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,HR=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,jR=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,GR=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,WR=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,$R=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,XR=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,qR=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,YR=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,ZR=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,KR=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,JR=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,QR=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,e4=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,t4=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,n4=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,i4=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return shadow;
	}
#endif`,r4=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,s4=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,o4=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,a4=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,c4=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,l4=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,u4=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,h4=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,d4=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,f4=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,p4=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,x4=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,m4=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,g4=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,v4=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,E4=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,y4=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,C4=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,_4=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,A4=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,w4=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,b4=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,D4=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,S4=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,M4=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,T4=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,F4=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,B4=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,I4=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,P4=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,R4=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,O4=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,k4=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,N4=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,L4=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,U4=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,V4=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,z4=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,H4=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,j4=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,G4=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,W4=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,$4=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,X4=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,q4=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Y4=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Z4=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,K4=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,J4=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Q4=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,eO=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,rt={alphahash_fragment:_6,alphahash_pars_fragment:A6,alphamap_fragment:w6,alphamap_pars_fragment:b6,alphatest_fragment:D6,alphatest_pars_fragment:S6,aomap_fragment:M6,aomap_pars_fragment:T6,batching_pars_vertex:F6,batching_vertex:B6,begin_vertex:I6,beginnormal_vertex:P6,bsdfs:R6,iridescence_fragment:O6,bumpmap_pars_fragment:k6,clipping_planes_fragment:N6,clipping_planes_pars_fragment:L6,clipping_planes_pars_vertex:U6,clipping_planes_vertex:V6,color_fragment:z6,color_pars_fragment:H6,color_pars_vertex:j6,color_vertex:G6,common:W6,cube_uv_reflection_fragment:$6,defaultnormal_vertex:X6,displacementmap_pars_vertex:q6,displacementmap_vertex:Y6,emissivemap_fragment:Z6,emissivemap_pars_fragment:K6,colorspace_fragment:J6,colorspace_pars_fragment:Q6,envmap_fragment:eR,envmap_common_pars_fragment:tR,envmap_pars_fragment:nR,envmap_pars_vertex:iR,envmap_physical_pars_fragment:pR,envmap_vertex:rR,fog_vertex:sR,fog_pars_vertex:oR,fog_fragment:aR,fog_pars_fragment:cR,gradientmap_pars_fragment:lR,lightmap_pars_fragment:uR,lights_lambert_fragment:hR,lights_lambert_pars_fragment:dR,lights_pars_begin:fR,lights_toon_fragment:xR,lights_toon_pars_fragment:mR,lights_phong_fragment:gR,lights_phong_pars_fragment:vR,lights_physical_fragment:ER,lights_physical_pars_fragment:yR,lights_fragment_begin:CR,lights_fragment_maps:_R,lights_fragment_end:AR,logdepthbuf_fragment:wR,logdepthbuf_pars_fragment:bR,logdepthbuf_pars_vertex:DR,logdepthbuf_vertex:SR,map_fragment:MR,map_pars_fragment:TR,map_particle_fragment:FR,map_particle_pars_fragment:BR,metalnessmap_fragment:IR,metalnessmap_pars_fragment:PR,morphinstance_vertex:RR,morphcolor_vertex:OR,morphnormal_vertex:kR,morphtarget_pars_vertex:NR,morphtarget_vertex:LR,normal_fragment_begin:UR,normal_fragment_maps:VR,normal_pars_fragment:zR,normal_pars_vertex:HR,normal_vertex:jR,normalmap_pars_fragment:GR,clearcoat_normal_fragment_begin:WR,clearcoat_normal_fragment_maps:$R,clearcoat_pars_fragment:XR,iridescence_pars_fragment:qR,opaque_fragment:YR,packing:ZR,premultiplied_alpha_fragment:KR,project_vertex:JR,dithering_fragment:QR,dithering_pars_fragment:e4,roughnessmap_fragment:t4,roughnessmap_pars_fragment:n4,shadowmap_pars_fragment:i4,shadowmap_pars_vertex:r4,shadowmap_vertex:s4,shadowmask_pars_fragment:o4,skinbase_vertex:a4,skinning_pars_vertex:c4,skinning_vertex:l4,skinnormal_vertex:u4,specularmap_fragment:h4,specularmap_pars_fragment:d4,tonemapping_fragment:f4,tonemapping_pars_fragment:p4,transmission_fragment:x4,transmission_pars_fragment:m4,uv_pars_fragment:g4,uv_pars_vertex:v4,uv_vertex:E4,worldpos_vertex:y4,background_vert:C4,background_frag:_4,backgroundCube_vert:A4,backgroundCube_frag:w4,cube_vert:b4,cube_frag:D4,depth_vert:S4,depth_frag:M4,distanceRGBA_vert:T4,distanceRGBA_frag:F4,equirect_vert:B4,equirect_frag:I4,linedashed_vert:P4,linedashed_frag:R4,meshbasic_vert:O4,meshbasic_frag:k4,meshlambert_vert:N4,meshlambert_frag:L4,meshmatcap_vert:U4,meshmatcap_frag:V4,meshnormal_vert:z4,meshnormal_frag:H4,meshphong_vert:j4,meshphong_frag:G4,meshphysical_vert:W4,meshphysical_frag:$4,meshtoon_vert:X4,meshtoon_frag:q4,points_vert:Y4,points_frag:Z4,shadow_vert:K4,shadow_frag:J4,sprite_vert:Q4,sprite_frag:eO},xe={common:{diffuse:{value:new Ge(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new st},alphaMap:{value:null},alphaMapTransform:{value:new st},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new st}},envmap:{envMap:{value:null},envMapRotation:{value:new st},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new st}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new st}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new st},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new st},normalScale:{value:new We(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new st},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new st}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new st}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new st}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ge(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ge(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new st},alphaTest:{value:0},uvTransform:{value:new st}},sprite:{diffuse:{value:new Ge(16777215)},opacity:{value:1},center:{value:new We(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new st},alphaMap:{value:null},alphaMapTransform:{value:new st},alphaTest:{value:0}}},br={basic:{uniforms:Zn([xe.common,xe.specularmap,xe.envmap,xe.aomap,xe.lightmap,xe.fog]),vertexShader:rt.meshbasic_vert,fragmentShader:rt.meshbasic_frag},lambert:{uniforms:Zn([xe.common,xe.specularmap,xe.envmap,xe.aomap,xe.lightmap,xe.emissivemap,xe.bumpmap,xe.normalmap,xe.displacementmap,xe.fog,xe.lights,{emissive:{value:new Ge(0)}}]),vertexShader:rt.meshlambert_vert,fragmentShader:rt.meshlambert_frag},phong:{uniforms:Zn([xe.common,xe.specularmap,xe.envmap,xe.aomap,xe.lightmap,xe.emissivemap,xe.bumpmap,xe.normalmap,xe.displacementmap,xe.fog,xe.lights,{emissive:{value:new Ge(0)},specular:{value:new Ge(1118481)},shininess:{value:30}}]),vertexShader:rt.meshphong_vert,fragmentShader:rt.meshphong_frag},standard:{uniforms:Zn([xe.common,xe.envmap,xe.aomap,xe.lightmap,xe.emissivemap,xe.bumpmap,xe.normalmap,xe.displacementmap,xe.roughnessmap,xe.metalnessmap,xe.fog,xe.lights,{emissive:{value:new Ge(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:rt.meshphysical_vert,fragmentShader:rt.meshphysical_frag},toon:{uniforms:Zn([xe.common,xe.aomap,xe.lightmap,xe.emissivemap,xe.bumpmap,xe.normalmap,xe.displacementmap,xe.gradientmap,xe.fog,xe.lights,{emissive:{value:new Ge(0)}}]),vertexShader:rt.meshtoon_vert,fragmentShader:rt.meshtoon_frag},matcap:{uniforms:Zn([xe.common,xe.bumpmap,xe.normalmap,xe.displacementmap,xe.fog,{matcap:{value:null}}]),vertexShader:rt.meshmatcap_vert,fragmentShader:rt.meshmatcap_frag},points:{uniforms:Zn([xe.points,xe.fog]),vertexShader:rt.points_vert,fragmentShader:rt.points_frag},dashed:{uniforms:Zn([xe.common,xe.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:rt.linedashed_vert,fragmentShader:rt.linedashed_frag},depth:{uniforms:Zn([xe.common,xe.displacementmap]),vertexShader:rt.depth_vert,fragmentShader:rt.depth_frag},normal:{uniforms:Zn([xe.common,xe.bumpmap,xe.normalmap,xe.displacementmap,{opacity:{value:1}}]),vertexShader:rt.meshnormal_vert,fragmentShader:rt.meshnormal_frag},sprite:{uniforms:Zn([xe.sprite,xe.fog]),vertexShader:rt.sprite_vert,fragmentShader:rt.sprite_frag},background:{uniforms:{uvTransform:{value:new st},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:rt.background_vert,fragmentShader:rt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new st}},vertexShader:rt.backgroundCube_vert,fragmentShader:rt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:rt.cube_vert,fragmentShader:rt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:rt.equirect_vert,fragmentShader:rt.equirect_frag},distanceRGBA:{uniforms:Zn([xe.common,xe.displacementmap,{referencePosition:{value:new k},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:rt.distanceRGBA_vert,fragmentShader:rt.distanceRGBA_frag},shadow:{uniforms:Zn([xe.lights,xe.fog,{color:{value:new Ge(0)},opacity:{value:1}}]),vertexShader:rt.shadow_vert,fragmentShader:rt.shadow_frag}};br.physical={uniforms:Zn([br.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new st},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new st},clearcoatNormalScale:{value:new We(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new st},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new st},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new st},sheen:{value:0},sheenColor:{value:new Ge(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new st},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new st},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new st},transmissionSamplerSize:{value:new We},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new st},attenuationDistance:{value:0},attenuationColor:{value:new Ge(0)},specularColor:{value:new Ge(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new st},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new st},anisotropyVector:{value:new We},anisotropyMap:{value:null},anisotropyMapTransform:{value:new st}}]),vertexShader:rt.meshphysical_vert,fragmentShader:rt.meshphysical_frag};var mf={r:0,b:0,g:0},No=new Go,tO=new qe;function nO(i,e,t,n,r,s,o){let a=new Ge(0),c=s===!0?0:1,l,u,h=null,d=0,f=null;function x(v){let E=v.isScene===!0?v.background:null;return E&&E.isTexture&&(E=(v.backgroundBlurriness>0?t:e).get(E)),E}function g(v){let E=!1,y=x(v);y===null?m(a,c):y&&y.isColor&&(m(y,1),E=!0);let w=i.xr.getEnvironmentBlendMode();w==="additive"?n.buffers.color.setClear(0,0,0,1,o):w==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,o),(i.autoClear||E)&&i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil)}function p(v,E){let y=x(E);y&&(y.isCubeTexture||y.mapping===Kf)?(u===void 0&&(u=new ii(new Mu(1,1,1),new Fr({name:"BackgroundCubeMaterial",uniforms:Cc(br.backgroundCube.uniforms),vertexShader:br.backgroundCube.vertexShader,fragmentShader:br.backgroundCube.fragmentShader,side:ri,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(w,A,b){this.matrixWorld.copyPosition(b.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),No.copy(E.backgroundRotation),No.x*=-1,No.y*=-1,No.z*=-1,y.isCubeTexture&&y.isRenderTargetTexture===!1&&(No.y*=-1,No.z*=-1),u.material.uniforms.envMap.value=y,u.material.uniforms.flipEnvMap.value=y.isCubeTexture&&y.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=E.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=E.backgroundIntensity,u.material.uniforms.backgroundRotation.value.setFromMatrix4(tO.makeRotationFromEuler(No)),u.material.toneMapped=Ot.getTransfer(y.colorSpace)!==qt,(h!==y||d!==y.version||f!==i.toneMapping)&&(u.material.needsUpdate=!0,h=y,d=y.version,f=i.toneMapping),u.layers.enableAll(),v.unshift(u,u.geometry,u.material,0,0,null)):y&&y.isTexture&&(l===void 0&&(l=new ii(new Nf(2,2),new Fr({name:"BackgroundMaterial",uniforms:Cc(br.background.uniforms),vertexShader:br.background.vertexShader,fragmentShader:br.background.fragmentShader,side:Mr,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=y,l.material.uniforms.backgroundIntensity.value=E.backgroundIntensity,l.material.toneMapped=Ot.getTransfer(y.colorSpace)!==qt,y.matrixAutoUpdate===!0&&y.updateMatrix(),l.material.uniforms.uvTransform.value.copy(y.matrix),(h!==y||d!==y.version||f!==i.toneMapping)&&(l.material.needsUpdate=!0,h=y,d=y.version,f=i.toneMapping),l.layers.enableAll(),v.unshift(l,l.geometry,l.material,0,0,null))}function m(v,E){v.getRGB(mf,cD(i)),n.buffers.color.setClear(mf.r,mf.g,mf.b,E,o)}return{getClearColor:function(){return a},setClearColor:function(v,E=1){a.set(v),c=E,m(a,c)},getClearAlpha:function(){return c},setClearAlpha:function(v){c=v,m(a,c)},render:g,addToRenderList:p}}function iO(i,e){let t=i.getParameter(i.MAX_VERTEX_ATTRIBS),n={},r=d(null),s=r,o=!1;function a(_,M,B,F,N){let L=!1,Z=h(F,B,M);s!==Z&&(s=Z,l(s.object)),L=f(_,F,B,N),L&&x(_,F,B,N),N!==null&&e.update(N,i.ELEMENT_ARRAY_BUFFER),(L||o)&&(o=!1,y(_,M,B,F),N!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.get(N).buffer))}function c(){return i.createVertexArray()}function l(_){return i.bindVertexArray(_)}function u(_){return i.deleteVertexArray(_)}function h(_,M,B){let F=B.wireframe===!0,N=n[_.id];N===void 0&&(N={},n[_.id]=N);let L=N[M.id];L===void 0&&(L={},N[M.id]=L);let Z=L[F];return Z===void 0&&(Z=d(c()),L[F]=Z),Z}function d(_){let M=[],B=[],F=[];for(let N=0;N<t;N++)M[N]=0,B[N]=0,F[N]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:M,enabledAttributes:B,attributeDivisors:F,object:_,attributes:{},index:null}}function f(_,M,B,F){let N=s.attributes,L=M.attributes,Z=0,Q=B.getAttributes();for(let j in Q)if(Q[j].location>=0){let ie=N[j],ue=L[j];if(ue===void 0&&(j==="instanceMatrix"&&_.instanceMatrix&&(ue=_.instanceMatrix),j==="instanceColor"&&_.instanceColor&&(ue=_.instanceColor)),ie===void 0||ie.attribute!==ue||ue&&ie.data!==ue.data)return!0;Z++}return s.attributesNum!==Z||s.index!==F}function x(_,M,B,F){let N={},L=M.attributes,Z=0,Q=B.getAttributes();for(let j in Q)if(Q[j].location>=0){let ie=L[j];ie===void 0&&(j==="instanceMatrix"&&_.instanceMatrix&&(ie=_.instanceMatrix),j==="instanceColor"&&_.instanceColor&&(ie=_.instanceColor));let ue={};ue.attribute=ie,ie&&ie.data&&(ue.data=ie.data),N[j]=ue,Z++}s.attributes=N,s.attributesNum=Z,s.index=F}function g(){let _=s.newAttributes;for(let M=0,B=_.length;M<B;M++)_[M]=0}function p(_){m(_,0)}function m(_,M){let B=s.newAttributes,F=s.enabledAttributes,N=s.attributeDivisors;B[_]=1,F[_]===0&&(i.enableVertexAttribArray(_),F[_]=1),N[_]!==M&&(i.vertexAttribDivisor(_,M),N[_]=M)}function v(){let _=s.newAttributes,M=s.enabledAttributes;for(let B=0,F=M.length;B<F;B++)M[B]!==_[B]&&(i.disableVertexAttribArray(B),M[B]=0)}function E(_,M,B,F,N,L,Z){Z===!0?i.vertexAttribIPointer(_,M,B,N,L):i.vertexAttribPointer(_,M,B,F,N,L)}function y(_,M,B,F){g();let N=F.attributes,L=B.getAttributes(),Z=M.defaultAttributeValues;for(let Q in L){let j=L[Q];if(j.location>=0){let W=N[Q];if(W===void 0&&(Q==="instanceMatrix"&&_.instanceMatrix&&(W=_.instanceMatrix),Q==="instanceColor"&&_.instanceColor&&(W=_.instanceColor)),W!==void 0){let ie=W.normalized,ue=W.itemSize,de=e.get(W);if(de===void 0)continue;let $e=de.buffer,X=de.type,O=de.bytesPerElement,z=X===i.INT||X===i.UNSIGNED_INT||W.gpuType===Jb;if(W.isInterleavedBufferAttribute){let R=W.data,K=R.stride,$=W.offset;if(R.isInstancedInterleavedBuffer){for(let P=0;P<j.locationSize;P++)m(j.location+P,R.meshPerAttribute);_.isInstancedMesh!==!0&&F._maxInstanceCount===void 0&&(F._maxInstanceCount=R.meshPerAttribute*R.count)}else for(let P=0;P<j.locationSize;P++)p(j.location+P);i.bindBuffer(i.ARRAY_BUFFER,$e);for(let P=0;P<j.locationSize;P++)E(j.location+P,ue/j.locationSize,X,ie,K*O,($+ue/j.locationSize*P)*O,z)}else{if(W.isInstancedBufferAttribute){for(let R=0;R<j.locationSize;R++)m(j.location+R,W.meshPerAttribute);_.isInstancedMesh!==!0&&F._maxInstanceCount===void 0&&(F._maxInstanceCount=W.meshPerAttribute*W.count)}else for(let R=0;R<j.locationSize;R++)p(j.location+R);i.bindBuffer(i.ARRAY_BUFFER,$e);for(let R=0;R<j.locationSize;R++)E(j.location+R,ue/j.locationSize,X,ie,ue*O,ue/j.locationSize*R*O,z)}}else if(Z!==void 0){let ie=Z[Q];if(ie!==void 0)switch(ie.length){case 2:i.vertexAttrib2fv(j.location,ie);break;case 3:i.vertexAttrib3fv(j.location,ie);break;case 4:i.vertexAttrib4fv(j.location,ie);break;default:i.vertexAttrib1fv(j.location,ie)}}}}v()}function w(){D();for(let _ in n){let M=n[_];for(let B in M){let F=M[B];for(let N in F)u(F[N].object),delete F[N];delete M[B]}delete n[_]}}function A(_){if(n[_.id]===void 0)return;let M=n[_.id];for(let B in M){let F=M[B];for(let N in F)u(F[N].object),delete F[N];delete M[B]}delete n[_.id]}function b(_){for(let M in n){let B=n[M];if(B[_.id]===void 0)continue;let F=B[_.id];for(let N in F)u(F[N].object),delete F[N];delete B[_.id]}}function D(){C(),o=!0,s!==r&&(s=r,l(s.object))}function C(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:a,reset:D,resetDefaultState:C,dispose:w,releaseStatesOfGeometry:A,releaseStatesOfProgram:b,initAttributes:g,enableAttribute:p,disableUnusedAttributes:v}}function rO(i,e,t){let n;function r(l){n=l}function s(l,u){i.drawArrays(n,l,u),t.update(u,n,1)}function o(l,u,h){h!==0&&(i.drawArraysInstanced(n,l,u,h),t.update(u,n,h))}function a(l,u,h){if(h===0)return;let d=e.get("WEBGL_multi_draw");if(d===null)for(let f=0;f<h;f++)this.render(l[f],u[f]);else{d.multiDrawArraysWEBGL(n,l,0,u,0,h);let f=0;for(let x=0;x<h;x++)f+=u[x];t.update(f,n,1)}}function c(l,u,h,d){if(h===0)return;let f=e.get("WEBGL_multi_draw");if(f===null)for(let x=0;x<l.length;x++)o(l[x],u[x],d[x]);else{f.multiDrawArraysInstancedWEBGL(n,l,0,u,0,d,0,h);let x=0;for(let g=0;g<h;g++)x+=u[g];for(let g=0;g<d.length;g++)t.update(x,n,d[g])}}this.setMode=r,this.render=s,this.renderInstances=o,this.renderMultiDraw=a,this.renderMultiDrawInstances=c}function sO(i,e,t,n){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){let A=e.get("EXT_texture_filter_anisotropic");r=i.getParameter(A.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function o(A){return!(A!==Dr&&n.convert(A)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_FORMAT))}function a(A){let b=A===Jf&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(A!==Ns&&n.convert(A)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_TYPE)&&A!==Rs&&!b)}function c(A){if(A==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";A="mediump"}return A==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let l=t.precision!==void 0?t.precision:"highp",u=c(l);u!==l&&(console.warn("THREE.WebGLRenderer:",l,"not supported, using",u,"instead."),l=u);let h=t.logarithmicDepthBuffer===!0,d=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),f=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),x=i.getParameter(i.MAX_TEXTURE_SIZE),g=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),p=i.getParameter(i.MAX_VERTEX_ATTRIBS),m=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),v=i.getParameter(i.MAX_VARYING_VECTORS),E=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),y=f>0,w=i.getParameter(i.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:c,textureFormatReadable:o,textureTypeReadable:a,precision:l,logarithmicDepthBuffer:h,maxTextures:d,maxVertexTextures:f,maxTextureSize:x,maxCubemapSize:g,maxAttributes:p,maxVertexUniforms:m,maxVaryings:v,maxFragmentUniforms:E,vertexTextures:y,maxSamples:w}}function oO(i){let e=this,t=null,n=0,r=!1,s=!1,o=new ts,a=new st,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d){let f=h.length!==0||d||n!==0||r;return r=d,n=h.length,f},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,d){t=u(h,d,0)},this.setState=function(h,d,f){let x=h.clippingPlanes,g=h.clipIntersection,p=h.clipShadows,m=i.get(h);if(!r||x===null||x.length===0||s&&!p)s?u(null):l();else{let v=s?0:n,E=v*4,y=m.clippingState||null;c.value=y,y=u(x,d,E,f);for(let w=0;w!==E;++w)y[w]=t[w];m.clippingState=y,this.numIntersection=g?this.numPlanes:0,this.numPlanes+=v}};function l(){c.value!==t&&(c.value=t,c.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function u(h,d,f,x){let g=h!==null?h.length:0,p=null;if(g!==0){if(p=c.value,x!==!0||p===null){let m=f+g*4,v=d.matrixWorldInverse;a.getNormalMatrix(v),(p===null||p.length<m)&&(p=new Float32Array(m));for(let E=0,y=f;E!==g;++E,y+=4)o.copy(h[E]).applyMatrix4(v,a),o.normal.toArray(p,y),p[y+3]=o.constant}c.value=p,c.needsUpdate=!0}return e.numPlanes=g,e.numIntersection=0,p}}function aO(i){let e=new WeakMap;function t(o,a){return a===sv?o.mapping=gc:a===ov&&(o.mapping=vc),o}function n(o){if(o&&o.isTexture){let a=o.mapping;if(a===sv||a===ov)if(e.has(o)){let c=e.get(o).texture;return t(c,o.mapping)}else{let c=o.image;if(c&&c.height>0){let l=new dv(c.height);return l.fromEquirectangularTexture(i,o),e.set(o,l),o.addEventListener("dispose",r),t(l.texture,o.mapping)}else return null}}return o}function r(o){let a=o.target;a.removeEventListener("dispose",r);let c=e.get(a);c!==void 0&&(e.delete(a),c.dispose())}function s(){e=new WeakMap}return{get:n,dispose:s}}var fv=class extends Of{constructor(e=-1,t=1,n=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,s=n-e,o=n+e,a=r+t,c=r-t;if(this.view!==null&&this.view.enabled){let l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=l*this.view.offsetX,o=s+l*this.view.width,a-=u*this.view.offsetY,c=a-u*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,c,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}},dc=4,gb=[.125,.215,.35,.446,.526,.582],zo=20,qg=new fv,vb=new Ge,Yg=null,Zg=0,Kg=0,Jg=!1,Uo=(1+Math.sqrt(5))/2,lc=1/Uo,Eb=[new k(-Uo,lc,0),new k(Uo,lc,0),new k(-lc,0,Uo),new k(lc,0,Uo),new k(0,Uo,-lc),new k(0,Uo,lc),new k(-1,1,-1),new k(1,1,-1),new k(-1,1,1),new k(1,1,1)],Lf=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,n=.1,r=100){Yg=this._renderer.getRenderTarget(),Zg=this._renderer.getActiveCubeFace(),Kg=this._renderer.getActiveMipmapLevel(),Jg=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);let s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,n,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=_b(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Cb(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Yg,Zg,Kg),this._renderer.xr.enabled=Jg,e.scissorTest=!1,gf(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===gc||e.mapping===vc?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Yg=this._renderer.getRenderTarget(),Zg=this._renderer.getActiveCubeFace(),Kg=this._renderer.getActiveMipmapLevel(),Jg=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;let n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:er,minFilter:er,generateMipmaps:!1,type:Jf,format:Dr,colorSpace:Us,depthBuffer:!1},r=yb(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=yb(e,t,n);let{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=cO(s)),this._blurMaterial=lO(s,e,t)}return r}_compileMaterial(e){let t=new ii(this._lodPlanes[0],e);this._renderer.compile(t,qg)}_sceneToCubeUV(e,t,n,r){let a=new zn(90,1,t,n),c=[1,-1,1,1,1,1],l=[1,1,1,-1,-1,-1],u=this._renderer,h=u.autoClear,d=u.toneMapping;u.getClearColor(vb),u.toneMapping=ks,u.autoClear=!1;let f=new If({name:"PMREM.Background",side:ri,depthWrite:!1,depthTest:!1}),x=new ii(new Mu,f),g=!1,p=e.background;p?p.isColor&&(f.color.copy(p),e.background=null,g=!0):(f.color.copy(vb),g=!0);for(let m=0;m<6;m++){let v=m%3;v===0?(a.up.set(0,c[m],0),a.lookAt(l[m],0,0)):v===1?(a.up.set(0,0,c[m]),a.lookAt(0,l[m],0)):(a.up.set(0,c[m],0),a.lookAt(0,0,l[m]));let E=this._cubeSize;gf(r,v*E,m>2?E:0,E,E),u.setRenderTarget(r),g&&u.render(x,a),u.render(e,a)}x.geometry.dispose(),x.material.dispose(),u.toneMapping=d,u.autoClear=h,e.background=p}_textureToCubeUV(e,t){let n=this._renderer,r=e.mapping===gc||e.mapping===vc;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=_b()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Cb());let s=r?this._cubemapMaterial:this._equirectMaterial,o=new ii(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;let c=this._cubeSize;gf(t,0,0,3*c,2*c),n.setRenderTarget(t),n.render(o,qg)}_applyPMREM(e){let t=this._renderer,n=t.autoClear;t.autoClear=!1;let r=this._lodPlanes.length;for(let s=1;s<r;s++){let o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),a=Eb[(r-s-1)%Eb.length];this._blur(e,s-1,s,o,a)}t.autoClear=n}_blur(e,t,n,r,s){let o=this._pingPongRenderTarget;this._halfBlur(e,o,t,n,r,"latitudinal",s),this._halfBlur(o,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,o,a){let c=this._renderer,l=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let u=3,h=new ii(this._lodPlanes[r],l),d=l.uniforms,f=this._sizeLods[n]-1,x=isFinite(s)?Math.PI/(2*f):2*Math.PI/(2*zo-1),g=s/x,p=isFinite(s)?1+Math.floor(u*g):zo;p>zo&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${p} samples when the maximum is set to ${zo}`);let m=[],v=0;for(let b=0;b<zo;++b){let D=b/g,C=Math.exp(-D*D/2);m.push(C),b===0?v+=C:b<p&&(v+=2*C)}for(let b=0;b<m.length;b++)m[b]=m[b]/v;d.envMap.value=e.texture,d.samples.value=p,d.weights.value=m,d.latitudinal.value=o==="latitudinal",a&&(d.poleAxis.value=a);let{_lodMax:E}=this;d.dTheta.value=x,d.mipInt.value=E-n;let y=this._sizeLods[r],w=3*y*(r>E-dc?r-E+dc:0),A=4*(this._cubeSize-y);gf(t,w,A,3*y,2*y),c.setRenderTarget(t),c.render(h,qg)}};function cO(i){let e=[],t=[],n=[],r=i,s=i-dc+1+gb.length;for(let o=0;o<s;o++){let a=Math.pow(2,r);t.push(a);let c=1/a;o>i-dc?c=gb[o-i+dc-1]:o===0&&(c=0),n.push(c);let l=1/(a-2),u=-l,h=1+l,d=[u,u,h,u,h,h,u,u,h,h,u,h],f=6,x=6,g=3,p=2,m=1,v=new Float32Array(g*x*f),E=new Float32Array(p*x*f),y=new Float32Array(m*x*f);for(let A=0;A<f;A++){let b=A%3*2/3-1,D=A>2?0:-1,C=[b,D,0,b+2/3,D,0,b+2/3,D+1,0,b,D,0,b+2/3,D+1,0,b,D+1,0];v.set(C,g*x*A),E.set(d,p*x*A);let _=[A,A,A,A,A,A];y.set(_,m*x*A)}let w=new bn;w.setAttribute("position",new Mi(v,g)),w.setAttribute("uv",new Mi(E,p)),w.setAttribute("faceIndex",new Mi(y,m)),e.push(w),r>dc&&r--}return{lodPlanes:e,sizeLods:t,sigmas:n}}function yb(i,e,t){let n=new rs(i,e,t);return n.texture.mapping=Kf,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function gf(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function lO(i,e,t){let n=new Float32Array(zo),r=new k(0,1,0);return new Fr({name:"SphericalGaussianBlur",defines:{n:zo,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:$v(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Os,depthTest:!1,depthWrite:!1})}function Cb(){return new Fr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:$v(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Os,depthTest:!1,depthWrite:!1})}function _b(){return new Fr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:$v(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Os,depthTest:!1,depthWrite:!1})}function $v(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function uO(i){let e=new WeakMap,t=null;function n(a){if(a&&a.isTexture){let c=a.mapping,l=c===sv||c===ov,u=c===gc||c===vc;if(l||u){let h=e.get(a),d=h!==void 0?h.texture.pmremVersion:0;if(a.isRenderTargetTexture&&a.pmremVersion!==d)return t===null&&(t=new Lf(i)),h=l?t.fromEquirectangular(a,h):t.fromCubemap(a,h),h.texture.pmremVersion=a.pmremVersion,e.set(a,h),h.texture;if(h!==void 0)return h.texture;{let f=a.image;return l&&f&&f.height>0||u&&f&&r(f)?(t===null&&(t=new Lf(i)),h=l?t.fromEquirectangular(a):t.fromCubemap(a),h.texture.pmremVersion=a.pmremVersion,e.set(a,h),a.addEventListener("dispose",s),h.texture):null}}}return a}function r(a){let c=0,l=6;for(let u=0;u<l;u++)a[u]!==void 0&&c++;return c===l}function s(a){let c=a.target;c.removeEventListener("dispose",s);let l=e.get(c);l!==void 0&&(e.delete(c),l.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:o}}function hO(i){let e={};function t(n){if(e[n]!==void 0)return e[n];let r;switch(n){case"WEBGL_depth_texture":r=i.getExtension("WEBGL_depth_texture")||i.getExtension("MOZ_WEBGL_depth_texture")||i.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=i.getExtension("WEBGL_compressed_texture_s3tc")||i.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=i.getExtension("WEBGL_compressed_texture_pvrtc")||i.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=i.getExtension(n)}return e[n]=r,r}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){let r=t(n);return r===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function dO(i,e,t,n){let r={},s=new WeakMap;function o(h){let d=h.target;d.index!==null&&e.remove(d.index);for(let x in d.attributes)e.remove(d.attributes[x]);for(let x in d.morphAttributes){let g=d.morphAttributes[x];for(let p=0,m=g.length;p<m;p++)e.remove(g[p])}d.removeEventListener("dispose",o),delete r[d.id];let f=s.get(d);f&&(e.remove(f),s.delete(d)),n.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,t.memory.geometries--}function a(h,d){return r[d.id]===!0||(d.addEventListener("dispose",o),r[d.id]=!0,t.memory.geometries++),d}function c(h){let d=h.attributes;for(let x in d)e.update(d[x],i.ARRAY_BUFFER);let f=h.morphAttributes;for(let x in f){let g=f[x];for(let p=0,m=g.length;p<m;p++)e.update(g[p],i.ARRAY_BUFFER)}}function l(h){let d=[],f=h.index,x=h.attributes.position,g=0;if(f!==null){let v=f.array;g=f.version;for(let E=0,y=v.length;E<y;E+=3){let w=v[E+0],A=v[E+1],b=v[E+2];d.push(w,A,A,b,b,w)}}else if(x!==void 0){let v=x.array;g=x.version;for(let E=0,y=v.length/3-1;E<y;E+=3){let w=E+0,A=E+1,b=E+2;d.push(w,A,A,b,b,w)}}else return;let p=new(oD(d)?Rf:Pf)(d,1);p.version=g;let m=s.get(h);m&&e.remove(m),s.set(h,p)}function u(h){let d=s.get(h);if(d){let f=h.index;f!==null&&d.version<f.version&&l(h)}else l(h);return s.get(h)}return{get:a,update:c,getWireframeAttribute:u}}function fO(i,e,t){let n;function r(d){n=d}let s,o;function a(d){s=d.type,o=d.bytesPerElement}function c(d,f){i.drawElements(n,f,s,d*o),t.update(f,n,1)}function l(d,f,x){x!==0&&(i.drawElementsInstanced(n,f,s,d*o,x),t.update(f,n,x))}function u(d,f,x){if(x===0)return;let g=e.get("WEBGL_multi_draw");if(g===null)for(let p=0;p<x;p++)this.render(d[p]/o,f[p]);else{g.multiDrawElementsWEBGL(n,f,0,s,d,0,x);let p=0;for(let m=0;m<x;m++)p+=f[m];t.update(p,n,1)}}function h(d,f,x,g){if(x===0)return;let p=e.get("WEBGL_multi_draw");if(p===null)for(let m=0;m<d.length;m++)l(d[m]/o,f[m],g[m]);else{p.multiDrawElementsInstancedWEBGL(n,f,0,s,d,0,g,0,x);let m=0;for(let v=0;v<x;v++)m+=f[v];for(let v=0;v<g.length;v++)t.update(m,n,g[v])}}this.setMode=r,this.setIndex=a,this.render=c,this.renderInstances=l,this.renderMultiDraw=u,this.renderMultiDrawInstances=h}function pO(i){let e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,o,a){switch(t.calls++,o){case i.TRIANGLES:t.triangles+=a*(s/3);break;case i.LINES:t.lines+=a*(s/2);break;case i.LINE_STRIP:t.lines+=a*(s-1);break;case i.LINE_LOOP:t.lines+=a*s;break;case i.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:n}}function xO(i,e,t){let n=new WeakMap,r=new Zt;function s(o,a,c){let l=o.morphTargetInfluences,u=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,h=u!==void 0?u.length:0,d=n.get(a);if(d===void 0||d.count!==h){let _=function(){D.dispose(),n.delete(a),a.removeEventListener("dispose",_)};var f=_;d!==void 0&&d.texture.dispose();let x=a.morphAttributes.position!==void 0,g=a.morphAttributes.normal!==void 0,p=a.morphAttributes.color!==void 0,m=a.morphAttributes.position||[],v=a.morphAttributes.normal||[],E=a.morphAttributes.color||[],y=0;x===!0&&(y=1),g===!0&&(y=2),p===!0&&(y=3);let w=a.attributes.position.count*y,A=1;w>e.maxTextureSize&&(A=Math.ceil(w/e.maxTextureSize),w=e.maxTextureSize);let b=new Float32Array(w*A*4*h),D=new Bf(b,w,A,h);D.type=Rs,D.needsUpdate=!0;let C=y*4;for(let M=0;M<h;M++){let B=m[M],F=v[M],N=E[M],L=w*A*4*M;for(let Z=0;Z<B.count;Z++){let Q=Z*C;x===!0&&(r.fromBufferAttribute(B,Z),b[L+Q+0]=r.x,b[L+Q+1]=r.y,b[L+Q+2]=r.z,b[L+Q+3]=0),g===!0&&(r.fromBufferAttribute(F,Z),b[L+Q+4]=r.x,b[L+Q+5]=r.y,b[L+Q+6]=r.z,b[L+Q+7]=0),p===!0&&(r.fromBufferAttribute(N,Z),b[L+Q+8]=r.x,b[L+Q+9]=r.y,b[L+Q+10]=r.z,b[L+Q+11]=N.itemSize===4?r.w:1)}}d={count:h,texture:D,size:new We(w,A)},n.set(a,d),a.addEventListener("dispose",_)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)c.getUniforms().setValue(i,"morphTexture",o.morphTexture,t);else{let x=0;for(let p=0;p<l.length;p++)x+=l[p];let g=a.morphTargetsRelative?1:1-x;c.getUniforms().setValue(i,"morphTargetBaseInfluence",g),c.getUniforms().setValue(i,"morphTargetInfluences",l)}c.getUniforms().setValue(i,"morphTargetsTexture",d.texture,t),c.getUniforms().setValue(i,"morphTargetsTextureSize",d.size)}return{update:s}}function mO(i,e,t,n){let r=new WeakMap;function s(c){let l=n.render.frame,u=c.geometry,h=e.get(c,u);if(r.get(h)!==l&&(e.update(h),r.set(h,l)),c.isInstancedMesh&&(c.hasEventListener("dispose",a)===!1&&c.addEventListener("dispose",a),r.get(c)!==l&&(t.update(c.instanceMatrix,i.ARRAY_BUFFER),c.instanceColor!==null&&t.update(c.instanceColor,i.ARRAY_BUFFER),r.set(c,l))),c.isSkinnedMesh){let d=c.skeleton;r.get(d)!==l&&(d.update(),r.set(d,l))}return h}function o(){r=new WeakMap}function a(c){let l=c.target;l.removeEventListener("dispose",a),t.remove(l.instanceMatrix),l.instanceColor!==null&&t.remove(l.instanceColor)}return{update:s,dispose:o}}var Uf=class extends Vs{constructor(e,t,n,r,s,o,a,c,l,u){if(u=u!==void 0?u:pc,u!==pc&&u!==wu)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&u===pc&&(n=Ec),n===void 0&&u===wu&&(n=Bu),super(null,r,s,o,a,c,u,n,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:Si,this.minFilter=c!==void 0?c:Si,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){let t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}},uD=new Vs,hD=new Uf(1,1);hD.compareFunction=sD;var dD=new Bf,fD=new uv,pD=new kf,Ab=[],wb=[],bb=new Float32Array(16),Db=new Float32Array(9),Sb=new Float32Array(4);function Mc(i,e,t){let n=i[0];if(n<=0||n>0)return i;let r=e*t,s=Ab[r];if(s===void 0&&(s=new Float32Array(r),Ab[r]=s),e!==0){n.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,i[o].toArray(s,a)}return s}function Cn(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function _n(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function e0(i,e){let t=wb[e];t===void 0&&(t=new Int32Array(e),wb[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function gO(i,e){let t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function vO(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Cn(t,e))return;i.uniform2fv(this.addr,e),_n(t,e)}}function EO(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Cn(t,e))return;i.uniform3fv(this.addr,e),_n(t,e)}}function yO(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Cn(t,e))return;i.uniform4fv(this.addr,e),_n(t,e)}}function CO(i,e){let t=this.cache,n=e.elements;if(n===void 0){if(Cn(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),_n(t,e)}else{if(Cn(t,n))return;Sb.set(n),i.uniformMatrix2fv(this.addr,!1,Sb),_n(t,n)}}function _O(i,e){let t=this.cache,n=e.elements;if(n===void 0){if(Cn(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),_n(t,e)}else{if(Cn(t,n))return;Db.set(n),i.uniformMatrix3fv(this.addr,!1,Db),_n(t,n)}}function AO(i,e){let t=this.cache,n=e.elements;if(n===void 0){if(Cn(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),_n(t,e)}else{if(Cn(t,n))return;bb.set(n),i.uniformMatrix4fv(this.addr,!1,bb),_n(t,n)}}function wO(i,e){let t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function bO(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Cn(t,e))return;i.uniform2iv(this.addr,e),_n(t,e)}}function DO(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Cn(t,e))return;i.uniform3iv(this.addr,e),_n(t,e)}}function SO(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Cn(t,e))return;i.uniform4iv(this.addr,e),_n(t,e)}}function MO(i,e){let t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function TO(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Cn(t,e))return;i.uniform2uiv(this.addr,e),_n(t,e)}}function FO(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Cn(t,e))return;i.uniform3uiv(this.addr,e),_n(t,e)}}function BO(i,e){let t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Cn(t,e))return;i.uniform4uiv(this.addr,e),_n(t,e)}}function IO(i,e,t){let n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r);let s=this.type===i.SAMPLER_2D_SHADOW?hD:uD;t.setTexture2D(e||s,r)}function PO(i,e,t){let n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||fD,r)}function RO(i,e,t){let n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||pD,r)}function OO(i,e,t){let n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||dD,r)}function kO(i){switch(i){case 5126:return gO;case 35664:return vO;case 35665:return EO;case 35666:return yO;case 35674:return CO;case 35675:return _O;case 35676:return AO;case 5124:case 35670:return wO;case 35667:case 35671:return bO;case 35668:case 35672:return DO;case 35669:case 35673:return SO;case 5125:return MO;case 36294:return TO;case 36295:return FO;case 36296:return BO;case 35678:case 36198:case 36298:case 36306:case 35682:return IO;case 35679:case 36299:case 36307:return PO;case 35680:case 36300:case 36308:case 36293:return RO;case 36289:case 36303:case 36311:case 36292:return OO}}function NO(i,e){i.uniform1fv(this.addr,e)}function LO(i,e){let t=Mc(e,this.size,2);i.uniform2fv(this.addr,t)}function UO(i,e){let t=Mc(e,this.size,3);i.uniform3fv(this.addr,t)}function VO(i,e){let t=Mc(e,this.size,4);i.uniform4fv(this.addr,t)}function zO(i,e){let t=Mc(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function HO(i,e){let t=Mc(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function jO(i,e){let t=Mc(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function GO(i,e){i.uniform1iv(this.addr,e)}function WO(i,e){i.uniform2iv(this.addr,e)}function $O(i,e){i.uniform3iv(this.addr,e)}function XO(i,e){i.uniform4iv(this.addr,e)}function qO(i,e){i.uniform1uiv(this.addr,e)}function YO(i,e){i.uniform2uiv(this.addr,e)}function ZO(i,e){i.uniform3uiv(this.addr,e)}function KO(i,e){i.uniform4uiv(this.addr,e)}function JO(i,e,t){let n=this.cache,r=e.length,s=e0(t,r);Cn(n,s)||(i.uniform1iv(this.addr,s),_n(n,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||uD,s[o])}function QO(i,e,t){let n=this.cache,r=e.length,s=e0(t,r);Cn(n,s)||(i.uniform1iv(this.addr,s),_n(n,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||fD,s[o])}function ek(i,e,t){let n=this.cache,r=e.length,s=e0(t,r);Cn(n,s)||(i.uniform1iv(this.addr,s),_n(n,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||pD,s[o])}function tk(i,e,t){let n=this.cache,r=e.length,s=e0(t,r);Cn(n,s)||(i.uniform1iv(this.addr,s),_n(n,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||dD,s[o])}function nk(i){switch(i){case 5126:return NO;case 35664:return LO;case 35665:return UO;case 35666:return VO;case 35674:return zO;case 35675:return HO;case 35676:return jO;case 5124:case 35670:return GO;case 35667:case 35671:return WO;case 35668:case 35672:return $O;case 35669:case 35673:return XO;case 5125:return qO;case 36294:return YO;case 36295:return ZO;case 36296:return KO;case 35678:case 36198:case 36298:case 36306:case 35682:return JO;case 35679:case 36299:case 36307:return QO;case 35680:case 36300:case 36308:case 36293:return ek;case 36289:case 36303:case 36311:case 36292:return tk}}var pv=class{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=kO(t.type)}},xv=class{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=nk(t.type)}},mv=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){let r=this.seq;for(let s=0,o=r.length;s!==o;++s){let a=r[s];a.setValue(e,t[a.id],n)}}},Qg=/(\w+)(\])?(\[|\.)?/g;function Mb(i,e){i.seq.push(e),i.map[e.id]=e}function ik(i,e,t){let n=i.name,r=n.length;for(Qg.lastIndex=0;;){let s=Qg.exec(n),o=Qg.lastIndex,a=s[1],c=s[2]==="]",l=s[3];if(c&&(a=a|0),l===void 0||l==="["&&o+2===r){Mb(t,l===void 0?new pv(a,i,e):new xv(a,i,e));break}else{let h=t.map[a];h===void 0&&(h=new mv(a),Mb(t,h)),t=h}}}var mc=class{constructor(e,t){this.seq=[],this.map={};let n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){let s=e.getActiveUniform(t,r),o=e.getUniformLocation(t,s.name);ik(s,o,this)}}setValue(e,t,n,r){let s=this.map[t];s!==void 0&&s.setValue(e,n,r)}setOptional(e,t,n){let r=t[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let s=0,o=t.length;s!==o;++s){let a=t[s],c=n[a.id];c.needsUpdate!==!1&&a.setValue(e,c.value,r)}}static seqWithValue(e,t){let n=[];for(let r=0,s=e.length;r!==s;++r){let o=e[r];o.id in t&&n.push(o)}return n}};function Tb(i,e,t){let n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}var rk=37297,sk=0;function ok(i,e){let t=i.split(`
`),n=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){let a=o+1;n.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return n.join(`
`)}function ak(i){let e=Ot.getPrimaries(Ot.workingColorSpace),t=Ot.getPrimaries(i),n;switch(e===t?n="":e===Mf&&t===Sf?n="LinearDisplayP3ToLinearSRGB":e===Sf&&t===Mf&&(n="LinearSRGBToLinearDisplayP3"),i){case Us:case Qf:return[n,"LinearTransferOETF"];case Di:case Gv:return[n,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",i),[n,"LinearTransferOETF"]}}function Fb(i,e,t){let n=i.getShaderParameter(e,i.COMPILE_STATUS),r=i.getShaderInfoLog(e).trim();if(n&&r==="")return"";let s=/ERROR: 0:(\d+)/.exec(r);if(s){let o=parseInt(s[1]);return t.toUpperCase()+`

`+r+`

`+ok(i.getShaderSource(e),o)}else return r}function ck(i,e){let t=ak(e);return`vec4 ${i}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function lk(i,e){let t;switch(e){case uP:t="Linear";break;case hP:t="Reinhard";break;case dP:t="OptimizedCineon";break;case fP:t="ACESFilmic";break;case xP:t="AgX";break;case mP:t="Neutral";break;case pP:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function uk(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Eu).join(`
`)}function hk(i){let e=[];for(let t in i){let n=i[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function dk(i,e){let t={},n=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){let s=i.getActiveAttrib(e,r),o=s.name,a=1;s.type===i.FLOAT_MAT2&&(a=2),s.type===i.FLOAT_MAT3&&(a=3),s.type===i.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:i.getAttribLocation(e,o),locationSize:a}}return t}function Eu(i){return i!==""}function Bb(i,e){let t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Ib(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var fk=/^[ \t]*#include +<([\w\d./]+)>/gm;function gv(i){return i.replace(fk,xk)}var pk=new Map;function xk(i,e){let t=rt[e];if(t===void 0){let n=pk.get(e);if(n!==void 0)t=rt[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return gv(t)}var mk=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Pb(i){return i.replace(mk,gk)}function gk(i,e,t,n){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function Rb(i){let e=`precision ${i.precision} float;
	precision ${i.precision} int;
	precision ${i.precision} sampler2D;
	precision ${i.precision} samplerCube;
	precision ${i.precision} sampler3D;
	precision ${i.precision} sampler2DArray;
	precision ${i.precision} sampler2DShadow;
	precision ${i.precision} samplerCubeShadow;
	precision ${i.precision} sampler2DArrayShadow;
	precision ${i.precision} isampler2D;
	precision ${i.precision} isampler3D;
	precision ${i.precision} isamplerCube;
	precision ${i.precision} isampler2DArray;
	precision ${i.precision} usampler2D;
	precision ${i.precision} usampler3D;
	precision ${i.precision} usamplerCube;
	precision ${i.precision} usampler2DArray;
	`;return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function vk(i){let e="SHADOWMAP_TYPE_BASIC";return i.shadowMapType===Zb?e="SHADOWMAP_TYPE_PCF":i.shadowMapType===kI?e="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===es&&(e="SHADOWMAP_TYPE_VSM"),e}function Ek(i){let e="ENVMAP_TYPE_CUBE";if(i.envMap)switch(i.envMapMode){case gc:case vc:e="ENVMAP_TYPE_CUBE";break;case Kf:e="ENVMAP_TYPE_CUBE_UV";break}return e}function yk(i){let e="ENVMAP_MODE_REFLECTION";if(i.envMap)switch(i.envMapMode){case vc:e="ENVMAP_MODE_REFRACTION";break}return e}function Ck(i){let e="ENVMAP_BLENDING_NONE";if(i.envMap)switch(i.combine){case jv:e="ENVMAP_BLENDING_MULTIPLY";break;case cP:e="ENVMAP_BLENDING_MIX";break;case lP:e="ENVMAP_BLENDING_ADD";break}return e}function _k(i){let e=i.envMapCubeUVHeight;if(e===null)return null;let t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:n,maxMip:t}}function Ak(i,e,t,n){let r=i.getContext(),s=t.defines,o=t.vertexShader,a=t.fragmentShader,c=vk(t),l=Ek(t),u=yk(t),h=Ck(t),d=_k(t),f=uk(t),x=hk(s),g=r.createProgram(),p,m,v=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(p=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,x].filter(Eu).join(`
`),p.length>0&&(p+=`
`),m=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,x].filter(Eu).join(`
`),m.length>0&&(m+=`
`)):(p=[Rb(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,x,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Eu).join(`
`),m=[Rb(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,x,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+l:"",t.envMap?"#define "+u:"",t.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==ks?"#define TONE_MAPPING":"",t.toneMapping!==ks?rt.tonemapping_pars_fragment:"",t.toneMapping!==ks?lk("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",rt.colorspace_pars_fragment,ck("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Eu).join(`
`)),o=gv(o),o=Bb(o,t),o=Ib(o,t),a=gv(a),a=Bb(a,t),a=Ib(a,t),o=Pb(o),a=Pb(a),t.isRawShaderMaterial!==!0&&(v=`#version 300 es
`,p=[f,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+p,m=["#define varying in",t.glslVersion===Zw?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===Zw?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+m);let E=v+p+o,y=v+m+a,w=Tb(r,r.VERTEX_SHADER,E),A=Tb(r,r.FRAGMENT_SHADER,y);r.attachShader(g,w),r.attachShader(g,A),t.index0AttributeName!==void 0?r.bindAttribLocation(g,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(g,0,"position"),r.linkProgram(g);function b(M){if(i.debug.checkShaderErrors){let B=r.getProgramInfoLog(g).trim(),F=r.getShaderInfoLog(w).trim(),N=r.getShaderInfoLog(A).trim(),L=!0,Z=!0;if(r.getProgramParameter(g,r.LINK_STATUS)===!1)if(L=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(r,g,w,A);else{let Q=Fb(r,w,"vertex"),j=Fb(r,A,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(g,r.VALIDATE_STATUS)+`

Material Name: `+M.name+`
Material Type: `+M.type+`

Program Info Log: `+B+`
`+Q+`
`+j)}else B!==""?console.warn("THREE.WebGLProgram: Program Info Log:",B):(F===""||N==="")&&(Z=!1);Z&&(M.diagnostics={runnable:L,programLog:B,vertexShader:{log:F,prefix:p},fragmentShader:{log:N,prefix:m}})}r.deleteShader(w),r.deleteShader(A),D=new mc(r,g),C=dk(r,g)}let D;this.getUniforms=function(){return D===void 0&&b(this),D};let C;this.getAttributes=function(){return C===void 0&&b(this),C};let _=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return _===!1&&(_=r.getProgramParameter(g,rk)),_},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(g),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=sk++,this.cacheKey=e,this.usedTimes=1,this.program=g,this.vertexShader=w,this.fragmentShader=A,this}var wk=0,vv=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(n),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){let t=this.shaderCache,n=t.get(e);return n===void 0&&(n=new Ev(e),t.set(e,n)),n}},Ev=class{constructor(e){this.id=wk++,this.code=e,this.usedTimes=0}};function bk(i,e,t,n,r,s,o){let a=new Su,c=new vv,l=new Set,u=[],h=r.logarithmicDepthBuffer,d=r.vertexTextures,f=r.precision,x={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function g(C){return l.add(C),C===0?"uv":`uv${C}`}function p(C,_,M,B,F){let N=B.fog,L=F.geometry,Z=C.isMeshStandardMaterial?B.environment:null,Q=(C.isMeshStandardMaterial?t:e).get(C.envMap||Z),j=Q&&Q.mapping===Kf?Q.image.height:null,W=x[C.type];C.precision!==null&&(f=r.getMaxPrecision(C.precision),f!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",f,"instead."));let ie=L.morphAttributes.position||L.morphAttributes.normal||L.morphAttributes.color,ue=ie!==void 0?ie.length:0,de=0;L.morphAttributes.position!==void 0&&(de=1),L.morphAttributes.normal!==void 0&&(de=2),L.morphAttributes.color!==void 0&&(de=3);let $e,X,O,z;if(W){let Ft=br[W];$e=Ft.vertexShader,X=Ft.fragmentShader}else $e=C.vertexShader,X=C.fragmentShader,c.update(C),O=c.getVertexShaderID(C),z=c.getFragmentShaderID(C);let R=i.getRenderTarget(),K=F.isInstancedMesh===!0,$=F.isBatchedMesh===!0,P=!!C.map,fe=!!C.matcap,oe=!!Q,De=!!C.aoMap,ge=!!C.lightMap,he=!!C.bumpMap,Be=!!C.normalMap,Te=!!C.displacementMap,Wt=!!C.emissiveMap,I=!!C.metalnessMap,S=!!C.roughnessMap,te=C.anisotropy>0,se=C.clearcoat>0,ce=C.dispersion>0,le=C.iridescence>0,Ne=C.sheen>0,Ce=C.transmission>0,ye=te&&!!C.anisotropyMap,ot=se&&!!C.clearcoatMap,pe=se&&!!C.clearcoatNormalMap,Oe=se&&!!C.clearcoatRoughnessMap,wt=le&&!!C.iridescenceMap,Ue=le&&!!C.iridescenceThicknessMap,we=Ne&&!!C.sheenColorMap,at=Ne&&!!C.sheenRoughnessMap,pt=!!C.specularMap,sn=!!C.specularColorMap,ct=!!C.specularIntensityMap,H=Ce&&!!C.transmissionMap,ae=Ce&&!!C.thicknessMap,re=!!C.gradientMap,ve=!!C.alphaMap,Ae=C.alphaTest>0,bt=!!C.alphaHash,$t=!!C.extensions,Jt=ks;C.toneMapped&&(R===null||R.isXRRenderTarget===!0)&&(Jt=i.toneMapping);let On={shaderID:W,shaderType:C.type,shaderName:C.name,vertexShader:$e,fragmentShader:X,defines:C.defines,customVertexShaderID:O,customFragmentShaderID:z,isRawShaderMaterial:C.isRawShaderMaterial===!0,glslVersion:C.glslVersion,precision:f,batching:$,instancing:K,instancingColor:K&&F.instanceColor!==null,instancingMorph:K&&F.morphTexture!==null,supportsVertexTextures:d,outputColorSpace:R===null?i.outputColorSpace:R.isXRRenderTarget===!0?R.texture.colorSpace:Us,alphaToCoverage:!!C.alphaToCoverage,map:P,matcap:fe,envMap:oe,envMapMode:oe&&Q.mapping,envMapCubeUVHeight:j,aoMap:De,lightMap:ge,bumpMap:he,normalMap:Be,displacementMap:d&&Te,emissiveMap:Wt,normalMapObjectSpace:Be&&C.normalMapType===FP,normalMapTangentSpace:Be&&C.normalMapType===rD,metalnessMap:I,roughnessMap:S,anisotropy:te,anisotropyMap:ye,clearcoat:se,clearcoatMap:ot,clearcoatNormalMap:pe,clearcoatRoughnessMap:Oe,dispersion:ce,iridescence:le,iridescenceMap:wt,iridescenceThicknessMap:Ue,sheen:Ne,sheenColorMap:we,sheenRoughnessMap:at,specularMap:pt,specularColorMap:sn,specularIntensityMap:ct,transmission:Ce,transmissionMap:H,thicknessMap:ae,gradientMap:re,opaque:C.transparent===!1&&C.blending===fc&&C.alphaToCoverage===!1,alphaMap:ve,alphaTest:Ae,alphaHash:bt,combine:C.combine,mapUv:P&&g(C.map.channel),aoMapUv:De&&g(C.aoMap.channel),lightMapUv:ge&&g(C.lightMap.channel),bumpMapUv:he&&g(C.bumpMap.channel),normalMapUv:Be&&g(C.normalMap.channel),displacementMapUv:Te&&g(C.displacementMap.channel),emissiveMapUv:Wt&&g(C.emissiveMap.channel),metalnessMapUv:I&&g(C.metalnessMap.channel),roughnessMapUv:S&&g(C.roughnessMap.channel),anisotropyMapUv:ye&&g(C.anisotropyMap.channel),clearcoatMapUv:ot&&g(C.clearcoatMap.channel),clearcoatNormalMapUv:pe&&g(C.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Oe&&g(C.clearcoatRoughnessMap.channel),iridescenceMapUv:wt&&g(C.iridescenceMap.channel),iridescenceThicknessMapUv:Ue&&g(C.iridescenceThicknessMap.channel),sheenColorMapUv:we&&g(C.sheenColorMap.channel),sheenRoughnessMapUv:at&&g(C.sheenRoughnessMap.channel),specularMapUv:pt&&g(C.specularMap.channel),specularColorMapUv:sn&&g(C.specularColorMap.channel),specularIntensityMapUv:ct&&g(C.specularIntensityMap.channel),transmissionMapUv:H&&g(C.transmissionMap.channel),thicknessMapUv:ae&&g(C.thicknessMap.channel),alphaMapUv:ve&&g(C.alphaMap.channel),vertexTangents:!!L.attributes.tangent&&(Be||te),vertexColors:C.vertexColors,vertexAlphas:C.vertexColors===!0&&!!L.attributes.color&&L.attributes.color.itemSize===4,pointsUvs:F.isPoints===!0&&!!L.attributes.uv&&(P||ve),fog:!!N,useFog:C.fog===!0,fogExp2:!!N&&N.isFogExp2,flatShading:C.flatShading===!0,sizeAttenuation:C.sizeAttenuation===!0,logarithmicDepthBuffer:h,skinning:F.isSkinnedMesh===!0,morphTargets:L.morphAttributes.position!==void 0,morphNormals:L.morphAttributes.normal!==void 0,morphColors:L.morphAttributes.color!==void 0,morphTargetsCount:ue,morphTextureStride:de,numDirLights:_.directional.length,numPointLights:_.point.length,numSpotLights:_.spot.length,numSpotLightMaps:_.spotLightMap.length,numRectAreaLights:_.rectArea.length,numHemiLights:_.hemi.length,numDirLightShadows:_.directionalShadowMap.length,numPointLightShadows:_.pointShadowMap.length,numSpotLightShadows:_.spotShadowMap.length,numSpotLightShadowsWithMaps:_.numSpotLightShadowsWithMaps,numLightProbes:_.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:C.dithering,shadowMapEnabled:i.shadowMap.enabled&&M.length>0,shadowMapType:i.shadowMap.type,toneMapping:Jt,useLegacyLights:i._useLegacyLights,decodeVideoTexture:P&&C.map.isVideoTexture===!0&&Ot.getTransfer(C.map.colorSpace)===qt,premultipliedAlpha:C.premultipliedAlpha,doubleSided:C.side===ns,flipSided:C.side===ri,useDepthPacking:C.depthPacking>=0,depthPacking:C.depthPacking||0,index0AttributeName:C.index0AttributeName,extensionClipCullDistance:$t&&C.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:$t&&C.extensions.multiDraw===!0&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:C.customProgramCacheKey()};return On.vertexUv1s=l.has(1),On.vertexUv2s=l.has(2),On.vertexUv3s=l.has(3),l.clear(),On}function m(C){let _=[];if(C.shaderID?_.push(C.shaderID):(_.push(C.customVertexShaderID),_.push(C.customFragmentShaderID)),C.defines!==void 0)for(let M in C.defines)_.push(M),_.push(C.defines[M]);return C.isRawShaderMaterial===!1&&(v(_,C),E(_,C),_.push(i.outputColorSpace)),_.push(C.customProgramCacheKey),_.join()}function v(C,_){C.push(_.precision),C.push(_.outputColorSpace),C.push(_.envMapMode),C.push(_.envMapCubeUVHeight),C.push(_.mapUv),C.push(_.alphaMapUv),C.push(_.lightMapUv),C.push(_.aoMapUv),C.push(_.bumpMapUv),C.push(_.normalMapUv),C.push(_.displacementMapUv),C.push(_.emissiveMapUv),C.push(_.metalnessMapUv),C.push(_.roughnessMapUv),C.push(_.anisotropyMapUv),C.push(_.clearcoatMapUv),C.push(_.clearcoatNormalMapUv),C.push(_.clearcoatRoughnessMapUv),C.push(_.iridescenceMapUv),C.push(_.iridescenceThicknessMapUv),C.push(_.sheenColorMapUv),C.push(_.sheenRoughnessMapUv),C.push(_.specularMapUv),C.push(_.specularColorMapUv),C.push(_.specularIntensityMapUv),C.push(_.transmissionMapUv),C.push(_.thicknessMapUv),C.push(_.combine),C.push(_.fogExp2),C.push(_.sizeAttenuation),C.push(_.morphTargetsCount),C.push(_.morphAttributeCount),C.push(_.numDirLights),C.push(_.numPointLights),C.push(_.numSpotLights),C.push(_.numSpotLightMaps),C.push(_.numHemiLights),C.push(_.numRectAreaLights),C.push(_.numDirLightShadows),C.push(_.numPointLightShadows),C.push(_.numSpotLightShadows),C.push(_.numSpotLightShadowsWithMaps),C.push(_.numLightProbes),C.push(_.shadowMapType),C.push(_.toneMapping),C.push(_.numClippingPlanes),C.push(_.numClipIntersection),C.push(_.depthPacking)}function E(C,_){a.disableAll(),_.supportsVertexTextures&&a.enable(0),_.instancing&&a.enable(1),_.instancingColor&&a.enable(2),_.instancingMorph&&a.enable(3),_.matcap&&a.enable(4),_.envMap&&a.enable(5),_.normalMapObjectSpace&&a.enable(6),_.normalMapTangentSpace&&a.enable(7),_.clearcoat&&a.enable(8),_.iridescence&&a.enable(9),_.alphaTest&&a.enable(10),_.vertexColors&&a.enable(11),_.vertexAlphas&&a.enable(12),_.vertexUv1s&&a.enable(13),_.vertexUv2s&&a.enable(14),_.vertexUv3s&&a.enable(15),_.vertexTangents&&a.enable(16),_.anisotropy&&a.enable(17),_.alphaHash&&a.enable(18),_.batching&&a.enable(19),_.dispersion&&a.enable(20),C.push(a.mask),a.disableAll(),_.fog&&a.enable(0),_.useFog&&a.enable(1),_.flatShading&&a.enable(2),_.logarithmicDepthBuffer&&a.enable(3),_.skinning&&a.enable(4),_.morphTargets&&a.enable(5),_.morphNormals&&a.enable(6),_.morphColors&&a.enable(7),_.premultipliedAlpha&&a.enable(8),_.shadowMapEnabled&&a.enable(9),_.useLegacyLights&&a.enable(10),_.doubleSided&&a.enable(11),_.flipSided&&a.enable(12),_.useDepthPacking&&a.enable(13),_.dithering&&a.enable(14),_.transmission&&a.enable(15),_.sheen&&a.enable(16),_.opaque&&a.enable(17),_.pointsUvs&&a.enable(18),_.decodeVideoTexture&&a.enable(19),_.alphaToCoverage&&a.enable(20),C.push(a.mask)}function y(C){let _=x[C.type],M;if(_){let B=br[_];M=m6.clone(B.uniforms)}else M=C.uniforms;return M}function w(C,_){let M;for(let B=0,F=u.length;B<F;B++){let N=u[B];if(N.cacheKey===_){M=N,++M.usedTimes;break}}return M===void 0&&(M=new Ak(i,_,C,s),u.push(M)),M}function A(C){if(--C.usedTimes===0){let _=u.indexOf(C);u[_]=u[u.length-1],u.pop(),C.destroy()}}function b(C){c.remove(C)}function D(){c.dispose()}return{getParameters:p,getProgramCacheKey:m,getUniforms:y,acquireProgram:w,releaseProgram:A,releaseShaderCache:b,programs:u,dispose:D}}function Dk(){let i=new WeakMap;function e(s){let o=i.get(s);return o===void 0&&(o={},i.set(s,o)),o}function t(s){i.delete(s)}function n(s,o,a){i.get(s)[o]=a}function r(){i=new WeakMap}return{get:e,remove:t,update:n,dispose:r}}function Sk(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function Ob(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function kb(){let i=[],e=0,t=[],n=[],r=[];function s(){e=0,t.length=0,n.length=0,r.length=0}function o(h,d,f,x,g,p){let m=i[e];return m===void 0?(m={id:h.id,object:h,geometry:d,material:f,groupOrder:x,renderOrder:h.renderOrder,z:g,group:p},i[e]=m):(m.id=h.id,m.object=h,m.geometry=d,m.material=f,m.groupOrder=x,m.renderOrder=h.renderOrder,m.z=g,m.group=p),e++,m}function a(h,d,f,x,g,p){let m=o(h,d,f,x,g,p);f.transmission>0?n.push(m):f.transparent===!0?r.push(m):t.push(m)}function c(h,d,f,x,g,p){let m=o(h,d,f,x,g,p);f.transmission>0?n.unshift(m):f.transparent===!0?r.unshift(m):t.unshift(m)}function l(h,d){t.length>1&&t.sort(h||Sk),n.length>1&&n.sort(d||Ob),r.length>1&&r.sort(d||Ob)}function u(){for(let h=e,d=i.length;h<d;h++){let f=i[h];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:t,transmissive:n,transparent:r,init:s,push:a,unshift:c,finish:u,sort:l}}function Mk(){let i=new WeakMap;function e(n,r){let s=i.get(n),o;return s===void 0?(o=new kb,i.set(n,[o])):r>=s.length?(o=new kb,s.push(o)):o=s[r],o}function t(){i=new WeakMap}return{get:e,dispose:t}}function Tk(){let i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new k,color:new Ge};break;case"SpotLight":t={position:new k,direction:new k,color:new Ge,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new k,color:new Ge,distance:0,decay:0};break;case"HemisphereLight":t={direction:new k,skyColor:new Ge,groundColor:new Ge};break;case"RectAreaLight":t={color:new Ge,position:new k,halfWidth:new k,halfHeight:new k};break}return i[e.id]=t,t}}}function Fk(){let i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new We};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new We};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new We,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}var Bk=0;function Ik(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function Pk(i){let e=new Tk,t=Fk(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let l=0;l<9;l++)n.probe.push(new k);let r=new k,s=new qe,o=new qe;function a(l,u){let h=0,d=0,f=0;for(let M=0;M<9;M++)n.probe[M].set(0,0,0);let x=0,g=0,p=0,m=0,v=0,E=0,y=0,w=0,A=0,b=0,D=0;l.sort(Ik);let C=u===!0?Math.PI:1;for(let M=0,B=l.length;M<B;M++){let F=l[M],N=F.color,L=F.intensity,Z=F.distance,Q=F.shadow&&F.shadow.map?F.shadow.map.texture:null;if(F.isAmbientLight)h+=N.r*L*C,d+=N.g*L*C,f+=N.b*L*C;else if(F.isLightProbe){for(let j=0;j<9;j++)n.probe[j].addScaledVector(F.sh.coefficients[j],L);D++}else if(F.isDirectionalLight){let j=e.get(F);if(j.color.copy(F.color).multiplyScalar(F.intensity*C),F.castShadow){let W=F.shadow,ie=t.get(F);ie.shadowBias=W.bias,ie.shadowNormalBias=W.normalBias,ie.shadowRadius=W.radius,ie.shadowMapSize=W.mapSize,n.directionalShadow[x]=ie,n.directionalShadowMap[x]=Q,n.directionalShadowMatrix[x]=F.shadow.matrix,E++}n.directional[x]=j,x++}else if(F.isSpotLight){let j=e.get(F);j.position.setFromMatrixPosition(F.matrixWorld),j.color.copy(N).multiplyScalar(L*C),j.distance=Z,j.coneCos=Math.cos(F.angle),j.penumbraCos=Math.cos(F.angle*(1-F.penumbra)),j.decay=F.decay,n.spot[p]=j;let W=F.shadow;if(F.map&&(n.spotLightMap[A]=F.map,A++,W.updateMatrices(F),F.castShadow&&b++),n.spotLightMatrix[p]=W.matrix,F.castShadow){let ie=t.get(F);ie.shadowBias=W.bias,ie.shadowNormalBias=W.normalBias,ie.shadowRadius=W.radius,ie.shadowMapSize=W.mapSize,n.spotShadow[p]=ie,n.spotShadowMap[p]=Q,w++}p++}else if(F.isRectAreaLight){let j=e.get(F);j.color.copy(N).multiplyScalar(L),j.halfWidth.set(F.width*.5,0,0),j.halfHeight.set(0,F.height*.5,0),n.rectArea[m]=j,m++}else if(F.isPointLight){let j=e.get(F);if(j.color.copy(F.color).multiplyScalar(F.intensity*C),j.distance=F.distance,j.decay=F.decay,F.castShadow){let W=F.shadow,ie=t.get(F);ie.shadowBias=W.bias,ie.shadowNormalBias=W.normalBias,ie.shadowRadius=W.radius,ie.shadowMapSize=W.mapSize,ie.shadowCameraNear=W.camera.near,ie.shadowCameraFar=W.camera.far,n.pointShadow[g]=ie,n.pointShadowMap[g]=Q,n.pointShadowMatrix[g]=F.shadow.matrix,y++}n.point[g]=j,g++}else if(F.isHemisphereLight){let j=e.get(F);j.skyColor.copy(F.color).multiplyScalar(L*C),j.groundColor.copy(F.groundColor).multiplyScalar(L*C),n.hemi[v]=j,v++}}m>0&&(i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=xe.LTC_FLOAT_1,n.rectAreaLTC2=xe.LTC_FLOAT_2):(n.rectAreaLTC1=xe.LTC_HALF_1,n.rectAreaLTC2=xe.LTC_HALF_2)),n.ambient[0]=h,n.ambient[1]=d,n.ambient[2]=f;let _=n.hash;(_.directionalLength!==x||_.pointLength!==g||_.spotLength!==p||_.rectAreaLength!==m||_.hemiLength!==v||_.numDirectionalShadows!==E||_.numPointShadows!==y||_.numSpotShadows!==w||_.numSpotMaps!==A||_.numLightProbes!==D)&&(n.directional.length=x,n.spot.length=p,n.rectArea.length=m,n.point.length=g,n.hemi.length=v,n.directionalShadow.length=E,n.directionalShadowMap.length=E,n.pointShadow.length=y,n.pointShadowMap.length=y,n.spotShadow.length=w,n.spotShadowMap.length=w,n.directionalShadowMatrix.length=E,n.pointShadowMatrix.length=y,n.spotLightMatrix.length=w+A-b,n.spotLightMap.length=A,n.numSpotLightShadowsWithMaps=b,n.numLightProbes=D,_.directionalLength=x,_.pointLength=g,_.spotLength=p,_.rectAreaLength=m,_.hemiLength=v,_.numDirectionalShadows=E,_.numPointShadows=y,_.numSpotShadows=w,_.numSpotMaps=A,_.numLightProbes=D,n.version=Bk++)}function c(l,u){let h=0,d=0,f=0,x=0,g=0,p=u.matrixWorldInverse;for(let m=0,v=l.length;m<v;m++){let E=l[m];if(E.isDirectionalLight){let y=n.directional[h];y.direction.setFromMatrixPosition(E.matrixWorld),r.setFromMatrixPosition(E.target.matrixWorld),y.direction.sub(r),y.direction.transformDirection(p),h++}else if(E.isSpotLight){let y=n.spot[f];y.position.setFromMatrixPosition(E.matrixWorld),y.position.applyMatrix4(p),y.direction.setFromMatrixPosition(E.matrixWorld),r.setFromMatrixPosition(E.target.matrixWorld),y.direction.sub(r),y.direction.transformDirection(p),f++}else if(E.isRectAreaLight){let y=n.rectArea[x];y.position.setFromMatrixPosition(E.matrixWorld),y.position.applyMatrix4(p),o.identity(),s.copy(E.matrixWorld),s.premultiply(p),o.extractRotation(s),y.halfWidth.set(E.width*.5,0,0),y.halfHeight.set(0,E.height*.5,0),y.halfWidth.applyMatrix4(o),y.halfHeight.applyMatrix4(o),x++}else if(E.isPointLight){let y=n.point[d];y.position.setFromMatrixPosition(E.matrixWorld),y.position.applyMatrix4(p),d++}else if(E.isHemisphereLight){let y=n.hemi[g];y.direction.setFromMatrixPosition(E.matrixWorld),y.direction.transformDirection(p),g++}}}return{setup:a,setupView:c,state:n}}function Nb(i){let e=new Pk(i),t=[],n=[];function r(u){l.camera=u,t.length=0,n.length=0}function s(u){t.push(u)}function o(u){n.push(u)}function a(u){e.setup(t,u)}function c(u){e.setupView(t,u)}let l={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:l,setupLights:a,setupLightsView:c,pushLight:s,pushShadow:o}}function Rk(i){let e=new WeakMap;function t(r,s=0){let o=e.get(r),a;return o===void 0?(a=new Nb(i),e.set(r,[a])):s>=o.length?(a=new Nb(i),o.push(a)):a=o[s],a}function n(){e=new WeakMap}return{get:t,dispose:n}}var yv=class extends Fi{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=MP,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},Cv=class extends Fi{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}},Ok=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,kk=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Nk(i,e,t){let n=new Tu,r=new We,s=new We,o=new Zt,a=new yv({depthPacking:TP}),c=new Cv,l={},u=t.maxTextureSize,h={[Mr]:ri,[ri]:Mr,[ns]:ns},d=new Fr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new We},radius:{value:4}},vertexShader:Ok,fragmentShader:kk}),f=d.clone();f.defines.HORIZONTAL_PASS=1;let x=new bn;x.setAttribute("position",new Mi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let g=new ii(x,d),p=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Zb;let m=this.type;this.render=function(A,b,D){if(p.enabled===!1||p.autoUpdate===!1&&p.needsUpdate===!1||A.length===0)return;let C=i.getRenderTarget(),_=i.getActiveCubeFace(),M=i.getActiveMipmapLevel(),B=i.state;B.setBlending(Os),B.buffers.color.setClear(1,1,1,1),B.buffers.depth.setTest(!0),B.setScissorTest(!1);let F=m!==es&&this.type===es,N=m===es&&this.type!==es;for(let L=0,Z=A.length;L<Z;L++){let Q=A[L],j=Q.shadow;if(j===void 0){console.warn("THREE.WebGLShadowMap:",Q,"has no shadow.");continue}if(j.autoUpdate===!1&&j.needsUpdate===!1)continue;r.copy(j.mapSize);let W=j.getFrameExtents();if(r.multiply(W),s.copy(j.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/W.x),r.x=s.x*W.x,j.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/W.y),r.y=s.y*W.y,j.mapSize.y=s.y)),j.map===null||F===!0||N===!0){let ue=this.type!==es?{minFilter:Si,magFilter:Si}:{};j.map!==null&&j.map.dispose(),j.map=new rs(r.x,r.y,ue),j.map.texture.name=Q.name+".shadowMap",j.camera.updateProjectionMatrix()}i.setRenderTarget(j.map),i.clear();let ie=j.getViewportCount();for(let ue=0;ue<ie;ue++){let de=j.getViewport(ue);o.set(s.x*de.x,s.y*de.y,s.x*de.z,s.y*de.w),B.viewport(o),j.updateMatrices(Q,ue),n=j.getFrustum(),y(b,D,j.camera,Q,this.type)}j.isPointLightShadow!==!0&&this.type===es&&v(j,D),j.needsUpdate=!1}m=this.type,p.needsUpdate=!1,i.setRenderTarget(C,_,M)};function v(A,b){let D=e.update(g);d.defines.VSM_SAMPLES!==A.blurSamples&&(d.defines.VSM_SAMPLES=A.blurSamples,f.defines.VSM_SAMPLES=A.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),A.mapPass===null&&(A.mapPass=new rs(r.x,r.y)),d.uniforms.shadow_pass.value=A.map.texture,d.uniforms.resolution.value=A.mapSize,d.uniforms.radius.value=A.radius,i.setRenderTarget(A.mapPass),i.clear(),i.renderBufferDirect(b,null,D,d,g,null),f.uniforms.shadow_pass.value=A.mapPass.texture,f.uniforms.resolution.value=A.mapSize,f.uniforms.radius.value=A.radius,i.setRenderTarget(A.map),i.clear(),i.renderBufferDirect(b,null,D,f,g,null)}function E(A,b,D,C){let _=null,M=D.isPointLight===!0?A.customDistanceMaterial:A.customDepthMaterial;if(M!==void 0)_=M;else if(_=D.isPointLight===!0?c:a,i.localClippingEnabled&&b.clipShadows===!0&&Array.isArray(b.clippingPlanes)&&b.clippingPlanes.length!==0||b.displacementMap&&b.displacementScale!==0||b.alphaMap&&b.alphaTest>0||b.map&&b.alphaTest>0){let B=_.uuid,F=b.uuid,N=l[B];N===void 0&&(N={},l[B]=N);let L=N[F];L===void 0&&(L=_.clone(),N[F]=L,b.addEventListener("dispose",w)),_=L}if(_.visible=b.visible,_.wireframe=b.wireframe,C===es?_.side=b.shadowSide!==null?b.shadowSide:b.side:_.side=b.shadowSide!==null?b.shadowSide:h[b.side],_.alphaMap=b.alphaMap,_.alphaTest=b.alphaTest,_.map=b.map,_.clipShadows=b.clipShadows,_.clippingPlanes=b.clippingPlanes,_.clipIntersection=b.clipIntersection,_.displacementMap=b.displacementMap,_.displacementScale=b.displacementScale,_.displacementBias=b.displacementBias,_.wireframeLinewidth=b.wireframeLinewidth,_.linewidth=b.linewidth,D.isPointLight===!0&&_.isMeshDistanceMaterial===!0){let B=i.properties.get(_);B.light=D}return _}function y(A,b,D,C,_){if(A.visible===!1)return;if(A.layers.test(b.layers)&&(A.isMesh||A.isLine||A.isPoints)&&(A.castShadow||A.receiveShadow&&_===es)&&(!A.frustumCulled||n.intersectsObject(A))){A.modelViewMatrix.multiplyMatrices(D.matrixWorldInverse,A.matrixWorld);let F=e.update(A),N=A.material;if(Array.isArray(N)){let L=F.groups;for(let Z=0,Q=L.length;Z<Q;Z++){let j=L[Z],W=N[j.materialIndex];if(W&&W.visible){let ie=E(A,W,C,_);A.onBeforeShadow(i,A,b,D,F,ie,j),i.renderBufferDirect(D,null,F,ie,A,j),A.onAfterShadow(i,A,b,D,F,ie,j)}}}else if(N.visible){let L=E(A,N,C,_);A.onBeforeShadow(i,A,b,D,F,L,null),i.renderBufferDirect(D,null,F,L,A,null),A.onAfterShadow(i,A,b,D,F,L,null)}}let B=A.children;for(let F=0,N=B.length;F<N;F++)y(B[F],b,D,C,_)}function w(A){A.target.removeEventListener("dispose",w);for(let D in l){let C=l[D],_=A.target.uuid;_ in C&&(C[_].dispose(),delete C[_])}}}function Lk(i){function e(){let H=!1,ae=new Zt,re=null,ve=new Zt(0,0,0,0);return{setMask:function(Ae){re!==Ae&&!H&&(i.colorMask(Ae,Ae,Ae,Ae),re=Ae)},setLocked:function(Ae){H=Ae},setClear:function(Ae,bt,$t,Jt,On){On===!0&&(Ae*=Jt,bt*=Jt,$t*=Jt),ae.set(Ae,bt,$t,Jt),ve.equals(ae)===!1&&(i.clearColor(Ae,bt,$t,Jt),ve.copy(ae))},reset:function(){H=!1,re=null,ve.set(-1,0,0,0)}}}function t(){let H=!1,ae=null,re=null,ve=null;return{setTest:function(Ae){Ae?z(i.DEPTH_TEST):R(i.DEPTH_TEST)},setMask:function(Ae){ae!==Ae&&!H&&(i.depthMask(Ae),ae=Ae)},setFunc:function(Ae){if(re!==Ae){switch(Ae){case tP:i.depthFunc(i.NEVER);break;case nP:i.depthFunc(i.ALWAYS);break;case iP:i.depthFunc(i.LESS);break;case Af:i.depthFunc(i.LEQUAL);break;case rP:i.depthFunc(i.EQUAL);break;case sP:i.depthFunc(i.GEQUAL);break;case oP:i.depthFunc(i.GREATER);break;case aP:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}re=Ae}},setLocked:function(Ae){H=Ae},setClear:function(Ae){ve!==Ae&&(i.clearDepth(Ae),ve=Ae)},reset:function(){H=!1,ae=null,re=null,ve=null}}}function n(){let H=!1,ae=null,re=null,ve=null,Ae=null,bt=null,$t=null,Jt=null,On=null;return{setTest:function(Ft){H||(Ft?z(i.STENCIL_TEST):R(i.STENCIL_TEST))},setMask:function(Ft){ae!==Ft&&!H&&(i.stencilMask(Ft),ae=Ft)},setFunc:function(Ft,dr,Wn){(re!==Ft||ve!==dr||Ae!==Wn)&&(i.stencilFunc(Ft,dr,Wn),re=Ft,ve=dr,Ae=Wn)},setOp:function(Ft,dr,Wn){(bt!==Ft||$t!==dr||Jt!==Wn)&&(i.stencilOp(Ft,dr,Wn),bt=Ft,$t=dr,Jt=Wn)},setLocked:function(Ft){H=Ft},setClear:function(Ft){On!==Ft&&(i.clearStencil(Ft),On=Ft)},reset:function(){H=!1,ae=null,re=null,ve=null,Ae=null,bt=null,$t=null,Jt=null,On=null}}}let r=new e,s=new t,o=new n,a=new WeakMap,c=new WeakMap,l={},u={},h=new WeakMap,d=[],f=null,x=!1,g=null,p=null,m=null,v=null,E=null,y=null,w=null,A=new Ge(0,0,0),b=0,D=!1,C=null,_=null,M=null,B=null,F=null,N=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS),L=!1,Z=0,Q=i.getParameter(i.VERSION);Q.indexOf("WebGL")!==-1?(Z=parseFloat(/^WebGL (\d)/.exec(Q)[1]),L=Z>=1):Q.indexOf("OpenGL ES")!==-1&&(Z=parseFloat(/^OpenGL ES (\d)/.exec(Q)[1]),L=Z>=2);let j=null,W={},ie=i.getParameter(i.SCISSOR_BOX),ue=i.getParameter(i.VIEWPORT),de=new Zt().fromArray(ie),$e=new Zt().fromArray(ue);function X(H,ae,re,ve){let Ae=new Uint8Array(4),bt=i.createTexture();i.bindTexture(H,bt),i.texParameteri(H,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(H,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let $t=0;$t<re;$t++)H===i.TEXTURE_3D||H===i.TEXTURE_2D_ARRAY?i.texImage3D(ae,0,i.RGBA,1,1,ve,0,i.RGBA,i.UNSIGNED_BYTE,Ae):i.texImage2D(ae+$t,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,Ae);return bt}let O={};O[i.TEXTURE_2D]=X(i.TEXTURE_2D,i.TEXTURE_2D,1),O[i.TEXTURE_CUBE_MAP]=X(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),O[i.TEXTURE_2D_ARRAY]=X(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),O[i.TEXTURE_3D]=X(i.TEXTURE_3D,i.TEXTURE_3D,1,1),r.setClear(0,0,0,1),s.setClear(1),o.setClear(0),z(i.DEPTH_TEST),s.setFunc(Af),he(!1),Be(pw),z(i.CULL_FACE),De(Os);function z(H){l[H]!==!0&&(i.enable(H),l[H]=!0)}function R(H){l[H]!==!1&&(i.disable(H),l[H]=!1)}function K(H,ae){return u[H]!==ae?(i.bindFramebuffer(H,ae),u[H]=ae,H===i.DRAW_FRAMEBUFFER&&(u[i.FRAMEBUFFER]=ae),H===i.FRAMEBUFFER&&(u[i.DRAW_FRAMEBUFFER]=ae),!0):!1}function $(H,ae){let re=d,ve=!1;if(H){re=h.get(ae),re===void 0&&(re=[],h.set(ae,re));let Ae=H.textures;if(re.length!==Ae.length||re[0]!==i.COLOR_ATTACHMENT0){for(let bt=0,$t=Ae.length;bt<$t;bt++)re[bt]=i.COLOR_ATTACHMENT0+bt;re.length=Ae.length,ve=!0}}else re[0]!==i.BACK&&(re[0]=i.BACK,ve=!0);ve&&i.drawBuffers(re)}function P(H){return f!==H?(i.useProgram(H),f=H,!0):!1}let fe={[Vo]:i.FUNC_ADD,[LI]:i.FUNC_SUBTRACT,[UI]:i.FUNC_REVERSE_SUBTRACT};fe[VI]=i.MIN,fe[zI]=i.MAX;let oe={[HI]:i.ZERO,[jI]:i.ONE,[GI]:i.SRC_COLOR,[iv]:i.SRC_ALPHA,[ZI]:i.SRC_ALPHA_SATURATE,[qI]:i.DST_COLOR,[$I]:i.DST_ALPHA,[WI]:i.ONE_MINUS_SRC_COLOR,[rv]:i.ONE_MINUS_SRC_ALPHA,[YI]:i.ONE_MINUS_DST_COLOR,[XI]:i.ONE_MINUS_DST_ALPHA,[KI]:i.CONSTANT_COLOR,[JI]:i.ONE_MINUS_CONSTANT_COLOR,[QI]:i.CONSTANT_ALPHA,[eP]:i.ONE_MINUS_CONSTANT_ALPHA};function De(H,ae,re,ve,Ae,bt,$t,Jt,On,Ft){if(H===Os){x===!0&&(R(i.BLEND),x=!1);return}if(x===!1&&(z(i.BLEND),x=!0),H!==NI){if(H!==g||Ft!==D){if((p!==Vo||E!==Vo)&&(i.blendEquation(i.FUNC_ADD),p=Vo,E=Vo),Ft)switch(H){case fc:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case xw:i.blendFunc(i.ONE,i.ONE);break;case mw:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case gw:i.blendFuncSeparate(i.ZERO,i.SRC_COLOR,i.ZERO,i.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",H);break}else switch(H){case fc:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case xw:i.blendFunc(i.SRC_ALPHA,i.ONE);break;case mw:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case gw:i.blendFunc(i.ZERO,i.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",H);break}m=null,v=null,y=null,w=null,A.set(0,0,0),b=0,g=H,D=Ft}return}Ae=Ae||ae,bt=bt||re,$t=$t||ve,(ae!==p||Ae!==E)&&(i.blendEquationSeparate(fe[ae],fe[Ae]),p=ae,E=Ae),(re!==m||ve!==v||bt!==y||$t!==w)&&(i.blendFuncSeparate(oe[re],oe[ve],oe[bt],oe[$t]),m=re,v=ve,y=bt,w=$t),(Jt.equals(A)===!1||On!==b)&&(i.blendColor(Jt.r,Jt.g,Jt.b,On),A.copy(Jt),b=On),g=H,D=!1}function ge(H,ae){H.side===ns?R(i.CULL_FACE):z(i.CULL_FACE);let re=H.side===ri;ae&&(re=!re),he(re),H.blending===fc&&H.transparent===!1?De(Os):De(H.blending,H.blendEquation,H.blendSrc,H.blendDst,H.blendEquationAlpha,H.blendSrcAlpha,H.blendDstAlpha,H.blendColor,H.blendAlpha,H.premultipliedAlpha),s.setFunc(H.depthFunc),s.setTest(H.depthTest),s.setMask(H.depthWrite),r.setMask(H.colorWrite);let ve=H.stencilWrite;o.setTest(ve),ve&&(o.setMask(H.stencilWriteMask),o.setFunc(H.stencilFunc,H.stencilRef,H.stencilFuncMask),o.setOp(H.stencilFail,H.stencilZFail,H.stencilZPass)),Wt(H.polygonOffset,H.polygonOffsetFactor,H.polygonOffsetUnits),H.alphaToCoverage===!0?z(i.SAMPLE_ALPHA_TO_COVERAGE):R(i.SAMPLE_ALPHA_TO_COVERAGE)}function he(H){C!==H&&(H?i.frontFace(i.CW):i.frontFace(i.CCW),C=H)}function Be(H){H!==RI?(z(i.CULL_FACE),H!==_&&(H===pw?i.cullFace(i.BACK):H===OI?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):R(i.CULL_FACE),_=H}function Te(H){H!==M&&(L&&i.lineWidth(H),M=H)}function Wt(H,ae,re){H?(z(i.POLYGON_OFFSET_FILL),(B!==ae||F!==re)&&(i.polygonOffset(ae,re),B=ae,F=re)):R(i.POLYGON_OFFSET_FILL)}function I(H){H?z(i.SCISSOR_TEST):R(i.SCISSOR_TEST)}function S(H){H===void 0&&(H=i.TEXTURE0+N-1),j!==H&&(i.activeTexture(H),j=H)}function te(H,ae,re){re===void 0&&(j===null?re=i.TEXTURE0+N-1:re=j);let ve=W[re];ve===void 0&&(ve={type:void 0,texture:void 0},W[re]=ve),(ve.type!==H||ve.texture!==ae)&&(j!==re&&(i.activeTexture(re),j=re),i.bindTexture(H,ae||O[H]),ve.type=H,ve.texture=ae)}function se(){let H=W[j];H!==void 0&&H.type!==void 0&&(i.bindTexture(H.type,null),H.type=void 0,H.texture=void 0)}function ce(){try{i.compressedTexImage2D.apply(i,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function le(){try{i.compressedTexImage3D.apply(i,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function Ne(){try{i.texSubImage2D.apply(i,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function Ce(){try{i.texSubImage3D.apply(i,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function ye(){try{i.compressedTexSubImage2D.apply(i,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function ot(){try{i.compressedTexSubImage3D.apply(i,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function pe(){try{i.texStorage2D.apply(i,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function Oe(){try{i.texStorage3D.apply(i,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function wt(){try{i.texImage2D.apply(i,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function Ue(){try{i.texImage3D.apply(i,arguments)}catch(H){console.error("THREE.WebGLState:",H)}}function we(H){de.equals(H)===!1&&(i.scissor(H.x,H.y,H.z,H.w),de.copy(H))}function at(H){$e.equals(H)===!1&&(i.viewport(H.x,H.y,H.z,H.w),$e.copy(H))}function pt(H,ae){let re=c.get(ae);re===void 0&&(re=new WeakMap,c.set(ae,re));let ve=re.get(H);ve===void 0&&(ve=i.getUniformBlockIndex(ae,H.name),re.set(H,ve))}function sn(H,ae){let ve=c.get(ae).get(H);a.get(ae)!==ve&&(i.uniformBlockBinding(ae,ve,H.__bindingPointIndex),a.set(ae,ve))}function ct(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),l={},j=null,W={},u={},h=new WeakMap,d=[],f=null,x=!1,g=null,p=null,m=null,v=null,E=null,y=null,w=null,A=new Ge(0,0,0),b=0,D=!1,C=null,_=null,M=null,B=null,F=null,de.set(0,0,i.canvas.width,i.canvas.height),$e.set(0,0,i.canvas.width,i.canvas.height),r.reset(),s.reset(),o.reset()}return{buffers:{color:r,depth:s,stencil:o},enable:z,disable:R,bindFramebuffer:K,drawBuffers:$,useProgram:P,setBlending:De,setMaterial:ge,setFlipSided:he,setCullFace:Be,setLineWidth:Te,setPolygonOffset:Wt,setScissorTest:I,activeTexture:S,bindTexture:te,unbindTexture:se,compressedTexImage2D:ce,compressedTexImage3D:le,texImage2D:wt,texImage3D:Ue,updateUBOMapping:pt,uniformBlockBinding:sn,texStorage2D:pe,texStorage3D:Oe,texSubImage2D:Ne,texSubImage3D:Ce,compressedTexSubImage2D:ye,compressedTexSubImage3D:ot,scissor:we,viewport:at,reset:ct}}function Uk(i,e,t,n,r,s,o){let a=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,c=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),l=new We,u=new WeakMap,h,d=new WeakMap,f=!1;try{f=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function x(I,S){return f?new OffscreenCanvas(I,S):Du("canvas")}function g(I,S,te){let se=1,ce=Wt(I);if((ce.width>te||ce.height>te)&&(se=te/Math.max(ce.width,ce.height)),se<1)if(typeof HTMLImageElement<"u"&&I instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&I instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&I instanceof ImageBitmap||typeof VideoFrame<"u"&&I instanceof VideoFrame){let le=Math.floor(se*ce.width),Ne=Math.floor(se*ce.height);h===void 0&&(h=x(le,Ne));let Ce=S?x(le,Ne):h;return Ce.width=le,Ce.height=Ne,Ce.getContext("2d").drawImage(I,0,0,le,Ne),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ce.width+"x"+ce.height+") to ("+le+"x"+Ne+")."),Ce}else return"data"in I&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ce.width+"x"+ce.height+")."),I;return I}function p(I){return I.generateMipmaps&&I.minFilter!==Si&&I.minFilter!==er}function m(I){i.generateMipmap(I)}function v(I,S,te,se,ce=!1){if(I!==null){if(i[I]!==void 0)return i[I];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+I+"'")}let le=S;if(S===i.RED&&(te===i.FLOAT&&(le=i.R32F),te===i.HALF_FLOAT&&(le=i.R16F),te===i.UNSIGNED_BYTE&&(le=i.R8)),S===i.RED_INTEGER&&(te===i.UNSIGNED_BYTE&&(le=i.R8UI),te===i.UNSIGNED_SHORT&&(le=i.R16UI),te===i.UNSIGNED_INT&&(le=i.R32UI),te===i.BYTE&&(le=i.R8I),te===i.SHORT&&(le=i.R16I),te===i.INT&&(le=i.R32I)),S===i.RG&&(te===i.FLOAT&&(le=i.RG32F),te===i.HALF_FLOAT&&(le=i.RG16F),te===i.UNSIGNED_BYTE&&(le=i.RG8)),S===i.RG_INTEGER&&(te===i.UNSIGNED_BYTE&&(le=i.RG8UI),te===i.UNSIGNED_SHORT&&(le=i.RG16UI),te===i.UNSIGNED_INT&&(le=i.RG32UI),te===i.BYTE&&(le=i.RG8I),te===i.SHORT&&(le=i.RG16I),te===i.INT&&(le=i.RG32I)),S===i.RGB&&te===i.UNSIGNED_INT_5_9_9_9_REV&&(le=i.RGB9_E5),S===i.RGBA){let Ne=ce?Df:Ot.getTransfer(se);te===i.FLOAT&&(le=i.RGBA32F),te===i.HALF_FLOAT&&(le=i.RGBA16F),te===i.UNSIGNED_BYTE&&(le=Ne===qt?i.SRGB8_ALPHA8:i.RGBA8),te===i.UNSIGNED_SHORT_4_4_4_4&&(le=i.RGBA4),te===i.UNSIGNED_SHORT_5_5_5_1&&(le=i.RGB5_A1)}return(le===i.R16F||le===i.R32F||le===i.RG16F||le===i.RG32F||le===i.RGBA16F||le===i.RGBA32F)&&e.get("EXT_color_buffer_float"),le}function E(I,S){return p(I)===!0||I.isFramebufferTexture&&I.minFilter!==Si&&I.minFilter!==er?Math.log2(Math.max(S.width,S.height))+1:I.mipmaps!==void 0&&I.mipmaps.length>0?I.mipmaps.length:I.isCompressedTexture&&Array.isArray(I.image)?S.mipmaps.length:1}function y(I){let S=I.target;S.removeEventListener("dispose",y),A(S),S.isVideoTexture&&u.delete(S)}function w(I){let S=I.target;S.removeEventListener("dispose",w),D(S)}function A(I){let S=n.get(I);if(S.__webglInit===void 0)return;let te=I.source,se=d.get(te);if(se){let ce=se[S.__cacheKey];ce.usedTimes--,ce.usedTimes===0&&b(I),Object.keys(se).length===0&&d.delete(te)}n.remove(I)}function b(I){let S=n.get(I);i.deleteTexture(S.__webglTexture);let te=I.source,se=d.get(te);delete se[S.__cacheKey],o.memory.textures--}function D(I){let S=n.get(I);if(I.depthTexture&&I.depthTexture.dispose(),I.isWebGLCubeRenderTarget)for(let se=0;se<6;se++){if(Array.isArray(S.__webglFramebuffer[se]))for(let ce=0;ce<S.__webglFramebuffer[se].length;ce++)i.deleteFramebuffer(S.__webglFramebuffer[se][ce]);else i.deleteFramebuffer(S.__webglFramebuffer[se]);S.__webglDepthbuffer&&i.deleteRenderbuffer(S.__webglDepthbuffer[se])}else{if(Array.isArray(S.__webglFramebuffer))for(let se=0;se<S.__webglFramebuffer.length;se++)i.deleteFramebuffer(S.__webglFramebuffer[se]);else i.deleteFramebuffer(S.__webglFramebuffer);if(S.__webglDepthbuffer&&i.deleteRenderbuffer(S.__webglDepthbuffer),S.__webglMultisampledFramebuffer&&i.deleteFramebuffer(S.__webglMultisampledFramebuffer),S.__webglColorRenderbuffer)for(let se=0;se<S.__webglColorRenderbuffer.length;se++)S.__webglColorRenderbuffer[se]&&i.deleteRenderbuffer(S.__webglColorRenderbuffer[se]);S.__webglDepthRenderbuffer&&i.deleteRenderbuffer(S.__webglDepthRenderbuffer)}let te=I.textures;for(let se=0,ce=te.length;se<ce;se++){let le=n.get(te[se]);le.__webglTexture&&(i.deleteTexture(le.__webglTexture),o.memory.textures--),n.remove(te[se])}n.remove(I)}let C=0;function _(){C=0}function M(){let I=C;return I>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+I+" texture units while this GPU supports only "+r.maxTextures),C+=1,I}function B(I){let S=[];return S.push(I.wrapS),S.push(I.wrapT),S.push(I.wrapR||0),S.push(I.magFilter),S.push(I.minFilter),S.push(I.anisotropy),S.push(I.internalFormat),S.push(I.format),S.push(I.type),S.push(I.generateMipmaps),S.push(I.premultiplyAlpha),S.push(I.flipY),S.push(I.unpackAlignment),S.push(I.colorSpace),S.join()}function F(I,S){let te=n.get(I);if(I.isVideoTexture&&Be(I),I.isRenderTargetTexture===!1&&I.version>0&&te.__version!==I.version){let se=I.image;if(se===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(se.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{de(te,I,S);return}}t.bindTexture(i.TEXTURE_2D,te.__webglTexture,i.TEXTURE0+S)}function N(I,S){let te=n.get(I);if(I.version>0&&te.__version!==I.version){de(te,I,S);return}t.bindTexture(i.TEXTURE_2D_ARRAY,te.__webglTexture,i.TEXTURE0+S)}function L(I,S){let te=n.get(I);if(I.version>0&&te.__version!==I.version){de(te,I,S);return}t.bindTexture(i.TEXTURE_3D,te.__webglTexture,i.TEXTURE0+S)}function Z(I,S){let te=n.get(I);if(I.version>0&&te.__version!==I.version){$e(te,I,S);return}t.bindTexture(i.TEXTURE_CUBE_MAP,te.__webglTexture,i.TEXTURE0+S)}let Q={[Au]:i.REPEAT,[Ho]:i.CLAMP_TO_EDGE,[av]:i.MIRRORED_REPEAT},j={[Si]:i.NEAREST,[gP]:i.NEAREST_MIPMAP_NEAREST,[Yd]:i.NEAREST_MIPMAP_LINEAR,[er]:i.LINEAR,[Ag]:i.LINEAR_MIPMAP_NEAREST,[jo]:i.LINEAR_MIPMAP_LINEAR},W={[BP]:i.NEVER,[NP]:i.ALWAYS,[IP]:i.LESS,[sD]:i.LEQUAL,[PP]:i.EQUAL,[kP]:i.GEQUAL,[RP]:i.GREATER,[OP]:i.NOTEQUAL};function ie(I,S){if(S.type===Rs&&e.has("OES_texture_float_linear")===!1&&(S.magFilter===er||S.magFilter===Ag||S.magFilter===Yd||S.magFilter===jo||S.minFilter===er||S.minFilter===Ag||S.minFilter===Yd||S.minFilter===jo)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),i.texParameteri(I,i.TEXTURE_WRAP_S,Q[S.wrapS]),i.texParameteri(I,i.TEXTURE_WRAP_T,Q[S.wrapT]),(I===i.TEXTURE_3D||I===i.TEXTURE_2D_ARRAY)&&i.texParameteri(I,i.TEXTURE_WRAP_R,Q[S.wrapR]),i.texParameteri(I,i.TEXTURE_MAG_FILTER,j[S.magFilter]),i.texParameteri(I,i.TEXTURE_MIN_FILTER,j[S.minFilter]),S.compareFunction&&(i.texParameteri(I,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(I,i.TEXTURE_COMPARE_FUNC,W[S.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(S.magFilter===Si||S.minFilter!==Yd&&S.minFilter!==jo||S.type===Rs&&e.has("OES_texture_float_linear")===!1)return;if(S.anisotropy>1||n.get(S).__currentAnisotropy){let te=e.get("EXT_texture_filter_anisotropic");i.texParameterf(I,te.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(S.anisotropy,r.getMaxAnisotropy())),n.get(S).__currentAnisotropy=S.anisotropy}}}function ue(I,S){let te=!1;I.__webglInit===void 0&&(I.__webglInit=!0,S.addEventListener("dispose",y));let se=S.source,ce=d.get(se);ce===void 0&&(ce={},d.set(se,ce));let le=B(S);if(le!==I.__cacheKey){ce[le]===void 0&&(ce[le]={texture:i.createTexture(),usedTimes:0},o.memory.textures++,te=!0),ce[le].usedTimes++;let Ne=ce[I.__cacheKey];Ne!==void 0&&(ce[I.__cacheKey].usedTimes--,Ne.usedTimes===0&&b(S)),I.__cacheKey=le,I.__webglTexture=ce[le].texture}return te}function de(I,S,te){let se=i.TEXTURE_2D;(S.isDataArrayTexture||S.isCompressedArrayTexture)&&(se=i.TEXTURE_2D_ARRAY),S.isData3DTexture&&(se=i.TEXTURE_3D);let ce=ue(I,S),le=S.source;t.bindTexture(se,I.__webglTexture,i.TEXTURE0+te);let Ne=n.get(le);if(le.version!==Ne.__version||ce===!0){t.activeTexture(i.TEXTURE0+te);let Ce=Ot.getPrimaries(Ot.workingColorSpace),ye=S.colorSpace===Ps?null:Ot.getPrimaries(S.colorSpace),ot=S.colorSpace===Ps||Ce===ye?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,S.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,S.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,S.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,ot);let pe=g(S.image,!1,r.maxTextureSize);pe=Te(S,pe);let Oe=s.convert(S.format,S.colorSpace),wt=s.convert(S.type),Ue=v(S.internalFormat,Oe,wt,S.colorSpace,S.isVideoTexture);ie(se,S);let we,at=S.mipmaps,pt=S.isVideoTexture!==!0,sn=Ne.__version===void 0||ce===!0,ct=le.dataReady,H=E(S,pe);if(S.isDepthTexture)Ue=i.DEPTH_COMPONENT16,S.type===Rs?Ue=i.DEPTH_COMPONENT32F:S.type===Ec?Ue=i.DEPTH_COMPONENT24:S.type===Bu&&(Ue=i.DEPTH24_STENCIL8),sn&&(pt?t.texStorage2D(i.TEXTURE_2D,1,Ue,pe.width,pe.height):t.texImage2D(i.TEXTURE_2D,0,Ue,pe.width,pe.height,0,Oe,wt,null));else if(S.isDataTexture)if(at.length>0){pt&&sn&&t.texStorage2D(i.TEXTURE_2D,H,Ue,at[0].width,at[0].height);for(let ae=0,re=at.length;ae<re;ae++)we=at[ae],pt?ct&&t.texSubImage2D(i.TEXTURE_2D,ae,0,0,we.width,we.height,Oe,wt,we.data):t.texImage2D(i.TEXTURE_2D,ae,Ue,we.width,we.height,0,Oe,wt,we.data);S.generateMipmaps=!1}else pt?(sn&&t.texStorage2D(i.TEXTURE_2D,H,Ue,pe.width,pe.height),ct&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,pe.width,pe.height,Oe,wt,pe.data)):t.texImage2D(i.TEXTURE_2D,0,Ue,pe.width,pe.height,0,Oe,wt,pe.data);else if(S.isCompressedTexture)if(S.isCompressedArrayTexture){pt&&sn&&t.texStorage3D(i.TEXTURE_2D_ARRAY,H,Ue,at[0].width,at[0].height,pe.depth);for(let ae=0,re=at.length;ae<re;ae++)we=at[ae],S.format!==Dr?Oe!==null?pt?ct&&t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,ae,0,0,0,we.width,we.height,pe.depth,Oe,we.data,0,0):t.compressedTexImage3D(i.TEXTURE_2D_ARRAY,ae,Ue,we.width,we.height,pe.depth,0,we.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):pt?ct&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,ae,0,0,0,we.width,we.height,pe.depth,Oe,wt,we.data):t.texImage3D(i.TEXTURE_2D_ARRAY,ae,Ue,we.width,we.height,pe.depth,0,Oe,wt,we.data)}else{pt&&sn&&t.texStorage2D(i.TEXTURE_2D,H,Ue,at[0].width,at[0].height);for(let ae=0,re=at.length;ae<re;ae++)we=at[ae],S.format!==Dr?Oe!==null?pt?ct&&t.compressedTexSubImage2D(i.TEXTURE_2D,ae,0,0,we.width,we.height,Oe,we.data):t.compressedTexImage2D(i.TEXTURE_2D,ae,Ue,we.width,we.height,0,we.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):pt?ct&&t.texSubImage2D(i.TEXTURE_2D,ae,0,0,we.width,we.height,Oe,wt,we.data):t.texImage2D(i.TEXTURE_2D,ae,Ue,we.width,we.height,0,Oe,wt,we.data)}else if(S.isDataArrayTexture)pt?(sn&&t.texStorage3D(i.TEXTURE_2D_ARRAY,H,Ue,pe.width,pe.height,pe.depth),ct&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,pe.width,pe.height,pe.depth,Oe,wt,pe.data)):t.texImage3D(i.TEXTURE_2D_ARRAY,0,Ue,pe.width,pe.height,pe.depth,0,Oe,wt,pe.data);else if(S.isData3DTexture)pt?(sn&&t.texStorage3D(i.TEXTURE_3D,H,Ue,pe.width,pe.height,pe.depth),ct&&t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,pe.width,pe.height,pe.depth,Oe,wt,pe.data)):t.texImage3D(i.TEXTURE_3D,0,Ue,pe.width,pe.height,pe.depth,0,Oe,wt,pe.data);else if(S.isFramebufferTexture){if(sn)if(pt)t.texStorage2D(i.TEXTURE_2D,H,Ue,pe.width,pe.height);else{let ae=pe.width,re=pe.height;for(let ve=0;ve<H;ve++)t.texImage2D(i.TEXTURE_2D,ve,Ue,ae,re,0,Oe,wt,null),ae>>=1,re>>=1}}else if(at.length>0){if(pt&&sn){let ae=Wt(at[0]);t.texStorage2D(i.TEXTURE_2D,H,Ue,ae.width,ae.height)}for(let ae=0,re=at.length;ae<re;ae++)we=at[ae],pt?ct&&t.texSubImage2D(i.TEXTURE_2D,ae,0,0,Oe,wt,we):t.texImage2D(i.TEXTURE_2D,ae,Ue,Oe,wt,we);S.generateMipmaps=!1}else if(pt){if(sn){let ae=Wt(pe);t.texStorage2D(i.TEXTURE_2D,H,Ue,ae.width,ae.height)}ct&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,Oe,wt,pe)}else t.texImage2D(i.TEXTURE_2D,0,Ue,Oe,wt,pe);p(S)&&m(se),Ne.__version=le.version,S.onUpdate&&S.onUpdate(S)}I.__version=S.version}function $e(I,S,te){if(S.image.length!==6)return;let se=ue(I,S),ce=S.source;t.bindTexture(i.TEXTURE_CUBE_MAP,I.__webglTexture,i.TEXTURE0+te);let le=n.get(ce);if(ce.version!==le.__version||se===!0){t.activeTexture(i.TEXTURE0+te);let Ne=Ot.getPrimaries(Ot.workingColorSpace),Ce=S.colorSpace===Ps?null:Ot.getPrimaries(S.colorSpace),ye=S.colorSpace===Ps||Ne===Ce?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,S.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,S.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,S.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,ye);let ot=S.isCompressedTexture||S.image[0].isCompressedTexture,pe=S.image[0]&&S.image[0].isDataTexture,Oe=[];for(let re=0;re<6;re++)!ot&&!pe?Oe[re]=g(S.image[re],!0,r.maxCubemapSize):Oe[re]=pe?S.image[re].image:S.image[re],Oe[re]=Te(S,Oe[re]);let wt=Oe[0],Ue=s.convert(S.format,S.colorSpace),we=s.convert(S.type),at=v(S.internalFormat,Ue,we,S.colorSpace),pt=S.isVideoTexture!==!0,sn=le.__version===void 0||se===!0,ct=ce.dataReady,H=E(S,wt);ie(i.TEXTURE_CUBE_MAP,S);let ae;if(ot){pt&&sn&&t.texStorage2D(i.TEXTURE_CUBE_MAP,H,at,wt.width,wt.height);for(let re=0;re<6;re++){ae=Oe[re].mipmaps;for(let ve=0;ve<ae.length;ve++){let Ae=ae[ve];S.format!==Dr?Ue!==null?pt?ct&&t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+re,ve,0,0,Ae.width,Ae.height,Ue,Ae.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+re,ve,at,Ae.width,Ae.height,0,Ae.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):pt?ct&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+re,ve,0,0,Ae.width,Ae.height,Ue,we,Ae.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+re,ve,at,Ae.width,Ae.height,0,Ue,we,Ae.data)}}}else{if(ae=S.mipmaps,pt&&sn){ae.length>0&&H++;let re=Wt(Oe[0]);t.texStorage2D(i.TEXTURE_CUBE_MAP,H,at,re.width,re.height)}for(let re=0;re<6;re++)if(pe){pt?ct&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+re,0,0,0,Oe[re].width,Oe[re].height,Ue,we,Oe[re].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+re,0,at,Oe[re].width,Oe[re].height,0,Ue,we,Oe[re].data);for(let ve=0;ve<ae.length;ve++){let bt=ae[ve].image[re].image;pt?ct&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+re,ve+1,0,0,bt.width,bt.height,Ue,we,bt.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+re,ve+1,at,bt.width,bt.height,0,Ue,we,bt.data)}}else{pt?ct&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+re,0,0,0,Ue,we,Oe[re]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+re,0,at,Ue,we,Oe[re]);for(let ve=0;ve<ae.length;ve++){let Ae=ae[ve];pt?ct&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+re,ve+1,0,0,Ue,we,Ae.image[re]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+re,ve+1,at,Ue,we,Ae.image[re])}}}p(S)&&m(i.TEXTURE_CUBE_MAP),le.__version=ce.version,S.onUpdate&&S.onUpdate(S)}I.__version=S.version}function X(I,S,te,se,ce,le){let Ne=s.convert(te.format,te.colorSpace),Ce=s.convert(te.type),ye=v(te.internalFormat,Ne,Ce,te.colorSpace);if(!n.get(S).__hasExternalTextures){let pe=Math.max(1,S.width>>le),Oe=Math.max(1,S.height>>le);ce===i.TEXTURE_3D||ce===i.TEXTURE_2D_ARRAY?t.texImage3D(ce,le,ye,pe,Oe,S.depth,0,Ne,Ce,null):t.texImage2D(ce,le,ye,pe,Oe,0,Ne,Ce,null)}t.bindFramebuffer(i.FRAMEBUFFER,I),he(S)?a.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,se,ce,n.get(te).__webglTexture,0,ge(S)):(ce===i.TEXTURE_2D||ce>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&ce<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,se,ce,n.get(te).__webglTexture,le),t.bindFramebuffer(i.FRAMEBUFFER,null)}function O(I,S,te){if(i.bindRenderbuffer(i.RENDERBUFFER,I),S.depthBuffer&&!S.stencilBuffer){let se=i.DEPTH_COMPONENT24;if(te||he(S)){let ce=S.depthTexture;ce&&ce.isDepthTexture&&(ce.type===Rs?se=i.DEPTH_COMPONENT32F:ce.type===Ec&&(se=i.DEPTH_COMPONENT24));let le=ge(S);he(S)?a.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,le,se,S.width,S.height):i.renderbufferStorageMultisample(i.RENDERBUFFER,le,se,S.width,S.height)}else i.renderbufferStorage(i.RENDERBUFFER,se,S.width,S.height);i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.RENDERBUFFER,I)}else if(S.depthBuffer&&S.stencilBuffer){let se=ge(S);te&&he(S)===!1?i.renderbufferStorageMultisample(i.RENDERBUFFER,se,i.DEPTH24_STENCIL8,S.width,S.height):he(S)?a.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,se,i.DEPTH24_STENCIL8,S.width,S.height):i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,S.width,S.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.RENDERBUFFER,I)}else{let se=S.textures;for(let ce=0;ce<se.length;ce++){let le=se[ce],Ne=s.convert(le.format,le.colorSpace),Ce=s.convert(le.type),ye=v(le.internalFormat,Ne,Ce,le.colorSpace),ot=ge(S);te&&he(S)===!1?i.renderbufferStorageMultisample(i.RENDERBUFFER,ot,ye,S.width,S.height):he(S)?a.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,ot,ye,S.width,S.height):i.renderbufferStorage(i.RENDERBUFFER,ye,S.width,S.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function z(I,S){if(S&&S.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(i.FRAMEBUFFER,I),!(S.depthTexture&&S.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(S.depthTexture).__webglTexture||S.depthTexture.image.width!==S.width||S.depthTexture.image.height!==S.height)&&(S.depthTexture.image.width=S.width,S.depthTexture.image.height=S.height,S.depthTexture.needsUpdate=!0),F(S.depthTexture,0);let se=n.get(S.depthTexture).__webglTexture,ce=ge(S);if(S.depthTexture.format===pc)he(S)?a.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,se,0,ce):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_ATTACHMENT,i.TEXTURE_2D,se,0);else if(S.depthTexture.format===wu)he(S)?a.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,se,0,ce):i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,se,0);else throw new Error("Unknown depthTexture format")}function R(I){let S=n.get(I),te=I.isWebGLCubeRenderTarget===!0;if(I.depthTexture&&!S.__autoAllocateDepthBuffer){if(te)throw new Error("target.depthTexture not supported in Cube render targets");z(S.__webglFramebuffer,I)}else if(te){S.__webglDepthbuffer=[];for(let se=0;se<6;se++)t.bindFramebuffer(i.FRAMEBUFFER,S.__webglFramebuffer[se]),S.__webglDepthbuffer[se]=i.createRenderbuffer(),O(S.__webglDepthbuffer[se],I,!1)}else t.bindFramebuffer(i.FRAMEBUFFER,S.__webglFramebuffer),S.__webglDepthbuffer=i.createRenderbuffer(),O(S.__webglDepthbuffer,I,!1);t.bindFramebuffer(i.FRAMEBUFFER,null)}function K(I,S,te){let se=n.get(I);S!==void 0&&X(se.__webglFramebuffer,I,I.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),te!==void 0&&R(I)}function $(I){let S=I.texture,te=n.get(I),se=n.get(S);I.addEventListener("dispose",w);let ce=I.textures,le=I.isWebGLCubeRenderTarget===!0,Ne=ce.length>1;if(Ne||(se.__webglTexture===void 0&&(se.__webglTexture=i.createTexture()),se.__version=S.version,o.memory.textures++),le){te.__webglFramebuffer=[];for(let Ce=0;Ce<6;Ce++)if(S.mipmaps&&S.mipmaps.length>0){te.__webglFramebuffer[Ce]=[];for(let ye=0;ye<S.mipmaps.length;ye++)te.__webglFramebuffer[Ce][ye]=i.createFramebuffer()}else te.__webglFramebuffer[Ce]=i.createFramebuffer()}else{if(S.mipmaps&&S.mipmaps.length>0){te.__webglFramebuffer=[];for(let Ce=0;Ce<S.mipmaps.length;Ce++)te.__webglFramebuffer[Ce]=i.createFramebuffer()}else te.__webglFramebuffer=i.createFramebuffer();if(Ne)for(let Ce=0,ye=ce.length;Ce<ye;Ce++){let ot=n.get(ce[Ce]);ot.__webglTexture===void 0&&(ot.__webglTexture=i.createTexture(),o.memory.textures++)}if(I.samples>0&&he(I)===!1){te.__webglMultisampledFramebuffer=i.createFramebuffer(),te.__webglColorRenderbuffer=[],t.bindFramebuffer(i.FRAMEBUFFER,te.__webglMultisampledFramebuffer);for(let Ce=0;Ce<ce.length;Ce++){let ye=ce[Ce];te.__webglColorRenderbuffer[Ce]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,te.__webglColorRenderbuffer[Ce]);let ot=s.convert(ye.format,ye.colorSpace),pe=s.convert(ye.type),Oe=v(ye.internalFormat,ot,pe,ye.colorSpace,I.isXRRenderTarget===!0),wt=ge(I);i.renderbufferStorageMultisample(i.RENDERBUFFER,wt,Oe,I.width,I.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+Ce,i.RENDERBUFFER,te.__webglColorRenderbuffer[Ce])}i.bindRenderbuffer(i.RENDERBUFFER,null),I.depthBuffer&&(te.__webglDepthRenderbuffer=i.createRenderbuffer(),O(te.__webglDepthRenderbuffer,I,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}}if(le){t.bindTexture(i.TEXTURE_CUBE_MAP,se.__webglTexture),ie(i.TEXTURE_CUBE_MAP,S);for(let Ce=0;Ce<6;Ce++)if(S.mipmaps&&S.mipmaps.length>0)for(let ye=0;ye<S.mipmaps.length;ye++)X(te.__webglFramebuffer[Ce][ye],I,S,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,ye);else X(te.__webglFramebuffer[Ce],I,S,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+Ce,0);p(S)&&m(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Ne){for(let Ce=0,ye=ce.length;Ce<ye;Ce++){let ot=ce[Ce],pe=n.get(ot);t.bindTexture(i.TEXTURE_2D,pe.__webglTexture),ie(i.TEXTURE_2D,ot),X(te.__webglFramebuffer,I,ot,i.COLOR_ATTACHMENT0+Ce,i.TEXTURE_2D,0),p(ot)&&m(i.TEXTURE_2D)}t.unbindTexture()}else{let Ce=i.TEXTURE_2D;if((I.isWebGL3DRenderTarget||I.isWebGLArrayRenderTarget)&&(Ce=I.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(Ce,se.__webglTexture),ie(Ce,S),S.mipmaps&&S.mipmaps.length>0)for(let ye=0;ye<S.mipmaps.length;ye++)X(te.__webglFramebuffer[ye],I,S,i.COLOR_ATTACHMENT0,Ce,ye);else X(te.__webglFramebuffer,I,S,i.COLOR_ATTACHMENT0,Ce,0);p(S)&&m(Ce),t.unbindTexture()}I.depthBuffer&&R(I)}function P(I){let S=I.textures;for(let te=0,se=S.length;te<se;te++){let ce=S[te];if(p(ce)){let le=I.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:i.TEXTURE_2D,Ne=n.get(ce).__webglTexture;t.bindTexture(le,Ne),m(le),t.unbindTexture()}}}let fe=[],oe=[];function De(I){if(I.samples>0){if(he(I)===!1){let S=I.textures,te=I.width,se=I.height,ce=i.COLOR_BUFFER_BIT,le=I.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Ne=n.get(I),Ce=S.length>1;if(Ce)for(let ye=0;ye<S.length;ye++)t.bindFramebuffer(i.FRAMEBUFFER,Ne.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+ye,i.RENDERBUFFER,null),t.bindFramebuffer(i.FRAMEBUFFER,Ne.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+ye,i.TEXTURE_2D,null,0);t.bindFramebuffer(i.READ_FRAMEBUFFER,Ne.__webglMultisampledFramebuffer),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Ne.__webglFramebuffer);for(let ye=0;ye<S.length;ye++){if(I.resolveDepthBuffer&&(I.depthBuffer&&(ce|=i.DEPTH_BUFFER_BIT),I.stencilBuffer&&I.resolveStencilBuffer&&(ce|=i.STENCIL_BUFFER_BIT)),Ce){i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,Ne.__webglColorRenderbuffer[ye]);let ot=n.get(S[ye]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,ot,0)}i.blitFramebuffer(0,0,te,se,0,0,te,se,ce,i.NEAREST),c===!0&&(fe.length=0,oe.length=0,fe.push(i.COLOR_ATTACHMENT0+ye),I.depthBuffer&&I.resolveDepthBuffer===!1&&(fe.push(le),oe.push(le),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,oe)),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,fe))}if(t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),Ce)for(let ye=0;ye<S.length;ye++){t.bindFramebuffer(i.FRAMEBUFFER,Ne.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+ye,i.RENDERBUFFER,Ne.__webglColorRenderbuffer[ye]);let ot=n.get(S[ye]).__webglTexture;t.bindFramebuffer(i.FRAMEBUFFER,Ne.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+ye,i.TEXTURE_2D,ot,0)}t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Ne.__webglMultisampledFramebuffer)}else if(I.depthBuffer&&I.resolveDepthBuffer===!1&&c){let S=I.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[S])}}}function ge(I){return Math.min(r.maxSamples,I.samples)}function he(I){let S=n.get(I);return I.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&S.__useRenderToTexture!==!1}function Be(I){let S=o.render.frame;u.get(I)!==S&&(u.set(I,S),I.update())}function Te(I,S){let te=I.colorSpace,se=I.format,ce=I.type;return I.isCompressedTexture===!0||I.isVideoTexture===!0||te!==Us&&te!==Ps&&(Ot.getTransfer(te)===qt?(se!==Dr||ce!==Ns)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",te)),S}function Wt(I){return typeof HTMLImageElement<"u"&&I instanceof HTMLImageElement?(l.width=I.naturalWidth||I.width,l.height=I.naturalHeight||I.height):typeof VideoFrame<"u"&&I instanceof VideoFrame?(l.width=I.displayWidth,l.height=I.displayHeight):(l.width=I.width,l.height=I.height),l}this.allocateTextureUnit=M,this.resetTextureUnits=_,this.setTexture2D=F,this.setTexture2DArray=N,this.setTexture3D=L,this.setTextureCube=Z,this.rebindTextures=K,this.setupRenderTarget=$,this.updateRenderTargetMipmap=P,this.updateMultisampleRenderTarget=De,this.setupDepthRenderbuffer=R,this.setupFrameBufferTexture=X,this.useMultisampledRTT=he}function Vk(i,e){function t(n,r=Ps){let s,o=Ot.getTransfer(r);if(n===Ns)return i.UNSIGNED_BYTE;if(n===Qb)return i.UNSIGNED_SHORT_4_4_4_4;if(n===eD)return i.UNSIGNED_SHORT_5_5_5_1;if(n===yP)return i.UNSIGNED_INT_5_9_9_9_REV;if(n===vP)return i.BYTE;if(n===EP)return i.SHORT;if(n===Kb)return i.UNSIGNED_SHORT;if(n===Jb)return i.INT;if(n===Ec)return i.UNSIGNED_INT;if(n===Rs)return i.FLOAT;if(n===Jf)return i.HALF_FLOAT;if(n===CP)return i.ALPHA;if(n===_P)return i.RGB;if(n===Dr)return i.RGBA;if(n===AP)return i.LUMINANCE;if(n===wP)return i.LUMINANCE_ALPHA;if(n===pc)return i.DEPTH_COMPONENT;if(n===wu)return i.DEPTH_STENCIL;if(n===bP)return i.RED;if(n===tD)return i.RED_INTEGER;if(n===DP)return i.RG;if(n===nD)return i.RG_INTEGER;if(n===iD)return i.RGBA_INTEGER;if(n===wg||n===bg||n===Dg||n===Sg)if(o===qt)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(n===wg)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===bg)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Dg)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Sg)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(n===wg)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===bg)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Dg)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Sg)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===Ew||n===yw||n===Cw||n===_w)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(n===Ew)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===yw)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Cw)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===_w)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===Aw||n===ww||n===bw)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(n===Aw||n===ww)return o===qt?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(n===bw)return o===qt?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===Dw||n===Sw||n===Mw||n===Tw||n===Fw||n===Bw||n===Iw||n===Pw||n===Rw||n===Ow||n===kw||n===Nw||n===Lw||n===Uw)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(n===Dw)return o===qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===Sw)return o===qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===Mw)return o===qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===Tw)return o===qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===Fw)return o===qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===Bw)return o===qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===Iw)return o===qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===Pw)return o===qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===Rw)return o===qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===Ow)return o===qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===kw)return o===qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===Nw)return o===qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===Lw)return o===qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===Uw)return o===qt?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===Mg||n===Vw||n===zw)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(n===Mg)return o===qt?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===Vw)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===zw)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===SP||n===Hw||n===jw||n===Gw)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(n===Mg)return s.COMPRESSED_RED_RGTC1_EXT;if(n===Hw)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===jw)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===Gw)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===Bu?i.UNSIGNED_INT_24_8:i[n]!==void 0?i[n]:null}return{convert:t}}var _v=class extends zn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}},Sr=class extends nr{constructor(){super(),this.isGroup=!0,this.type="Group"}},zk={type:"move"},_u=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Sr,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Sr,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new k,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new k),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Sr,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new k,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new k),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,s=null,o=null,a=this._targetRay,c=this._grip,l=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(l&&e.hand){o=!0;for(let g of e.hand.values()){let p=t.getJointPose(g,n),m=this._getHandJoint(l,g);p!==null&&(m.matrix.fromArray(p.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.matrixWorldNeedsUpdate=!0,m.jointRadius=p.radius),m.visible=p!==null}let u=l.joints["index-finger-tip"],h=l.joints["thumb-tip"],d=u.position.distanceTo(h.position),f=.02,x=.005;l.inputState.pinching&&d>f+x?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&d<=f-x&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else c!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),s!==null&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1));a!==null&&(r=t.getPose(e.targetRaySpace,n),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(zk)))}return a!==null&&(a.visible=r!==null),c!==null&&(c.visible=s!==null),l!==null&&(l.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){let n=new Sr;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}},Hk=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,jk=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`,Av=class{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,n){if(this.texture===null){let r=new Vs,s=e.properties.get(r);s.__webglTexture=t.texture,(t.depthNear!=n.depthNear||t.depthFar!=n.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}render(e,t){if(this.texture!==null){if(this.mesh===null){let n=t.cameras[0].viewport,r=new Fr({vertexShader:Hk,fragmentShader:jk,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new ii(new Nf(20,20),r)}e.render(this.mesh,t)}}reset(){this.texture=null,this.mesh=null}},wv=class extends Tr{constructor(e,t){super();let n=this,r=null,s=1,o=null,a="local-floor",c=1,l=null,u=null,h=null,d=null,f=null,x=null,g=new Av,p=t.getContextAttributes(),m=null,v=null,E=[],y=[],w=new We,A=null,b=new zn;b.layers.enable(1),b.viewport=new Zt;let D=new zn;D.layers.enable(2),D.viewport=new Zt;let C=[b,D],_=new _v;_.layers.enable(1),_.layers.enable(2);let M=null,B=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(X){let O=E[X];return O===void 0&&(O=new _u,E[X]=O),O.getTargetRaySpace()},this.getControllerGrip=function(X){let O=E[X];return O===void 0&&(O=new _u,E[X]=O),O.getGripSpace()},this.getHand=function(X){let O=E[X];return O===void 0&&(O=new _u,E[X]=O),O.getHandSpace()};function F(X){let O=y.indexOf(X.inputSource);if(O===-1)return;let z=E[O];z!==void 0&&(z.update(X.inputSource,X.frame,l||o),z.dispatchEvent({type:X.type,data:X.inputSource}))}function N(){r.removeEventListener("select",F),r.removeEventListener("selectstart",F),r.removeEventListener("selectend",F),r.removeEventListener("squeeze",F),r.removeEventListener("squeezestart",F),r.removeEventListener("squeezeend",F),r.removeEventListener("end",N),r.removeEventListener("inputsourceschange",L);for(let X=0;X<E.length;X++){let O=y[X];O!==null&&(y[X]=null,E[X].disconnect(O))}M=null,B=null,g.reset(),e.setRenderTarget(m),f=null,d=null,h=null,r=null,v=null,$e.stop(),n.isPresenting=!1,e.setPixelRatio(A),e.setSize(w.width,w.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(X){s=X,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(X){a=X,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||o},this.setReferenceSpace=function(X){l=X},this.getBaseLayer=function(){return d!==null?d:f},this.getBinding=function(){return h},this.getFrame=function(){return x},this.getSession=function(){return r},this.setSession=function(X){return He(this,null,function*(){if(r=X,r!==null){if(m=e.getRenderTarget(),r.addEventListener("select",F),r.addEventListener("selectstart",F),r.addEventListener("selectend",F),r.addEventListener("squeeze",F),r.addEventListener("squeezestart",F),r.addEventListener("squeezeend",F),r.addEventListener("end",N),r.addEventListener("inputsourceschange",L),p.xrCompatible!==!0&&(yield t.makeXRCompatible()),A=e.getPixelRatio(),e.getSize(w),r.renderState.layers===void 0){let O={antialias:p.antialias,alpha:!0,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:s};f=new XRWebGLLayer(r,t,O),r.updateRenderState({baseLayer:f}),e.setPixelRatio(1),e.setSize(f.framebufferWidth,f.framebufferHeight,!1),v=new rs(f.framebufferWidth,f.framebufferHeight,{format:Dr,type:Ns,colorSpace:e.outputColorSpace,stencilBuffer:p.stencil})}else{let O=null,z=null,R=null;p.depth&&(R=p.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,O=p.stencil?wu:pc,z=p.stencil?Bu:Ec);let K={colorFormat:t.RGBA8,depthFormat:R,scaleFactor:s};h=new XRWebGLBinding(r,t),d=h.createProjectionLayer(K),r.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),v=new rs(d.textureWidth,d.textureHeight,{format:Dr,type:Ns,depthTexture:new Uf(d.textureWidth,d.textureHeight,z,void 0,void 0,void 0,void 0,void 0,void 0,O),stencilBuffer:p.stencil,colorSpace:e.outputColorSpace,samples:p.antialias?4:0,resolveDepthBuffer:d.ignoreDepthValues===!1})}v.isXRRenderTarget=!0,this.setFoveation(c),l=null,o=yield r.requestReferenceSpace(a),$e.setContext(r),$e.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}})},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode};function L(X){for(let O=0;O<X.removed.length;O++){let z=X.removed[O],R=y.indexOf(z);R>=0&&(y[R]=null,E[R].disconnect(z))}for(let O=0;O<X.added.length;O++){let z=X.added[O],R=y.indexOf(z);if(R===-1){for(let $=0;$<E.length;$++)if($>=y.length){y.push(z),R=$;break}else if(y[$]===null){y[$]=z,R=$;break}if(R===-1)break}let K=E[R];K&&K.connect(z)}}let Z=new k,Q=new k;function j(X,O,z){Z.setFromMatrixPosition(O.matrixWorld),Q.setFromMatrixPosition(z.matrixWorld);let R=Z.distanceTo(Q),K=O.projectionMatrix.elements,$=z.projectionMatrix.elements,P=K[14]/(K[10]-1),fe=K[14]/(K[10]+1),oe=(K[9]+1)/K[5],De=(K[9]-1)/K[5],ge=(K[8]-1)/K[0],he=($[8]+1)/$[0],Be=P*ge,Te=P*he,Wt=R/(-ge+he),I=Wt*-ge;O.matrixWorld.decompose(X.position,X.quaternion,X.scale),X.translateX(I),X.translateZ(Wt),X.matrixWorld.compose(X.position,X.quaternion,X.scale),X.matrixWorldInverse.copy(X.matrixWorld).invert();let S=P+Wt,te=fe+Wt,se=Be-I,ce=Te+(R-I),le=oe*fe/te*S,Ne=De*fe/te*S;X.projectionMatrix.makePerspective(se,ce,le,Ne,S,te),X.projectionMatrixInverse.copy(X.projectionMatrix).invert()}function W(X,O){O===null?X.matrixWorld.copy(X.matrix):X.matrixWorld.multiplyMatrices(O.matrixWorld,X.matrix),X.matrixWorldInverse.copy(X.matrixWorld).invert()}this.updateCamera=function(X){if(r===null)return;g.texture!==null&&(X.near=g.depthNear,X.far=g.depthFar),_.near=D.near=b.near=X.near,_.far=D.far=b.far=X.far,(M!==_.near||B!==_.far)&&(r.updateRenderState({depthNear:_.near,depthFar:_.far}),M=_.near,B=_.far,b.near=M,b.far=B,D.near=M,D.far=B,b.updateProjectionMatrix(),D.updateProjectionMatrix(),X.updateProjectionMatrix());let O=X.parent,z=_.cameras;W(_,O);for(let R=0;R<z.length;R++)W(z[R],O);z.length===2?j(_,b,D):_.projectionMatrix.copy(b.projectionMatrix),ie(X,_,O)};function ie(X,O,z){z===null?X.matrix.copy(O.matrixWorld):(X.matrix.copy(z.matrixWorld),X.matrix.invert(),X.matrix.multiply(O.matrixWorld)),X.matrix.decompose(X.position,X.quaternion,X.scale),X.updateMatrixWorld(!0),X.projectionMatrix.copy(O.projectionMatrix),X.projectionMatrixInverse.copy(O.projectionMatrixInverse),X.isPerspectiveCamera&&(X.fov=bu*2*Math.atan(1/X.projectionMatrix.elements[5]),X.zoom=1)}this.getCamera=function(){return _},this.getFoveation=function(){if(!(d===null&&f===null))return c},this.setFoveation=function(X){c=X,d!==null&&(d.fixedFoveation=X),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=X)},this.hasDepthSensing=function(){return g.texture!==null};let ue=null;function de(X,O){if(u=O.getViewerPose(l||o),x=O,u!==null){let z=u.views;f!==null&&(e.setRenderTargetFramebuffer(v,f.framebuffer),e.setRenderTarget(v));let R=!1;z.length!==_.cameras.length&&(_.cameras.length=0,R=!0);for(let $=0;$<z.length;$++){let P=z[$],fe=null;if(f!==null)fe=f.getViewport(P);else{let De=h.getViewSubImage(d,P);fe=De.viewport,$===0&&(e.setRenderTargetTextures(v,De.colorTexture,d.ignoreDepthValues?void 0:De.depthStencilTexture),e.setRenderTarget(v))}let oe=C[$];oe===void 0&&(oe=new zn,oe.layers.enable($),oe.viewport=new Zt,C[$]=oe),oe.matrix.fromArray(P.transform.matrix),oe.matrix.decompose(oe.position,oe.quaternion,oe.scale),oe.projectionMatrix.fromArray(P.projectionMatrix),oe.projectionMatrixInverse.copy(oe.projectionMatrix).invert(),oe.viewport.set(fe.x,fe.y,fe.width,fe.height),$===0&&(_.matrix.copy(oe.matrix),_.matrix.decompose(_.position,_.quaternion,_.scale)),R===!0&&_.cameras.push(oe)}let K=r.enabledFeatures;if(K&&K.includes("depth-sensing")){let $=h.getDepthInformation(z[0]);$&&$.isValid&&$.texture&&g.init(e,$,r.renderState)}}for(let z=0;z<E.length;z++){let R=y[z],K=E[z];R!==null&&K!==void 0&&K.update(R,O,l||o)}g.render(e,_),ue&&ue(X,O),O.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:O}),x=null}let $e=new lD;$e.setAnimationLoop(de),this.setAnimationLoop=function(X){ue=X},this.dispose=function(){}}},Lo=new Go,Gk=new qe;function Wk(i,e){function t(p,m){p.matrixAutoUpdate===!0&&p.updateMatrix(),m.value.copy(p.matrix)}function n(p,m){m.color.getRGB(p.fogColor.value,cD(i)),m.isFog?(p.fogNear.value=m.near,p.fogFar.value=m.far):m.isFogExp2&&(p.fogDensity.value=m.density)}function r(p,m,v,E,y){m.isMeshBasicMaterial||m.isMeshLambertMaterial?s(p,m):m.isMeshToonMaterial?(s(p,m),h(p,m)):m.isMeshPhongMaterial?(s(p,m),u(p,m)):m.isMeshStandardMaterial?(s(p,m),d(p,m),m.isMeshPhysicalMaterial&&f(p,m,y)):m.isMeshMatcapMaterial?(s(p,m),x(p,m)):m.isMeshDepthMaterial?s(p,m):m.isMeshDistanceMaterial?(s(p,m),g(p,m)):m.isMeshNormalMaterial?s(p,m):m.isLineBasicMaterial?(o(p,m),m.isLineDashedMaterial&&a(p,m)):m.isPointsMaterial?c(p,m,v,E):m.isSpriteMaterial?l(p,m):m.isShadowMaterial?(p.color.value.copy(m.color),p.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}function s(p,m){p.opacity.value=m.opacity,m.color&&p.diffuse.value.copy(m.color),m.emissive&&p.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(p.map.value=m.map,t(m.map,p.mapTransform)),m.alphaMap&&(p.alphaMap.value=m.alphaMap,t(m.alphaMap,p.alphaMapTransform)),m.bumpMap&&(p.bumpMap.value=m.bumpMap,t(m.bumpMap,p.bumpMapTransform),p.bumpScale.value=m.bumpScale,m.side===ri&&(p.bumpScale.value*=-1)),m.normalMap&&(p.normalMap.value=m.normalMap,t(m.normalMap,p.normalMapTransform),p.normalScale.value.copy(m.normalScale),m.side===ri&&p.normalScale.value.negate()),m.displacementMap&&(p.displacementMap.value=m.displacementMap,t(m.displacementMap,p.displacementMapTransform),p.displacementScale.value=m.displacementScale,p.displacementBias.value=m.displacementBias),m.emissiveMap&&(p.emissiveMap.value=m.emissiveMap,t(m.emissiveMap,p.emissiveMapTransform)),m.specularMap&&(p.specularMap.value=m.specularMap,t(m.specularMap,p.specularMapTransform)),m.alphaTest>0&&(p.alphaTest.value=m.alphaTest);let v=e.get(m),E=v.envMap,y=v.envMapRotation;if(E&&(p.envMap.value=E,Lo.copy(y),Lo.x*=-1,Lo.y*=-1,Lo.z*=-1,E.isCubeTexture&&E.isRenderTargetTexture===!1&&(Lo.y*=-1,Lo.z*=-1),p.envMapRotation.value.setFromMatrix4(Gk.makeRotationFromEuler(Lo)),p.flipEnvMap.value=E.isCubeTexture&&E.isRenderTargetTexture===!1?-1:1,p.reflectivity.value=m.reflectivity,p.ior.value=m.ior,p.refractionRatio.value=m.refractionRatio),m.lightMap){p.lightMap.value=m.lightMap;let w=i._useLegacyLights===!0?Math.PI:1;p.lightMapIntensity.value=m.lightMapIntensity*w,t(m.lightMap,p.lightMapTransform)}m.aoMap&&(p.aoMap.value=m.aoMap,p.aoMapIntensity.value=m.aoMapIntensity,t(m.aoMap,p.aoMapTransform))}function o(p,m){p.diffuse.value.copy(m.color),p.opacity.value=m.opacity,m.map&&(p.map.value=m.map,t(m.map,p.mapTransform))}function a(p,m){p.dashSize.value=m.dashSize,p.totalSize.value=m.dashSize+m.gapSize,p.scale.value=m.scale}function c(p,m,v,E){p.diffuse.value.copy(m.color),p.opacity.value=m.opacity,p.size.value=m.size*v,p.scale.value=E*.5,m.map&&(p.map.value=m.map,t(m.map,p.uvTransform)),m.alphaMap&&(p.alphaMap.value=m.alphaMap,t(m.alphaMap,p.alphaMapTransform)),m.alphaTest>0&&(p.alphaTest.value=m.alphaTest)}function l(p,m){p.diffuse.value.copy(m.color),p.opacity.value=m.opacity,p.rotation.value=m.rotation,m.map&&(p.map.value=m.map,t(m.map,p.mapTransform)),m.alphaMap&&(p.alphaMap.value=m.alphaMap,t(m.alphaMap,p.alphaMapTransform)),m.alphaTest>0&&(p.alphaTest.value=m.alphaTest)}function u(p,m){p.specular.value.copy(m.specular),p.shininess.value=Math.max(m.shininess,1e-4)}function h(p,m){m.gradientMap&&(p.gradientMap.value=m.gradientMap)}function d(p,m){p.metalness.value=m.metalness,m.metalnessMap&&(p.metalnessMap.value=m.metalnessMap,t(m.metalnessMap,p.metalnessMapTransform)),p.roughness.value=m.roughness,m.roughnessMap&&(p.roughnessMap.value=m.roughnessMap,t(m.roughnessMap,p.roughnessMapTransform)),m.envMap&&(p.envMapIntensity.value=m.envMapIntensity)}function f(p,m,v){p.ior.value=m.ior,m.sheen>0&&(p.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),p.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(p.sheenColorMap.value=m.sheenColorMap,t(m.sheenColorMap,p.sheenColorMapTransform)),m.sheenRoughnessMap&&(p.sheenRoughnessMap.value=m.sheenRoughnessMap,t(m.sheenRoughnessMap,p.sheenRoughnessMapTransform))),m.clearcoat>0&&(p.clearcoat.value=m.clearcoat,p.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(p.clearcoatMap.value=m.clearcoatMap,t(m.clearcoatMap,p.clearcoatMapTransform)),m.clearcoatRoughnessMap&&(p.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap,t(m.clearcoatRoughnessMap,p.clearcoatRoughnessMapTransform)),m.clearcoatNormalMap&&(p.clearcoatNormalMap.value=m.clearcoatNormalMap,t(m.clearcoatNormalMap,p.clearcoatNormalMapTransform),p.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),m.side===ri&&p.clearcoatNormalScale.value.negate())),m.dispersion>0&&(p.dispersion.value=m.dispersion),m.iridescence>0&&(p.iridescence.value=m.iridescence,p.iridescenceIOR.value=m.iridescenceIOR,p.iridescenceThicknessMinimum.value=m.iridescenceThicknessRange[0],p.iridescenceThicknessMaximum.value=m.iridescenceThicknessRange[1],m.iridescenceMap&&(p.iridescenceMap.value=m.iridescenceMap,t(m.iridescenceMap,p.iridescenceMapTransform)),m.iridescenceThicknessMap&&(p.iridescenceThicknessMap.value=m.iridescenceThicknessMap,t(m.iridescenceThicknessMap,p.iridescenceThicknessMapTransform))),m.transmission>0&&(p.transmission.value=m.transmission,p.transmissionSamplerMap.value=v.texture,p.transmissionSamplerSize.value.set(v.width,v.height),m.transmissionMap&&(p.transmissionMap.value=m.transmissionMap,t(m.transmissionMap,p.transmissionMapTransform)),p.thickness.value=m.thickness,m.thicknessMap&&(p.thicknessMap.value=m.thicknessMap,t(m.thicknessMap,p.thicknessMapTransform)),p.attenuationDistance.value=m.attenuationDistance,p.attenuationColor.value.copy(m.attenuationColor)),m.anisotropy>0&&(p.anisotropyVector.value.set(m.anisotropy*Math.cos(m.anisotropyRotation),m.anisotropy*Math.sin(m.anisotropyRotation)),m.anisotropyMap&&(p.anisotropyMap.value=m.anisotropyMap,t(m.anisotropyMap,p.anisotropyMapTransform))),p.specularIntensity.value=m.specularIntensity,p.specularColor.value.copy(m.specularColor),m.specularColorMap&&(p.specularColorMap.value=m.specularColorMap,t(m.specularColorMap,p.specularColorMapTransform)),m.specularIntensityMap&&(p.specularIntensityMap.value=m.specularIntensityMap,t(m.specularIntensityMap,p.specularIntensityMapTransform))}function x(p,m){m.matcap&&(p.matcap.value=m.matcap)}function g(p,m){let v=e.get(m).light;p.referencePosition.value.setFromMatrixPosition(v.matrixWorld),p.nearDistance.value=v.shadow.camera.near,p.farDistance.value=v.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function $k(i,e,t,n){let r={},s={},o=[],a=i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS);function c(v,E){let y=E.program;n.uniformBlockBinding(v,y)}function l(v,E){let y=r[v.id];y===void 0&&(x(v),y=u(v),r[v.id]=y,v.addEventListener("dispose",p));let w=E.program;n.updateUBOMapping(v,w);let A=e.render.frame;s[v.id]!==A&&(d(v),s[v.id]=A)}function u(v){let E=h();v.__bindingPointIndex=E;let y=i.createBuffer(),w=v.__size,A=v.usage;return i.bindBuffer(i.UNIFORM_BUFFER,y),i.bufferData(i.UNIFORM_BUFFER,w,A),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,E,y),y}function h(){for(let v=0;v<a;v++)if(o.indexOf(v)===-1)return o.push(v),v;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(v){let E=r[v.id],y=v.uniforms,w=v.__cache;i.bindBuffer(i.UNIFORM_BUFFER,E);for(let A=0,b=y.length;A<b;A++){let D=Array.isArray(y[A])?y[A]:[y[A]];for(let C=0,_=D.length;C<_;C++){let M=D[C];if(f(M,A,C,w)===!0){let B=M.__offset,F=Array.isArray(M.value)?M.value:[M.value],N=0;for(let L=0;L<F.length;L++){let Z=F[L],Q=g(Z);typeof Z=="number"||typeof Z=="boolean"?(M.__data[0]=Z,i.bufferSubData(i.UNIFORM_BUFFER,B+N,M.__data)):Z.isMatrix3?(M.__data[0]=Z.elements[0],M.__data[1]=Z.elements[1],M.__data[2]=Z.elements[2],M.__data[3]=0,M.__data[4]=Z.elements[3],M.__data[5]=Z.elements[4],M.__data[6]=Z.elements[5],M.__data[7]=0,M.__data[8]=Z.elements[6],M.__data[9]=Z.elements[7],M.__data[10]=Z.elements[8],M.__data[11]=0):(Z.toArray(M.__data,N),N+=Q.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,B,M.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function f(v,E,y,w){let A=v.value,b=E+"_"+y;if(w[b]===void 0)return typeof A=="number"||typeof A=="boolean"?w[b]=A:w[b]=A.clone(),!0;{let D=w[b];if(typeof A=="number"||typeof A=="boolean"){if(D!==A)return w[b]=A,!0}else if(D.equals(A)===!1)return D.copy(A),!0}return!1}function x(v){let E=v.uniforms,y=0,w=16;for(let b=0,D=E.length;b<D;b++){let C=Array.isArray(E[b])?E[b]:[E[b]];for(let _=0,M=C.length;_<M;_++){let B=C[_],F=Array.isArray(B.value)?B.value:[B.value];for(let N=0,L=F.length;N<L;N++){let Z=F[N],Q=g(Z),j=y%w;j!==0&&w-j<Q.boundary&&(y+=w-j),B.__data=new Float32Array(Q.storage/Float32Array.BYTES_PER_ELEMENT),B.__offset=y,y+=Q.storage}}}let A=y%w;return A>0&&(y+=w-A),v.__size=y,v.__cache={},this}function g(v){let E={boundary:0,storage:0};return typeof v=="number"||typeof v=="boolean"?(E.boundary=4,E.storage=4):v.isVector2?(E.boundary=8,E.storage=8):v.isVector3||v.isColor?(E.boundary=16,E.storage=12):v.isVector4?(E.boundary=16,E.storage=16):v.isMatrix3?(E.boundary=48,E.storage=48):v.isMatrix4?(E.boundary=64,E.storage=64):v.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",v),E}function p(v){let E=v.target;E.removeEventListener("dispose",p);let y=o.indexOf(E.__bindingPointIndex);o.splice(y,1),i.deleteBuffer(r[E.id]),delete r[E.id],delete s[E.id]}function m(){for(let v in r)i.deleteBuffer(r[v]);o=[],r={},s={}}return{bind:c,update:l,dispose:m}}var Vf=class{constructor(e={}){let{canvas:t=e6(),context:n=null,depth:r=!0,stencil:s=!1,alpha:o=!1,antialias:a=!1,premultipliedAlpha:c=!0,preserveDrawingBuffer:l=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:h=!1}=e;this.isWebGLRenderer=!0;let d;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");d=n.getContextAttributes().alpha}else d=o;let f=new Uint32Array(4),x=new Int32Array(4),g=null,p=null,m=[],v=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Di,this._useLegacyLights=!1,this.toneMapping=ks,this.toneMappingExposure=1;let E=this,y=!1,w=0,A=0,b=null,D=-1,C=null,_=new Zt,M=new Zt,B=null,F=new Ge(0),N=0,L=t.width,Z=t.height,Q=1,j=null,W=null,ie=new Zt(0,0,L,Z),ue=new Zt(0,0,L,Z),de=!1,$e=new Tu,X=!1,O=!1,z=new qe,R=new k,K={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function $(){return b===null?Q:1}let P=n;function fe(T,G){return t.getContext(T,G)}try{let T={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:c,preserveDrawingBuffer:l,powerPreference:u,failIfMajorPerformanceCaveat:h};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Hv}`),t.addEventListener("webglcontextlost",H,!1),t.addEventListener("webglcontextrestored",ae,!1),t.addEventListener("webglcontextcreationerror",re,!1),P===null){let G="webgl2";if(P=fe(G,T),P===null)throw fe(G)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(T){throw console.error("THREE.WebGLRenderer: "+T.message),T}let oe,De,ge,he,Be,Te,Wt,I,S,te,se,ce,le,Ne,Ce,ye,ot,pe,Oe,wt,Ue,we,at,pt;function sn(){oe=new hO(P),oe.init(),we=new Vk(P,oe),De=new sO(P,oe,e,we),ge=new Lk(P),he=new pO(P),Be=new Dk,Te=new Uk(P,oe,ge,Be,De,we,he),Wt=new aO(E),I=new uO(E),S=new C6(P),at=new iO(P,S),te=new dO(P,S,he,at),se=new mO(P,te,S,he),Oe=new xO(P,De,Te),ye=new oO(Be),ce=new bk(E,Wt,I,oe,De,at,ye),le=new Wk(E,Be),Ne=new Mk,Ce=new Rk(oe),pe=new nO(E,Wt,I,ge,se,d,c),ot=new Nk(E,se,De),pt=new $k(P,he,De,ge),wt=new rO(P,oe,he),Ue=new fO(P,oe,he),he.programs=ce.programs,E.capabilities=De,E.extensions=oe,E.properties=Be,E.renderLists=Ne,E.shadowMap=ot,E.state=ge,E.info=he}sn();let ct=new wv(E,P);this.xr=ct,this.getContext=function(){return P},this.getContextAttributes=function(){return P.getContextAttributes()},this.forceContextLoss=function(){let T=oe.get("WEBGL_lose_context");T&&T.loseContext()},this.forceContextRestore=function(){let T=oe.get("WEBGL_lose_context");T&&T.restoreContext()},this.getPixelRatio=function(){return Q},this.setPixelRatio=function(T){T!==void 0&&(Q=T,this.setSize(L,Z,!1))},this.getSize=function(T){return T.set(L,Z)},this.setSize=function(T,G,ee=!0){if(ct.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}L=T,Z=G,t.width=Math.floor(T*Q),t.height=Math.floor(G*Q),ee===!0&&(t.style.width=T+"px",t.style.height=G+"px"),this.setViewport(0,0,T,G)},this.getDrawingBufferSize=function(T){return T.set(L*Q,Z*Q).floor()},this.setDrawingBufferSize=function(T,G,ee){L=T,Z=G,Q=ee,t.width=Math.floor(T*ee),t.height=Math.floor(G*ee),this.setViewport(0,0,T,G)},this.getCurrentViewport=function(T){return T.copy(_)},this.getViewport=function(T){return T.copy(ie)},this.setViewport=function(T,G,ee,q){T.isVector4?ie.set(T.x,T.y,T.z,T.w):ie.set(T,G,ee,q),ge.viewport(_.copy(ie).multiplyScalar(Q).round())},this.getScissor=function(T){return T.copy(ue)},this.setScissor=function(T,G,ee,q){T.isVector4?ue.set(T.x,T.y,T.z,T.w):ue.set(T,G,ee,q),ge.scissor(M.copy(ue).multiplyScalar(Q).round())},this.getScissorTest=function(){return de},this.setScissorTest=function(T){ge.setScissorTest(de=T)},this.setOpaqueSort=function(T){j=T},this.setTransparentSort=function(T){W=T},this.getClearColor=function(T){return T.copy(pe.getClearColor())},this.setClearColor=function(){pe.setClearColor.apply(pe,arguments)},this.getClearAlpha=function(){return pe.getClearAlpha()},this.setClearAlpha=function(){pe.setClearAlpha.apply(pe,arguments)},this.clear=function(T=!0,G=!0,ee=!0){let q=0;if(T){let Y=!1;if(b!==null){let Ee=b.texture.format;Y=Ee===iD||Ee===nD||Ee===tD}if(Y){let Ee=b.texture.type,Fe=Ee===Ns||Ee===Ec||Ee===Kb||Ee===Bu||Ee===Qb||Ee===eD,Pe=pe.getClearColor(),Ve=pe.getClearAlpha(),Ze=Pe.r,tt=Pe.g,ut=Pe.b;Fe?(f[0]=Ze,f[1]=tt,f[2]=ut,f[3]=Ve,P.clearBufferuiv(P.COLOR,0,f)):(x[0]=Ze,x[1]=tt,x[2]=ut,x[3]=Ve,P.clearBufferiv(P.COLOR,0,x))}else q|=P.COLOR_BUFFER_BIT}G&&(q|=P.DEPTH_BUFFER_BIT),ee&&(q|=P.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),P.clear(q)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",H,!1),t.removeEventListener("webglcontextrestored",ae,!1),t.removeEventListener("webglcontextcreationerror",re,!1),Ne.dispose(),Ce.dispose(),Be.dispose(),Wt.dispose(),I.dispose(),se.dispose(),at.dispose(),pt.dispose(),ce.dispose(),ct.dispose(),ct.removeEventListener("sessionstart",Ft),ct.removeEventListener("sessionend",dr),Wn.stop()};function H(T){T.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),y=!0}function ae(){console.log("THREE.WebGLRenderer: Context Restored."),y=!1;let T=he.autoReset,G=ot.enabled,ee=ot.autoUpdate,q=ot.needsUpdate,Y=ot.type;sn(),he.autoReset=T,ot.enabled=G,ot.autoUpdate=ee,ot.needsUpdate=q,ot.type=Y}function re(T){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",T.statusMessage)}function ve(T){let G=T.target;G.removeEventListener("dispose",ve),Ae(G)}function Ae(T){bt(T),Be.remove(T)}function bt(T){let G=Be.get(T).programs;G!==void 0&&(G.forEach(function(ee){ce.releaseProgram(ee)}),T.isShaderMaterial&&ce.releaseShaderCache(T))}this.renderBufferDirect=function(T,G,ee,q,Y,Ee){G===null&&(G=K);let Fe=Y.isMesh&&Y.matrixWorld.determinant()<0,Pe=b9(T,G,ee,q,Y);ge.setMaterial(q,Fe);let Ve=ee.index,Ze=1;if(q.wireframe===!0){if(Ve=te.getWireframeAttribute(ee),Ve===void 0)return;Ze=2}let tt=ee.drawRange,ut=ee.attributes.position,dn=tt.start*Ze,kn=(tt.start+tt.count)*Ze;Ee!==null&&(dn=Math.max(dn,Ee.start*Ze),kn=Math.min(kn,(Ee.start+Ee.count)*Ze)),Ve!==null?(dn=Math.max(dn,0),kn=Math.min(kn,Ve.count)):ut!=null&&(dn=Math.max(dn,0),kn=Math.min(kn,ut.count));let ai=kn-dn;if(ai<0||ai===1/0)return;at.setup(Y,q,Pe,ee,Ve);let Ur,Mt=wt;if(Ve!==null&&(Ur=S.get(Ve),Mt=Ue,Mt.setIndex(Ur)),Y.isMesh)q.wireframe===!0?(ge.setLineWidth(q.wireframeLinewidth*$()),Mt.setMode(P.LINES)):Mt.setMode(P.TRIANGLES);else if(Y.isLine){let Ke=q.linewidth;Ke===void 0&&(Ke=1),ge.setLineWidth(Ke*$()),Y.isLineSegments?Mt.setMode(P.LINES):Y.isLineLoop?Mt.setMode(P.LINE_LOOP):Mt.setMode(P.LINE_STRIP)}else Y.isPoints?Mt.setMode(P.POINTS):Y.isSprite&&Mt.setMode(P.TRIANGLES);if(Y.isBatchedMesh)Y._multiDrawInstances!==null?Mt.renderMultiDrawInstances(Y._multiDrawStarts,Y._multiDrawCounts,Y._multiDrawCount,Y._multiDrawInstances):Mt.renderMultiDraw(Y._multiDrawStarts,Y._multiDrawCounts,Y._multiDrawCount);else if(Y.isInstancedMesh)Mt.renderInstances(dn,ai,Y.count);else if(ee.isInstancedBufferGeometry){let Ke=ee._maxInstanceCount!==void 0?ee._maxInstanceCount:1/0,xl=Math.min(ee.instanceCount,Ke);Mt.renderInstances(dn,ai,xl)}else Mt.render(dn,ai)};function $t(T,G,ee){T.transparent===!0&&T.side===ns&&T.forceSinglePass===!1?(T.side=ri,T.needsUpdate=!0,dh(T,G,ee),T.side=Mr,T.needsUpdate=!0,dh(T,G,ee),T.side=ns):dh(T,G,ee)}this.compile=function(T,G,ee=null){ee===null&&(ee=T),p=Ce.get(ee),p.init(G),v.push(p),ee.traverseVisible(function(Y){Y.isLight&&Y.layers.test(G.layers)&&(p.pushLight(Y),Y.castShadow&&p.pushShadow(Y))}),T!==ee&&T.traverseVisible(function(Y){Y.isLight&&Y.layers.test(G.layers)&&(p.pushLight(Y),Y.castShadow&&p.pushShadow(Y))}),p.setupLights(E._useLegacyLights);let q=new Set;return T.traverse(function(Y){let Ee=Y.material;if(Ee)if(Array.isArray(Ee))for(let Fe=0;Fe<Ee.length;Fe++){let Pe=Ee[Fe];$t(Pe,ee,Y),q.add(Pe)}else $t(Ee,ee,Y),q.add(Ee)}),v.pop(),p=null,q},this.compileAsync=function(T,G,ee=null){let q=this.compile(T,G,ee);return new Promise(Y=>{function Ee(){if(q.forEach(function(Fe){Be.get(Fe).currentProgram.isReady()&&q.delete(Fe)}),q.size===0){Y(T);return}setTimeout(Ee,10)}oe.get("KHR_parallel_shader_compile")!==null?Ee():setTimeout(Ee,10)})};let Jt=null;function On(T){Jt&&Jt(T)}function Ft(){Wn.stop()}function dr(){Wn.start()}let Wn=new lD;Wn.setAnimationLoop(On),typeof self<"u"&&Wn.setContext(self),this.setAnimationLoop=function(T){Jt=T,ct.setAnimationLoop(T),T===null?Wn.stop():Wn.start()},ct.addEventListener("sessionstart",Ft),ct.addEventListener("sessionend",dr),this.render=function(T,G){if(G!==void 0&&G.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(y===!0)return;T.matrixWorldAutoUpdate===!0&&T.updateMatrixWorld(),G.parent===null&&G.matrixWorldAutoUpdate===!0&&G.updateMatrixWorld(),ct.enabled===!0&&ct.isPresenting===!0&&(ct.cameraAutoUpdate===!0&&ct.updateCamera(G),G=ct.getCamera()),T.isScene===!0&&T.onBeforeRender(E,T,G,b),p=Ce.get(T,v.length),p.init(G),v.push(p),z.multiplyMatrices(G.projectionMatrix,G.matrixWorldInverse),$e.setFromProjectionMatrix(z),O=this.localClippingEnabled,X=ye.init(this.clippingPlanes,O),g=Ne.get(T,m.length),g.init(),m.push(g),My(T,G,0,E.sortObjects),g.finish(),E.sortObjects===!0&&g.sort(j,W);let ee=ct.enabled===!1||ct.isPresenting===!1||ct.hasDepthSensing()===!1;ee&&pe.addToRenderList(g,T),this.info.render.frame++,X===!0&&ye.beginShadows();let q=p.state.shadowsArray;ot.render(q,T,G),X===!0&&ye.endShadows(),this.info.autoReset===!0&&this.info.reset();let Y=g.opaque,Ee=g.transmissive;if(p.setupLights(E._useLegacyLights),G.isArrayCamera){let Fe=G.cameras;if(Ee.length>0)for(let Pe=0,Ve=Fe.length;Pe<Ve;Pe++){let Ze=Fe[Pe];Fy(Y,Ee,T,Ze)}ee&&pe.render(T);for(let Pe=0,Ve=Fe.length;Pe<Ve;Pe++){let Ze=Fe[Pe];Ty(g,T,Ze,Ze.viewport)}}else Ee.length>0&&Fy(Y,Ee,T,G),ee&&pe.render(T),Ty(g,T,G);b!==null&&(Te.updateMultisampleRenderTarget(b),Te.updateRenderTargetMipmap(b)),T.isScene===!0&&T.onAfterRender(E,T,G),at.resetDefaultState(),D=-1,C=null,v.pop(),v.length>0?(p=v[v.length-1],X===!0&&ye.setGlobalState(E.clippingPlanes,p.state.camera)):p=null,m.pop(),m.length>0?g=m[m.length-1]:g=null};function My(T,G,ee,q){if(T.visible===!1)return;if(T.layers.test(G.layers)){if(T.isGroup)ee=T.renderOrder;else if(T.isLOD)T.autoUpdate===!0&&T.update(G);else if(T.isLight)p.pushLight(T),T.castShadow&&p.pushShadow(T);else if(T.isSprite){if(!T.frustumCulled||$e.intersectsSprite(T)){q&&R.setFromMatrixPosition(T.matrixWorld).applyMatrix4(z);let Fe=se.update(T),Pe=T.material;Pe.visible&&g.push(T,Fe,Pe,ee,R.z,null)}}else if((T.isMesh||T.isLine||T.isPoints)&&(!T.frustumCulled||$e.intersectsObject(T))){let Fe=se.update(T),Pe=T.material;if(q&&(T.boundingSphere!==void 0?(T.boundingSphere===null&&T.computeBoundingSphere(),R.copy(T.boundingSphere.center)):(Fe.boundingSphere===null&&Fe.computeBoundingSphere(),R.copy(Fe.boundingSphere.center)),R.applyMatrix4(T.matrixWorld).applyMatrix4(z)),Array.isArray(Pe)){let Ve=Fe.groups;for(let Ze=0,tt=Ve.length;Ze<tt;Ze++){let ut=Ve[Ze],dn=Pe[ut.materialIndex];dn&&dn.visible&&g.push(T,Fe,dn,ee,R.z,ut)}}else Pe.visible&&g.push(T,Fe,Pe,ee,R.z,null)}}let Ee=T.children;for(let Fe=0,Pe=Ee.length;Fe<Pe;Fe++)My(Ee[Fe],G,ee,q)}function Ty(T,G,ee,q){let Y=T.opaque,Ee=T.transmissive,Fe=T.transparent;p.setupLightsView(ee),X===!0&&ye.setGlobalState(E.clippingPlanes,ee),q&&ge.viewport(_.copy(q)),Y.length>0&&hh(Y,G,ee),Ee.length>0&&hh(Ee,G,ee),Fe.length>0&&hh(Fe,G,ee),ge.buffers.depth.setTest(!0),ge.buffers.depth.setMask(!0),ge.buffers.color.setMask(!0),ge.setPolygonOffset(!1)}function Fy(T,G,ee,q){if((ee.isScene===!0?ee.overrideMaterial:null)!==null)return;p.state.transmissionRenderTarget[q.id]===void 0&&(p.state.transmissionRenderTarget[q.id]=new rs(1,1,{generateMipmaps:!0,type:oe.has("EXT_color_buffer_half_float")||oe.has("EXT_color_buffer_float")?Jf:Ns,minFilter:jo,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1}));let Ee=p.state.transmissionRenderTarget[q.id],Fe=q.viewport||_;Ee.setSize(Fe.z,Fe.w);let Pe=E.getRenderTarget();E.setRenderTarget(Ee),E.getClearColor(F),N=E.getClearAlpha(),N<1&&E.setClearColor(16777215,.5),E.clear();let Ve=E.toneMapping;E.toneMapping=ks;let Ze=q.viewport;if(q.viewport!==void 0&&(q.viewport=void 0),p.setupLightsView(q),X===!0&&ye.setGlobalState(E.clippingPlanes,q),hh(T,ee,q),Te.updateMultisampleRenderTarget(Ee),Te.updateRenderTargetMipmap(Ee),oe.has("WEBGL_multisampled_render_to_texture")===!1){let tt=!1;for(let ut=0,dn=G.length;ut<dn;ut++){let kn=G[ut],ai=kn.object,Ur=kn.geometry,Mt=kn.material,Ke=kn.group;if(Mt.side===ns&&ai.layers.test(q.layers)){let xl=Mt.side;Mt.side=ri,Mt.needsUpdate=!0,By(ai,ee,q,Ur,Mt,Ke),Mt.side=xl,Mt.needsUpdate=!0,tt=!0}}tt===!0&&(Te.updateMultisampleRenderTarget(Ee),Te.updateRenderTargetMipmap(Ee))}E.setRenderTarget(Pe),E.setClearColor(F,N),Ze!==void 0&&(q.viewport=Ze),E.toneMapping=Ve}function hh(T,G,ee){let q=G.isScene===!0?G.overrideMaterial:null;for(let Y=0,Ee=T.length;Y<Ee;Y++){let Fe=T[Y],Pe=Fe.object,Ve=Fe.geometry,Ze=q===null?Fe.material:q,tt=Fe.group;Pe.layers.test(ee.layers)&&By(Pe,G,ee,Ve,Ze,tt)}}function By(T,G,ee,q,Y,Ee){T.onBeforeRender(E,G,ee,q,Y,Ee),T.modelViewMatrix.multiplyMatrices(ee.matrixWorldInverse,T.matrixWorld),T.normalMatrix.getNormalMatrix(T.modelViewMatrix),Y.onBeforeRender(E,G,ee,q,T,Ee),Y.transparent===!0&&Y.side===ns&&Y.forceSinglePass===!1?(Y.side=ri,Y.needsUpdate=!0,E.renderBufferDirect(ee,G,q,Y,T,Ee),Y.side=Mr,Y.needsUpdate=!0,E.renderBufferDirect(ee,G,q,Y,T,Ee),Y.side=ns):E.renderBufferDirect(ee,G,q,Y,T,Ee),T.onAfterRender(E,G,ee,q,Y,Ee)}function dh(T,G,ee){G.isScene!==!0&&(G=K);let q=Be.get(T),Y=p.state.lights,Ee=p.state.shadowsArray,Fe=Y.state.version,Pe=ce.getParameters(T,Y.state,Ee,G,ee),Ve=ce.getProgramCacheKey(Pe),Ze=q.programs;q.environment=T.isMeshStandardMaterial?G.environment:null,q.fog=G.fog,q.envMap=(T.isMeshStandardMaterial?I:Wt).get(T.envMap||q.environment),q.envMapRotation=q.environment!==null&&T.envMap===null?G.environmentRotation:T.envMapRotation,Ze===void 0&&(T.addEventListener("dispose",ve),Ze=new Map,q.programs=Ze);let tt=Ze.get(Ve);if(tt!==void 0){if(q.currentProgram===tt&&q.lightsStateVersion===Fe)return Py(T,Pe),tt}else Pe.uniforms=ce.getUniforms(T),T.onBuild(ee,Pe,E),T.onBeforeCompile(Pe,E),tt=ce.acquireProgram(Pe,Ve),Ze.set(Ve,tt),q.uniforms=Pe.uniforms;let ut=q.uniforms;return(!T.isShaderMaterial&&!T.isRawShaderMaterial||T.clipping===!0)&&(ut.clippingPlanes=ye.uniform),Py(T,Pe),q.needsLights=S9(T),q.lightsStateVersion=Fe,q.needsLights&&(ut.ambientLightColor.value=Y.state.ambient,ut.lightProbe.value=Y.state.probe,ut.directionalLights.value=Y.state.directional,ut.directionalLightShadows.value=Y.state.directionalShadow,ut.spotLights.value=Y.state.spot,ut.spotLightShadows.value=Y.state.spotShadow,ut.rectAreaLights.value=Y.state.rectArea,ut.ltc_1.value=Y.state.rectAreaLTC1,ut.ltc_2.value=Y.state.rectAreaLTC2,ut.pointLights.value=Y.state.point,ut.pointLightShadows.value=Y.state.pointShadow,ut.hemisphereLights.value=Y.state.hemi,ut.directionalShadowMap.value=Y.state.directionalShadowMap,ut.directionalShadowMatrix.value=Y.state.directionalShadowMatrix,ut.spotShadowMap.value=Y.state.spotShadowMap,ut.spotLightMatrix.value=Y.state.spotLightMatrix,ut.spotLightMap.value=Y.state.spotLightMap,ut.pointShadowMap.value=Y.state.pointShadowMap,ut.pointShadowMatrix.value=Y.state.pointShadowMatrix),q.currentProgram=tt,q.uniformsList=null,tt}function Iy(T){if(T.uniformsList===null){let G=T.currentProgram.getUniforms();T.uniformsList=mc.seqWithValue(G.seq,T.uniforms)}return T.uniformsList}function Py(T,G){let ee=Be.get(T);ee.outputColorSpace=G.outputColorSpace,ee.batching=G.batching,ee.instancing=G.instancing,ee.instancingColor=G.instancingColor,ee.instancingMorph=G.instancingMorph,ee.skinning=G.skinning,ee.morphTargets=G.morphTargets,ee.morphNormals=G.morphNormals,ee.morphColors=G.morphColors,ee.morphTargetsCount=G.morphTargetsCount,ee.numClippingPlanes=G.numClippingPlanes,ee.numIntersection=G.numClipIntersection,ee.vertexAlphas=G.vertexAlphas,ee.vertexTangents=G.vertexTangents,ee.toneMapping=G.toneMapping}function b9(T,G,ee,q,Y){G.isScene!==!0&&(G=K),Te.resetTextureUnits();let Ee=G.fog,Fe=q.isMeshStandardMaterial?G.environment:null,Pe=b===null?E.outputColorSpace:b.isXRRenderTarget===!0?b.texture.colorSpace:Us,Ve=(q.isMeshStandardMaterial?I:Wt).get(q.envMap||Fe),Ze=q.vertexColors===!0&&!!ee.attributes.color&&ee.attributes.color.itemSize===4,tt=!!ee.attributes.tangent&&(!!q.normalMap||q.anisotropy>0),ut=!!ee.morphAttributes.position,dn=!!ee.morphAttributes.normal,kn=!!ee.morphAttributes.color,ai=ks;q.toneMapped&&(b===null||b.isXRRenderTarget===!0)&&(ai=E.toneMapping);let Ur=ee.morphAttributes.position||ee.morphAttributes.normal||ee.morphAttributes.color,Mt=Ur!==void 0?Ur.length:0,Ke=Be.get(q),xl=p.state.lights;if(X===!0&&(O===!0||T!==C)){let vi=T===C&&q.id===D;ye.setState(q,T,vi)}let Yt=!1;q.version===Ke.__version?(Ke.needsLights&&Ke.lightsStateVersion!==xl.state.version||Ke.outputColorSpace!==Pe||Y.isBatchedMesh&&Ke.batching===!1||!Y.isBatchedMesh&&Ke.batching===!0||Y.isInstancedMesh&&Ke.instancing===!1||!Y.isInstancedMesh&&Ke.instancing===!0||Y.isSkinnedMesh&&Ke.skinning===!1||!Y.isSkinnedMesh&&Ke.skinning===!0||Y.isInstancedMesh&&Ke.instancingColor===!0&&Y.instanceColor===null||Y.isInstancedMesh&&Ke.instancingColor===!1&&Y.instanceColor!==null||Y.isInstancedMesh&&Ke.instancingMorph===!0&&Y.morphTexture===null||Y.isInstancedMesh&&Ke.instancingMorph===!1&&Y.morphTexture!==null||Ke.envMap!==Ve||q.fog===!0&&Ke.fog!==Ee||Ke.numClippingPlanes!==void 0&&(Ke.numClippingPlanes!==ye.numPlanes||Ke.numIntersection!==ye.numIntersection)||Ke.vertexAlphas!==Ze||Ke.vertexTangents!==tt||Ke.morphTargets!==ut||Ke.morphNormals!==dn||Ke.morphColors!==kn||Ke.toneMapping!==ai||Ke.morphTargetsCount!==Mt)&&(Yt=!0):(Yt=!0,Ke.__version=q.version);let ao=Ke.currentProgram;Yt===!0&&(ao=dh(q,G,Y));let Ry=!1,ml=!1,dp=!1,Nn=ao.getUniforms(),ps=Ke.uniforms;if(ge.useProgram(ao.program)&&(Ry=!0,ml=!0,dp=!0),q.id!==D&&(D=q.id,ml=!0),Ry||C!==T){Nn.setValue(P,"projectionMatrix",T.projectionMatrix),Nn.setValue(P,"viewMatrix",T.matrixWorldInverse);let vi=Nn.map.cameraPosition;vi!==void 0&&vi.setValue(P,R.setFromMatrixPosition(T.matrixWorld)),De.logarithmicDepthBuffer&&Nn.setValue(P,"logDepthBufFC",2/(Math.log(T.far+1)/Math.LN2)),(q.isMeshPhongMaterial||q.isMeshToonMaterial||q.isMeshLambertMaterial||q.isMeshBasicMaterial||q.isMeshStandardMaterial||q.isShaderMaterial)&&Nn.setValue(P,"isOrthographic",T.isOrthographicCamera===!0),C!==T&&(C=T,ml=!0,dp=!0)}if(Y.isSkinnedMesh){Nn.setOptional(P,Y,"bindMatrix"),Nn.setOptional(P,Y,"bindMatrixInverse");let vi=Y.skeleton;vi&&(vi.boneTexture===null&&vi.computeBoneTexture(),Nn.setValue(P,"boneTexture",vi.boneTexture,Te))}Y.isBatchedMesh&&(Nn.setOptional(P,Y,"batchingTexture"),Nn.setValue(P,"batchingTexture",Y._matricesTexture,Te));let fp=ee.morphAttributes;if((fp.position!==void 0||fp.normal!==void 0||fp.color!==void 0)&&Oe.update(Y,ee,ao),(ml||Ke.receiveShadow!==Y.receiveShadow)&&(Ke.receiveShadow=Y.receiveShadow,Nn.setValue(P,"receiveShadow",Y.receiveShadow)),q.isMeshGouraudMaterial&&q.envMap!==null&&(ps.envMap.value=Ve,ps.flipEnvMap.value=Ve.isCubeTexture&&Ve.isRenderTargetTexture===!1?-1:1),q.isMeshStandardMaterial&&q.envMap===null&&G.environment!==null&&(ps.envMapIntensity.value=G.environmentIntensity),ml&&(Nn.setValue(P,"toneMappingExposure",E.toneMappingExposure),Ke.needsLights&&D9(ps,dp),Ee&&q.fog===!0&&le.refreshFogUniforms(ps,Ee),le.refreshMaterialUniforms(ps,q,Q,Z,p.state.transmissionRenderTarget[T.id]),mc.upload(P,Iy(Ke),ps,Te)),q.isShaderMaterial&&q.uniformsNeedUpdate===!0&&(mc.upload(P,Iy(Ke),ps,Te),q.uniformsNeedUpdate=!1),q.isSpriteMaterial&&Nn.setValue(P,"center",Y.center),Nn.setValue(P,"modelViewMatrix",Y.modelViewMatrix),Nn.setValue(P,"normalMatrix",Y.normalMatrix),Nn.setValue(P,"modelMatrix",Y.matrixWorld),q.isShaderMaterial||q.isRawShaderMaterial){let vi=q.uniformsGroups;for(let pp=0,M9=vi.length;pp<M9;pp++){let Oy=vi[pp];pt.update(Oy,ao),pt.bind(Oy,ao)}}return ao}function D9(T,G){T.ambientLightColor.needsUpdate=G,T.lightProbe.needsUpdate=G,T.directionalLights.needsUpdate=G,T.directionalLightShadows.needsUpdate=G,T.pointLights.needsUpdate=G,T.pointLightShadows.needsUpdate=G,T.spotLights.needsUpdate=G,T.spotLightShadows.needsUpdate=G,T.rectAreaLights.needsUpdate=G,T.hemisphereLights.needsUpdate=G}function S9(T){return T.isMeshLambertMaterial||T.isMeshToonMaterial||T.isMeshPhongMaterial||T.isMeshStandardMaterial||T.isShadowMaterial||T.isShaderMaterial&&T.lights===!0}this.getActiveCubeFace=function(){return w},this.getActiveMipmapLevel=function(){return A},this.getRenderTarget=function(){return b},this.setRenderTargetTextures=function(T,G,ee){Be.get(T.texture).__webglTexture=G,Be.get(T.depthTexture).__webglTexture=ee;let q=Be.get(T);q.__hasExternalTextures=!0,q.__autoAllocateDepthBuffer=ee===void 0,q.__autoAllocateDepthBuffer||oe.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),q.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(T,G){let ee=Be.get(T);ee.__webglFramebuffer=G,ee.__useDefaultFramebuffer=G===void 0},this.setRenderTarget=function(T,G=0,ee=0){b=T,w=G,A=ee;let q=!0,Y=null,Ee=!1,Fe=!1;if(T){let Ve=Be.get(T);Ve.__useDefaultFramebuffer!==void 0?(ge.bindFramebuffer(P.FRAMEBUFFER,null),q=!1):Ve.__webglFramebuffer===void 0?Te.setupRenderTarget(T):Ve.__hasExternalTextures&&Te.rebindTextures(T,Be.get(T.texture).__webglTexture,Be.get(T.depthTexture).__webglTexture);let Ze=T.texture;(Ze.isData3DTexture||Ze.isDataArrayTexture||Ze.isCompressedArrayTexture)&&(Fe=!0);let tt=Be.get(T).__webglFramebuffer;T.isWebGLCubeRenderTarget?(Array.isArray(tt[G])?Y=tt[G][ee]:Y=tt[G],Ee=!0):T.samples>0&&Te.useMultisampledRTT(T)===!1?Y=Be.get(T).__webglMultisampledFramebuffer:Array.isArray(tt)?Y=tt[ee]:Y=tt,_.copy(T.viewport),M.copy(T.scissor),B=T.scissorTest}else _.copy(ie).multiplyScalar(Q).floor(),M.copy(ue).multiplyScalar(Q).floor(),B=de;if(ge.bindFramebuffer(P.FRAMEBUFFER,Y)&&q&&ge.drawBuffers(T,Y),ge.viewport(_),ge.scissor(M),ge.setScissorTest(B),Ee){let Ve=Be.get(T.texture);P.framebufferTexture2D(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,P.TEXTURE_CUBE_MAP_POSITIVE_X+G,Ve.__webglTexture,ee)}else if(Fe){let Ve=Be.get(T.texture),Ze=G||0;P.framebufferTextureLayer(P.FRAMEBUFFER,P.COLOR_ATTACHMENT0,Ve.__webglTexture,ee||0,Ze)}D=-1},this.readRenderTargetPixels=function(T,G,ee,q,Y,Ee,Fe){if(!(T&&T.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Pe=Be.get(T).__webglFramebuffer;if(T.isWebGLCubeRenderTarget&&Fe!==void 0&&(Pe=Pe[Fe]),Pe){ge.bindFramebuffer(P.FRAMEBUFFER,Pe);try{let Ve=T.texture,Ze=Ve.format,tt=Ve.type;if(!De.textureFormatReadable(Ze)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!De.textureTypeReadable(tt)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}G>=0&&G<=T.width-q&&ee>=0&&ee<=T.height-Y&&P.readPixels(G,ee,q,Y,we.convert(Ze),we.convert(tt),Ee)}finally{let Ve=b!==null?Be.get(b).__webglFramebuffer:null;ge.bindFramebuffer(P.FRAMEBUFFER,Ve)}}},this.copyFramebufferToTexture=function(T,G,ee=0){let q=Math.pow(2,-ee),Y=Math.floor(G.image.width*q),Ee=Math.floor(G.image.height*q);Te.setTexture2D(G,0),P.copyTexSubImage2D(P.TEXTURE_2D,ee,0,0,T.x,T.y,Y,Ee),ge.unbindTexture()},this.copyTextureToTexture=function(T,G,ee,q=0){let Y=G.image.width,Ee=G.image.height,Fe=we.convert(ee.format),Pe=we.convert(ee.type);Te.setTexture2D(ee,0),P.pixelStorei(P.UNPACK_FLIP_Y_WEBGL,ee.flipY),P.pixelStorei(P.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ee.premultiplyAlpha),P.pixelStorei(P.UNPACK_ALIGNMENT,ee.unpackAlignment),G.isDataTexture?P.texSubImage2D(P.TEXTURE_2D,q,T.x,T.y,Y,Ee,Fe,Pe,G.image.data):G.isCompressedTexture?P.compressedTexSubImage2D(P.TEXTURE_2D,q,T.x,T.y,G.mipmaps[0].width,G.mipmaps[0].height,Fe,G.mipmaps[0].data):P.texSubImage2D(P.TEXTURE_2D,q,T.x,T.y,Fe,Pe,G.image),q===0&&ee.generateMipmaps&&P.generateMipmap(P.TEXTURE_2D),ge.unbindTexture()},this.copyTextureToTexture3D=function(T,G,ee,q,Y=0){let Ee=T.max.x-T.min.x,Fe=T.max.y-T.min.y,Pe=T.max.z-T.min.z,Ve=we.convert(q.format),Ze=we.convert(q.type),tt;if(q.isData3DTexture)Te.setTexture3D(q,0),tt=P.TEXTURE_3D;else if(q.isDataArrayTexture||q.isCompressedArrayTexture)Te.setTexture2DArray(q,0),tt=P.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}P.pixelStorei(P.UNPACK_FLIP_Y_WEBGL,q.flipY),P.pixelStorei(P.UNPACK_PREMULTIPLY_ALPHA_WEBGL,q.premultiplyAlpha),P.pixelStorei(P.UNPACK_ALIGNMENT,q.unpackAlignment);let ut=P.getParameter(P.UNPACK_ROW_LENGTH),dn=P.getParameter(P.UNPACK_IMAGE_HEIGHT),kn=P.getParameter(P.UNPACK_SKIP_PIXELS),ai=P.getParameter(P.UNPACK_SKIP_ROWS),Ur=P.getParameter(P.UNPACK_SKIP_IMAGES),Mt=ee.isCompressedTexture?ee.mipmaps[Y]:ee.image;P.pixelStorei(P.UNPACK_ROW_LENGTH,Mt.width),P.pixelStorei(P.UNPACK_IMAGE_HEIGHT,Mt.height),P.pixelStorei(P.UNPACK_SKIP_PIXELS,T.min.x),P.pixelStorei(P.UNPACK_SKIP_ROWS,T.min.y),P.pixelStorei(P.UNPACK_SKIP_IMAGES,T.min.z),ee.isDataTexture||ee.isData3DTexture?P.texSubImage3D(tt,Y,G.x,G.y,G.z,Ee,Fe,Pe,Ve,Ze,Mt.data):q.isCompressedArrayTexture?P.compressedTexSubImage3D(tt,Y,G.x,G.y,G.z,Ee,Fe,Pe,Ve,Mt.data):P.texSubImage3D(tt,Y,G.x,G.y,G.z,Ee,Fe,Pe,Ve,Ze,Mt),P.pixelStorei(P.UNPACK_ROW_LENGTH,ut),P.pixelStorei(P.UNPACK_IMAGE_HEIGHT,dn),P.pixelStorei(P.UNPACK_SKIP_PIXELS,kn),P.pixelStorei(P.UNPACK_SKIP_ROWS,ai),P.pixelStorei(P.UNPACK_SKIP_IMAGES,Ur),Y===0&&q.generateMipmaps&&P.generateMipmap(tt),ge.unbindTexture()},this.initTexture=function(T){T.isCubeTexture?Te.setTextureCube(T,0):T.isData3DTexture?Te.setTexture3D(T,0):T.isDataArrayTexture||T.isCompressedArrayTexture?Te.setTexture2DArray(T,0):Te.setTexture2D(T,0),ge.unbindTexture()},this.resetState=function(){w=0,A=0,b=null,ge.reset(),at.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return is}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;let t=this.getContext();t.drawingBufferColorSpace=e===Gv?"display-p3":"srgb",t.unpackColorSpace=Ot.workingColorSpace===Qf?"display-p3":"srgb"}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}};var zf=class extends nr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Go,this.environmentIntensity=1,this.environmentRotation=new Go,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}};var Bi=class extends Fi{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ge(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},Hf=new k,jf=new k,Lb=new qe,gu=new yc,vf=new os,ev=new k,Ub=new k,Wo=class extends nr{constructor(e=new bn,t=new Bi){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,n=[0];for(let r=1,s=t.count;r<s;r++)Hf.fromBufferAttribute(t,r-1),jf.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=Hf.distanceTo(jf);e.setAttribute("lineDistance",new xn(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let n=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),vf.copy(n.boundingSphere),vf.applyMatrix4(r),vf.radius+=s,e.ray.intersectsSphere(vf)===!1)return;Lb.copy(r).invert(),gu.copy(e.ray).applyMatrix4(Lb);let a=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,l=this.isLineSegments?2:1,u=n.index,d=n.attributes.position;if(u!==null){let f=Math.max(0,o.start),x=Math.min(u.count,o.start+o.count);for(let g=f,p=x-1;g<p;g+=l){let m=u.getX(g),v=u.getX(g+1),E=Ef(this,e,gu,c,m,v);E&&t.push(E)}if(this.isLineLoop){let g=u.getX(x-1),p=u.getX(f),m=Ef(this,e,gu,c,g,p);m&&t.push(m)}}else{let f=Math.max(0,o.start),x=Math.min(d.count,o.start+o.count);for(let g=f,p=x-1;g<p;g+=l){let m=Ef(this,e,gu,c,g,g+1);m&&t.push(m)}if(this.isLineLoop){let g=Ef(this,e,gu,c,x-1,f);g&&t.push(g)}}}updateMorphTargets(){let t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){let r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){let a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}};function Ef(i,e,t,n,r,s){let o=i.geometry.attributes.position;if(Hf.fromBufferAttribute(o,r),jf.fromBufferAttribute(o,s),t.distanceSqToSegment(Hf,jf,ev,Ub)>n)return;ev.applyMatrix4(i.matrixWorld);let c=e.ray.origin.distanceTo(ev);if(!(c<e.near||c>e.far))return{distance:c,point:Ub.clone().applyMatrix4(i.matrixWorld),index:r,face:null,faceIndex:null,object:i}}var Vb=new k,zb=new k,_c=class extends Wo{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,n=[];for(let r=0,s=t.count;r<s;r+=2)Vb.fromBufferAttribute(t,r),zb.fromBufferAttribute(t,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+Vb.distanceTo(zb);e.setAttribute("lineDistance",new xn(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}};var Ls=class extends Fi{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Ge(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}},Hb=new qe,bv=new yc,yf=new os,Cf=new k,Ac=class extends nr{constructor(e=new bn,t=new Ls){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){let n=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),yf.copy(n.boundingSphere),yf.applyMatrix4(r),yf.radius+=s,e.ray.intersectsSphere(yf)===!1)return;Hb.copy(r).invert(),bv.copy(e.ray).applyMatrix4(Hb);let a=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,l=n.index,h=n.attributes.position;if(l!==null){let d=Math.max(0,o.start),f=Math.min(l.count,o.start+o.count);for(let x=d,g=f;x<g;x++){let p=l.getX(x);Cf.fromBufferAttribute(h,p),jb(Cf,p,c,r,e,t,this)}}else{let d=Math.max(0,o.start),f=Math.min(h.count,o.start+o.count);for(let x=d,g=f;x<g;x++)Cf.fromBufferAttribute(h,x),jb(Cf,x,c,r,e,t,this)}}updateMorphTargets(){let t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){let r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){let a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}};function jb(i,e,t,n,r,s,o){let a=bv.distanceSqToPoint(i);if(a<t){let c=new k;bv.closestPointToPoint(i,c),c.applyMatrix4(n);let l=r.ray.origin.distanceTo(c);if(l<r.near||l>r.far)return;s.push({distance:l,distanceToRay:Math.sqrt(a),point:c,index:e,face:null,object:o})}}var Dv=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){let t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){let t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],n,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)n=this.getPoint(o/e),s+=n.distanceTo(r),t.push(s),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let n=this.getLengths(),r=0,s=n.length,o;t?o=t:o=e*n[s-1];let a=0,c=s-1,l;for(;a<=c;)if(r=Math.floor(a+(c-a)/2),l=n[r]-o,l<0)a=r+1;else if(l>0)c=r-1;else{c=r;break}if(r=c,n[r]===o)return r/(s-1);let u=n[r],d=n[r+1]-u,f=(o-u)/d;return(r+f)/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);let o=this.getPoint(r),a=this.getPoint(s),c=t||(o.isVector2?new We:new k);return c.copy(a).sub(o).normalize(),c}getTangentAt(e,t){let n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t){let n=new k,r=[],s=[],o=[],a=new k,c=new qe;for(let f=0;f<=e;f++){let x=f/e;r[f]=this.getTangentAt(x,new k)}s[0]=new k,o[0]=new k;let l=Number.MAX_VALUE,u=Math.abs(r[0].x),h=Math.abs(r[0].y),d=Math.abs(r[0].z);u<=l&&(l=u,n.set(1,0,0)),h<=l&&(l=h,n.set(0,1,0)),d<=l&&n.set(0,0,1),a.crossVectors(r[0],n).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let f=1;f<=e;f++){if(s[f]=s[f-1].clone(),o[f]=o[f-1].clone(),a.crossVectors(r[f-1],r[f]),a.length()>Number.EPSILON){a.normalize();let x=Math.acos(Bn(r[f-1].dot(r[f]),-1,1));s[f].applyMatrix4(c.makeRotationAxis(a,x))}o[f].crossVectors(r[f],s[f])}if(t===!0){let f=Math.acos(Bn(s[0].dot(s[e]),-1,1));f/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(f=-f);for(let x=1;x<=e;x++)s[x].applyMatrix4(c.makeRotationAxis(r[x],f*x)),o[x].crossVectors(r[x],s[x])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},$o=class extends Dv{constructor(e=0,t=0,n=1,r=1,s=0,o=Math.PI*2,a=!1,c=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=c}getPoint(e,t=new We){let n=t,r=Math.PI*2,s=this.aEndAngle-this.aStartAngle,o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);let a=this.aStartAngle+e*s,c=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){let u=Math.cos(this.aRotation),h=Math.sin(this.aRotation),d=c-this.aX,f=l-this.aY;c=d*u-f*h+this.aX,l=d*h+f*u+this.aY}return n.set(c,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}};var wc=class extends Fi{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Ge(16777215),this.specular=new Ge(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ge(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=rD,this.normalScale=new We(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Go,this.combine=jv,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}};function _f(i,e,t){return!i||!t&&i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)}function Xk(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}var bc=class{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,n=this._cachedIndex,r=t[n],s=t[n-1];n:{e:{let o;t:{i:if(!(e<r)){for(let a=n+2;;){if(r===void 0){if(e<s)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===a)break;if(s=r,r=t[++n],e<r)break e}o=t.length;break t}if(!(e>=s)){let a=t[1];e<a&&(n=2,s=a);for(let c=n-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===c)break;if(r=s,s=t[--n-1],e>=s)break e}o=n,n=0;break t}break n}for(;n<o;){let a=n+o>>>1;e<t[a]?o=a:n=a+1}if(r=t[n],s=t[n-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=n[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},Sv=class extends bc{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Ww,endingEnd:Ww}}intervalChanged_(e,t,n){let r=this.parameterPositions,s=e-2,o=e+1,a=r[s],c=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case $w:s=e,a=2*t-n;break;case Xw:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=n}if(c===void 0)switch(this.getSettings_().endingEnd){case $w:o=e,c=2*n-t;break;case Xw:o=1,c=n+r[1]-r[0];break;default:o=e-1,c=t}let l=(n-t)*.5,u=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(c-n),this._offsetPrev=s*u,this._offsetNext=o*u}interpolate_(e,t,n,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=this._offsetPrev,h=this._offsetNext,d=this._weightPrev,f=this._weightNext,x=(n-t)/(r-t),g=x*x,p=g*x,m=-d*p+2*d*g-d*x,v=(1+d)*p+(-1.5-2*d)*g+(-.5+d)*x+1,E=(-1-f)*p+(1.5+f)*g+.5*x,y=f*p-f*g;for(let w=0;w!==a;++w)s[w]=m*o[u+w]+v*o[l+w]+E*o[c+w]+y*o[h+w];return s}},Mv=class extends bc{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,l=c-a,u=(n-t)/(r-t),h=1-u;for(let d=0;d!==a;++d)s[d]=o[l+d]*h+o[c+d]*u;return s}},Tv=class extends bc{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}},tr=class{constructor(e,t,n,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=_f(t,this.TimeBufferType),this.values=_f(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:_f(e.times,Array),values:_f(e.values,Array)};let r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new Tv(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Mv(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Sv(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case wf:t=this.InterpolantFactoryMethodDiscrete;break;case bf:t=this.InterpolantFactoryMethodLinear;break;case Tg:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return wf;case this.InterpolantFactoryMethodLinear:return bf;case this.InterpolantFactoryMethodSmooth:return Tg}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){let n=this.times,r=n.length,s=0,o=r-1;for(;s!==r&&n[s]<e;)++s;for(;o!==-1&&n[o]>t;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);let a=this.getValueSize();this.times=n.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let n=this.times,r=this.values,s=n.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){let c=n[a];if(typeof c=="number"&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,c),e=!1;break}if(o!==null&&o>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,c,o),e=!1;break}o=c}if(r!==void 0&&Xk(r))for(let a=0,c=r.length;a!==c;++a){let l=r[a];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,l),e=!1;break}}return e}optimize(){let e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===Tg,s=e.length-1,o=1;for(let a=1;a<s;++a){let c=!1,l=e[a],u=e[a+1];if(l!==u&&(a!==1||l!==e[0]))if(r)c=!0;else{let h=a*n,d=h-n,f=h+n;for(let x=0;x!==n;++x){let g=t[h+x];if(g!==t[d+x]||g!==t[f+x]){c=!0;break}}}if(c){if(a!==o){e[o]=e[a];let h=a*n,d=o*n;for(let f=0;f!==n;++f)t[d+f]=t[h+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*n,c=o*n,l=0;l!==n;++l)t[c+l]=t[a+l];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*n)):(this.times=e,this.values=t),this}clone(){let e=this.times.slice(),t=this.values.slice(),n=this.constructor,r=new n(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}};tr.prototype.TimeBufferType=Float32Array;tr.prototype.ValueBufferType=Float32Array;tr.prototype.DefaultInterpolation=bf;var Xo=class extends tr{};Xo.prototype.ValueTypeName="bool";Xo.prototype.ValueBufferType=Array;Xo.prototype.DefaultInterpolation=wf;Xo.prototype.InterpolantFactoryMethodLinear=void 0;Xo.prototype.InterpolantFactoryMethodSmooth=void 0;var Fv=class extends tr{};Fv.prototype.ValueTypeName="color";var Bv=class extends tr{};Bv.prototype.ValueTypeName="number";var Iv=class extends bc{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){let s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=(n-t)/(r-t),l=e*a;for(let u=l+a;l!==u;l+=4)Ti.slerpFlat(s,0,o,l-a,o,l,c);return s}},Fu=class extends tr{InterpolantFactoryMethodLinear(e){return new Iv(this.times,this.values,this.getValueSize(),e)}};Fu.prototype.ValueTypeName="quaternion";Fu.prototype.DefaultInterpolation=bf;Fu.prototype.InterpolantFactoryMethodSmooth=void 0;var qo=class extends tr{};qo.prototype.ValueTypeName="string";qo.prototype.ValueBufferType=Array;qo.prototype.DefaultInterpolation=wf;qo.prototype.InterpolantFactoryMethodLinear=void 0;qo.prototype.InterpolantFactoryMethodSmooth=void 0;var Pv=class extends tr{};Pv.prototype.ValueTypeName="vector";var Gf={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}},Rv=class{constructor(e,t,n){let r=this,s=!1,o=0,a=0,c,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(u){a++,s===!1&&r.onStart!==void 0&&r.onStart(u,o,a),s=!0},this.itemEnd=function(u){o++,r.onProgress!==void 0&&r.onProgress(u,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(u){r.onError!==void 0&&r.onError(u)},this.resolveURL=function(u){return c?c(u):u},this.setURLModifier=function(u){return c=u,this},this.addHandler=function(u,h){return l.push(u,h),this},this.removeHandler=function(u){let h=l.indexOf(u);return h!==-1&&l.splice(h,2),this},this.getHandler=function(u){for(let h=0,d=l.length;h<d;h+=2){let f=l[h],x=l[h+1];if(f.global&&(f.lastIndex=0),f.test(u))return x}return null}}},Xv=new Rv,Yo=(()=>{class i{constructor(t){this.manager=t!==void 0?t:Xv,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,n){let r=this;return new Promise(function(s,o){r.load(t,s,n,o)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}return i.DEFAULT_MATERIAL_NAME="__DEFAULT",i})(),Qr={},Ov=class extends Error{constructor(e,t){super(e),this.response=t}},Dc=class extends Yo{constructor(e){super(e)}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let s=Gf.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(Qr[e]!==void 0){Qr[e].push({onLoad:t,onProgress:n,onError:r});return}Qr[e]=[],Qr[e].push({onLoad:t,onProgress:n,onError:r});let o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,c=this.responseType;fetch(o).then(l=>{if(l.status===200||l.status===0){if(l.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||l.body===void 0||l.body.getReader===void 0)return l;let u=Qr[e],h=l.body.getReader(),d=l.headers.get("X-File-Size")||l.headers.get("Content-Length"),f=d?parseInt(d):0,x=f!==0,g=0,p=new ReadableStream({start(m){v();function v(){h.read().then(({done:E,value:y})=>{if(E)m.close();else{g+=y.byteLength;let w=new ProgressEvent("progress",{lengthComputable:x,loaded:g,total:f});for(let A=0,b=u.length;A<b;A++){let D=u[A];D.onProgress&&D.onProgress(w)}m.enqueue(y),v()}})}}});return new Response(p)}else throw new Ov(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(c){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(u=>new DOMParser().parseFromString(u,a));case"json":return l.json();default:if(a===void 0)return l.text();{let h=/charset="?([^;"\s]*)"?/i.exec(a),d=h&&h[1]?h[1].toLowerCase():void 0,f=new TextDecoder(d);return l.arrayBuffer().then(x=>f.decode(x))}}}).then(l=>{Gf.add(e,l);let u=Qr[e];delete Qr[e];for(let h=0,d=u.length;h<d;h++){let f=u[h];f.onLoad&&f.onLoad(l)}}).catch(l=>{let u=Qr[e];if(u===void 0)throw this.manager.itemError(e),l;delete Qr[e];for(let h=0,d=u.length;h<d;h++){let f=u[h];f.onError&&f.onError(l)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}};var kv=class extends Yo{constructor(e){super(e)}load(e,t,n,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let s=this,o=Gf.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;let a=Du("img");function c(){u(),Gf.add(e,this),t&&t(this),s.manager.itemEnd(e)}function l(h){u(),r&&r(h),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){a.removeEventListener("load",c,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",c,!1),a.addEventListener("error",l,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}};var Wf=class extends Yo{constructor(e){super(e)}load(e,t,n,r){let s=new Vs,o=new kv(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},n,r),s}},Nv=class extends nr{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Ge(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}};var tv=new qe,Gb=new k,Wb=new k,Lv=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new We(512,512),this.map=null,this.mapPass=null,this.matrix=new qe,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Tu,this._frameExtents=new We(1,1),this._viewportCount=1,this._viewports=[new Zt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,n=this.matrix;Gb.setFromMatrixPosition(e.matrixWorld),t.position.copy(Gb),Wb.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Wb),t.updateMatrixWorld(),tv.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(tv),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(tv)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}};var $b=new qe,vu=new k,nv=new k,Uv=class extends Lv{constructor(){super(new zn(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new We(4,2),this._viewportCount=6,this._viewports=[new Zt(2,1,1,1),new Zt(0,1,1,1),new Zt(3,1,1,1),new Zt(1,1,1,1),new Zt(3,0,1,1),new Zt(1,0,1,1)],this._cubeDirections=[new k(1,0,0),new k(-1,0,0),new k(0,0,1),new k(0,0,-1),new k(0,1,0),new k(0,-1,0)],this._cubeUps=[new k(0,1,0),new k(0,1,0),new k(0,1,0),new k(0,1,0),new k(0,0,1),new k(0,0,-1)]}updateMatrices(e,t=0){let n=this.camera,r=this.matrix,s=e.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),vu.setFromMatrixPosition(e.matrixWorld),n.position.copy(vu),nv.copy(n.position),nv.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(nv),n.updateMatrixWorld(),r.makeTranslation(-vu.x,-vu.y,-vu.z),$b.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix($b)}},$f=class extends Nv{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new Uv}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}};var Xf=class{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){let t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}};var qf=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Xb(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=Xb();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function Xb(){return(typeof performance>"u"?Date:performance).now()}var qv="\\[\\]\\.:\\/",qk=new RegExp("["+qv+"]","g"),Yv="[^"+qv+"]",Yk="[^"+qv.replace("\\.","")+"]",Zk=/((?:WC+[\/:])*)/.source.replace("WC",Yv),Kk=/(WCOD+)?/.source.replace("WCOD",Yk),Jk=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Yv),Qk=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Yv),e7=new RegExp("^"+Zk+Kk+Jk+Qk+"$"),t7=["material","materials","bones","map"],Vv=class{constructor(e,t,n){let r=n||an.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();let n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(e,t)}setValue(e,t){let n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}},an=(()=>{class i{constructor(t,n,r){this.path=n,this.parsedPath=r||i.parseTrackName(n),this.node=i.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,n,r){return t&&t.isAnimationObjectGroup?new i.Composite(t,n,r):new i(t,n,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(qk,"")}static parseTrackName(t){let n=e7.exec(t);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+t);let r={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},s=r.nodeName&&r.nodeName.lastIndexOf(".");if(s!==void 0&&s!==-1){let o=r.nodeName.substring(s+1);t7.indexOf(o)!==-1&&(r.nodeName=r.nodeName.substring(0,s),r.objectName=o)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,n){if(n===void 0||n===""||n==="."||n===-1||n===t.name||n===t.uuid)return t;if(t.skeleton){let r=t.skeleton.getBoneByName(n);if(r!==void 0)return r}if(t.children){let r=function(o){for(let a=0;a<o.length;a++){let c=o[a];if(c.name===n||c.uuid===n)return c;let l=r(c.children);if(l)return l}return null},s=r(t.children);if(s)return s}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,n){t[n]=this.targetObject[this.propertyName]}_getValue_array(t,n){let r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)t[n++]=r[s]}_getValue_arrayElement(t,n){t[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,n){this.resolvedProperty.toArray(t,n)}_setValue_direct(t,n){this.targetObject[this.propertyName]=t[n]}_setValue_direct_setNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,n){let r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++]}_setValue_array_setNeedsUpdate(t,n){let r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,n){let r=this.resolvedProperty;for(let s=0,o=r.length;s!==o;++s)r[s]=t[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,n){this.resolvedProperty[this.propertyIndex]=t[n]}_setValue_arrayElement_setNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,n){this.resolvedProperty.fromArray(t,n)}_setValue_fromArray_setNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,n){this.bind(),this.getValue(t,n)}_setValue_unbound(t,n){this.bind(),this.setValue(t,n)}bind(){let t=this.node,n=this.parsedPath,r=n.objectName,s=n.propertyName,o=n.propertyIndex;if(t||(t=i.findNode(this.rootNode,n.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let u=n.objectIndex;switch(r){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(let h=0;h<t.length;h++)if(t[h].name===u){u=h;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}t=t.material.map;break;default:if(t[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[r]}if(u!==void 0){if(t[u]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[u]}}let a=t[s];if(a===void 0){let u=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+s+" but it wasn't found.",t);return}let c=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?c=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(c=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(o!==void 0){if(s==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[o]!==void 0&&(o=t.morphTargetDictionary[o])}l=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=o}else a.fromArray!==void 0&&a.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(l=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=s;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return i.Composite=Vv,i})();an.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};an.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};an.prototype.GetterByBindingType=[an.prototype._getValue_direct,an.prototype._getValue_array,an.prototype._getValue_arrayElement,an.prototype._getValue_toArray];an.prototype.SetterByBindingTypeAndVersioning=[[an.prototype._setValue_direct,an.prototype._setValue_direct_setNeedsUpdate,an.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[an.prototype._setValue_array,an.prototype._setValue_array_setNeedsUpdate,an.prototype._setValue_array_setMatrixWorldNeedsUpdate],[an.prototype._setValue_arrayElement,an.prototype._setValue_arrayElement_setNeedsUpdate,an.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[an.prototype._setValue_fromArray,an.prototype._setValue_fromArray_setNeedsUpdate,an.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var CX=new Float32Array(1);var qb=new qe,Yf=class{constructor(e,t,n=0,r=1/0){this.ray=new yc(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new Su,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return qb.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(qb),this}intersectObject(e,t=!0,n=[]){return zv(e,this,n,t),n.sort(Yb),n}intersectObjects(e,t=!0,n=[]){for(let r=0,s=e.length;r<s;r++)zv(e[r],this,n,t);return n.sort(Yb),n}};function Yb(i,e){return i.distance-e.distance}function zv(i,e,t,n){if(i.layers.test(e.layers)&&i.raycast(e,t),n===!0){let r=i.children;for(let s=0,o=r.length;s<o;s++)zv(r[s],e,t,!0)}}var Zf=class extends _c{constructor(e=10,t=10,n=4473924,r=8947848){n=new Ge(n),r=new Ge(r);let s=t/2,o=e/t,a=e/2,c=[],l=[];for(let d=0,f=0,x=-a;d<=t;d++,x+=o){c.push(-a,0,x,a,0,x),c.push(x,0,-a,x,0,a);let g=d===s?n:r;g.toArray(l,f),f+=3,g.toArray(l,f),f+=3,g.toArray(l,f),f+=3,g.toArray(l,f),f+=3}let u=new bn;u.setAttribute("position",new xn(c,3)),u.setAttribute("color",new xn(l,3));let h=new Bi({vertexColors:!0,toneMapped:!1});super(u,h),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Hv}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Hv);var xD=new k,i7=new Ti,mD=new k,t0=class extends nr{constructor(e=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(t){t.element instanceof Element&&t.element.parentNode!==null&&t.element.parentNode.removeChild(t.element)})})}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this}};var Br=new qe,r7=new qe,n0=class{constructor(e={}){let t=this,n,r,s,o,a={camera:{style:""},objects:new WeakMap},c=e.element!==void 0?e.element:document.createElement("div");c.style.overflow="hidden",this.domElement=c;let l=document.createElement("div");l.style.transformOrigin="0 0",l.style.pointerEvents="none",c.appendChild(l);let u=document.createElement("div");u.style.transformStyle="preserve-3d",l.appendChild(u),this.getSize=function(){return{width:n,height:r}},this.render=function(g,p){let m=p.projectionMatrix.elements[5]*o;p.view&&p.view.enabled?(l.style.transform=`translate( ${-p.view.offsetX*(n/p.view.width)}px, ${-p.view.offsetY*(r/p.view.height)}px )`,l.style.transform+=`scale( ${p.view.fullWidth/p.view.width}, ${p.view.fullHeight/p.view.height} )`):l.style.transform="",g.matrixWorldAutoUpdate===!0&&g.updateMatrixWorld(),p.parent===null&&p.matrixWorldAutoUpdate===!0&&p.updateMatrixWorld();let v,E;p.isOrthographicCamera&&(v=-(p.right+p.left)/2,E=(p.top+p.bottom)/2);let y=p.view&&p.view.enabled?p.view.height/p.view.fullHeight:1,w=p.isOrthographicCamera?`scale( ${y} )scale(`+m+")translate("+h(v)+"px,"+h(E)+"px)"+d(p.matrixWorldInverse):`scale( ${y} )translateZ(`+m+"px)"+d(p.matrixWorldInverse),b=(p.isPerspectiveCamera?"perspective("+m+"px) ":"")+w+"translate("+s+"px,"+o+"px)";a.camera.style!==b&&(u.style.transform=b,a.camera.style=b),x(g,g,p,w)},this.setSize=function(g,p){n=g,r=p,s=n/2,o=r/2,c.style.width=g+"px",c.style.height=p+"px",l.style.width=g+"px",l.style.height=p+"px",u.style.width=g+"px",u.style.height=p+"px"};function h(g){return Math.abs(g)<1e-10?0:g}function d(g){let p=g.elements;return"matrix3d("+h(p[0])+","+h(-p[1])+","+h(p[2])+","+h(p[3])+","+h(p[4])+","+h(-p[5])+","+h(p[6])+","+h(p[7])+","+h(p[8])+","+h(-p[9])+","+h(p[10])+","+h(p[11])+","+h(p[12])+","+h(-p[13])+","+h(p[14])+","+h(p[15])+")"}function f(g){let p=g.elements;return"translate(-50%,-50%)"+("matrix3d("+h(p[0])+","+h(p[1])+","+h(p[2])+","+h(p[3])+","+h(-p[4])+","+h(-p[5])+","+h(-p[6])+","+h(-p[7])+","+h(p[8])+","+h(p[9])+","+h(p[10])+","+h(p[11])+","+h(p[12])+","+h(p[13])+","+h(p[14])+","+h(p[15])+")")}function x(g,p,m,v){if(g.isCSS3DObject){let E=g.visible===!0&&g.layers.test(m.layers)===!0;if(g.element.style.display=E===!0?"":"none",E===!0){g.onBeforeRender(t,p,m);let y;g.isCSS3DSprite?(Br.copy(m.matrixWorldInverse),Br.transpose(),g.rotation2D!==0&&Br.multiply(r7.makeRotationZ(g.rotation2D)),g.matrixWorld.decompose(xD,i7,mD),Br.setPosition(xD),Br.scale(mD),Br.elements[3]=0,Br.elements[7]=0,Br.elements[11]=0,Br.elements[15]=1,y=f(Br)):y=f(g.matrixWorld);let w=g.element,A=a.objects.get(g);if(A===void 0||A.style!==y){w.style.transform=y;let b={style:y};a.objects.set(g,b)}w.parentNode!==u&&u.appendChild(w),g.onAfterRender(t,p,m)}}for(let E=0,y=g.children.length;E<y;E++)x(g.children[E],p,m,v)}}};var Re={IDLE:Symbol(),ROTATE:Symbol(),PAN:Symbol(),SCALE:Symbol(),FOV:Symbol(),FOCUS:Symbol(),ZROTATE:Symbol(),TOUCH_MULTI:Symbol(),ANIMATION_FOCUS:Symbol(),ANIMATION_ROTATE:Symbol()},It={NONE:Symbol(),ONE_FINGER:Symbol(),ONE_FINGER_SWITCHED:Symbol(),TWO_FINGER:Symbol(),MULT_FINGER:Symbol(),CURSOR:Symbol()},Qe={x:0,y:0},xi={camera:new qe,gizmos:new qe},Gt={type:"change"},rr={type:"start"},Ii={type:"end"},s7=new Yf,mn=new k,gD=new qe,vD=new qe,ir=new k,i0=class extends Tr{constructor(e,t,n=null){super(),this.camera=null,this.domElement=t,this.scene=n,this.target=new k,this._currentTarget=new k,this.radiusFactor=.67,this.mouseActions=[],this._mouseOp=null,this._v2_1=new We,this._v3_1=new k,this._v3_2=new k,this._m4_1=new qe,this._m4_2=new qe,this._quat=new Ti,this._translationMatrix=new qe,this._rotationMatrix=new qe,this._scaleMatrix=new qe,this._rotationAxis=new k,this._cameraMatrixState=new qe,this._cameraProjectionState=new qe,this._fovState=1,this._upState=new k,this._zoomState=1,this._nearPos=0,this._farPos=0,this._gizmoMatrixState=new qe,this._up0=new k,this._zoom0=1,this._fov0=0,this._initialNear=0,this._nearPos0=0,this._initialFar=0,this._farPos0=0,this._cameraMatrixState0=new qe,this._gizmoMatrixState0=new qe,this._button=-1,this._touchStart=[],this._touchCurrent=[],this._input=It.NONE,this._switchSensibility=32,this._startFingerDistance=0,this._currentFingerDistance=0,this._startFingerRotation=0,this._currentFingerRotation=0,this._devPxRatio=0,this._downValid=!0,this._nclicks=0,this._downEvents=[],this._downStart=0,this._clickStart=0,this._maxDownTime=250,this._maxInterval=300,this._posThreshold=24,this._movementThreshold=24,this._currentCursorPosition=new k,this._startCursorPosition=new k,this._grid=null,this._gridPosition=new k,this._gizmos=new Sr,this._curvePts=128,this._timeStart=-1,this._animationId=-1,this.focusAnimationTime=500,this._timePrev=0,this._timeCurrent=0,this._anglePrev=0,this._angleCurrent=0,this._cursorPosPrev=new k,this._cursorPosCurr=new k,this._wPrev=0,this._wCurr=0,this.adjustNearFar=!1,this.scaleFactor=1.1,this.dampingFactor=25,this.wMax=20,this.enableAnimations=!0,this.enableGrid=!1,this.cursorZoom=!1,this.minFov=5,this.maxFov=90,this.rotateSpeed=1,this.enabled=!0,this.enablePan=!0,this.enableRotate=!0,this.enableZoom=!0,this.enableGizmos=!0,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this._tbRadius=1,this._state=Re.IDLE,this.setCamera(e),this.scene!=null&&this.scene.add(this._gizmos),this.domElement.style.touchAction="none",this._devPxRatio=window.devicePixelRatio,this.initializeMouseActions(),this._onContextMenu=a7.bind(this),this._onWheel=d7.bind(this),this._onPointerUp=h7.bind(this),this._onPointerMove=u7.bind(this),this._onPointerDown=l7.bind(this),this._onPointerCancel=c7.bind(this),this._onWindowResize=o7.bind(this),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onWheel),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerCancel),window.addEventListener("resize",this._onWindowResize)}onSinglePanStart(e,t){if(this.enabled)switch(this.dispatchEvent(rr),this.setCenter(e.clientX,e.clientY),t){case"PAN":if(!this.enablePan)return;this._animationId!=-1&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(Gt)),this.updateTbState(Re.PAN,!0),this._startCursorPosition.copy(this.unprojectOnTbPlane(this.camera,Qe.x,Qe.y,this.domElement)),this.enableGrid&&(this.drawGrid(),this.dispatchEvent(Gt));break;case"ROTATE":if(!this.enableRotate)return;this._animationId!=-1&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1),this.updateTbState(Re.ROTATE,!0),this._startCursorPosition.copy(this.unprojectOnTbSurface(this.camera,Qe.x,Qe.y,this.domElement,this._tbRadius)),this.activateGizmos(!0),this.enableAnimations&&(this._timePrev=this._timeCurrent=performance.now(),this._angleCurrent=this._anglePrev=0,this._cursorPosPrev.copy(this._startCursorPosition),this._cursorPosCurr.copy(this._cursorPosPrev),this._wCurr=0,this._wPrev=this._wCurr),this.dispatchEvent(Gt);break;case"FOV":if(!this.camera.isPerspectiveCamera||!this.enableZoom)return;this._animationId!=-1&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(Gt)),this.updateTbState(Re.FOV,!0),this._startCursorPosition.setY(this.getCursorNDC(Qe.x,Qe.y,this.domElement).y*.5),this._currentCursorPosition.copy(this._startCursorPosition);break;case"ZOOM":if(!this.enableZoom)return;this._animationId!=-1&&(cancelAnimationFrame(this._animationId),this._animationId=-1,this._timeStart=-1,this.activateGizmos(!1),this.dispatchEvent(Gt)),this.updateTbState(Re.SCALE,!0),this._startCursorPosition.setY(this.getCursorNDC(Qe.x,Qe.y,this.domElement).y*.5),this._currentCursorPosition.copy(this._startCursorPosition);break}}onSinglePanMove(e,t){if(this.enabled){let n=t!=this._state;switch(this.setCenter(e.clientX,e.clientY),t){case Re.PAN:this.enablePan&&(n?(this.dispatchEvent(Ii),this.dispatchEvent(rr),this.updateTbState(t,!0),this._startCursorPosition.copy(this.unprojectOnTbPlane(this.camera,Qe.x,Qe.y,this.domElement)),this.enableGrid&&this.drawGrid(),this.activateGizmos(!1)):(this._currentCursorPosition.copy(this.unprojectOnTbPlane(this.camera,Qe.x,Qe.y,this.domElement)),this.applyTransformMatrix(this.pan(this._startCursorPosition,this._currentCursorPosition))));break;case Re.ROTATE:if(this.enableRotate)if(n)this.dispatchEvent(Ii),this.dispatchEvent(rr),this.updateTbState(t,!0),this._startCursorPosition.copy(this.unprojectOnTbSurface(this.camera,Qe.x,Qe.y,this.domElement,this._tbRadius)),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!0);else{this._currentCursorPosition.copy(this.unprojectOnTbSurface(this.camera,Qe.x,Qe.y,this.domElement,this._tbRadius));let r=this._startCursorPosition.distanceTo(this._currentCursorPosition),s=this._startCursorPosition.angleTo(this._currentCursorPosition),o=Math.max(r/this._tbRadius,s)*this.rotateSpeed;this.applyTransformMatrix(this.rotate(this.calculateRotationAxis(this._startCursorPosition,this._currentCursorPosition),o)),this.enableAnimations&&(this._timePrev=this._timeCurrent,this._timeCurrent=performance.now(),this._anglePrev=this._angleCurrent,this._angleCurrent=o,this._cursorPosPrev.copy(this._cursorPosCurr),this._cursorPosCurr.copy(this._currentCursorPosition),this._wPrev=this._wCurr,this._wCurr=this.calculateAngularSpeed(this._anglePrev,this._angleCurrent,this._timePrev,this._timeCurrent))}break;case Re.SCALE:if(this.enableZoom)if(n)this.dispatchEvent(Ii),this.dispatchEvent(rr),this.updateTbState(t,!0),this._startCursorPosition.setY(this.getCursorNDC(Qe.x,Qe.y,this.domElement).y*.5),this._currentCursorPosition.copy(this._startCursorPosition),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1);else{this._currentCursorPosition.setY(this.getCursorNDC(Qe.x,Qe.y,this.domElement).y*.5);let s=this._currentCursorPosition.y-this._startCursorPosition.y,o=1;s<0?o=1/Math.pow(this.scaleFactor,-s*8):s>0&&(o=Math.pow(this.scaleFactor,s*8)),this._v3_1.setFromMatrixPosition(this._gizmoMatrixState),this.applyTransformMatrix(this.scale(o,this._v3_1))}break;case Re.FOV:if(this.enableZoom&&this.camera.isPerspectiveCamera)if(n)this.dispatchEvent(Ii),this.dispatchEvent(rr),this.updateTbState(t,!0),this._startCursorPosition.setY(this.getCursorNDC(Qe.x,Qe.y,this.domElement).y*.5),this._currentCursorPosition.copy(this._startCursorPosition),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1);else{this._currentCursorPosition.setY(this.getCursorNDC(Qe.x,Qe.y,this.domElement).y*.5);let s=this._currentCursorPosition.y-this._startCursorPosition.y,o=1;s<0?o=1/Math.pow(this.scaleFactor,-s*8):s>0&&(o=Math.pow(this.scaleFactor,s*8)),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);let a=this._v3_1.distanceTo(this._gizmos.position),c=a/o;c=Kt.clamp(c,this.minDistance,this.maxDistance);let l=a*Math.tan(Kt.DEG2RAD*this._fovState*.5),u=Kt.RAD2DEG*(Math.atan(l/c)*2);u=Kt.clamp(u,this.minFov,this.maxFov);let h=l/Math.tan(Kt.DEG2RAD*(u/2));o=a/h,this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),this.setFov(u),this.applyTransformMatrix(this.scale(o,this._v3_2,!1)),mn.copy(this._gizmos.position).sub(this.camera.position).normalize().multiplyScalar(h/a),this._m4_1.makeTranslation(mn.x,mn.y,mn.z)}break}this.dispatchEvent(Gt)}}onSinglePanEnd(){if(this._state==Re.ROTATE){if(!this.enableRotate)return;if(this.enableAnimations)if(performance.now()-this._timeCurrent<120){let t=Math.abs((this._wPrev+this._wCurr)/2),n=this;this._animationId=window.requestAnimationFrame(function(r){n.updateTbState(Re.ANIMATION_ROTATE,!0);let s=n.calculateRotationAxis(n._cursorPosPrev,n._cursorPosCurr);n.onRotationAnim(r,s,Math.min(t,n.wMax))})}else this.updateTbState(Re.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(Gt);else this.updateTbState(Re.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(Gt)}else(this._state==Re.PAN||this._state==Re.IDLE)&&(this.updateTbState(Re.IDLE,!1),this.enableGrid&&this.disposeGrid(),this.activateGizmos(!1),this.dispatchEvent(Gt));this.dispatchEvent(Ii)}onDoubleTap(e){if(this.enabled&&this.enablePan&&this.scene!=null){this.dispatchEvent(rr),this.setCenter(e.clientX,e.clientY);let t=this.unprojectOnObj(this.getCursorNDC(Qe.x,Qe.y,this.domElement),this.camera);if(t!=null&&this.enableAnimations){let n=this;this._animationId!=-1&&window.cancelAnimationFrame(this._animationId),this._timeStart=-1,this._animationId=window.requestAnimationFrame(function(r){n.updateTbState(Re.ANIMATION_FOCUS,!0),n.onFocusAnim(r,t,n._cameraMatrixState,n._gizmoMatrixState)})}else t!=null&&!this.enableAnimations&&(this.updateTbState(Re.FOCUS,!0),this.focus(t,this.scaleFactor),this.updateTbState(Re.IDLE,!1),this.dispatchEvent(Gt))}this.dispatchEvent(Ii)}onDoublePanStart(){this.enabled&&this.enablePan&&(this.dispatchEvent(rr),this.updateTbState(Re.PAN,!0),this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2),this._startCursorPosition.copy(this.unprojectOnTbPlane(this.camera,Qe.x,Qe.y,this.domElement,!0)),this._currentCursorPosition.copy(this._startCursorPosition),this.activateGizmos(!1))}onDoublePanMove(){this.enabled&&this.enablePan&&(this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2),this._state!=Re.PAN&&(this.updateTbState(Re.PAN,!0),this._startCursorPosition.copy(this._currentCursorPosition)),this._currentCursorPosition.copy(this.unprojectOnTbPlane(this.camera,Qe.x,Qe.y,this.domElement,!0)),this.applyTransformMatrix(this.pan(this._startCursorPosition,this._currentCursorPosition,!0)),this.dispatchEvent(Gt))}onDoublePanEnd(){this.updateTbState(Re.IDLE,!1),this.dispatchEvent(Ii)}onRotateStart(){this.enabled&&this.enableRotate&&(this.dispatchEvent(rr),this.updateTbState(Re.ZROTATE,!0),this._startFingerRotation=this.getAngle(this._touchCurrent[1],this._touchCurrent[0])+this.getAngle(this._touchStart[1],this._touchStart[0]),this._currentFingerRotation=this._startFingerRotation,this.camera.getWorldDirection(this._rotationAxis),!this.enablePan&&!this.enableZoom&&this.activateGizmos(!0))}onRotateMove(){if(this.enabled&&this.enableRotate){this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2);let e;this._state!=Re.ZROTATE&&(this.updateTbState(Re.ZROTATE,!0),this._startFingerRotation=this._currentFingerRotation),this._currentFingerRotation=this.getAngle(this._touchCurrent[1],this._touchCurrent[0])+this.getAngle(this._touchStart[1],this._touchStart[0]),this.enablePan?(this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),e=this.unprojectOnTbPlane(this.camera,Qe.x,Qe.y,this.domElement).applyQuaternion(this.camera.quaternion).multiplyScalar(1/this.camera.zoom).add(this._v3_2)):e=new k().setFromMatrixPosition(this._gizmoMatrixState);let t=Kt.DEG2RAD*(this._startFingerRotation-this._currentFingerRotation);this.applyTransformMatrix(this.zRotate(e,t)),this.dispatchEvent(Gt)}}onRotateEnd(){this.updateTbState(Re.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(Ii)}onPinchStart(){this.enabled&&this.enableZoom&&(this.dispatchEvent(rr),this.updateTbState(Re.SCALE,!0),this._startFingerDistance=this.calculatePointersDistance(this._touchCurrent[0],this._touchCurrent[1]),this._currentFingerDistance=this._startFingerDistance,this.activateGizmos(!1))}onPinchMove(){if(this.enabled&&this.enableZoom){this.setCenter((this._touchCurrent[0].clientX+this._touchCurrent[1].clientX)/2,(this._touchCurrent[0].clientY+this._touchCurrent[1].clientY)/2);let e=12;this._state!=Re.SCALE&&(this._startFingerDistance=this._currentFingerDistance,this.updateTbState(Re.SCALE,!0)),this._currentFingerDistance=Math.max(this.calculatePointersDistance(this._touchCurrent[0],this._touchCurrent[1]),e*this._devPxRatio);let t=this._currentFingerDistance/this._startFingerDistance,n;this.enablePan?this.camera.isOrthographicCamera?n=this.unprojectOnTbPlane(this.camera,Qe.x,Qe.y,this.domElement).applyQuaternion(this.camera.quaternion).multiplyScalar(1/this.camera.zoom).add(this._gizmos.position):this.camera.isPerspectiveCamera&&(n=this.unprojectOnTbPlane(this.camera,Qe.x,Qe.y,this.domElement).applyQuaternion(this.camera.quaternion).add(this._gizmos.position)):n=this._gizmos.position,this.applyTransformMatrix(this.scale(t,n)),this.dispatchEvent(Gt)}}onPinchEnd(){this.updateTbState(Re.IDLE,!1),this.dispatchEvent(Ii)}onTriplePanStart(){if(this.enabled&&this.enableZoom){this.dispatchEvent(rr),this.updateTbState(Re.SCALE,!0);let e=0,t=0,n=this._touchCurrent.length;for(let r=0;r<n;r++)e+=this._touchCurrent[r].clientX,t+=this._touchCurrent[r].clientY;this.setCenter(e/n,t/n),this._startCursorPosition.setY(this.getCursorNDC(Qe.x,Qe.y,this.domElement).y*.5),this._currentCursorPosition.copy(this._startCursorPosition)}}onTriplePanMove(){if(this.enabled&&this.enableZoom){let e=0,t=0,n=this._touchCurrent.length;for(let d=0;d<n;d++)e+=this._touchCurrent[d].clientX,t+=this._touchCurrent[d].clientY;this.setCenter(e/n,t/n);let r=8;this._currentCursorPosition.setY(this.getCursorNDC(Qe.x,Qe.y,this.domElement).y*.5);let s=this._currentCursorPosition.y-this._startCursorPosition.y,o=1;s<0?o=1/Math.pow(this.scaleFactor,-s*r):s>0&&(o=Math.pow(this.scaleFactor,s*r)),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);let a=this._v3_1.distanceTo(this._gizmos.position),c=a/o;c=Kt.clamp(c,this.minDistance,this.maxDistance);let l=a*Math.tan(Kt.DEG2RAD*this._fovState*.5),u=Kt.RAD2DEG*(Math.atan(l/c)*2);u=Kt.clamp(u,this.minFov,this.maxFov);let h=l/Math.tan(Kt.DEG2RAD*(u/2));o=a/h,this._v3_2.setFromMatrixPosition(this._gizmoMatrixState),this.setFov(u),this.applyTransformMatrix(this.scale(o,this._v3_2,!1)),mn.copy(this._gizmos.position).sub(this.camera.position).normalize().multiplyScalar(h/a),this._m4_1.makeTranslation(mn.x,mn.y,mn.z),this.dispatchEvent(Gt)}}onTriplePanEnd(){this.updateTbState(Re.IDLE,!1),this.dispatchEvent(Ii)}setCenter(e,t){Qe.x=e,Qe.y=t}initializeMouseActions(){this.setMouseAction("PAN",0,"CTRL"),this.setMouseAction("PAN",2),this.setMouseAction("ROTATE",0),this.setMouseAction("ZOOM","WHEEL"),this.setMouseAction("ZOOM",1),this.setMouseAction("FOV","WHEEL","SHIFT"),this.setMouseAction("FOV",1,"SHIFT")}compareMouseAction(e,t){return e.operation==t.operation?e.mouse==t.mouse&&e.key==t.key:!1}setMouseAction(e,t,n=null){let r=["PAN","ROTATE","ZOOM","FOV"],s=[0,1,2,"WHEEL"],o=["CTRL","SHIFT",null],a;if(!r.includes(e)||!s.includes(t)||!o.includes(n)||t=="WHEEL"&&e!="ZOOM"&&e!="FOV")return!1;switch(e){case"PAN":a=Re.PAN;break;case"ROTATE":a=Re.ROTATE;break;case"ZOOM":a=Re.SCALE;break;case"FOV":a=Re.FOV;break}let c={operation:e,mouse:t,key:n,state:a};for(let l=0;l<this.mouseActions.length;l++)if(this.mouseActions[l].mouse==c.mouse&&this.mouseActions[l].key==c.key)return this.mouseActions.splice(l,1,c),!0;return this.mouseActions.push(c),!0}unsetMouseAction(e,t=null){for(let n=0;n<this.mouseActions.length;n++)if(this.mouseActions[n].mouse==e&&this.mouseActions[n].key==t)return this.mouseActions.splice(n,1),!0;return!1}getOpFromAction(e,t){let n;for(let r=0;r<this.mouseActions.length;r++)if(n=this.mouseActions[r],n.mouse==e&&n.key==t)return n.operation;if(t!=null){for(let r=0;r<this.mouseActions.length;r++)if(n=this.mouseActions[r],n.mouse==e&&n.key==null)return n.operation}return null}getOpStateFromAction(e,t){let n;for(let r=0;r<this.mouseActions.length;r++)if(n=this.mouseActions[r],n.mouse==e&&n.key==t)return n.state;if(t!=null){for(let r=0;r<this.mouseActions.length;r++)if(n=this.mouseActions[r],n.mouse==e&&n.key==null)return n.state}return null}getAngle(e,t){return Math.atan2(t.clientY-e.clientY,t.clientX-e.clientX)*180/Math.PI}updateTouchEvent(e){for(let t=0;t<this._touchCurrent.length;t++)if(this._touchCurrent[t].pointerId==e.pointerId){this._touchCurrent.splice(t,1,e);break}}applyTransformMatrix(e){if(e.camera!=null&&(this._m4_1.copy(this._cameraMatrixState).premultiply(e.camera),this._m4_1.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.updateMatrix(),(this._state==Re.ROTATE||this._state==Re.ZROTATE||this._state==Re.ANIMATION_ROTATE)&&this.camera.up.copy(this._upState).applyQuaternion(this.camera.quaternion)),e.gizmos!=null&&(this._m4_1.copy(this._gizmoMatrixState).premultiply(e.gizmos),this._m4_1.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.updateMatrix()),this._state==Re.SCALE||this._state==Re.FOCUS||this._state==Re.ANIMATION_FOCUS)if(this._tbRadius=this.calculateTbRadius(this.camera),this.adjustNearFar){let t=this.camera.position.distanceTo(this._gizmos.position),n=new ss;n.setFromObject(this._gizmos);let r=new os;n.getBoundingSphere(r);let s=Math.max(this._nearPos0,r.radius+r.center.length()),o=t-this._initialNear,a=Math.min(s,o);this.camera.near=t-a;let c=Math.min(this._farPos0,-r.radius+r.center.length()),l=t-this._initialFar,u=Math.min(c,l);this.camera.far=t-u,this.camera.updateProjectionMatrix()}else{let t=!1;this.camera.near!=this._initialNear&&(this.camera.near=this._initialNear,t=!0),this.camera.far!=this._initialFar&&(this.camera.far=this._initialFar,t=!0),t&&this.camera.updateProjectionMatrix()}}calculateAngularSpeed(e,t,n,r){let s=t-e,o=(r-n)/1e3;return o==0?0:s/o}calculatePointersDistance(e,t){return Math.sqrt(Math.pow(t.clientX-e.clientX,2)+Math.pow(t.clientY-e.clientY,2))}calculateRotationAxis(e,t){return this._rotationMatrix.extractRotation(this._cameraMatrixState),this._quat.setFromRotationMatrix(this._rotationMatrix),this._rotationAxis.crossVectors(e,t).applyQuaternion(this._quat),this._rotationAxis.normalize().clone()}calculateTbRadius(e){let t=e.position.distanceTo(this._gizmos.position);if(e.type=="PerspectiveCamera"){let n=Kt.DEG2RAD*e.fov*.5,r=Math.atan(e.aspect*Math.tan(n));return Math.tan(Math.min(n,r))*t*this.radiusFactor}else if(e.type=="OrthographicCamera")return Math.min(e.top,e.right)*this.radiusFactor}focus(e,t,n=1){mn.copy(e).sub(this._gizmos.position).multiplyScalar(n),this._translationMatrix.makeTranslation(mn.x,mn.y,mn.z),gD.copy(this._gizmoMatrixState),this._gizmoMatrixState.premultiply(this._translationMatrix),this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),vD.copy(this._cameraMatrixState),this._cameraMatrixState.premultiply(this._translationMatrix),this._cameraMatrixState.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.enableZoom&&this.applyTransformMatrix(this.scale(t,this._gizmos.position)),this._gizmoMatrixState.copy(gD),this._cameraMatrixState.copy(vD)}drawGrid(){if(this.scene!=null){let n,r,s,o;if(this.camera.isOrthographicCamera){let a=this.camera.right-this.camera.left,c=this.camera.bottom-this.camera.top;s=Math.max(a,c),o=s/20,n=s/this.camera.zoom*3,r=n/o*this.camera.zoom}else if(this.camera.isPerspectiveCamera){let a=this.camera.position.distanceTo(this._gizmos.position),c=Kt.DEG2RAD*this.camera.fov*.5,l=Math.atan(this.camera.aspect*Math.tan(c));s=Math.tan(Math.max(c,l))*a*2,o=s/20,n=s*3,r=n/o}this._grid==null&&(this._grid=new Zf(n,r,8947848,8947848),this._grid.position.copy(this._gizmos.position),this._gridPosition.copy(this._grid.position),this._grid.quaternion.copy(this.camera.quaternion),this._grid.rotateX(Math.PI*.5),this.scene.add(this._grid))}}dispose(){this._animationId!=-1&&window.cancelAnimationFrame(this._animationId),this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointercancel",this._onPointerCancel),this.domElement.removeEventListener("wheel",this._onWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),window.removeEventListener("pointermove",this._onPointerMove),window.removeEventListener("pointerup",this._onPointerUp),window.removeEventListener("resize",this._onWindowResize),this.scene!==null&&this.scene.remove(this._gizmos),this.disposeGrid()}disposeGrid(){this._grid!=null&&this.scene!=null&&(this.scene.remove(this._grid),this._grid=null)}easeOutCubic(e){return 1-Math.pow(1-e,3)}activateGizmos(e){let t=this._gizmos.children[0],n=this._gizmos.children[1],r=this._gizmos.children[2];e?(t.material.setValues({opacity:1}),n.material.setValues({opacity:1}),r.material.setValues({opacity:1})):(t.material.setValues({opacity:.6}),n.material.setValues({opacity:.6}),r.material.setValues({opacity:.6}))}getCursorNDC(e,t,n){let r=n.getBoundingClientRect();return this._v2_1.setX((e-r.left)/r.width*2-1),this._v2_1.setY((r.bottom-t)/r.height*2-1),this._v2_1.clone()}getCursorPosition(e,t,n){return this._v2_1.copy(this.getCursorNDC(e,t,n)),this._v2_1.x*=(this.camera.right-this.camera.left)*.5,this._v2_1.y*=(this.camera.top-this.camera.bottom)*.5,this._v2_1.clone()}setCamera(e){e.lookAt(this.target),e.updateMatrix(),e.type=="PerspectiveCamera"&&(this._fov0=e.fov,this._fovState=e.fov),this._cameraMatrixState0.copy(e.matrix),this._cameraMatrixState.copy(this._cameraMatrixState0),this._cameraProjectionState.copy(e.projectionMatrix),this._zoom0=e.zoom,this._zoomState=this._zoom0,this._initialNear=e.near,this._nearPos0=e.position.distanceTo(this.target)-e.near,this._nearPos=this._initialNear,this._initialFar=e.far,this._farPos0=e.position.distanceTo(this.target)-e.far,this._farPos=this._initialFar,this._up0.copy(e.up),this._upState.copy(e.up),this.camera=e,this.camera.updateProjectionMatrix(),this._tbRadius=this.calculateTbRadius(e),this.makeGizmos(this.target,this._tbRadius)}setGizmosVisible(e){this._gizmos.visible=e,this.dispatchEvent(Gt)}setTbRadius(e){this.radiusFactor=e,this._tbRadius=this.calculateTbRadius(this.camera);let n=new $o(0,0,this._tbRadius,this._tbRadius).getPoints(this._curvePts),r=new bn().setFromPoints(n);for(let s in this._gizmos.children)this._gizmos.children[s].geometry=r;this.dispatchEvent(Gt)}makeGizmos(e,t){let r=new $o(0,0,t,t).getPoints(this._curvePts),s=new bn().setFromPoints(r),o=new Bi({color:16744576,fog:!1,transparent:!0,opacity:.6}),a=new Bi({color:8454016,fog:!1,transparent:!0,opacity:.6}),c=new Bi({color:8421631,fog:!1,transparent:!0,opacity:.6}),l=new Wo(s,o),u=new Wo(s,a),h=new Wo(s,c),d=Math.PI*.5;if(l.rotation.x=d,u.rotation.y=d,this._gizmoMatrixState0.identity().setPosition(e),this._gizmoMatrixState.copy(this._gizmoMatrixState0),this.camera.zoom!==1){let f=1/this.camera.zoom;this._scaleMatrix.makeScale(f,f,f),this._translationMatrix.makeTranslation(-e.x,-e.y,-e.z),this._gizmoMatrixState.premultiply(this._translationMatrix).premultiply(this._scaleMatrix),this._translationMatrix.makeTranslation(e.x,e.y,e.z),this._gizmoMatrixState.premultiply(this._translationMatrix)}this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.traverse(function(f){f.isLine&&(f.geometry.dispose(),f.material.dispose())}),this._gizmos.clear(),this._gizmos.add(l),this._gizmos.add(u),this._gizmos.add(h)}onFocusAnim(e,t,n,r){if(this._timeStart==-1&&(this._timeStart=e),this._state==Re.ANIMATION_FOCUS){let o=(e-this._timeStart)/this.focusAnimationTime;if(this._gizmoMatrixState.copy(r),o>=1)this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.focus(t,this.scaleFactor),this._timeStart=-1,this.updateTbState(Re.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(Gt);else{let a=this.easeOutCubic(o),c=1-a+this.scaleFactor*a;this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.focus(t,c,a),this.dispatchEvent(Gt);let l=this;this._animationId=window.requestAnimationFrame(function(u){l.onFocusAnim(u,t,n,r.clone())})}}else this._animationId=-1,this._timeStart=-1}onRotationAnim(e,t,n){if(this._timeStart==-1&&(this._anglePrev=0,this._angleCurrent=0,this._timeStart=e),this._state==Re.ANIMATION_ROTATE){let r=(e-this._timeStart)/1e3;if(n+-this.dampingFactor*r>0){this._angleCurrent=.5*-this.dampingFactor*Math.pow(r,2)+n*r+0,this.applyTransformMatrix(this.rotate(t,this._angleCurrent)),this.dispatchEvent(Gt);let o=this;this._animationId=window.requestAnimationFrame(function(a){o.onRotationAnim(a,t,n)})}else this._animationId=-1,this._timeStart=-1,this.updateTbState(Re.IDLE,!1),this.activateGizmos(!1),this.dispatchEvent(Gt)}else this._animationId=-1,this._timeStart=-1,this._state!=Re.ROTATE&&(this.activateGizmos(!1),this.dispatchEvent(Gt))}pan(e,t,n=!1){let r=e.clone().sub(t);if(this.camera.isOrthographicCamera)r.multiplyScalar(1/this.camera.zoom);else if(this.camera.isPerspectiveCamera&&n){this._v3_1.setFromMatrixPosition(this._cameraMatrixState0),this._v3_2.setFromMatrixPosition(this._gizmoMatrixState0);let s=this._v3_1.distanceTo(this._v3_2)/this.camera.position.distanceTo(this._gizmos.position);r.multiplyScalar(1/s)}return this._v3_1.set(r.x,r.y,0).applyQuaternion(this.camera.quaternion),this._m4_1.makeTranslation(this._v3_1.x,this._v3_1.y,this._v3_1.z),this.setTransformationMatrices(this._m4_1,this._m4_1),xi}reset(){this.camera.zoom=this._zoom0,this.camera.isPerspectiveCamera&&(this.camera.fov=this._fov0),this.camera.near=this._nearPos,this.camera.far=this._farPos,this._cameraMatrixState.copy(this._cameraMatrixState0),this._cameraMatrixState.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.up.copy(this._up0),this.camera.updateMatrix(),this.camera.updateProjectionMatrix(),this._gizmoMatrixState.copy(this._gizmoMatrixState0),this._gizmoMatrixState0.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this._gizmos.updateMatrix(),this._tbRadius=this.calculateTbRadius(this.camera),this.makeGizmos(this._gizmos.position,this._tbRadius),this.camera.lookAt(this._gizmos.position),this.updateTbState(Re.IDLE,!1),this.dispatchEvent(Gt)}rotate(e,t){let n=this._gizmos.position;return this._translationMatrix.makeTranslation(-n.x,-n.y,-n.z),this._rotationMatrix.makeRotationAxis(e,-t),this._m4_1.makeTranslation(n.x,n.y,n.z),this._m4_1.multiply(this._rotationMatrix),this._m4_1.multiply(this._translationMatrix),this.setTransformationMatrices(this._m4_1),xi}copyState(){let e;this.camera.isOrthographicCamera?e=JSON.stringify({arcballState:{cameraFar:this.camera.far,cameraMatrix:this.camera.matrix,cameraNear:this.camera.near,cameraUp:this.camera.up,cameraZoom:this.camera.zoom,gizmoMatrix:this._gizmos.matrix}}):this.camera.isPerspectiveCamera&&(e=JSON.stringify({arcballState:{cameraFar:this.camera.far,cameraFov:this.camera.fov,cameraMatrix:this.camera.matrix,cameraNear:this.camera.near,cameraUp:this.camera.up,cameraZoom:this.camera.zoom,gizmoMatrix:this._gizmos.matrix}})),navigator.clipboard.writeText(e)}pasteState(){let e=this;navigator.clipboard.readText().then(function(n){e.setStateFromJSON(n)})}saveState(){this._cameraMatrixState0.copy(this.camera.matrix),this._gizmoMatrixState0.copy(this._gizmos.matrix),this._nearPos=this.camera.near,this._farPos=this.camera.far,this._zoom0=this.camera.zoom,this._up0.copy(this.camera.up),this.camera.isPerspectiveCamera&&(this._fov0=this.camera.fov)}scale(e,t,n=!0){ir.copy(t);let r=1/e;if(this.camera.isOrthographicCamera){this.camera.zoom=this._zoomState,this.camera.zoom*=e,this.camera.zoom>this.maxZoom?(this.camera.zoom=this.maxZoom,r=this._zoomState/this.maxZoom):this.camera.zoom<this.minZoom&&(this.camera.zoom=this.minZoom,r=this._zoomState/this.minZoom),this.camera.updateProjectionMatrix(),this._v3_1.setFromMatrixPosition(this._gizmoMatrixState),this._scaleMatrix.makeScale(r,r,r),this._translationMatrix.makeTranslation(-this._v3_1.x,-this._v3_1.y,-this._v3_1.z),this._m4_2.makeTranslation(this._v3_1.x,this._v3_1.y,this._v3_1.z).multiply(this._scaleMatrix),this._m4_2.multiply(this._translationMatrix),ir.sub(this._v3_1);let s=ir.clone().multiplyScalar(r);return ir.sub(s),this._m4_1.makeTranslation(ir.x,ir.y,ir.z),this._m4_2.premultiply(this._m4_1),this.setTransformationMatrices(this._m4_1,this._m4_2),xi}else if(this.camera.isPerspectiveCamera){this._v3_1.setFromMatrixPosition(this._cameraMatrixState),this._v3_2.setFromMatrixPosition(this._gizmoMatrixState);let s=this._v3_1.distanceTo(ir),o=s-s*r,a=s-o;if(a<this.minDistance?(r=this.minDistance/s,o=s-s*r):a>this.maxDistance&&(r=this.maxDistance/s,o=s-s*r),mn.copy(ir).sub(this._v3_1).normalize().multiplyScalar(o),this._m4_1.makeTranslation(mn.x,mn.y,mn.z),n){let c=this._v3_2;s=c.distanceTo(ir),o=s-s*r,mn.copy(ir).sub(this._v3_2).normalize().multiplyScalar(o),this._translationMatrix.makeTranslation(c.x,c.y,c.z),this._scaleMatrix.makeScale(r,r,r),this._m4_2.makeTranslation(mn.x,mn.y,mn.z).multiply(this._translationMatrix),this._m4_2.multiply(this._scaleMatrix),this._translationMatrix.makeTranslation(-c.x,-c.y,-c.z),this._m4_2.multiply(this._translationMatrix),this.setTransformationMatrices(this._m4_1,this._m4_2)}else this.setTransformationMatrices(this._m4_1);return xi}}setFov(e){this.camera.isPerspectiveCamera&&(this.camera.fov=Kt.clamp(e,this.minFov,this.maxFov),this.camera.updateProjectionMatrix())}setTransformationMatrices(e=null,t=null){e!=null?xi.camera!=null?xi.camera.copy(e):xi.camera=e.clone():xi.camera=null,t!=null?xi.gizmos!=null?xi.gizmos.copy(t):xi.gizmos=t.clone():xi.gizmos=null}zRotate(e,t){return this._rotationMatrix.makeRotationAxis(this._rotationAxis,t),this._translationMatrix.makeTranslation(-e.x,-e.y,-e.z),this._m4_1.makeTranslation(e.x,e.y,e.z),this._m4_1.multiply(this._rotationMatrix),this._m4_1.multiply(this._translationMatrix),this._v3_1.setFromMatrixPosition(this._gizmoMatrixState).sub(e),this._v3_2.copy(this._v3_1).applyAxisAngle(this._rotationAxis,t),this._v3_2.sub(this._v3_1),this._m4_2.makeTranslation(this._v3_2.x,this._v3_2.y,this._v3_2.z),this.setTransformationMatrices(this._m4_1,this._m4_2),xi}getRaycaster(){return s7}unprojectOnObj(e,t){let n=this.getRaycaster();n.near=t.near,n.far=t.far,n.setFromCamera(e,t);let r=n.intersectObjects(this.scene.children,!0);for(let s=0;s<r.length;s++)if(r[s].object.uuid!=this._gizmos.uuid&&r[s].face!=null)return r[s].point.clone();return null}unprojectOnTbSurface(e,t,n,r,s){if(e.type=="OrthographicCamera"){this._v2_1.copy(this.getCursorPosition(t,n,r)),this._v3_1.set(this._v2_1.x,this._v2_1.y,0);let o=Math.pow(this._v2_1.x,2),a=Math.pow(this._v2_1.y,2),c=Math.pow(this._tbRadius,2);return o+a<=c*.5?this._v3_1.setZ(Math.sqrt(c-(o+a))):this._v3_1.setZ(c*.5/Math.sqrt(o+a)),this._v3_1}else if(e.type=="PerspectiveCamera"){this._v2_1.copy(this.getCursorNDC(t,n,r)),this._v3_1.set(this._v2_1.x,this._v2_1.y,-1),this._v3_1.applyMatrix4(e.projectionMatrixInverse);let o=this._v3_1.clone().normalize(),a=e.position.distanceTo(this._gizmos.position),c=Math.pow(s,2),l=this._v3_1.z,u=Math.sqrt(Math.pow(this._v3_1.x,2)+Math.pow(this._v3_1.y,2));if(u==0)return o.set(this._v3_1.x,this._v3_1.y,s),o;let h=l/u,d=a,f=Math.pow(h,2)+1,x=2*h*d,g=Math.pow(d,2)-c,p=Math.pow(x,2)-4*f*g;if(p>=0&&(this._v2_1.setX((-x-Math.sqrt(p))/(2*f)),this._v2_1.setY(h*this._v2_1.x+d),Kt.RAD2DEG*this._v2_1.angle()>=45)){let E=Math.sqrt(Math.pow(this._v2_1.x,2)+Math.pow(a-this._v2_1.y,2));return o.multiplyScalar(E),o.z+=a,o}f=h,x=d,g=-c*.5,p=Math.pow(x,2)-4*f*g,this._v2_1.setX((-x-Math.sqrt(p))/(2*f)),this._v2_1.setY(h*this._v2_1.x+d);let m=Math.sqrt(Math.pow(this._v2_1.x,2)+Math.pow(a-this._v2_1.y,2));return o.multiplyScalar(m),o.z+=a,o}}unprojectOnTbPlane(e,t,n,r,s=!1){if(e.type=="OrthographicCamera")return this._v2_1.copy(this.getCursorPosition(t,n,r)),this._v3_1.set(this._v2_1.x,this._v2_1.y,0),this._v3_1.clone();if(e.type=="PerspectiveCamera"){this._v2_1.copy(this.getCursorNDC(t,n,r)),this._v3_1.set(this._v2_1.x,this._v2_1.y,-1),this._v3_1.applyMatrix4(e.projectionMatrixInverse);let o=this._v3_1.clone().normalize(),a=this._v3_1.z,c=Math.sqrt(Math.pow(this._v3_1.x,2)+Math.pow(this._v3_1.y,2)),l;if(s?l=this._v3_1.setFromMatrixPosition(this._cameraMatrixState0).distanceTo(this._v3_2.setFromMatrixPosition(this._gizmoMatrixState0)):l=e.position.distanceTo(this._gizmos.position),c==0)return o.set(0,0,0),o;let u=a/c,h=l,d=-h/u,f=Math.sqrt(Math.pow(h,2)+Math.pow(d,2));return o.multiplyScalar(f),o.z=0,o}}updateMatrixState(){this._cameraMatrixState.copy(this.camera.matrix),this._gizmoMatrixState.copy(this._gizmos.matrix),this.camera.isOrthographicCamera?(this._cameraProjectionState.copy(this.camera.projectionMatrix),this.camera.updateProjectionMatrix(),this._zoomState=this.camera.zoom):this.camera.isPerspectiveCamera&&(this._fovState=this.camera.fov)}updateTbState(e,t){this._state=e,t&&this.updateMatrixState()}update(){if(this.target.equals(this._currentTarget)===!1&&(this._gizmos.position.copy(this.target),this._tbRadius=this.calculateTbRadius(this.camera),this.makeGizmos(this.target,this._tbRadius),this._currentTarget.copy(this.target)),this.camera.isOrthographicCamera){if(this.camera.zoom>this.maxZoom||this.camera.zoom<this.minZoom){let t=Kt.clamp(this.camera.zoom,this.minZoom,this.maxZoom);this.applyTransformMatrix(this.scale(t/this.camera.zoom,this._gizmos.position,!0))}}else if(this.camera.isPerspectiveCamera){let t=this.camera.position.distanceTo(this._gizmos.position);if(t>this.maxDistance+1e-6||t<this.minDistance-1e-6){let r=Kt.clamp(t,this.minDistance,this.maxDistance);this.applyTransformMatrix(this.scale(r/t,this._gizmos.position)),this.updateMatrixState()}(this.camera.fov<this.minFov||this.camera.fov>this.maxFov)&&(this.camera.fov=Kt.clamp(this.camera.fov,this.minFov,this.maxFov),this.camera.updateProjectionMatrix());let n=this._tbRadius;if(this._tbRadius=this.calculateTbRadius(this.camera),n<this._tbRadius-1e-6||n>this._tbRadius+1e-6){let r=(this._gizmos.scale.x+this._gizmos.scale.y+this._gizmos.scale.z)/3,s=this._tbRadius/r,a=new $o(0,0,s,s).getPoints(this._curvePts),c=new bn().setFromPoints(a);for(let l in this._gizmos.children)this._gizmos.children[l].geometry=c}}this.camera.lookAt(this._gizmos.position)}setStateFromJSON(e){let t=JSON.parse(e);if(t.arcballState!=null){this._cameraMatrixState.fromArray(t.arcballState.cameraMatrix.elements),this._cameraMatrixState.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.up.copy(t.arcballState.cameraUp),this.camera.near=t.arcballState.cameraNear,this.camera.far=t.arcballState.cameraFar,this.camera.zoom=t.arcballState.cameraZoom,this.camera.isPerspectiveCamera&&(this.camera.fov=t.arcballState.cameraFov),this._gizmoMatrixState.fromArray(t.arcballState.gizmoMatrix.elements),this._gizmoMatrixState.decompose(this._gizmos.position,this._gizmos.quaternion,this._gizmos.scale),this.camera.updateMatrix(),this.camera.updateProjectionMatrix(),this._gizmos.updateMatrix(),this._tbRadius=this.calculateTbRadius(this.camera);let n=new qe().copy(this._gizmoMatrixState0);this.makeGizmos(this._gizmos.position,this._tbRadius),this._gizmoMatrixState0.copy(n),this.camera.lookAt(this._gizmos.position),this.updateTbState(Re.IDLE,!1),this.dispatchEvent(Gt)}}};function o7(){let i=(this._gizmos.scale.x+this._gizmos.scale.y+this._gizmos.scale.z)/3;this._tbRadius=this.calculateTbRadius(this.camera);let e=this._tbRadius/i,n=new $o(0,0,e,e).getPoints(this._curvePts),r=new bn().setFromPoints(n);for(let s in this._gizmos.children)this._gizmos.children[s].geometry=r;this.dispatchEvent(Gt)}function a7(i){if(this.enabled){for(let e=0;e<this.mouseActions.length;e++)if(this.mouseActions[e].mouse==2){i.preventDefault();break}}}function c7(){this._touchStart.splice(0,this._touchStart.length),this._touchCurrent.splice(0,this._touchCurrent.length),this._input=It.NONE}function l7(i){if(i.button==0&&i.isPrimary?(this._downValid=!0,this._downEvents.push(i),this._downStart=performance.now()):this._downValid=!1,i.pointerType=="touch"&&this._input!=It.CURSOR)switch(this._touchStart.push(i),this._touchCurrent.push(i),this._input){case It.NONE:this._input=It.ONE_FINGER,this.onSinglePanStart(i,"ROTATE"),window.addEventListener("pointermove",this._onPointerMove),window.addEventListener("pointerup",this._onPointerUp);break;case It.ONE_FINGER:case It.ONE_FINGER_SWITCHED:this._input=It.TWO_FINGER,this.onRotateStart(),this.onPinchStart(),this.onDoublePanStart();break;case It.TWO_FINGER:this._input=It.MULT_FINGER,this.onTriplePanStart(i);break}else if(i.pointerType!="touch"&&this._input==It.NONE){let e=null;i.ctrlKey||i.metaKey?e="CTRL":i.shiftKey&&(e="SHIFT"),this._mouseOp=this.getOpFromAction(i.button,e),this._mouseOp!=null&&(window.addEventListener("pointermove",this._onPointerMove),window.addEventListener("pointerup",this._onPointerUp),this._input=It.CURSOR,this._button=i.button,this.onSinglePanStart(i,this._mouseOp))}}function u7(i){if(i.pointerType=="touch"&&this._input!=It.CURSOR)switch(this._input){case It.ONE_FINGER:this.updateTouchEvent(i),this.onSinglePanMove(i,Re.ROTATE);break;case It.ONE_FINGER_SWITCHED:if(this.calculatePointersDistance(this._touchCurrent[0],i)*this._devPxRatio>=this._switchSensibility){this._input=It.ONE_FINGER,this.updateTouchEvent(i),this.onSinglePanStart(i,"ROTATE");break}break;case It.TWO_FINGER:this.updateTouchEvent(i),this.onRotateMove(),this.onPinchMove(),this.onDoublePanMove();break;case It.MULT_FINGER:this.updateTouchEvent(i),this.onTriplePanMove(i);break}else if(i.pointerType!="touch"&&this._input==It.CURSOR){let e=null;i.ctrlKey||i.metaKey?e="CTRL":i.shiftKey&&(e="SHIFT");let t=this.getOpStateFromAction(this._button,e);t!=null&&this.onSinglePanMove(i,t)}this._downValid&&this.calculatePointersDistance(this._downEvents[this._downEvents.length-1],i)*this._devPxRatio>this._movementThreshold&&(this._downValid=!1)}function h7(i){if(i.pointerType=="touch"&&this._input!=It.CURSOR){let e=this._touchCurrent.length;for(let t=0;t<e;t++)if(this._touchCurrent[t].pointerId==i.pointerId){this._touchCurrent.splice(t,1),this._touchStart.splice(t,1);break}switch(this._input){case It.ONE_FINGER:case It.ONE_FINGER_SWITCHED:window.removeEventListener("pointermove",this._onPointerMove),window.removeEventListener("pointerup",this._onPointerUp),this._input=It.NONE,this.onSinglePanEnd();break;case It.TWO_FINGER:this.onDoublePanEnd(i),this.onPinchEnd(i),this.onRotateEnd(i),this._input=It.ONE_FINGER_SWITCHED;break;case It.MULT_FINGER:this._touchCurrent.length==0&&(window.removeEventListener("pointermove",this._onPointerMove),window.removeEventListener("pointerup",this._onPointerUp),this._input=It.NONE,this.onTriplePanEnd());break}}else i.pointerType!="touch"&&this._input==It.CURSOR&&(window.removeEventListener("pointermove",this._onPointerMove),window.removeEventListener("pointerup",this._onPointerUp),this._input=It.NONE,this.onSinglePanEnd(),this._button=-1);if(i.isPrimary)if(this._downValid)if(i.timeStamp-this._downEvents[this._downEvents.length-1].timeStamp<=this._maxDownTime)if(this._nclicks==0)this._nclicks=1,this._clickStart=performance.now();else{let t=i.timeStamp-this._clickStart,n=this.calculatePointersDistance(this._downEvents[1],this._downEvents[0])*this._devPxRatio;t<=this._maxInterval&&n<=this._posThreshold?(this._nclicks=0,this._downEvents.splice(0,this._downEvents.length),this.onDoubleTap(i)):(this._nclicks=1,this._downEvents.shift(),this._clickStart=performance.now())}else this._downValid=!1,this._nclicks=0,this._downEvents.splice(0,this._downEvents.length);else this._nclicks=0,this._downEvents.splice(0,this._downEvents.length)}function d7(i){if(this.enabled&&this.enableZoom){let e=null;i.ctrlKey||i.metaKey?e="CTRL":i.shiftKey&&(e="SHIFT");let t=this.getOpFromAction("WHEEL",e);if(t!=null){i.preventDefault(),this.dispatchEvent(rr);let n=125,r=i.deltaY/n,s=1;switch(r>0?s=1/this.scaleFactor:r<0&&(s=this.scaleFactor),t){case"ZOOM":if(this.updateTbState(Re.SCALE,!0),r>0?s=1/Math.pow(this.scaleFactor,r):r<0&&(s=Math.pow(this.scaleFactor,-r)),this.cursorZoom&&this.enablePan){let o;this.camera.isOrthographicCamera?o=this.unprojectOnTbPlane(this.camera,i.clientX,i.clientY,this.domElement).applyQuaternion(this.camera.quaternion).multiplyScalar(1/this.camera.zoom).add(this._gizmos.position):this.camera.isPerspectiveCamera&&(o=this.unprojectOnTbPlane(this.camera,i.clientX,i.clientY,this.domElement).applyQuaternion(this.camera.quaternion).add(this._gizmos.position)),this.applyTransformMatrix(this.scale(s,o))}else this.applyTransformMatrix(this.scale(s,this._gizmos.position));this._grid!=null&&(this.disposeGrid(),this.drawGrid()),this.updateTbState(Re.IDLE,!1),this.dispatchEvent(Gt),this.dispatchEvent(Ii);break;case"FOV":if(this.camera.isPerspectiveCamera){this.updateTbState(Re.FOV,!0),i.deltaX!=0&&(r=i.deltaX/n,s=1,r>0?s=1/Math.pow(this.scaleFactor,r):r<0&&(s=Math.pow(this.scaleFactor,-r))),this._v3_1.setFromMatrixPosition(this._cameraMatrixState);let o=this._v3_1.distanceTo(this._gizmos.position),a=o/s;a=Kt.clamp(a,this.minDistance,this.maxDistance);let c=o*Math.tan(Kt.DEG2RAD*this.camera.fov*.5),l=Kt.RAD2DEG*(Math.atan(c/a)*2);l>this.maxFov?l=this.maxFov:l<this.minFov&&(l=this.minFov);let u=c/Math.tan(Kt.DEG2RAD*(l/2));s=o/u,this.setFov(l),this.applyTransformMatrix(this.scale(s,this._gizmos.position,!1))}this._grid!=null&&(this.disposeGrid(),this.drawGrid()),this.updateTbState(Re.IDLE,!1),this.dispatchEvent(Gt),this.dispatchEvent(Ii);break}}}}var r0=class extends Yo{constructor(e){super(e)}load(e,t,n,r){let s=this,o=this.path===""?Xf.extractUrlBase(e):this.path,a=new Dc(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(c){try{t(s.parse(c,o))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},n,r)}setMaterialOptions(e){return this.materialOptions=e,this}parse(e,t){let n=e.split(`
`),r={},s=/\s+/,o={};for(let c=0;c<n.length;c++){let l=n[c];if(l=l.trim(),l.length===0||l.charAt(0)==="#")continue;let u=l.indexOf(" "),h=u>=0?l.substring(0,u):l;h=h.toLowerCase();let d=u>=0?l.substring(u+1):"";if(d=d.trim(),h==="newmtl")r={name:d},o[d]=r;else if(h==="ka"||h==="kd"||h==="ks"||h==="ke"){let f=d.split(s,3);r[h]=[parseFloat(f[0]),parseFloat(f[1]),parseFloat(f[2])]}else r[h]=d}let a=new Zv(this.resourcePath||t,this.materialOptions);return a.setCrossOrigin(this.crossOrigin),a.setManager(this.manager),a.setMaterials(o),a}},Zv=class{constructor(e="",t={}){this.baseUrl=e,this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:Mr,this.wrap=this.options.wrap!==void 0?this.options.wrap:Au}setCrossOrigin(e){return this.crossOrigin=e,this}setManager(e){this.manager=e}setMaterials(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(e){if(!this.options)return e;let t={};for(let n in e){let r=e[n],s={};t[n]=s;for(let o in r){let a=!0,c=r[o],l=o.toLowerCase();switch(l){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(c=[c[0]/255,c[1]/255,c[2]/255]),this.options&&this.options.ignoreZeroRGBs&&c[0]===0&&c[1]===0&&c[2]===0&&(a=!1);break;default:break}a&&(s[l]=c)}}return t}preload(){for(let e in this.materialsInfo)this.create(e)}getIndex(e){return this.nameLookup[e]}getAsArray(){let e=0;for(let t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray}create(e){return this.materials[e]===void 0&&this.createMaterial_(e),this.materials[e]}createMaterial_(e){let t=this,n=this.materialsInfo[e],r={name:e,side:this.side};function s(a,c){return typeof c!="string"||c===""?"":/^https?:\/\//i.test(c)?c:a+c}function o(a,c){if(r[a])return;let l=t.getTextureParams(c,r),u=t.loadTexture(s(t.baseUrl,l.url));u.repeat.copy(l.scale),u.offset.copy(l.offset),u.wrapS=t.wrap,u.wrapT=t.wrap,(a==="map"||a==="emissiveMap")&&(u.colorSpace=Di),r[a]=u}for(let a in n){let c=n[a],l;if(c!=="")switch(a.toLowerCase()){case"kd":r.color=new Ge().fromArray(c).convertSRGBToLinear();break;case"ks":r.specular=new Ge().fromArray(c).convertSRGBToLinear();break;case"ke":r.emissive=new Ge().fromArray(c).convertSRGBToLinear();break;case"map_kd":o("map",c);break;case"map_ks":o("specularMap",c);break;case"map_ke":o("emissiveMap",c);break;case"norm":o("normalMap",c);break;case"map_bump":case"bump":o("bumpMap",c);break;case"map_d":o("alphaMap",c),r.transparent=!0;break;case"ns":r.shininess=parseFloat(c);break;case"d":l=parseFloat(c),l<1&&(r.opacity=l,r.transparent=!0);break;case"tr":l=parseFloat(c),this.options&&this.options.invertTrProperty&&(l=1-l),l>0&&(r.opacity=1-l,r.transparent=!0);break;default:break}}return this.materials[e]=new wc(r),this.materials[e]}getTextureParams(e,t){let n={scale:new We(1,1),offset:new We(0,0)},r=e.split(/\s+/),s;return s=r.indexOf("-bm"),s>=0&&(t.bumpScale=parseFloat(r[s+1]),r.splice(s,2)),s=r.indexOf("-s"),s>=0&&(n.scale.set(parseFloat(r[s+1]),parseFloat(r[s+2])),r.splice(s,4)),s=r.indexOf("-o"),s>=0&&(n.offset.set(parseFloat(r[s+1]),parseFloat(r[s+2])),r.splice(s,4)),n.url=r.join(" ").trim(),n}loadTexture(e,t,n,r,s){let o=this.manager!==void 0?this.manager:Xv,a=o.getHandler(e);a===null&&(a=new Wf(o)),a.setCrossOrigin&&a.setCrossOrigin(this.crossOrigin);let c=a.load(e,n,r,s);return t!==void 0&&(c.mapping=t),c}};var f7=/^[og]\s*(.+)?/,p7=/^mtllib /,x7=/^usemtl /,m7=/^usemap /,ED=/\s+/,yD=new k,Kv=new k,CD=new k,_D=new k,Pi=new k,s0=new Ge;function g7(){let i={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&this.object.fromDeclaration===!1){this.object.name=e,this.object.fromDeclaration=t!==!1;return}let n=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:t!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(r,s){let o=this._finalize(!1);o&&(o.inherited||o.groupCount<=0)&&this.materials.splice(o.index,1);let a={index:this.materials.length,name:r||"",mtllib:Array.isArray(s)&&s.length>0?s[s.length-1]:"",smooth:o!==void 0?o.smooth:this.smooth,groupStart:o!==void 0?o.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(c){let l={index:typeof c=="number"?c:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return l.clone=this.clone.bind(l),l}};return this.materials.push(a),a},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(r){let s=this.currentMaterial();if(s&&s.groupEnd===-1&&(s.groupEnd=this.geometry.vertices.length/3,s.groupCount=s.groupEnd-s.groupStart,s.inherited=!1),r&&this.materials.length>1)for(let o=this.materials.length-1;o>=0;o--)this.materials[o].groupCount<=0&&this.materials.splice(o,1);return r&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),s}},n&&n.name&&typeof n.clone=="function"){let r=n.clone(0);r.inherited=!0,this.object.materials.push(r)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(e,t){let n=parseInt(e,10);return(n>=0?n-1:n+t/3)*3},parseNormalIndex:function(e,t){let n=parseInt(e,10);return(n>=0?n-1:n+t/3)*3},parseUVIndex:function(e,t){let n=parseInt(e,10);return(n>=0?n-1:n+t/2)*2},addVertex:function(e,t,n){let r=this.vertices,s=this.object.geometry.vertices;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[t+0],r[t+1],r[t+2]),s.push(r[n+0],r[n+1],r[n+2])},addVertexPoint:function(e){let t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){let t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,n){let r=this.normals,s=this.object.geometry.normals;s.push(r[e+0],r[e+1],r[e+2]),s.push(r[t+0],r[t+1],r[t+2]),s.push(r[n+0],r[n+1],r[n+2])},addFaceNormal:function(e,t,n){let r=this.vertices,s=this.object.geometry.normals;yD.fromArray(r,e),Kv.fromArray(r,t),CD.fromArray(r,n),Pi.subVectors(CD,Kv),_D.subVectors(yD,Kv),Pi.cross(_D),Pi.normalize(),s.push(Pi.x,Pi.y,Pi.z),s.push(Pi.x,Pi.y,Pi.z),s.push(Pi.x,Pi.y,Pi.z)},addColor:function(e,t,n){let r=this.colors,s=this.object.geometry.colors;r[e]!==void 0&&s.push(r[e+0],r[e+1],r[e+2]),r[t]!==void 0&&s.push(r[t+0],r[t+1],r[t+2]),r[n]!==void 0&&s.push(r[n+0],r[n+1],r[n+2])},addUV:function(e,t,n){let r=this.uvs,s=this.object.geometry.uvs;s.push(r[e+0],r[e+1]),s.push(r[t+0],r[t+1]),s.push(r[n+0],r[n+1])},addDefaultUV:function(){let e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){let t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,n,r,s,o,a,c,l){let u=this.vertices.length,h=this.parseVertexIndex(e,u),d=this.parseVertexIndex(t,u),f=this.parseVertexIndex(n,u);if(this.addVertex(h,d,f),this.addColor(h,d,f),a!==void 0&&a!==""){let x=this.normals.length;h=this.parseNormalIndex(a,x),d=this.parseNormalIndex(c,x),f=this.parseNormalIndex(l,x),this.addNormal(h,d,f)}else this.addFaceNormal(h,d,f);if(r!==void 0&&r!==""){let x=this.uvs.length;h=this.parseUVIndex(r,x),d=this.parseUVIndex(s,x),f=this.parseUVIndex(o,x),this.addUV(h,d,f),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";let t=this.vertices.length;for(let n=0,r=e.length;n<r;n++){let s=this.parseVertexIndex(e[n],t);this.addVertexPoint(s),this.addColor(s)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";let n=this.vertices.length,r=this.uvs.length;for(let s=0,o=e.length;s<o;s++)this.addVertexLine(this.parseVertexIndex(e[s],n));for(let s=0,o=t.length;s<o;s++)this.addUVLine(this.parseUVIndex(t[s],r))}};return i.startObject("",!1),i}var o0=class extends Yo{constructor(e){super(e),this.materials=null}load(e,t,n,r){let s=this,o=new Dc(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(a))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},n,r)}setMaterials(e){return this.materials=e,this}parse(e){let t=new g7;e.indexOf(`\r
`)!==-1&&(e=e.replace(/\r\n/g,`
`)),e.indexOf(`\\
`)!==-1&&(e=e.replace(/\\\n/g,""));let n=e.split(`
`),r=[];for(let a=0,c=n.length;a<c;a++){let l=n[a].trimStart();if(l.length===0)continue;let u=l.charAt(0);if(u!=="#")if(u==="v"){let h=l.split(ED);switch(h[0]){case"v":t.vertices.push(parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3])),h.length>=7?(s0.setRGB(parseFloat(h[4]),parseFloat(h[5]),parseFloat(h[6])).convertSRGBToLinear(),t.colors.push(s0.r,s0.g,s0.b)):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3]));break;case"vt":t.uvs.push(parseFloat(h[1]),parseFloat(h[2]));break}}else if(u==="f"){let d=l.slice(1).trim().split(ED),f=[];for(let g=0,p=d.length;g<p;g++){let m=d[g];if(m.length>0){let v=m.split("/");f.push(v)}}let x=f[0];for(let g=1,p=f.length-1;g<p;g++){let m=f[g],v=f[g+1];t.addFace(x[0],m[0],v[0],x[1],m[1],v[1],x[2],m[2],v[2])}}else if(u==="l"){let h=l.substring(1).trim().split(" "),d=[],f=[];if(l.indexOf("/")===-1)d=h;else for(let x=0,g=h.length;x<g;x++){let p=h[x].split("/");p[0]!==""&&d.push(p[0]),p[1]!==""&&f.push(p[1])}t.addLineGeometry(d,f)}else if(u==="p"){let d=l.slice(1).trim().split(" ");t.addPointGeometry(d)}else if((r=f7.exec(l))!==null){let h=(" "+r[0].slice(1).trim()).slice(1);t.startObject(h)}else if(x7.test(l))t.object.startMaterial(l.substring(7).trim(),t.materialLibraries);else if(p7.test(l))t.materialLibraries.push(l.substring(7).trim());else if(m7.test(l))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(u==="s"){if(r=l.split(" "),r.length>1){let d=r[1].trim().toLowerCase();t.object.smooth=d!=="0"&&d!=="off"}else t.object.smooth=!0;let h=t.object.currentMaterial();h&&(h.smooth=t.object.smooth)}else{if(l==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+l+'"')}}t.finalize();let s=new Sr;if(s.materialLibraries=[].concat(t.materialLibraries),!(t.objects.length===1&&t.objects[0].geometry.vertices.length===0)===!0)for(let a=0,c=t.objects.length;a<c;a++){let l=t.objects[a],u=l.geometry,h=l.materials,d=u.type==="Line",f=u.type==="Points",x=!1;if(u.vertices.length===0)continue;let g=new bn;g.setAttribute("position",new xn(u.vertices,3)),u.normals.length>0&&g.setAttribute("normal",new xn(u.normals,3)),u.colors.length>0&&(x=!0,g.setAttribute("color",new xn(u.colors,3))),u.hasUVIndices===!0&&g.setAttribute("uv",new xn(u.uvs,2));let p=[];for(let v=0,E=h.length;v<E;v++){let y=h[v],w=y.name+"_"+y.smooth+"_"+x,A=t.materials[w];if(this.materials!==null){if(A=this.materials.create(y.name),d&&A&&!(A instanceof Bi)){let b=new Bi;Fi.prototype.copy.call(b,A),b.color.copy(A.color),A=b}else if(f&&A&&!(A instanceof Ls)){let b=new Ls({size:10,sizeAttenuation:!1});Fi.prototype.copy.call(b,A),b.color.copy(A.color),b.map=A.map,A=b}}A===void 0&&(d?A=new Bi:f?A=new Ls({size:1,sizeAttenuation:!1}):A=new wc,A.name=y.name,A.flatShading=!y.smooth,A.vertexColors=x,t.materials[w]=A),p.push(A)}let m;if(p.length>1){for(let v=0,E=h.length;v<E;v++){let y=h[v];g.addGroup(y.groupStart,y.groupCount,v)}d?m=new _c(g,p):f?m=new Ac(g,p):m=new ii(g,p)}else d?m=new _c(g,p[0]):f?m=new Ac(g,p[0]):m=new ii(g,p[0]);m.name=l.name,s.add(m)}else if(t.vertices.length>0){let a=new Ls({size:1,sizeAttenuation:!1}),c=new bn;c.setAttribute("position",new xn(t.vertices,3)),t.colors.length>0&&t.colors[0]!==void 0&&(c.setAttribute("color",new xn(t.colors,3)),a.vertexColors=!0);let l=new Ac(c,a);s.add(l)}return s}};function AD(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function U(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?AD(Object(t),!0).forEach(function(n){V(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):AD(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function V(i,e,t){return(e=eS(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Pt(i,e){if(i==null)return{};var t,n,r=function(o,a){if(o==null)return{};var c,l,u={},h=Object.keys(o);for(l=0;l<h.length;l++)c=h[l],a.indexOf(c)>=0||(u[c]=o[c]);return u}(i,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);for(n=0;n<s.length;n++)t=s[n],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(i,t)&&(r[t]=i[t])}return r}function Nr(i,e){return e||(e=i.slice(0)),Object.freeze(Object.defineProperties(i,{raw:{value:Object.freeze(e)}}))}function eS(i){var e=function(t,n){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var s=r.call(t,n||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(t)}(i,"string");return typeof e=="symbol"?e:String(e)}var p0=class{constructor(){V(this,"browserShadowBlurConstant",1),V(this,"DPI",96),V(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),V(this,"perfLimitSizeTotal",2097152),V(this,"maxCacheSideLimit",4096),V(this,"minCacheSideLimit",256),V(this,"disableStyleCopyPaste",!1),V(this,"enableGLFiltering",!0),V(this,"textureSize",4096),V(this,"forceGLPutImageData",!1),V(this,"cachesBoundsOfCurve",!0),V(this,"fontPaths",{}),V(this,"NUM_FRACTION_DIGITS",4)}},_t=new class extends p0{constructor(i){super(),this.configure(i)}configure(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,i)}addFonts(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=U(U({},this.fontPaths),i)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(i=>{delete this.fontPaths[i]})}clearFonts(){this.fontPaths={}}restoreDefaults(i){let e=new p0,t=i?.reduce((n,r)=>(n[r]=e[r],n),{})||e;this.configure(t)}},Zs=function(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return console[i]("fabric",...t)},Ni=class extends Error{constructor(e,t){super("fabric: ".concat(e),t)}},x0=class extends Ni{constructor(e){super("".concat(e," 'options.signal' is in 'aborted' state"))}},uE=class{},hE=class extends uE{testPrecision(e,t){let n="precision ".concat(t,` float;
void main(){}`),r=e.createShader(e.FRAGMENT_SHADER);return!!r&&(e.shaderSource(r,n),e.compileShader(r),!!e.getShaderParameter(r,e.COMPILE_STATUS))}queryWebGL(e){let t=e.getContext("webgl");t&&(this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(n=>this.testPrecision(t,n)),t.getExtension("WEBGL_lose_context").loseContext(),Zs("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e}},v7={},wD;var Or=()=>wD||(wD={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new hE,dispose(){},copyPasteData:v7}),sl=()=>Or().document,U0=()=>Or().window,tS=()=>{var i;return Math.max((i=_t.devicePixelRatio)!==null&&i!==void 0?i:U0().devicePixelRatio,1)},Ou=new class{constructor(){V(this,"charWidthsCache",{}),V(this,"boundsOfCurveCache",{})}getFontCache(i){let{fontFamily:e,fontStyle:t,fontWeight:n}=i;e=e.toLowerCase(),this.charWidthsCache[e]||(this.charWidthsCache[e]={});let r=this.charWidthsCache[e],s="".concat(t.toLowerCase(),"_").concat((n+"").toLowerCase());return r[s]||(r[s]={}),r[s]}clearFontCache(i){(i=(i||"").toLowerCase())?this.charWidthsCache[i]&&delete this.charWidthsCache[i]:this.charWidthsCache={}}limitDimsByArea(i){let{perfLimitSizeTotal:e}=_t,t=Math.sqrt(e*i);return[Math.floor(t),Math.floor(e/t)]}},dE="6.0.0-rc1";function ea(){}var Ks=Math.PI/2,us=2*Math.PI,HE=Math.PI/180,Jn=Object.freeze([1,0,0,1,0,0]),jE=16,zs=.4477152502,lt="center",Dt="left",Gn="top",fE="bottom",cn="right",si="none",GE=/\r?\n/,Iu="json",Jv="svg",_e=new class{constructor(){this[Iu]=new Map,this[Jv]=new Map}getClass(i){let e=this[Iu].get(i);if(!e)throw new Ni("No class registered for ".concat(i));return e}setClass(i,e){e?this[Iu].set(e,i):(this[Iu].set(i.type,i),this[Iu].set(i.type.toLowerCase(),i))}getSVGClass(i){return this[Jv].get(i)}setSVGClass(i,e){this[Jv].set(e??i.type.toLowerCase(),i)}},m0=new class extends Array{remove(i){let e=this.indexOf(i);e>-1&&this.splice(e,1)}cancelAll(){let i=this.splice(0);return i.forEach(e=>e.abort()),i}cancelByCanvas(i){if(!i)return[];let e=this.filter(t=>{var n;return t.target===i||typeof t.target=="object"&&((n=t.target)===null||n===void 0?void 0:n.canvas)===i});return e.forEach(t=>t.abort()),e}cancelByTarget(i){if(!i)return[];let e=this.filter(t=>t.target===i);return e.forEach(t=>t.abort()),e}},pE=class{constructor(){V(this,"__eventListeners",{})}on(e,t){if(this.__eventListeners||(this.__eventListeners={}),typeof e=="object")return Object.entries(e).forEach(n=>{let[r,s]=n;this.on(r,s)}),()=>this.off(e);if(t){let n=e;return this.__eventListeners[n]||(this.__eventListeners[n]=[]),this.__eventListeners[n].push(t),()=>this.off(n,t)}return()=>!1}once(e,t){if(typeof e=="object"){let n=[];return Object.entries(e).forEach(r=>{let[s,o]=r;n.push(this.once(s,o))}),()=>n.forEach(r=>r())}if(t){let n=this.on(e,function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];t.call(this,...s),n()});return n}return()=>!1}_removeEventListener(e,t){if(this.__eventListeners[e])if(t){let n=this.__eventListeners[e],r=n.indexOf(t);r>-1&&n.splice(r,1)}else this.__eventListeners[e]=[]}off(e,t){if(this.__eventListeners)if(e===void 0)for(let n in this.__eventListeners)this._removeEventListener(n);else typeof e=="object"?Object.entries(e).forEach(n=>{let[r,s]=n;this._removeEventListener(r,s)}):this._removeEventListener(e,t)}fire(e,t){var n;if(!this.__eventListeners)return;let r=(n=this.__eventListeners[e])===null||n===void 0?void 0:n.concat();if(r)for(let s=0;s<r.length;s++)r[s].call(this,t||{})}},E7=(i,e)=>Math.floor(Math.random()*(e-i+1))+i,Fc=(i,e)=>isNaN(i)&&typeof e=="number"?e:i,Ko=(i,e)=>{let t=i.indexOf(e);return t!==-1&&i.splice(t,1),i},lr=i=>{if(i===0)return 1;switch(Math.abs(i)/Ks){case 1:case 3:return 0;case 2:return-1}return Math.cos(i)},ur=i=>{if(i===0)return 0;let e=i/Ks,t=Math.sign(i);switch(e){case 1:return t;case 2:return 0;case 3:return-t}return Math.sin(i)},J=class i{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t)}add(e){return new i(this.x+e.x,this.y+e.y)}addEquals(e){return this.x+=e.x,this.y+=e.y,this}scalarAdd(e){return new i(this.x+e,this.y+e)}scalarAddEquals(e){return this.x+=e,this.y+=e,this}subtract(e){return new i(this.x-e.x,this.y-e.y)}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this}scalarSubtract(e){return new i(this.x-e,this.y-e)}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this}multiply(e){return new i(this.x*e.x,this.y*e.y)}scalarMultiply(e){return new i(this.x*e,this.y*e)}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this}divide(e){return new i(this.x/e.x,this.y/e.y)}scalarDivide(e){return new i(this.x/e,this.y/e)}scalarDivideEquals(e){return this.x/=e,this.y/=e,this}eq(e){return this.x===e.x&&this.y===e.y}lt(e){return this.x<e.x&&this.y<e.y}lte(e){return this.x<=e.x&&this.y<=e.y}gt(e){return this.x>e.x&&this.y>e.y}gte(e){return this.x>=e.x&&this.y>=e.y}lerp(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return t=Math.max(Math.min(1,t),0),new i(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)}distanceFrom(e){let t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)}midPointFrom(e){return this.lerp(e)}min(e){return new i(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new i(Math.max(this.x,e.x),Math.max(this.y,e.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(e,t){return this.x=e,this.y=t,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setFromPoint(e){return this.x=e.x,this.y=e.y,this}swap(e){let t=this.x,n=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=n}clone(){return new i(this.x,this.y)}rotate(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:WE,n=ur(e),r=lr(e),s=this.subtract(t);return new i(s.x*r-s.y*n,s.x*n+s.y*r).add(t)}transform(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new i(e[0]*this.x+e[2]*this.y+(t?0:e[4]),e[1]*this.x+e[3]*this.y+(t?0:e[5]))}},WE=new J(0,0),f0=i=>!!i&&Array.isArray(i._objects);function nS(i){class e extends i{constructor(){super(...arguments),V(this,"_objects",[])}_onObjectAdded(n){}_onObjectRemoved(n){}_onStackOrderChanged(n){}add(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];let o=this._objects.push(...r);return r.forEach(a=>this._onObjectAdded(a)),o}insertAt(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),o=1;o<r;o++)s[o-1]=arguments[o];return this._objects.splice(n,0,...s),s.forEach(a=>this._onObjectAdded(a)),this._objects.length}remove(){let n=this._objects,r=[];for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return o.forEach(c=>{let l=n.indexOf(c);l!==-1&&(n.splice(l,1),r.push(c),this._onObjectRemoved(c))}),r}forEachObject(n){this.getObjects().forEach((r,s,o)=>n(r,s,o))}getObjects(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return r.length===0?[...this._objects]:this._objects.filter(o=>o.isType(...r))}item(n){return this._objects[n]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(n,r){return!!this._objects.includes(n)||!!r&&this._objects.some(s=>s instanceof e&&s.contains(n,!0))}complexity(){return this._objects.reduce((n,r)=>n+=r.complexity?r.complexity():0,0)}sendObjectToBack(n){return!(!n||n===this._objects[0])&&(Ko(this._objects,n),this._objects.unshift(n),this._onStackOrderChanged(n),!0)}bringObjectToFront(n){return!(!n||n===this._objects[this._objects.length-1])&&(Ko(this._objects,n),this._objects.push(n),this._onStackOrderChanged(n),!0)}sendObjectBackwards(n,r){if(!n)return!1;let s=this._objects.indexOf(n);if(s!==0){let o=this.findNewLowerIndex(n,s,r);return Ko(this._objects,n),this._objects.splice(o,0,n),this._onStackOrderChanged(n),!0}return!1}bringObjectForward(n,r){if(!n)return!1;let s=this._objects.indexOf(n);if(s!==this._objects.length-1){let o=this.findNewUpperIndex(n,s,r);return Ko(this._objects,n),this._objects.splice(o,0,n),this._onStackOrderChanged(n),!0}return!1}moveObjectTo(n,r){return n!==this._objects[r]&&(Ko(this._objects,n),this._objects.splice(r,0,n),this._onStackOrderChanged(n),!0)}findNewLowerIndex(n,r,s){let o;if(s){o=r;for(let a=r-1;a>=0;--a)if(n.isOverlapping(this._objects[a])){o=a;break}}else o=r-1;return o}findNewUpperIndex(n,r,s){let o;if(s){o=r;for(let a=r+1;a<this._objects.length;++a)if(n.isOverlapping(this._objects[a])){o=a;break}}else o=r+1;return o}collectObjects(n){let{left:r,top:s,width:o,height:a}=n,{includeIntersecting:c=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=[],u=new J(r,s),h=u.add(new J(o,a));for(let d=this._objects.length-1;d>=0;d--){let f=this._objects[d];f.selectable&&f.visible&&(c&&f.intersectsWithRect(u,h)||f.isContainedWithinRect(u,h)||c&&f.containsPoint(u)||c&&f.containsPoint(h))&&l.push(f)}return l}}return e}var g0=class extends pE{_setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(let t in e)this.set(t,e[t])}_setObject(e){for(let t in e)this._set(t,e[t])}set(e,t){return typeof e=="object"?this._setObject(e):this._set(e,t),this}_set(e,t){this[e]=t}toggle(e){let t=this.get(e);return typeof t=="boolean"&&this.set(e,!t),this}get(e){return this[e]}};function ku(i){return U0().requestAnimationFrame(i)}function iS(i){return U0().cancelAnimationFrame(i)}var y7=0,Js=()=>y7++,ln=()=>{let i=sl().createElement("canvas");if(!i||i.getContext===void 0)throw new Ni("Failed to create `canvas` element");return i},rS=()=>sl().createElement("img"),$E=(i,e,t)=>i.toDataURL("image/".concat(e),t),rn=i=>i*HE,ra=i=>i/HE,C7=["translateX","translateY","angle"],jn=(i,e,t)=>new J(i).transform(e,t),gi=i=>{let e=1/(i[0]*i[3]-i[1]*i[2]),t=[e*i[3],-e*i[1],-e*i[2],e*i[0],0,0],{x:n,y:r}=new J(i[4],i[5]).transform(t,!0);return t[4]=-n,t[5]=-r,t},Pn=(i,e,t)=>[i[0]*e[0]+i[2]*e[1],i[1]*e[0]+i[3]*e[1],i[0]*e[2]+i[2]*e[3],i[1]*e[2]+i[3]*e[3],t?0:i[0]*e[4]+i[2]*e[5]+i[4],t?0:i[1]*e[4]+i[3]*e[5]+i[5]],ol=(i,e)=>i.reduceRight((t,n)=>n?Pn(n,t,e):t,Jn),sS=i=>{let[e,t]=i;return Math.atan2(t,e)},tl=i=>{let e=sS(i),t=Math.pow(i[0],2)+Math.pow(i[1],2),n=Math.sqrt(t),r=(i[0]*i[3]-i[2]*i[1])/n,s=Math.atan2(i[0]*i[2]+i[1]*i[3],t);return{angle:ra(e),scaleX:n,scaleY:r,skewX:ra(s),skewY:0,translateX:i[4]||0,translateY:i[5]||0}},al=function(i){return[1,0,0,1,i,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function cl(){let{angle:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:e=0,y:t=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=rn(i),r=lr(n),s=ur(n);return[r,s,-s,r,e?e-(r*e-s*t):0,t?t-(s*e+r*t):0]}var V0=function(i){return[i,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:i,0,0]},oS=i=>Math.tan(rn(i)),XE=i=>[1,0,oS(i),1,0,0],qE=i=>[1,oS(i),0,1,0,0],qu=i=>{let{scaleX:e=1,scaleY:t=1,flipX:n=!1,flipY:r=!1,skewX:s=0,skewY:o=0}=i;return ol([V0(n?-e:e,r?-t:t),s&&XE(s),o&&qE(o)],!0)},aS=i=>{let{translateX:e=0,translateY:t=0,angle:n=0}=i,r=Pt(i,C7);return ol([al(e,t),n&&cl({angle:n}),qu(r)])},Nu=function(i){let{signal:e,crossOrigin:t=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(n,r){if(e&&e.aborted)return r(new x0("loadImage"));let s=rS(),o;e&&(o=function(c){s.src="",r(c)},e.addEventListener("abort",o,{once:!0}));let a=function(){s.onload=s.onerror=null,o&&e?.removeEventListener("abort",o),n(s)};i?(s.onload=a,s.onerror=function(){o&&e?.removeEventListener("abort",o),r(new Ni("Error loading ".concat(s.src)))},t&&(s.crossOrigin=t),s.src=i):a()})},nl=function(i){let{signal:e,reviver:t=ea}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((n,r)=>{let s=[];e&&e.addEventListener("abort",r,{once:!0}),Promise.all(i.map(o=>_e.getClass(o.type).fromObject(o,{signal:e}).then(a=>(t(o,a),s.push(a),a)))).then(n).catch(o=>{s.forEach(a=>{a.dispose&&a.dispose()}),r(o)}).finally(()=>{e&&e.removeEventListener("abort",r)})})},Yu=function(i){let{signal:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((t,n)=>{let r=[];e&&e.addEventListener("abort",n,{once:!0});let s=Object.values(i).map(a=>a&&(a.type?nl([a],{signal:e}).then(c=>{let[l]=c;return r.push(l),l}):a.source?_e.getClass("pattern").fromObject(a,{signal:e}).then(c=>(r.push(c),c)):a)),o=Object.keys(i);Promise.all(s).then(a=>a.reduce((c,l,u)=>(c[o[u]]=l,c),{})).then(t).catch(a=>{r.forEach(c=>{c.dispose&&c.dispose()}),n(a)}).finally(()=>{e&&e.removeEventListener("abort",n)})})},aa=function(i){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce((e,t)=>(t in i&&(e[t]=i[t]),e),{})},YE=(i,e)=>Object.keys(i).reduce((t,n)=>(e(i[n],n,i)&&(t[n]=i[n]),t),{}),bD={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},Qv=(i,e,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+6*(e-i)*t:t<.5?e:t<2/3?i+(e-i)*(2/3-t)*6:i),DD=(i,e,t,n)=>{i/=255,e/=255,t/=255;let r=Math.max(i,e,t),s=Math.min(i,e,t),o,a,c=(r+s)/2;if(r===s)o=a=0;else{let l=r-s;switch(a=c>.5?l/(2-r-s):l/(r+s),r){case i:o=(e-t)/l+(e<t?6:0);break;case e:o=(t-i)/l+2;break;case t:o=(i-e)/l+4}o/=6}return[Math.round(360*o),Math.round(100*a),Math.round(100*c),n]},SD=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(i)/(i.endsWith("%")?100:1)},a0=i=>Math.min(Math.round(i),255).toString(16).toUpperCase().padStart(2,"0"),MD=i=>{let[e,t,n,r=1]=i,s=Math.round(.3*e+.59*t+.11*n);return[s,s,s,r]},Qn=class i{constructor(e){if(e)if(e instanceof i)this.setSource([...e._source]);else if(Array.isArray(e)){let[t,n,r,s=1]=e;this.setSource([t,n,r,s])}else this.setSource(this._tryParsingColor(e));else this.setSource([0,0,0,1])}_tryParsingColor(e){return e in bD&&(e=bD[e]),e==="transparent"?[255,255,255,0]:i.sourceFromHex(e)||i.sourceFromRgb(e)||i.sourceFromHsl(e)||[0,0,0,1]}getSource(){return this._source}setSource(e){this._source=e}toRgb(){let[e,t,n]=this.getSource();return"rgb(".concat(e,",").concat(t,",").concat(n,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){let[e,t,n]=DD(...this.getSource());return"hsl(".concat(e,",").concat(t,"%,").concat(n,"%)")}toHsla(){let[e,t,n,r]=DD(...this.getSource());return"hsla(".concat(e,",").concat(t,"%,").concat(n,"%,").concat(r,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){let[e,t,n,r]=this.getSource();return"".concat(a0(e)).concat(a0(t)).concat(a0(n)).concat(a0(Math.round(255*r)))}getAlpha(){return this.getSource()[3]}setAlpha(e){return this._source[3]=e,this}toGrayscale(){return this.setSource(MD(this.getSource())),this}toBlackWhite(e){let[t,,,n]=MD(this.getSource()),r=t<(e||127)?0:255;return this.setSource([r,r,r,n]),this}overlayWith(e){e instanceof i||(e=new i(e));let t=this.getSource(),n=e.getSource(),[r,s,o]=t.map((a,c)=>Math.round(.5*a+.5*n[c]));return this.setSource([r,s,o,t[3]]),this}static fromRgb(e){return i.fromRgba(e)}static fromRgba(e){return new i(i.sourceFromRgb(e))}static sourceFromRgb(e){let t=e.match(/^rgba?\(\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d{0,3}(?:\.\d+)?%?)\s*)?\)$/i);if(t){let[n,r,s]=t.slice(1,4).map(o=>{let a=parseFloat(o);return o.endsWith("%")?Math.round(2.55*a):a});return[n,r,s,SD(t[4])]}}static fromHsl(e){return i.fromHsla(e)}static fromHsla(e){return new i(i.sourceFromHsl(e))}static sourceFromHsl(e){let t=e.match(/^hsla?\(\s*([+-]?\d{1,3})\s*[\s|,]\s*(\d{1,3}%)\s*[\s|,]\s*(\d{1,3}%)\s*(?:\s*[,/]\s*(\d*(?:\.\d+)?%?)\s*)?\)$/i);if(!t)return;let n=(parseFloat(t[1])%360+360)%360/360,r=parseFloat(t[2])/100,s=parseFloat(t[3])/100,o,a,c;if(r===0)o=a=c=s;else{let l=s<=.5?s*(r+1):s+r-s*r,u=2*s-l;o=Qv(u,l,n+1/3),a=Qv(u,l,n),c=Qv(u,l,n-1/3)}return[Math.round(255*o),Math.round(255*a),Math.round(255*c),SD(t[4])]}static fromHex(e){return new i(i.sourceFromHex(e))}static sourceFromHex(e){if(e.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){let t=e.slice(e.indexOf("#")+1),n;n=t.length<=4?t.split("").map(c=>c+c):t.match(/.{2}/g);let[r,s,o,a=255]=n.map(c=>parseInt(c,16));return[r,s,o,a/255]}}},xt=(i,e)=>parseFloat(Number(i).toFixed(e)),ta=function(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:jE,t=/\D{0,2}$/.exec(i),n=parseFloat(i),r=_t.DPI;switch(t?.[0]){case"mm":return n*r/25.4;case"cm":return n*r/2.54;case"in":return n*r;case"pt":return n*r/72;case"pc":return n*r/72*12;case"em":return n*e;default:return n}},cS=i=>{let[e,t]=i.trim().split(" "),[n,r]=(s=e)&&s!==si?[s.slice(1,4),s.slice(5,8)]:s===si?[s,s]:["Mid","Mid"];var s;return{meetOrSlice:t||"meet",alignX:n,alignY:r}},Hu=i=>"matrix("+i.map(e=>xt(e,_t.NUM_FRACTION_DIGITS)).join(" ")+")",ju=function(i,e){let t,n,r=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e)if(e.toLive)t="url(#SVGID_".concat(e.id,")");else{let s=new Qn(e),o=s.getAlpha();t=s.toRgb(),o!==1&&(n=o.toString())}else t="none";return r?"".concat(i,": ").concat(t,"; ").concat(n?"".concat(i,"-opacity: ").concat(n,"; "):""):"".concat(i,'="').concat(t,'" ').concat(n?"".concat(i,'-opacity="').concat(n,'" '):"")},ki=i=>!!i&&i.toLive!==void 0,TD=i=>!!i&&typeof i.toObject=="function",FD=i=>!!i&&i.offsetX!==void 0&&Object.hasOwn(i,"source"),lS=i=>!!i&&typeof i._renderText=="function",Bc=i=>!!i&&Object.hasOwn(i,"multiSelectionStacking");function uS(i){let e=i&&ar(i),t=0,n=0;if(!i||!e)return{left:t,top:n};let r=e.documentElement,s=e.body||{scrollLeft:0,scrollTop:0};for(;i&&(i.parentNode||i.host)&&((i=i.parentNode||i.host)===e?(t=s.scrollLeft||r.scrollLeft||0,n=s.scrollTop||r.scrollTop||0):(t+=i.scrollLeft||0,n+=i.scrollTop||0),i.nodeType!==1||i.style.position!=="fixed"););return{left:t,top:n}}var ar=i=>i.ownerDocument||null,hS=i=>{var e;return((e=i.ownerDocument)===null||e===void 0?void 0:e.defaultView)||null};function Lu(i,e){let t=i.style;t&&(typeof e=="string"?i.style.cssText+=";"+e:Object.entries(e).forEach(n=>{let[r,s]=n;return t.setProperty(r,s)}))}var dS=function(i,e,t){let{width:n,height:r}=t,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;i.width=n,i.height=r,s>1&&(i.setAttribute("width",(n*s).toString()),i.setAttribute("height",(r*s).toString()),e.scale(s,s))},xE=(i,e)=>{let{width:t,height:n}=e;t&&(i.style.width=typeof t=="number"?"".concat(t,"px"):t),n&&(i.style.height=typeof n=="number"?"".concat(n,"px"):n)};function BD(i){return i.onselectstart!==void 0&&(i.onselectstart=()=>!1),i.style.userSelect=si,i}var v0=class{constructor(e){V(this,"_originalCanvasStyle",void 0),V(this,"lower",void 0);let t=this.createLowerCanvas(e);this.lower={el:t,ctx:t.getContext("2d")}}createLowerCanvas(e){let t=(n=e)&&n.getContext!==void 0?e:e&&sl().getElementById(e)||ln();var n;if(t.hasAttribute("data-fabric"))throw new Ni("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=t.style.cssText,t.setAttribute("data-fabric","main"),t.classList.add("lower-canvas"),t}cleanupDOM(e){let{width:t,height:n}=e,{el:r}=this.lower;r.classList.remove("lower-canvas"),r.removeAttribute("data-fabric"),r.setAttribute("width","".concat(t)),r.setAttribute("height","".concat(n)),r.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(e,t){let{el:n,ctx:r}=this.lower;dS(n,r,e,t)}setCSSDimensions(e){xE(this.lower.el,e)}calcOffset(){return function(e){var t;let n={left:0,top:0},r=e&&ar(e),s={left:0,top:0},o={borderLeftWidth:Dt,borderTopWidth:Gn,paddingLeft:Dt,paddingTop:Gn};if(!r)return s;let a=((t=hS(e))===null||t===void 0?void 0:t.getComputedStyle(e,null))||{};for(let u in o)s[o[u]]+=parseInt(a[u],10)||0;let c=r.documentElement;e.getBoundingClientRect!==void 0&&(n=e.getBoundingClientRect());let l=uS(e);return{left:n.left+l.left-(c.clientLeft||0)+s.left,top:n.top+l.top-(c.clientTop||0)+s.top}}(this.lower.el)}dispose(){Or().dispose(this.lower.el),delete this.lower}},_7={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...Jn]},Gu=class i extends nS(g0){get lowerCanvasEl(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.el}get contextContainer(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.ctx}static getDefaults(){return i.ownDefaults}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(t),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(e){this.elements=new v0(e)}add(){let e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}insertAt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];let s=super.insertAt(e,...n);return n.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),s}remove(){let e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(Zs("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?tS():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(e,t){return this.setDimensions({width:e},t)}setHeight(e,t){return this.setDimensions({height:e},t)}_setDimensionsImpl(e){let{cssOnly:t=!1,backstoreOnly:n=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t){let r=U({width:this.width,height:this.height},e);this.elements.setDimensions(r,this.getRetinaScaling()),this.hasLostContext=!0,this.width=r.width,this.height=r.height}n||this.elements.setCSSDimensions(e),this.calcOffset()}setDimensions(e,t){this._setDimensionsImpl(e,t),t&&t.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(e){let t=this.backgroundImage,n=this.overlayImage,r=this._objects.length;this.viewportTransform=e;for(let s=0;s<r;s++){let o=this._objects[s];o.group||o.setCoords()}t&&t.setCoords(),n&&n.setCoords(),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(e,t){let n=e,r=[...this.viewportTransform],s=jn(e,gi(r));r[0]=t,r[3]=t;let o=jn(s,r);r[4]+=n.x-o.x,r[5]+=n.y-o.y,this.setViewportTransform(r)}setZoom(e){this.zoomToPoint(new J(0,0),e)}absolutePan(e){let t=[...this.viewportTransform];return t[4]=-e.x,t[5]=-e.y,this.setViewportTransform(t)}relativePan(e){return this.absolutePan(new J(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(e){e.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=ku(()=>this.renderAndReset()))}calcViewportBoundaries(){let e=this.width,t=this.height,n=gi(this.viewportTransform),r=jn({x:0,y:0},n),s=jn({x:e,y:t},n),o=r.min(s),a=r.max(s);return this.vptCoords={tl:o,tr:new J(a.x,o.y),bl:new J(o.x,a.y),br:a}}cancelRequestedRender(){this.nextRenderHandle&&(iS(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(e){}renderCanvas(e,t){if(this.destroyed)return;let n=this.viewportTransform,r=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality="best",this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._renderObjects(e,t),e.restore(),this.controlsAboveOverlay||this.drawControls(e),r&&(r._set("canvas",this),r.shouldCache(),r._transformDone=!0,r.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,r)),this._renderOverlay(e),this.controlsAboveOverlay&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(e,t){let n=this.viewportTransform;e.save(),e.transform(...n),e.globalCompositeOperation="destination-in",t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore()}_renderObjects(e,t){for(let n=0,r=t.length;n<r;++n)t[n]&&t[n].render(e)}_renderBackgroundOrOverlay(e,t){let n=this["".concat(t,"Color")],r=this["".concat(t,"Image")],s=this.viewportTransform,o=this["".concat(t,"Vpt")];if(!n&&!r)return;let a=ki(n);if(n){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=a?n.toLive(e):n,o&&e.transform(...s),a){e.transform(1,0,0,1,n.offsetX||0,n.offsetY||0);let c=n.gradientTransform||n.patternTransform;c&&e.transform(...c)}e.fill(),e.restore()}if(r){e.save();let{skipOffscreen:c}=this;this.skipOffscreen=o,o&&e.transform(...s),r.render(e),this.skipOffscreen=c,e.restore()}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background")}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new J(this.width/2,this.height/2)}centerObjectH(e){return this._centerObject(e,new J(this.getCenterPoint().x,e.getCenterPoint().y))}centerObjectV(e){return this._centerObject(e,new J(e.getCenterPoint().x,this.getCenterPoint().y))}centerObject(e){return this._centerObject(e,this.getCenterPoint())}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter())}viewportCenterObjectH(e){return this._centerObject(e,new J(this.getVpCenter().x,e.getCenterPoint().y))}viewportCenterObjectV(e){return this._centerObject(e,new J(e.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return jn(this.getCenterPoint(),gi(this.viewportTransform))}_centerObject(e,t){e.setXY(t,lt,lt),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(e){return this.toDatalessObject(e)}toObject(e){return this._toObjectMethod("toObject",e)}toJSON(){return this.toObject()}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e)}_toObjectMethod(e,t){let n=this.clipPath,r=n&&!n.excludeFromExport?this._toObject(n,e,t):null;return U(U(U({version:dE},aa(this,t)),{},{objects:this._objects.filter(s=>!s.excludeFromExport).map(s=>this._toObject(s,e,t))},this.__serializeBgOverlay(e,t)),r?{clipPath:r}:null)}_toObject(e,t,n){let r;this.includeDefaultValues||(r=e.includeDefaultValues,e.includeDefaultValues=!1);let s=e[t](n);return this.includeDefaultValues||(e.includeDefaultValues=!!r),s}__serializeBgOverlay(e,t){let n={},r=this.backgroundImage,s=this.overlayImage,o=this.backgroundColor,a=this.overlayColor;return ki(o)?o.excludeFromExport||(n.background=o.toObject(t)):o&&(n.background=o),ki(a)?a.excludeFromExport||(n.overlay=a.toObject(t)):a&&(n.overlay=a),r&&!r.excludeFromExport&&(n.backgroundImage=this._toObject(r,e,t)),s&&!s.excludeFromExport&&(n.overlayImage=this._toObject(s,e,t)),n}toSVG(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;e.reviver=t;let n=[];return this._setSVGPreamble(n,e),this._setSVGHeader(n,e),this.clipPath&&n.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(n,"background"),this._setSVGBgOverlayImage(n,"backgroundImage",t),this._setSVGObjects(n,t),this.clipPath&&n.push(`</g>
`),this._setSVGBgOverlayColor(n,"overlay"),this._setSVGBgOverlayImage(n,"overlayImage",t),n.push("</svg>"),n.join("")}_setSVGPreamble(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(e,t){let n=t.width||"".concat(this.width),r=t.height||"".concat(this.height),s=_t.NUM_FRACTION_DIGITS,o=t.viewBox,a;if(o)a='viewBox="'.concat(o.x," ").concat(o.y," ").concat(o.width," ").concat(o.height,'" ');else if(this.svgViewportTransformation){let c=this.viewportTransform;a='viewBox="'.concat(xt(-c[4]/c[0],s)," ").concat(xt(-c[5]/c[3],s)," ").concat(xt(this.width/c[0],s)," ").concat(xt(this.height/c[3],s),'" ')}else a='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',n,'" ','height="',r,'" ',a,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",dE,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(t),`</defs>
`)}createSVGClipPathMarkup(e){let t=this.clipPath;return t?(t.clipPathId="CLIPPATH_".concat(Js()),'<clipPath id="'.concat(t.clipPathId,`" >
`).concat(t.toClipPathSVG(e.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map(e=>{let t=this["".concat(e,"Color")];if(ki(t)){let n=this["".concat(e,"Vpt")],r=this.viewportTransform,s={isType:()=>!1,width:this.width/(n?r[0]:1),height:this.height/(n?r[3]:1)};return t.toSVG(s,{additionalTransform:n?Hu(r):""})}}).join("")}createSVGFontFacesMarkup(){let e=[],t={},n=_t.fontPaths;this._objects.forEach(function s(o){e.push(o),f0(o)&&o._objects.forEach(s)}),e.forEach(s=>{if(!lS(s))return;let{styles:o,fontFamily:a}=s;!t[a]&&n[a]&&(t[a]=!0,o&&Object.values(o).forEach(c=>{Object.values(c).forEach(l=>{let{fontFamily:u=""}=l;!t[u]&&n[u]&&(t[u]=!0)})}))});let r=Object.keys(t).map(s=>`		@font-face {
			font-family: '`.concat(s,`';
			src: url('`).concat(n[s],`');
		}
`)).join("");return r?`	<style type="text/css"><![CDATA[
`.concat(r,`]]></style>
`):""}_setSVGObjects(e,t){this.forEachObject(n=>{n.excludeFromExport||this._setSVGObject(e,n,t)})}_setSVGObject(e,t,n){e.push(t.toSVG(n))}_setSVGBgOverlayImage(e,t,n){let r=this[t];r&&!r.excludeFromExport&&r.toSVG&&e.push(r.toSVG(n))}_setSVGBgOverlayColor(e,t){let n=this["".concat(t,"Color")];if(n)if(ki(n)){let r=n.repeat||"",s=this.width,o=this.height,a=this["".concat(t,"Vpt")]?Hu(gi(this.viewportTransform)):"";e.push('<rect transform="'.concat(a," translate(").concat(s/2,",").concat(o/2,')" x="').concat(n.offsetX-s/2,'" y="').concat(n.offsetY-o/2,'" width="').concat(r!=="repeat-y"&&r!=="no-repeat"||!FD(n)?s:n.source.width,'" height="').concat(r!=="repeat-x"&&r!=="no-repeat"||!FD(n)?o:n.source.height,'" fill="url(#SVGID_').concat(n.id,`)"></rect>
`))}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',n,'"',`></rect>
`)}loadFromJSON(e,t){let{signal:n}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return Promise.reject(new Ni("`json` is undefined"));let r=typeof e=="string"?JSON.parse(e):e,{objects:s=[],backgroundImage:o,background:a,overlayImage:c,overlay:l,clipPath:u}=r,h=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([nl(s,{reviver:t,signal:n}),Yu({backgroundImage:o,backgroundColor:a,overlayImage:c,overlayColor:l,clipPath:u},{signal:n})]).then(d=>{let[f,x]=d;return this.clear(),this.add(...f),this.set(r),this.set(x),this.renderOnAddRemove=h,this})}clone(e){let t=this.toObject(e);return this.cloneWithoutData().loadFromJSON(t)}cloneWithoutData(){let e=ln();return e.width=this.width,e.height=this.height,new this.constructor(e)}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{format:t="png",quality:n=1,multiplier:r=1,enableRetinaScaling:s=!1}=e,o=r*(s?this.getRetinaScaling():1);return $E(this.toCanvasElement(o,e),t,n)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:t,height:n,left:r,top:s,filter:o}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=(t||this.width)*e,c=(n||this.height)*e,l=this.getZoom(),u=this.width,h=this.height,d=l*e,f=this.viewportTransform,x=[d,0,0,d,(f[4]-(r||0))*e,(f[5]-(s||0))*e],g=this.enableRetinaScaling,p=ln(),m=o?this._objects.filter(v=>o(v)):this._objects;return p.width=a,p.height=c,this.enableRetinaScaling=!1,this.viewportTransform=x,this.width=a,this.height=c,this.calcViewportBoundaries(),this.renderCanvas(p.getContext("2d"),m),this.viewportTransform=f,this.width=u,this.height=h,this.calcViewportBoundaries(),this.enableRetinaScaling=g,p}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),m0.cancelByCanvas(this),this.disposed=!0,new Promise((e,t)=>{let n=()=>{this.destroy(),e(!0)};n.kill=t,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=n:n()})}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(e=>e.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}};V(Gu,"ownDefaults",_7);var A7=["touchstart","touchmove","touchend"],fS=i=>{let e=uS(i.target),t=function(n){let r=n.changedTouches;return r&&r[0]?r[0]:n}(i);return new J(t.clientX+e.left,t.clientY+e.top)},E0=i=>A7.includes(i.type)||i.pointerType==="touch",mE=i=>{i.preventDefault(),i.stopPropagation()},Rr=i=>{if(i.length===0)return{left:0,top:0,width:0,height:0};let{min:e,max:t}=i.reduce((r,s)=>{let{min:o,max:a}=r;return{min:o.min(s),max:a.max(s)}},{min:new J(i[0]),max:new J(i[0])}),n=t.subtract(e);return{left:e.x,top:e.y,width:n.x,height:n.y}},w7=["translateX","translateY","scaleX","scaleY"],pS=(i,e)=>il(i,Pn(e,i.calcOwnMatrix())),il=(i,e)=>{let t=tl(e),{translateX:n,translateY:r,scaleX:s,scaleY:o}=t,a=Pt(t,w7),c=new J(n,r);i.flipX=!1,i.flipY=!1,Object.assign(i,a),i.set({scaleX:s,scaleY:o}),i.setPositionByOrigin(c,lt,lt)},xS=i=>{i.scaleX=1,i.scaleY=1,i.skewX=0,i.skewY=0,i.flipX=!1,i.flipY=!1,i.rotate(0)},ZE=i=>({scaleX:i.scaleX,scaleY:i.scaleY,skewX:i.skewX,skewY:i.skewY,angle:i.angle,left:i.left,flipX:i.flipX,flipY:i.flipY,top:i.top}),z0=(i,e,t)=>{let n=i/2,r=e/2,s=[new J(-n,-r),new J(n,-r),new J(-n,r),new J(n,r)].map(a=>a.transform(t)),o=Rr(s);return new J(o.width,o.height)},Zu=function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Jn;return Pn(gi(arguments.length>1&&arguments[1]!==void 0?arguments[1]:Jn),i)},Xs=function(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Jn,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Jn;return i.transform(Zu(e,t))},mS=function(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Jn,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Jn;return i.transform(Zu(e,t),!0)},gE=(i,e,t)=>{let n=Zu(e,t);return il(i,Pn(n,i.calcOwnMatrix())),n},gS=(i,e)=>{var t;let{transform:{target:n}}=e;(t=n.canvas)===null||t===void 0||t.fire("object:".concat(i),U(U({},e),{},{target:n})),n.fire(i,e)},b7={left:-.5,top:-.5,center:0,bottom:.5,right:.5},Ws=i=>typeof i=="string"?b7[i]:i-.5,y0="not-allowed";function vS(i){return i.originX===lt&&i.originY===lt}function ID(i){return .5-Ws(i)}var cr=(i,e)=>i[e],ES=(i,e,t,n)=>({e:i,transform:e,pointer:new J(t,n)});function yS(i,e){let t=i.getTotalAngle()+ra(Math.atan2(e.y,e.x))+360;return Math.round(t%360/45)}function H0(i,e,t,n,r){var s;let{target:o,corner:a}=i,c=o.controls[a],l=((s=o.canvas)===null||s===void 0?void 0:s.getZoom())||1,u=o.padding/l,h=function(d,f,x,g){let p=d.getRelativeCenterPoint(),m=x!==void 0&&g!==void 0?d.translateToGivenOrigin(p,lt,lt,x,g):new J(d.left,d.top);return(d.angle?f.rotate(-rn(d.angle),p):f).subtract(m)}(o,new J(n,r),e,t);return h.x>=u&&(h.x-=u),h.x<=-u&&(h.x+=u),h.y>=u&&(h.y-=u),h.y<=u&&(h.y+=u),h.x-=c.offsetX,h.y-=c.offsetY,h}var CS=(i,e,t,n)=>{let{target:r,offsetX:s,offsetY:o}=e,a=t-s,c=n-o,l=!cr(r,"lockMovementX")&&r.left!==a,u=!cr(r,"lockMovementY")&&r.top!==c;return l&&r.set(Dt,a),u&&r.set(Gn,c),(l||u)&&gS("moving",ES(i,e,t,n)),l||u},C0=class{getSvgStyles(e){let t=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",r=this.strokeDashArray?this.strokeDashArray.join(" "):si,s=this.strokeDashOffset?this.strokeDashOffset:"0",o=this.strokeLineCap?this.strokeLineCap:"butt",a=this.strokeLineJoin?this.strokeLineJoin:"miter",c=this.strokeMiterLimit?this.strokeMiterLimit:"4",l=this.opacity!==void 0?this.opacity:"1",u=this.visible?"":" visibility: hidden;",h=e?"":this.getSvgFilter(),d=ju("fill",this.fill);return[ju("stroke",this.stroke),"stroke-width: ",n,"; ","stroke-dasharray: ",r,"; ","stroke-linecap: ",o,"; ","stroke-dashoffset: ",s,"; ","stroke-linejoin: ",a,"; ","stroke-miterlimit: ",c,"; ",d,"fill-rule: ",t,"; ","opacity: ",l,";",h,u].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",n=e?this.calcTransformMatrix():this.calcOwnMatrix(),r='transform="'.concat(Hu(n));return"".concat(r).concat(t,'" ')}_toSVG(e){return[""]}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})}toClipPathSVG(e){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})}_createBaseClipPathSVGMarkup(e){let{reviver:t,additionalTransform:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=[this.getSvgTransform(!0,n),this.getSvgCommons()].join(""),s=e.indexOf("COMMON_PARTS");return e[s]=r,t?t(e.join("")):e.join("")}_createBaseSVGMarkup(e){let{noStyle:t,reviver:n,withShadow:r,additionalTransform:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=t?"":'style="'.concat(this.getSvgStyles(),'" '),a=r?'style="'.concat(this.getSvgFilter(),'" '):"",c=this.clipPath,l=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",u=c&&c.absolutePositioned,h=this.stroke,d=this.fill,f=this.shadow,x=[],g=e.indexOf("COMMON_PARTS"),p;c&&(c.clipPathId="CLIPPATH_".concat(Js()),p='<clipPath id="'.concat(c.clipPathId,`" >
`).concat(c.toClipPathSVG(n),`</clipPath>
`)),u&&x.push("<g ",a,this.getSvgCommons(),` >
`),x.push("<g ",this.getSvgTransform(!1),u?"":a+this.getSvgCommons(),` >
`);let m=[o,l,t?"":this.addPaintOrder()," ",s?'transform="'.concat(s,'" '):""].join("");return e[g]=m,ki(d)&&x.push(d.toSVG(this)),ki(h)&&x.push(h.toSVG(this)),f&&x.push(f.toSVG(this)),c&&x.push(p),x.push(e.join("")),x.push(`</g>
`),u&&x.push(`</g>
`),n?n(x.join("")):x.join("")}addPaintOrder(){return this.paintFirst!=="fill"?' paint-order="'.concat(this.paintFirst,'" '):""}},eE=(i,e,t,n)=>(i<Math.abs(e)?(i=e,n=t/4):n=e===0&&i===0?t/us*Math.asin(1):t/us*Math.asin(e/i),{a:i,c:e,p:t,s:n}),PD=(i,e,t,n,r)=>i*Math.pow(2,10*(n-=1))*Math.sin((n*r-e)*us/t),_S=(i,e,t,n)=>-t*Math.cos(i/n*Ks)+t+e,vE=(i,e,t,n)=>(i/=n)<1/2.75?t*(7.5625*i*i)+e:i<2/2.75?t*(7.5625*(i-=1.5/2.75)*i+.75)+e:i<2.5/2.75?t*(7.5625*(i-=2.25/2.75)*i+.9375)+e:t*(7.5625*(i-=2.625/2.75)*i+.984375)+e,RD=(i,e,t,n)=>t-vE(n-i,0,t,n)+e,D7=Object.freeze({__proto__:null,defaultEasing:_S,easeInBack:function(i,e,t,n){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*(i/=n)*i*((r+1)*i-r)+e},easeInBounce:RD,easeInCirc:(i,e,t,n)=>-t*(Math.sqrt(1-(i/=n)*i)-1)+e,easeInCubic:(i,e,t,n)=>t*(i/n)**3+e,easeInElastic:(i,e,t,n)=>{let r=t,s=0;if(i===0)return e;if((i/=n)===1)return e+t;s||(s=.3*n);let{a:o,s:a,p:c}=eE(r,t,s,1.70158);return-PD(o,a,c,i,n)+e},easeInExpo:(i,e,t,n)=>i===0?e:t*2**(10*(i/n-1))+e,easeInOutBack:function(i,e,t,n){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return(i/=n/2)<1?t/2*(i*i*((1+(r*=1.525))*i-r))+e:t/2*((i-=2)*i*((1+(r*=1.525))*i+r)+2)+e},easeInOutBounce:(i,e,t,n)=>i<n/2?.5*RD(2*i,0,t,n)+e:.5*vE(2*i-n,0,t,n)+.5*t+e,easeInOutCirc:(i,e,t,n)=>(i/=n/2)<1?-t/2*(Math.sqrt(1-i**2)-1)+e:t/2*(Math.sqrt(1-(i-=2)*i)+1)+e,easeInOutCubic:(i,e,t,n)=>(i/=n/2)<1?t/2*i**3+e:t/2*((i-2)**3+2)+e,easeInOutElastic:(i,e,t,n)=>{let r=t,s=0;if(i===0)return e;if((i/=n/2)===2)return e+t;s||(s=n*(.3*1.5));let{a:o,s:a,p:c,c:l}=eE(r,t,s,1.70158);return i<1?-.5*PD(o,a,c,i,n)+e:o*Math.pow(2,-10*(i-=1))*Math.sin((i*n-a)*us/c)*.5+l+e},easeInOutExpo:(i,e,t,n)=>i===0?e:i===n?e+t:(i/=n/2)<1?t/2*2**(10*(i-1))+e:t/2*-(2**(-10*--i)+2)+e,easeInOutQuad:(i,e,t,n)=>(i/=n/2)<1?t/2*i**2+e:-t/2*(--i*(i-2)-1)+e,easeInOutQuart:(i,e,t,n)=>(i/=n/2)<1?t/2*i**4+e:-t/2*((i-=2)*i**3-2)+e,easeInOutQuint:(i,e,t,n)=>(i/=n/2)<1?t/2*i**5+e:t/2*((i-2)**5+2)+e,easeInOutSine:(i,e,t,n)=>-t/2*(Math.cos(Math.PI*i/n)-1)+e,easeInQuad:(i,e,t,n)=>t*(i/=n)*i+e,easeInQuart:(i,e,t,n)=>t*(i/=n)*i**3+e,easeInQuint:(i,e,t,n)=>t*(i/n)**5+e,easeInSine:(i,e,t,n)=>-t*Math.cos(i/n*Ks)+t+e,easeOutBack:function(i,e,t,n){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:1.70158;return t*((i=i/n-1)*i*((r+1)*i+r)+1)+e},easeOutBounce:vE,easeOutCirc:(i,e,t,n)=>t*Math.sqrt(1-(i=i/n-1)*i)+e,easeOutCubic:(i,e,t,n)=>t*((i/n-1)**3+1)+e,easeOutElastic:(i,e,t,n)=>{let r=t,s=0;if(i===0)return e;if((i/=n)===1)return e+t;s||(s=.3*n);let{a:o,s:a,p:c,c:l}=eE(r,t,s,1.70158);return o*2**(-10*i)*Math.sin((i*n-a)*us/c)+l+e},easeOutExpo:(i,e,t,n)=>i===n?e+t:t*-(2**(-10*i/n)+1)+e,easeOutQuad:(i,e,t,n)=>-t*(i/=n)*(i-2)+e,easeOutQuart:(i,e,t,n)=>-t*((i=i/n-1)*i**3-1)+e,easeOutQuint:(i,e,t,n)=>t*((i/n-1)**5+1)+e,easeOutSine:(i,e,t,n)=>t*Math.sin(i/n*Ks)+e}),S7=()=>!1,Wu=class{constructor(e){let{startValue:t,byValue:n,duration:r=500,delay:s=0,easing:o=_S,onStart:a=ea,onChange:c=ea,onComplete:l=ea,abort:u=S7,target:h}=e;V(this,"_state","pending"),V(this,"durationProgress",0),V(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=r,this.delay=s,this.easing=o,this._onStart=a,this._onChange=c,this._onComplete=l,this._abort=u,this.target=h,this.startValue=t,this.byValue=n,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){let e=t=>{this._state==="pending"&&(this.startTime=t||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout(()=>ku(e),this.delay):ku(e)}tick(e){let t=(e||+new Date)-this.startTime,n=Math.min(t,this.duration);this.durationProgress=n/this.duration;let{value:r,valueProgress:s}=this.calculate(n);this.value=Object.freeze(r),this.valueProgress=s,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):t>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),ku(this.tick)))}register(){m0.push(this)}unregister(){m0.remove(this)}abort(){this._state="aborted",this.unregister()}},M7=["startValue","endValue"],EE=class extends Wu{constructor(e){let{startValue:t=0,endValue:n=100}=e;super(U(U({},Pt(e,M7)),{},{startValue:t,byValue:n-t}))}calculate(e){let t=this.easing(e,this.startValue,this.byValue,this.duration);return{value:t,valueProgress:Math.abs((t-this.startValue)/this.byValue)}}},T7=["startValue","endValue"],yE=class extends Wu{constructor(e){let{startValue:t=[0],endValue:n=[100]}=e;super(U(U({},Pt(e,T7)),{},{startValue:t,byValue:n.map((r,s)=>r-t[s])}))}calculate(e){let t=this.startValue.map((n,r)=>this.easing(e,n,this.byValue[r],this.duration,r));return{value:t,valueProgress:Math.abs((t[0]-this.startValue[0])/this.byValue[0])}}},sa=(i,e,t)=>Math.max(i,Math.min(e,t)),F7=["startValue","endValue","easing","onChange","onComplete","abort"],B7=(i,e,t,n)=>e+t*(1-Math.cos(i/n*Ks)),tE=i=>i&&((e,t,n)=>i(new Qn(e).toRgba(),t,n)),CE=class extends Wu{constructor(e){let{startValue:t,endValue:n,easing:r=B7,onChange:s,onComplete:o,abort:a}=e,c=Pt(e,F7),l=new Qn(t).getSource(),u=new Qn(n).getSource();super(U(U({},c),{},{startValue:l,byValue:u.map((h,d)=>h-l[d]),easing:r,onChange:tE(s),onComplete:tE(o),abort:tE(a)}))}calculate(e){let[t,n,r,s]=this.startValue.map((a,c)=>this.easing(e,a,this.byValue[c],this.duration,c)),o=[...[t,n,r].map(Math.round),sa(0,s,1)];return{value:o,valueProgress:o.map((a,c)=>this.byValue[c]!==0?Math.abs((a-this.startValue[c])/this.byValue[c]):0).find(a=>a!==0)||0}}};function KE(i){let e=(t=>Array.isArray(t.startValue)||Array.isArray(t.endValue))(i)?new yE(i):new EE(i);return e.start(),e}function AS(i){let e=new CE(i);return e.start(),e}var I7=new J(1,0),wS=new J,JE=(i,e)=>i.rotate(e),_0=(i,e)=>new J(e).subtract(i),A0=i=>i.distanceFrom(wS),w0=(i,e)=>Math.atan2(Lc(i,e),DS(i,e)),bS=i=>w0(I7,i),j0=i=>i.eq(wS)?i:i.scalarDivide(A0(i)),QE=function(i){let e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return j0(new J(-i.y,i.x).scalarMultiply(e?1:-1))},Lc=(i,e)=>i.x*e.y-i.y*e.x,DS=(i,e)=>i.x*e.x+i.y*e.y,_E=(i,e,t)=>{if(i.eq(e)||i.eq(t))return!0;let n=Lc(e,t),r=Lc(e,i),s=Lc(t,i);return n>=0?r>=0&&s<=0:!(r<=0&&s>=0)},na=class i{constructor(e){this.status=e,this.points=[]}includes(e){return this.points.some(t=>t.eq(e))}append(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.points=this.points.concat(t.filter(r=>!this.includes(r))),this}static isPointContained(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(t.eq(n))return e.eq(t);if(t.x===n.x)return e.x===t.x&&(r||e.y>=Math.min(t.y,n.y)&&e.y<=Math.max(t.y,n.y));if(t.y===n.y)return e.y===t.y&&(r||e.x>=Math.min(t.x,n.x)&&e.x<=Math.max(t.x,n.x));{let s=_0(t,n),o=_0(t,e).divide(s);return r?Math.abs(o.x)===Math.abs(o.y):o.x===o.y&&o.x>=0&&o.x<=1}}static isPointInPolygon(e,t){let n=new J(e).setX(Math.min(e.x-1,...t.map(s=>s.x))),r=0;for(let s=0;s<t.length;s++){let o=this.intersectSegmentSegment(t[s],t[(s+1)%t.length],e,n);if(o.includes(e))return!0;r+=+(o.status==="Intersection")}return r%2==1}static intersectLineLine(e,t,n,r){let s=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],o=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],a=t.x-e.x,c=t.y-e.y,l=r.x-n.x,u=r.y-n.y,h=e.x-n.x,d=e.y-n.y,f=l*d-u*h,x=a*d-c*h,g=u*a-l*c;if(g!==0){let p=f/g,m=x/g;return(s||0<=p&&p<=1)&&(o||0<=m&&m<=1)?new i("Intersection").append(new J(e.x+p*a,e.y+p*c)):new i}if(f===0||x===0){let p=s||o||i.isPointContained(e,n,r)||i.isPointContained(t,n,r)||i.isPointContained(n,e,t)||i.isPointContained(r,e,t);return new i(p?"Coincident":void 0)}return new i("Parallel")}static intersectSegmentLine(e,t,n,r){return i.intersectLineLine(e,t,n,r,!1,!0)}static intersectSegmentSegment(e,t,n,r){return i.intersectLineLine(e,t,n,r,!1,!1)}static intersectLinePolygon(e,t,n){let r=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3],s=new i,o=n.length;for(let a,c,l,u=0;u<o;u++){if(a=n[u],c=n[(u+1)%o],l=i.intersectLineLine(e,t,a,c,r,!1),l.status==="Coincident")return l;s.append(...l.points)}return s.points.length>0&&(s.status="Intersection"),s}static intersectSegmentPolygon(e,t,n){return i.intersectLinePolygon(e,t,n,!1)}static intersectPolygonPolygon(e,t){let n=new i,r=e.length,s=[];for(let o=0;o<r;o++){let a=e[o],c=e[(o+1)%r],l=i.intersectSegmentPolygon(a,c,t);l.status==="Coincident"?(s.push(l),n.append(a,c)):n.append(...l.points)}return s.length>0&&s.length===e.length?new i("Coincident"):(n.points.length>0&&(n.status="Intersection"),n)}static intersectPolygonRectangle(e,t,n){let r=t.min(n),s=t.max(n),o=new J(s.x,r.y),a=new J(r.x,s.y);return i.intersectPolygonPolygon(e,[r,o,s,a])}},AE=class extends g0{_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=U({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},e),n=t.strokeWidth,r=n,s=0;this.strokeUniform&&(r=0,s=n);let o=t.width+r,a=t.height+r,c;return c=t.skewX===0&&t.skewY===0?new J(o*t.scaleX,a*t.scaleY):z0(o,a,qu(t)),c.scalarAdd(s)}translateToGivenOrigin(e,t,n,r,s){let o=e.x,a=e.y,c=Ws(r)-Ws(t),l=Ws(s)-Ws(n);if(c||l){let u=this._getTransformedDimensions();o+=c*u.x,a+=l*u.y}return new J(o,a)}translateToCenterPoint(e,t,n){let r=this.translateToGivenOrigin(e,t,n,lt,lt);return this.angle?r.rotate(rn(this.angle),e):r}translateToOriginPoint(e,t,n){let r=this.translateToGivenOrigin(e,lt,lt,t,n);return this.angle?r.rotate(rn(this.angle),e):r}getCenterPoint(){let e=this.getRelativeCenterPoint();return this.group?jn(e,this.group.calcTransformMatrix()):e}getRelativeCenterPoint(){return this.translateToCenterPoint(new J(this.left,this.top),this.originX,this.originY)}getPointByOrigin(e,t){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,t)}setPositionByOrigin(e,t,n){let r=this.translateToCenterPoint(e,t,n),s=this.translateToOriginPoint(r,this.originX,this.originY);this.set({left:s.x,top:s.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),Dt,Gn)}},wE=class extends AE{getX(){return this.getXY().x}setX(e){this.setXY(this.getXY().setX(e))}getY(){return this.getXY().y}setY(e){this.setXY(this.getXY().setY(e))}getRelativeX(){return this.left}setRelativeX(e){this.left=e}getRelativeY(){return this.top}setRelativeY(e){this.top=e}getXY(){let e=this.getRelativeXY();return this.group?jn(e,this.group.calcTransformMatrix()):e}setXY(e,t,n){this.group&&(e=jn(e,gi(this.group.calcTransformMatrix()))),this.setRelativeXY(e,t,n)}getRelativeXY(){return new J(this.left,this.top)}setRelativeXY(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(e,t,n)}isStrokeAccountedForInDimensions(){return!1}getCoords(){let{tl:e,tr:t,br:n,bl:r}=this.aCoords||(this.aCoords=this.calcACoords()),s=[e,t,n,r];if(this.group){let o=this.group.calcTransformMatrix();return s.map(a=>jn(a,o))}return s}intersectsWithRect(e,t){return na.intersectPolygonRectangle(this.getCoords(),e,t).status==="Intersection"}intersectsWithObject(e){let t=na.intersectPolygonPolygon(this.getCoords(),e.getCoords());return t.status==="Intersection"||t.status==="Coincident"||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)}isContainedWithinObject(e){return this.getCoords().every(t=>e.containsPoint(t))}isContainedWithinRect(e,t){let{left:n,top:r,width:s,height:o}=this.getBoundingRect();return n>=e.x&&n+s<=t.x&&r>=e.y&&r+o<=t.y}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this)}containsPoint(e){return na.isPointInPolygon(e,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;let{tl:e,br:t}=this.canvas.vptCoords;return!!this.getCoords().some(n=>n.x<=t.x&&n.x>=e.x&&n.y<=t.y&&n.y>=e.y)||!!this.intersectsWithRect(e,t)||this.containsPoint(e.midPointFrom(t))}isPartiallyOnScreen(){if(!this.canvas)return!1;let{tl:e,br:t}=this.canvas.vptCoords;return this.intersectsWithRect(e,t)?!0:this.getCoords().every(n=>(n.x>=t.x||n.x<=e.x)&&(n.y>=t.y||n.y<=e.y))&&this.containsPoint(e.midPointFrom(t))}getBoundingRect(){return Rr(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(e){this._set("scaleX",e),this._set("scaleY",e),this.setCoords()}scaleToWidth(e){let t=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/t)}scaleToHeight(e){let t=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/t)}getCanvasRetinaScaling(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.getRetinaScaling())||1}getTotalAngle(){return this.group?ra(sS(this.calcTransformMatrix())):this.angle}getViewportTransform(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.viewportTransform)||Jn.concat()}calcACoords(){let e=cl({angle:this.angle}),{x:t,y:n}=this.getRelativeCenterPoint(),r=al(t,n),s=Pn(r,e),o=this._getTransformedDimensions(),a=o.x/2,c=o.y/2;return{tl:jn({x:-a,y:-c},s),tr:jn({x:a,y:-c},s),bl:jn({x:-a,y:c},s),br:jn({x:a,y:c},s)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t="_",n="";return!e&&this.group&&(n=this.group.transformMatrixKey(e)+t),n+this.top+t+this.left+t+this.scaleX+t+this.scaleY+t+this.skewX+t+this.skewY+t+this.angle+t+this.originX+t+this.originY+t+this.width+t+this.height+t+this.strokeWidth+this.flipX+this.flipY}calcTransformMatrix(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=this.calcOwnMatrix();if(e||!this.group)return t;let n=this.transformMatrixKey(e),r=this.matrixCache;return r&&r.key===n?r.value:(this.group&&(t=Pn(this.group.calcTransformMatrix(!1),t)),this.matrixCache={key:n,value:t},t)}calcOwnMatrix(){let e=this.transformMatrixKey(!0),t=this.ownMatrixCache;if(t&&t.key===e)return t.value;let n=this.getRelativeCenterPoint(),r={angle:this.angle,translateX:n.x,translateY:n.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},s=aS(r);return this.ownMatrixCache={key:e,value:s},s}_getNonTransformedDimensions(){return new J(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}},bE=class i extends wE{isDescendantOf(e){let{parent:t,group:n}=this;return t===e||n===e||this.canvas===e||!!t&&t.isDescendantOf(e)||!!n&&n!==t&&n.isDescendantOf(e)}getAncestors(e){let t=[],n=this;do{var r;n=n instanceof i?(r=n.parent)!==null&&r!==void 0?r:e?void 0:n.canvas:void 0,n&&t.push(n)}while(n);return t}findCommonAncestors(e,t){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors(t)]};let n=this.getAncestors(t),r=e.getAncestors(t);if(n.length===0&&r.length>0&&this===r[r.length-1])return{fork:[],otherFork:[e,...r.slice(0,r.length-1)],common:[this]};for(let s,o=0;o<n.length;o++){if(s=n[o],s===e)return{fork:[this,...n.slice(0,o)],otherFork:[],common:n.slice(o)};for(let a=0;a<r.length;a++){if(this===r[a])return{fork:[],otherFork:[e,...r.slice(0,a)],common:[this,...n]};if(s===r[a])return{fork:[this,...n.slice(0,o)],otherFork:[e,...r.slice(0,a)],common:n.slice(o)}}}return{fork:[this,...n],otherFork:[e,...r],common:[]}}hasCommonAncestors(e,t){let n=this.findCommonAncestors(e,t);return n&&!!n.common.length}isInFrontOf(e){if(this===e)return;let t=this.findCommonAncestors(e);if(!t)return;if(t.fork.includes(e))return!0;if(t.otherFork.includes(this))return!1;let n=t.common[0];if(!n)return;let r=t.fork.pop(),s=t.otherFork.pop(),o=n._objects.indexOf(r),a=n._objects.indexOf(s);return o>-1&&o>a}},b0=class extends bE{animate(e,t){return Object.entries(e).reduce((n,r)=>{let[s,o]=r;return n[s]=this._animate(s,o,t),n},{})}_animate(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=e.split("."),s=this.constructor.colorProperties.includes(r[r.length-1]),{easing:o,duration:a,abort:c,startValue:l,onChange:u,onComplete:h}=n,d={target:this,startValue:l??r.reduce((f,x)=>f[x],this),endValue:t,easing:o,duration:a,abort:c?.bind(this),onChange:(f,x,g)=>{r.reduce((p,m,v)=>(v===r.length-1&&(p[m]=f),p[m]),this),u&&u(f,x,g)},onComplete:(f,x,g)=>{this.setCoords(),h&&h(f,x,g)}};return s?AS(d):KE(d)}};function G0(i){return new RegExp("^("+i.join("|")+")\\b","i")}var OD,kD;V(b0,"colorProperties",["fill","stroke","backgroundColor"]);var Pr=String.raw(OD||(OD=Nr(["(?:[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?)"],["(?:[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?)"])));String.raw(kD||(kD=Nr(["(?:s+,?s*|,s*|$)"],["(?:\\s+,?\\s*|,\\s*|$)"])));var P7=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+Pr+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+Pr+"))?\\s+(.*)"),R7={cx:Dt,x:Dt,r:"radius",cy:Gn,y:Gn,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},nE="font-size",iE="clip-path",BX=G0(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),IX=G0(["symbol","image","marker","pattern","view","svg"]),ND=G0(["symbol","g","a","svg","clipPath","defs"]),PX=new RegExp("^\\s*("+Pr+"+)\\s*,?\\s*("+Pr+"+)\\s*,?\\s*("+Pr+"+)\\s*,?\\s*("+Pr+"+)\\s*$"),LD="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",ia=class i{constructor(e){let t=typeof e=="string"?i.parseShadow(e):e;Object.assign(this,this.constructor.ownDefaults);for(let n in t)this[n]=t[n];this.id=Js()}static parseShadow(e){let t=e.trim(),n=new RegExp("(?:\\s|^)"+LD+LD+"("+Pr+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)"),[,r=0,s=0,o=0]=(n.exec(t)||[]).map(a=>parseFloat(a)||0);return{color:(t.replace(n,"")||"rgb(0,0,0)").trim(),offsetX:r,offsetY:s,blur:o}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(e){let t=JE(new J(this.offsetX,this.offsetY),rn(-e.angle)),n=new Qn(this.color),r=40,s=40;return e.width&&e.height&&(r=100*xt((Math.abs(t.x)+this.blur)/e.width,_t.NUM_FRACTION_DIGITS)+20,s=100*xt((Math.abs(t.y)+this.blur)/e.height,_t.NUM_FRACTION_DIGITS)+20),e.flipX&&(t.x*=-1),e.flipY&&(t.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(s,'%" height="').concat(100+2*s,'%" x="-').concat(r,'%" width="').concat(100+2*r,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(xt(this.blur?this.blur/2:0,_t.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(xt(t.x,_t.NUM_FRACTION_DIGITS),'" dy="').concat(xt(t.y,_t.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(n.toRgb(),'" flood-opacity="').concat(n.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){let e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},t=i.ownDefaults;return this.includeDefaultValues?e:YE(e,(n,r)=>n!==t[r])}static fromObject(e){return He(this,null,function*(){return new this(e)})}};V(ia,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),V(ia,"type","shadow"),_e.setClass(ia,"shadow");var Ku=i=>JSON.parse(JSON.stringify(i)),O7=[Gn,Dt,"scaleX","scaleY","flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible","skewX","skewY"],hs=["fill","stroke","strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],k7={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:Dt,originY:Gn,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:"fill",fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},N7=["type"],L7=["extraParam"],Zo=class SS extends b0{static getDefaults(){return U({},SS.ownDefaults)}get type(){let e=this.constructor.type;return e==="FabricObject"?"object":e.toLowerCase()}set type(e){Zs("warn","Setting type has no effect",e)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),V(this,"_cacheContext",null),Object.assign(this,this.constructor.getDefaults()),this.setOptions(e)}_createCacheCanvas(){this._cacheCanvas=ln(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(e){let t=e.width,n=e.height,r=_t.maxCacheSideLimit,s=_t.minCacheSideLimit;if(t<=r&&n<=r&&t*n<=_t.perfLimitSizeTotal)return t<s&&(e.width=s),n<s&&(e.height=s),e;let o=t/n,[a,c]=Ou.limitDimsByArea(o),l=sa(s,a,r),u=sa(s,c,r);return t>l&&(e.zoomX/=t/l,e.width=l,e.capped=!0),n>u&&(e.zoomY/=n/u,e.height=u,e.capped=!0),e}_getCacheCanvasDimensions(){let e=this.getTotalObjectScaling(),t=this._getTransformedDimensions({skewX:0,skewY:0}),n=t.x*e.x/this.scaleX,r=t.y*e.y/this.scaleY;return{width:n+2,height:r+2,zoomX:e.x,zoomY:e.y,x:n,y:r}}_updateCacheCanvas(){let e=this._cacheCanvas,t=this._cacheContext,n=this._limitCacheSize(this._getCacheCanvasDimensions()),r=_t.minCacheSideLimit,s=n.width,o=n.height,a=n.zoomX,c=n.zoomY,l=s!==this.cacheWidth||o!==this.cacheHeight,u=this.zoomX!==a||this.zoomY!==c;if(!e||!t)return!1;let h,d,f=l||u,x=0,g=0,p=!1;if(l){let m=this._cacheCanvas.width,v=this._cacheCanvas.height,E=s>m||o>v;p=E||(s<.9*m||o<.9*v)&&m>r&&v>r,E&&!n.capped&&(s>r||o>r)&&(x=.1*s,g=.1*o)}return lS(this)&&this.path&&(f=!0,p=!0,x+=this.getHeightOfLine(0)*this.zoomX,g+=this.getHeightOfLine(0)*this.zoomY),!!f&&(p?(e.width=Math.ceil(s+x),e.height=Math.ceil(o+g)):(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height)),h=n.x/2,d=n.y/2,this.cacheTranslationX=Math.round(e.width/2-h)+h,this.cacheTranslationY=Math.round(e.height/2-d)+d,this.cacheWidth=s,this.cacheHeight=o,t.translate(this.cacheTranslationX,this.cacheTranslationY),t.scale(a,c),this.zoomX=a,this.zoomY=c,!0)}setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(e)}transform(e){let t=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,n=this.calcTransformMatrix(!t);e.transform(n[0],n[1],n[2],n[3],n[4],n[5])}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=_t.NUM_FRACTION_DIGITS,n=this.clipPath&&!this.clipPath.excludeFromExport?U(U({},this.clipPath.toObject(e)),{},{inverted:this.clipPath.inverted,absolutePositioned:this.clipPath.absolutePositioned}):null,r=U(U({},aa(this,e)),{},{type:this.constructor.type,version:dE,originX:this.originX,originY:this.originY,left:xt(this.left,t),top:xt(this.top,t),width:xt(this.width,t),height:xt(this.height,t),fill:TD(this.fill)?this.fill.toObject():this.fill,stroke:TD(this.stroke)?this.stroke.toObject():this.stroke,strokeWidth:xt(this.strokeWidth,t),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:xt(this.strokeMiterLimit,t),scaleX:xt(this.scaleX,t),scaleY:xt(this.scaleY,t),angle:xt(this.angle,t),flipX:this.flipX,flipY:this.flipY,opacity:xt(this.opacity,t),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:xt(this.skewX,t),skewY:xt(this.skewY,t)},n?{clipPath:n}:null);return this.includeDefaultValues?r:this._removeDefaultValues(r)}toDatalessObject(e){return this.toObject(e)}_removeDefaultValues(e){let t=this.constructor.getDefaults(),n=Object.keys(t).length>0?t:Object.getPrototypeOf(this);return YE(e,(r,s)=>{if(s===Dt||s===Gn||s==="type")return!0;let o=n[s];return r!==o&&!(Array.isArray(r)&&Array.isArray(o)&&r.length===0&&o.length===0)})}toString(){return"#<".concat(this.constructor.type,">")}getObjectScaling(){if(!this.group)return new J(Math.abs(this.scaleX),Math.abs(this.scaleY));let e=tl(this.calcTransformMatrix());return new J(Math.abs(e.scaleX),Math.abs(e.scaleY))}getTotalObjectScaling(){let e=this.getObjectScaling();if(this.canvas){let t=this.canvas.getZoom(),n=this.getCanvasRetinaScaling();return e.scalarMultiply(t*n)}return e}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:e===0?1e-4:e}_set(e,t){e!=="scaleX"&&e!=="scaleY"||(t=this._constrainScale(t)),e==="scaleX"&&t<0?(this.flipX=!this.flipX,t*=-1):e==="scaleY"&&t<0?(this.flipY=!this.flipY,t*=-1):e!=="shadow"||!t||t instanceof ia||(t=new ia(t));let n=this[e]!==t;return this[e]=t,n&&this.constructor.cacheProperties.includes(e)&&(this.dirty=!0),this.parent&&(this.dirty||n&&this.constructor.stateProperties.includes(e))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e),this.dirty=!1),e.restore())}drawSelectionBackground(e){}renderCache(e){e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext&&(this.drawObject(this._cacheContext,e.forClipping),this.dirty=!1)}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.parent||!this.parent.isOnACache()),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(e,t){if(e.save(),t.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",t.absolutePositioned){let n=gi(this.calcTransformMatrix());e.transform(n[0],n[1],n[2],n[3],n[4],n[5])}t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore()}drawObject(e,t){let n=this.fill,r=this.stroke;t?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath),this.fill=n,this.stroke=r}_drawClipPath(e,t){t&&(t._set("canvas",this.canvas),t.shouldCache(),t._transformDone=!0,t.renderCache({forClipping:!0}),this.drawClipPathOnCache(e,t))}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!e&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned){if(this._cacheCanvas&&this._cacheContext&&!e){let t=this.cacheWidth/this.zoomX,n=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-t/2,-n/2,t,n)}return!0}return!1}_renderBackground(e){if(!this.backgroundColor)return;let t=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),this._removeShadow(e)}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity}_setStrokeStyles(e,t){let n=t.stroke;n&&(e.lineWidth=t.strokeWidth,e.lineCap=t.strokeLineCap,e.lineDashOffset=t.strokeDashOffset,e.lineJoin=t.strokeLineJoin,e.miterLimit=t.strokeMiterLimit,ki(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?this._applyPatternForTransformedGradient(e,n):(e.strokeStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.strokeStyle=t.stroke)}_setFillStyles(e,t){let{fill:n}=t;n&&(ki(n)?(e.fillStyle=n.toLive(e),this._applyPatternGradientTransform(e,n)):e.fillStyle=n)}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"}_setLineDash(e,t){t&&t.length!==0&&(1&t.length&&t.push(...t),e.setLineDash(t))}_setShadow(e){if(!this.shadow)return;let t=this.shadow,n=this.canvas,r=this.getCanvasRetinaScaling(),[s,,,o]=n?.viewportTransform||Jn,a=s*r,c=o*r,l=t.nonScaling?new J(1,1):this.getObjectScaling();e.shadowColor=t.color,e.shadowBlur=t.blur*_t.browserShadowBlurConstant*(a+c)*(l.x+l.y)/4,e.shadowOffsetX=t.offsetX*a*l.x,e.shadowOffsetY=t.offsetY*c*l.y}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)}_applyPatternGradientTransform(e,t){if(!ki(t))return{offsetX:0,offsetY:0};let n=t.gradientTransform||t.patternTransform,r=-this.width/2+t.offsetX||0,s=-this.height/2+t.offsetY||0;return t.gradientUnits==="percentage"?e.transform(this.width,0,0,this.height,r,s):e.transform(1,0,0,1,r,s),n&&e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),{offsetX:r,offsetY:s}}_renderPaintInOrder(e){this.paintFirst==="stroke"?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),this.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}_renderStroke(e){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){let t=this.getObjectScaling();e.scale(1/t.x,1/t.y)}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}}_applyPatternForTransformedGradient(e,t){var n;let r=this._limitCacheSize(this._getCacheCanvasDimensions()),s=ln(),o=this.getCanvasRetinaScaling(),a=r.x/this.scaleX/o,c=r.y/this.scaleY/o;s.width=Math.ceil(a),s.height=Math.ceil(c);let l=s.getContext("2d");l&&(l.beginPath(),l.moveTo(0,0),l.lineTo(a,0),l.lineTo(a,c),l.lineTo(0,c),l.closePath(),l.translate(a/2,c/2),l.scale(r.zoomX/this.scaleX/o,r.zoomY/this.scaleY/o),this._applyPatternGradientTransform(l,t),l.fillStyle=t.toLive(e),l.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(o*this.scaleX/r.zoomX,o*this.scaleY/r.zoomY),e.strokeStyle=(n=l.createPattern(s,"no-repeat"))!==null&&n!==void 0?n:"")}_findCenterFromElement(){return new J(this.left+this.width/2,this.top+this.height/2)}clone(e){let t=this.toObject(e);return this.constructor.fromObject(t)}cloneAsImage(e){let t=this.toCanvasElement(e);return new(_e.getClass("image"))(t)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=ZE(this),n=this.group,r=this.shadow,s=Math.abs,o=e.enableRetinaScaling?tS():1,a=(e.multiplier||1)*o,c=e.canvasProvider||(v=>new Gu(v,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,e.withoutTransform&&xS(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&gE(this,this.getViewportTransform()),this.setCoords();let l=ln(),u=this.getBoundingRect(),h=this.shadow,d=new J;if(h){let v=h.blur,E=h.nonScaling?new J(1,1):this.getObjectScaling();d.x=2*Math.round(s(h.offsetX)+v)*s(E.x),d.y=2*Math.round(s(h.offsetY)+v)*s(E.y)}let f=u.width+d.x,x=u.height+d.y;l.width=Math.ceil(f),l.height=Math.ceil(x);let g=c(l);e.format==="jpeg"&&(g.backgroundColor="#fff"),this.setPositionByOrigin(new J(g.width/2,g.height/2),lt,lt);let p=this.canvas;g._objects=[this],this.set("canvas",g),this.setCoords();let m=g.toCanvasElement(a||1,e);return this.set("canvas",p),this.shadow=r,n&&(this.group=n),this.set(t),this.setCoords(),g._objects=[],g.destroy(),m}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return $E(this.toCanvasElement(e),e.format||"png",e.quality||1)}isType(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.includes(this.constructor.type)||t.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(e){let{centeredRotation:t,originX:n,originY:r}=this;if(t){let{x:s,y:o}=this.getRelativeCenterPoint();this.originX=lt,this.originY=lt,this.left=s,this.top=o}if(this.set("angle",e),t){let{x:s,y:o}=this.translateToOriginPoint(this.getRelativeCenterPoint(),n,r);this.left=s,this.top=o,this.originX=n,this.originY=r}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}dispose(){m0.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&Or().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}static _fromObject(e){let t=Pt(e,N7),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:r}=n,s=Pt(n,L7);return Yu(Ku(t),s).then(o=>{let a=U(U({},s),o);if(r){let{[r]:c}=a;return new this(c,Pt(a,[r].map(eS)))}return new this(a)})}static fromObject(e,t){return this._fromObject(e,t)}};V(Zo,"stateProperties",O7),V(Zo,"cacheProperties",hs),V(Zo,"ownDefaults",k7),V(Zo,"type","FabricObject"),_e.setClass(Zo),_e.setClass(Zo,"object");var Qs=(i,e)=>(t,n,r,s)=>{let o=e(t,n,r,s);return o&&gS(i,ES(t,n,r,s)),o};function ca(i){return(e,t,n,r)=>{let{target:s,originX:o,originY:a}=t,c=s.getRelativeCenterPoint(),l=s.translateToOriginPoint(c,o,a),u=i(e,t,n,r);return s.setPositionByOrigin(l,t.originX,t.originY),u}}var DE=Qs("resizing",ca((i,e,t,n)=>{let r=H0(e,e.originX,e.originY,t,n);if(e.originX===lt||e.originX===cn&&r.x<0||e.originX===Dt&&r.x>0){let{target:s}=e,o=s.strokeWidth/(s.strokeUniform?s.scaleX:1),a=vS(e)?2:1,c=s.width,l=Math.ceil(Math.abs(r.x*a/s.scaleX)-o);return s.set("width",Math.max(l,0)),c!==s.width}return!1}));function MS(i,e,t,n,r){n=n||{};let s=this.sizeX||n.cornerSize||r.cornerSize,o=this.sizeY||n.cornerSize||r.cornerSize,a=n.transparentCorners!==void 0?n.transparentCorners:r.transparentCorners,c=a?"stroke":"fill",l=!a&&(n.cornerStrokeColor||r.cornerStrokeColor),u,h=e,d=t;i.save(),i.fillStyle=n.cornerColor||r.cornerColor||"",i.strokeStyle=n.cornerStrokeColor||r.cornerStrokeColor||"",s>o?(u=s,i.scale(1,o/s),d=t*s/o):o>s?(u=o,i.scale(s/o,1),h=e*o/s):u=s,i.lineWidth=1,i.beginPath(),i.arc(h,d,u/2,0,us,!1),i[c](),l&&i.stroke(),i.restore()}function TS(i,e,t,n,r){n=n||{};let s=this.sizeX||n.cornerSize||r.cornerSize,o=this.sizeY||n.cornerSize||r.cornerSize,a=n.transparentCorners!==void 0?n.transparentCorners:r.transparentCorners,c=a?"stroke":"fill",l=!a&&(n.cornerStrokeColor||r.cornerStrokeColor),u=s/2,h=o/2;i.save(),i.fillStyle=n.cornerColor||r.cornerColor||"",i.strokeStyle=n.cornerStrokeColor||r.cornerStrokeColor||"",i.lineWidth=1,i.translate(e,t);let d=r.getTotalAngle();i.rotate(rn(d)),i["".concat(c,"Rect")](-u,-h,s,o),l&&i.strokeRect(-u,-h,s,o),i.restore()}var Hn=class{constructor(e){V(this,"visible",!0),V(this,"actionName","scale"),V(this,"angle",0),V(this,"x",0),V(this,"y",0),V(this,"offsetX",0),V(this,"offsetY",0),V(this,"sizeX",0),V(this,"sizeY",0),V(this,"touchSizeX",0),V(this,"touchSizeY",0),V(this,"cursorStyle","crosshair"),V(this,"withConnection",!1),Object.assign(this,e)}shouldActivate(e,t,n,r){var s;let{tl:o,tr:a,br:c,bl:l}=r;return((s=t.canvas)===null||s===void 0?void 0:s.getActiveObject())===t&&t.isControlVisible(e)&&na.isPointInPolygon(n,[o,a,c,l])}getActionHandler(e,t,n){return this.actionHandler}getMouseDownHandler(e,t,n){return this.mouseDownHandler}getMouseUpHandler(e,t,n){return this.mouseUpHandler}cursorStyleHandler(e,t,n){return t.cursorStyle}getActionName(e,t,n){return t.actionName}getVisibility(e,t){var n,r;return(n=(r=e._controlsVisibility)===null||r===void 0?void 0:r[t])!==null&&n!==void 0?n:this.visible}setVisibility(e,t,n){this.visible=e}positionHandler(e,t,n,r){return new J(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(t)}calcCornerCoords(e,t,n,r,s,o){let a=ol([al(n,r),cl({angle:e}),V0((s?this.touchSizeX:this.sizeX)||t,(s?this.touchSizeY:this.sizeY)||t)]);return{tl:new J(-.5,-.5).transform(a),tr:new J(.5,-.5).transform(a),bl:new J(-.5,.5).transform(a),br:new J(.5,.5).transform(a)}}render(e,t,n,r,s){((r=r||{}).cornerStyle||s.cornerStyle)==="circle"?MS.call(this,e,t,n,r,s):TS.call(this,e,t,n,r,s)}},FS=(i,e,t)=>t.lockRotation?y0:e.cursorStyle,BS=Qs("rotating",ca((i,e,t,n)=>{let{target:r,ex:s,ey:o,theta:a,originX:c,originY:l}=e,u=r.translateToOriginPoint(r.getRelativeCenterPoint(),c,l);if(cr(r,"lockRotation"))return!1;let h=Math.atan2(o-u.y,s-u.x),d=Math.atan2(n-u.y,t-u.x),f=ra(d-h+a);if(r.snapAngle&&r.snapAngle>0){let g=r.snapAngle,p=r.snapThreshold||g,m=Math.ceil(f/g)*g,v=Math.floor(f/g)*g;Math.abs(f-v)<p?f=v:Math.abs(f-m)<p&&(f=m)}f<0&&(f=360+f),f%=360;let x=r.angle!==f;return r.angle=f,x}));function IS(i,e){let t=e.canvas,n=i[t.uniScaleKey];return t.uniformScaling&&!n||!t.uniformScaling&&n}function PS(i,e,t){let n=cr(i,"lockScalingX"),r=cr(i,"lockScalingY");if(n&&r||!e&&(n||r)&&t||n&&e==="x"||r&&e==="y")return!0;let{width:s,height:o,strokeWidth:a}=i;return s===0&&a===0&&e!=="y"||o===0&&a===0&&e!=="x"}var U7=["e","se","s","sw","w","nw","n","ne","e"],Ic=(i,e,t)=>{let n=IS(i,t);if(PS(t,e.x!==0&&e.y===0?"x":e.x===0&&e.y!==0?"y":"",n))return y0;let r=yS(t,e);return"".concat(U7[r],"-resize")};function ey(i,e,t,n){let r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},s=e.target,o=r.by,a=IS(i,s),c,l,u,h,d,f;if(PS(s,o,a))return!1;if(e.gestureScale)l=e.scaleX*e.gestureScale,u=e.scaleY*e.gestureScale;else{if(c=H0(e,e.originX,e.originY,t,n),d=o!=="y"?Math.sign(c.x||e.signX||1):1,f=o!=="x"?Math.sign(c.y||e.signY||1):1,e.signX||(e.signX=d),e.signY||(e.signY=f),cr(s,"lockScalingFlip")&&(e.signX!==d||e.signY!==f))return!1;if(h=s._getTransformedDimensions(),a&&!o){let p=Math.abs(c.x)+Math.abs(c.y),{original:m}=e,v=p/(Math.abs(h.x*m.scaleX/s.scaleX)+Math.abs(h.y*m.scaleY/s.scaleY));l=m.scaleX*v,u=m.scaleY*v}else l=Math.abs(c.x*s.scaleX/h.x),u=Math.abs(c.y*s.scaleY/h.y);vS(e)&&(l*=2,u*=2),e.signX!==d&&o!=="y"&&(e.originX=ID(e.originX),l*=-1,e.signX=d),e.signY!==f&&o!=="x"&&(e.originY=ID(e.originY),u*=-1,e.signY=f)}let x=s.scaleX,g=s.scaleY;return o?(o==="x"&&s.set("scaleX",l),o==="y"&&s.set("scaleY",u)):(!cr(s,"lockScalingX")&&s.set("scaleX",l),!cr(s,"lockScalingY")&&s.set("scaleY",u)),x!==s.scaleX||g!==s.scaleY}var Pu=Qs("scaling",ca((i,e,t,n)=>ey(i,e,t,n))),RS=Qs("scaling",ca((i,e,t,n)=>ey(i,e,t,n,{by:"x"}))),OS=Qs("scaling",ca((i,e,t,n)=>ey(i,e,t,n,{by:"y"}))),V7=["target","ex","ey","skewingSide"],rE={x:{counterAxis:"y",scale:"scaleX",skew:"skewX",lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:"scaleY",skew:"skewY",lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},z7=["ns","nesw","ew","nwse"],kS=(i,e,t)=>{if(e.x!==0&&cr(t,"lockSkewingY")||e.y!==0&&cr(t,"lockSkewingX"))return y0;let n=yS(t,e)%4;return"".concat(z7[n],"-resize")};function NS(i,e,t,n,r){let{target:s}=t,{counterAxis:o,origin:a,lockSkewing:c,skew:l,flip:u}=rE[i];if(cr(s,c))return!1;let{origin:h,flip:d}=rE[o],f=Ws(t[h])*(s[d]?-1:1),x=-Math.sign(f)*(s[u]?-1:1),g=.5*-((s[l]===0&&H0(t,lt,lt,n,r)[i]>0||s[l]>0?1:-1)*x)+.5;return Qs("skewing",ca((m,v,E,y)=>function(w,A,b){let{target:D,ex:C,ey:_,skewingSide:M}=A,B=Pt(A,V7),{skew:F}=rE[w],N=b.subtract(new J(C,_)).divide(new J(D.scaleX,D.scaleY))[w],L=D[F],Z=B[F],Q=Math.tan(rn(Z)),j=w==="y"?D._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:D._getTransformedDimensions({scaleX:1,scaleY:1}).y,W=2*N*M/Math.max(j,1)+Q,ie=ra(Math.atan(W));D.set(F,ie);let ue=L!==D[F];if(ue&&w==="y"){let{skewX:de,scaleX:$e}=D,X=D._getTransformedDimensions({skewY:L}),O=D._getTransformedDimensions(),z=de!==0?X.x/O.x:1;z!==1&&D.set("scaleX",z*$e)}return ue}(i,v,new J(E,y))))(e,U(U({},t),{},{[a]:g,skewingSide:x}),n,r)}var LS=(i,e,t,n)=>NS("x",i,e,t,n),US=(i,e,t,n)=>NS("y",i,e,t,n);function W0(i,e){return i[e.canvas.altActionKey]}var Ru=(i,e,t)=>{let n=W0(i,t);return e.x===0?n?"skewX":"scaleY":e.y===0?n?"skewY":"scaleX":""},Qo=(i,e,t)=>W0(i,t)?kS(0,e,t):Ic(i,e,t),SE=(i,e,t,n)=>W0(i,e.target)?US(i,e,t,n):RS(i,e,t,n),ME=(i,e,t,n)=>W0(i,e.target)?LS(i,e,t,n):OS(i,e,t,n),ty=()=>({ml:new Hn({x:-.5,y:0,cursorStyleHandler:Qo,actionHandler:SE,getActionName:Ru}),mr:new Hn({x:.5,y:0,cursorStyleHandler:Qo,actionHandler:SE,getActionName:Ru}),mb:new Hn({x:0,y:.5,cursorStyleHandler:Qo,actionHandler:ME,getActionName:Ru}),mt:new Hn({x:0,y:-.5,cursorStyleHandler:Qo,actionHandler:ME,getActionName:Ru}),tl:new Hn({x:-.5,y:-.5,cursorStyleHandler:Ic,actionHandler:Pu}),tr:new Hn({x:.5,y:-.5,cursorStyleHandler:Ic,actionHandler:Pu}),bl:new Hn({x:-.5,y:.5,cursorStyleHandler:Ic,actionHandler:Pu}),br:new Hn({x:.5,y:.5,cursorStyleHandler:Ic,actionHandler:Pu}),mtr:new Hn({x:0,y:-.5,actionHandler:BS,cursorStyleHandler:FS,offsetY:-40,withConnection:!0,actionName:"rotate"})}),VS=()=>({mr:new Hn({x:.5,y:0,actionHandler:DE,cursorStyleHandler:Qo,actionName:"resizing"}),ml:new Hn({x:-.5,y:0,actionHandler:DE,cursorStyleHandler:Qo,actionName:"resizing"})}),zS=()=>U(U({},ty()),VS()),D0=class i extends Zo{static getDefaults(){return U(U({},super.getDefaults()),{},{controls:ty()},i.ownDefaults)}_updateCacheCanvas(){let e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){let t=e._currentTransform,n=t.target,r=t.action;if(this===n&&r&&r.startsWith("scale"))return!1}return super._updateCacheCanvas()}getActiveControl(){let e=this.__corner;return e?{key:e,control:this.controls[e],coord:this.oCoords[e]}:void 0}findControl(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;let n=Object.entries(this.oCoords);for(let r=n.length-1;r>=0;r--){let[s,o]=n[r],a=this.controls[s];if(a.shouldActivate(s,this,e,t?o.touchCorner:o.corner))return this.__corner=s,{key:s,control:a,coord:this.oCoords[s]}}}calcOCoords(){let e=this.getViewportTransform(),t=this.getCenterPoint(),n=al(t.x,t.y),r=cl({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),s=Pn(n,r),o=Pn(e,s),a=Pn(o,[1/e[0],0,0,1/e[3],0,0]),c=this.group?tl(this.calcTransformMatrix()):void 0,l=this._calculateCurrentDimensions(c),u={};return this.forEachControl((h,d)=>{let f=h.positionHandler(l,a,this,h);u[d]=Object.assign(f,this._calcCornerCoords(h,f))}),u}_calcCornerCoords(e,t){let n=this.getTotalAngle();return{corner:e.calcCornerCoords(n,this.cornerSize,t.x,t.y,!1,this),touchCorner:e.calcCornerCoords(n,this.touchCornerSize,t.x,t.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(e){for(let t in this.controls)e(this.controls[t],t,this)}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();let t=this.getRelativeCenterPoint(),n=this._calculateCurrentDimensions(),r=this.getViewportTransform();e.translate(t.x,t.y),e.scale(1/r[0],1/r[3]),e.rotate(rn(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-n.x/2,-n.y/2,n.x,n.y),e.restore()}strokeBorders(e,t){e.strokeRect(-t.x/2,-t.y/2,t.x,t.y)}_drawBorders(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=U({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},n);e.save(),e.strokeStyle=r.borderColor,this._setLineDash(e,r.borderDashArray),this.strokeBorders(e,t),r.hasControls&&this.drawControlsConnectingLines(e,t),e.restore()}_renderControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{hasBorders:n,hasControls:r}=this,s=U({hasBorders:n,hasControls:r},t),o=this.getViewportTransform(),a=s.hasBorders,c=s.hasControls,l=Pn(o,this.calcTransformMatrix()),u=tl(l);e.save(),e.translate(u.translateX,u.translateY),e.lineWidth=1*this.borderScaleFactor,this.group===this.parent&&(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(u.angle-=180),e.rotate(rn(this.group?u.angle:this.angle)),a&&this.drawBorders(e,u,t),c&&this.drawControls(e,t),e.restore()}drawBorders(e,t,n){let r;if(n&&n.forActiveSelection||this.group){let s=z0(this.width,this.height,qu(t)),o=this.isStrokeAccountedForInDimensions()?WE:(this.strokeUniform?new J().scalarAdd(this.canvas?this.canvas.getZoom():1):new J(t.scaleX,t.scaleY)).scalarMultiply(this.strokeWidth);r=s.add(o).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else r=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,r,n)}drawControlsConnectingLines(e,t){let n=!1;e.beginPath(),this.forEachControl((r,s)=>{r.withConnection&&r.getVisibility(this,s)&&(n=!0,e.moveTo(r.x*t.x,r.y*t.y),e.lineTo(r.x*t.x+r.offsetX,r.y*t.y+r.offsetY))}),n&&e.stroke()}drawControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.save();let n=this.getCanvasRetinaScaling(),{cornerStrokeColor:r,cornerDashArray:s,cornerColor:o}=this,a=U({cornerStrokeColor:r,cornerDashArray:s,cornerColor:o},t);e.setTransform(n,0,0,n,0,0),e.strokeStyle=e.fillStyle=a.cornerColor,this.transparentCorners||(e.strokeStyle=a.cornerStrokeColor),this._setLineDash(e,a.cornerDashArray),this.setCoords(),this.forEachControl((c,l)=>{if(c.getVisibility(this,l)){let u=this.oCoords[l];c.render(e,u.x,u.y,a,this)}}),e.restore()}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)}setControlVisible(e,t){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=t}setControlsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(e).forEach(t=>{let[n,r]=t;return this.setControlVisible(n,r)})}clearContextTop(e){if(!this.canvas)return;let t=this.canvas.contextTop;if(!t)return;let n=this.canvas.viewportTransform;t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this.transform(t);let r=this.width+4,s=this.height+4;return t.clearRect(-r/2,-s/2,r,s),e||t.restore(),t}onDeselect(e){return!1}onSelect(e){return!1}shouldStartDragging(){return!1}onDragStart(e){return!1}canDrop(e){return!1}renderDragSourceEffect(e){}renderDropTargetEffect(e){}};function HS(i,e){return e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(n=>{n!=="constructor"&&Object.defineProperty(i.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n)||Object.create(null))})}),i}V(D0,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});var un=class extends D0{};HS(un,[C0]),_e.setClass(un),_e.setClass(un,"object");var jS=(i,e,t,n)=>{let r=2*(n=Math.round(n))+1,{data:s}=i.getImageData(e-n,t-n,r,r);for(let o=3;o<s.length;o+=4)if(s[o]>0)return!1;return!0},S0=class{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new J(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new J(1/this.options.scaleX,1/this.options.scaleY):new J(1,1)}createSideVector(e,t){let n=_0(e,t);return this.options.strokeUniform?n.multiply(this.scale):n}projectOrthogonally(e,t,n){return this.applySkew(e.add(this.calcOrthogonalProjection(e,t,n)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(e){let t=new J(e);return t.y+=t.x*Math.tan(rn(this.options.skewY)),t.x+=t.y*Math.tan(rn(this.options.skewX)),t}scaleUnitVector(e,t){return e.multiply(this.strokeUniformScalar).scalarMultiply(t)}},H7=new J,M0=class i extends S0{static getOrthogonalRotationFactor(e,t){let n=t?w0(e,t):bS(e);return Math.abs(n)<Ks?-1:1}constructor(e,t,n,r){super(r),V(this,"AB",void 0),V(this,"AC",void 0),V(this,"alpha",void 0),V(this,"bisector",void 0),this.A=new J(e),this.B=new J(t),this.C=new J(n),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=w0(this.AB,this.AC),this.bisector=j0(JE(this.AB.eq(H7)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude,r=this.createSideVector(e,t),s=QE(r),o=i.getOrthogonalRotationFactor(s,this.bisector);return this.scaleUnitVector(s,n*o)}projectBevel(){let e=[];return(this.alpha%us==0?[this.B]:[this.B,this.C]).forEach(t=>{e.push(this.projectOrthogonally(this.A,t)),e.push(this.projectOrthogonally(this.A,t,-this.strokeProjectionMagnitude))}),e}projectMiter(){let e=[],t=Math.abs(this.alpha),n=1/Math.sin(t/2),r=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*n),s=this.options.strokeUniform?A0(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return A0(r)/this.strokeProjectionMagnitude<=s&&e.push(this.applySkew(this.A.add(r))),e.push(...this.projectBevel()),e}projectRoundNoSkew(e,t){let n=[],r=new J(i.getOrthogonalRotationFactor(this.bisector),i.getOrthogonalRotationFactor(new J(this.bisector.y,this.bisector.x)));return[new J(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(r),new J(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(r)].forEach(s=>{_E(s,e,t)&&n.push(this.A.add(s))}),n}projectRoundWithSkew(e,t){let n=[],{skewX:r,skewY:s,scaleX:o,scaleY:a,strokeUniform:c}=this.options,l=new J(Math.tan(rn(r)),Math.tan(rn(s))),u=this.strokeProjectionMagnitude,h=c?u/a/Math.sqrt(1/a**2+1/o**2*l.y**2):u/Math.sqrt(1+l.y**2),d=new J(Math.sqrt(Math.max(u**2-h**2,0)),h),f=c?u/Math.sqrt(1+l.x**2*(1/a)**2/(1/o+1/o*l.x*l.y)**2):u/Math.sqrt(1+l.x**2/(1+l.x*l.y)**2),x=new J(f,Math.sqrt(Math.max(u**2-f**2,0)));return[x,x.scalarMultiply(-1),d,d.scalarMultiply(-1)].map(g=>this.applySkew(c?g.multiply(this.strokeUniformScalar):g)).forEach(g=>{_E(g,e,t)&&n.push(this.applySkew(this.A).add(g))}),n}projectRound(){let e=[];e.push(...this.projectBevel());let t=this.alpha%us==0,n=this.applySkew(this.A),r=e[t?0:2].subtract(n),s=e[t?1:0].subtract(n),o=t?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),a=Lc(r,o)>0,c=a?r:s,l=a?s:r;return this.isSkewed()?e.push(...this.projectRoundWithSkew(c,l)):e.push(...this.projectRoundNoSkew(c,l)),e}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector}))}},T0=class extends S0{constructor(e,t,n){super(n),this.A=new J(e),this.T=new J(t)}calcOrthogonalProjection(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude,r=this.createSideVector(e,t);return this.scaleUnitVector(QE(r),n)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){let e=[];if(!this.isSkewed()&&this.A.eq(this.T)){let t=new J(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(t)),this.applySkew(this.A.subtract(t)))}else e.push(...new M0(this.A,this.T,this.T,this.options).projectRound());return e}projectSquare(){let e=[];if(this.A.eq(this.T)){let t=new J(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(t),this.A.subtract(t))}else{let t=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),n=this.scaleUnitVector(j0(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),r=this.A.add(n);e.push(r.add(t),r.subtract(t))}return e.map(t=>this.applySkew(t))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e}))}},GS=function(i,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2],n=[];if(i.length===0)return n;let r=i.reduce((s,o)=>(s[s.length-1].eq(o)||s.push(new J(o)),s),[new J(i[0])]);if(r.length===1)t=!0;else if(!t){let s=r[0],o=((a,c)=>{for(let l=a.length-1;l>=0;l--)if(c(a[l],l,a))return l;return-1})(r,a=>!a.eq(s));r.splice(o+1)}return r.forEach((s,o,a)=>{let c,l;o===0?(l=a[1],c=t?s:a[a.length-1]):o===a.length-1?(c=a[o-1],l=t?s:a[0]):(c=a[o-1],l=a[o+1]),t&&a.length===1?n.push(...new T0(s,s,e).project()):!t||o!==0&&o!==a.length-1?n.push(...new M0(s,c,l,e).project()):n.push(...new T0(s,o===0?l:c,e).project())}),n},WS=i=>i.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),$0=i=>{let e=[];for(let t,n=0;n<i.length;n++)(t=j7(i,n))!==!1&&e.push(t);return e},j7=(i,e)=>{let t=i.charCodeAt(e);if(isNaN(t))return"";if(t<55296||t>57343)return i.charAt(e);if(55296<=t&&t<=56319){if(i.length<=e+1)throw"High surrogate without following low surrogate";let r=i.charCodeAt(e+1);if(56320>r||r>57343)throw"High surrogate without following low surrogate";return i.charAt(e)+i.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";let n=i.charCodeAt(e-1);if(55296>n||n>56319)throw"Low surrogate without preceding high surrogate";return!1},G7=Object.freeze({__proto__:null,capitalize:function(i){let e=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return"".concat(i.charAt(0).toUpperCase()).concat(e?i.slice(1):i.slice(1).toLowerCase())},escapeXml:WS,graphemeSplit:$0}),X0=function(i,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return i.fill!==e.fill||i.stroke!==e.stroke||i.strokeWidth!==e.strokeWidth||i.fontSize!==e.fontSize||i.fontFamily!==e.fontFamily||i.fontWeight!==e.fontWeight||i.fontStyle!==e.fontStyle||i.textBackgroundColor!==e.textBackgroundColor||i.deltaY!==e.deltaY||t&&(i.overline!==e.overline||i.underline!==e.underline||i.linethrough!==e.linethrough)},$S=(i,e)=>{let t=e.split(`
`),n=[],r=-1,s={};i=Ku(i);for(let o=0;o<t.length;o++){let a=$0(t[o]);if(i[o])for(let c=0;c<a.length;c++){r++;let l=i[o][c];l&&Object.keys(l).length>0&&(X0(s,l,!0)?n.push({start:r,end:r+1,style:l}):n[n.length-1].end++),s=l||{}}else r+=a.length,s={}}return n},XS=(i,e)=>{if(!Array.isArray(i))return Ku(i);let t=e.split(GE),n={},r=-1,s=0;for(let o=0;o<t.length;o++){let a=$0(t[o]);for(let c=0;c<a.length;c++)r++,i[s]&&i[s].start<=r&&r<i[s].end&&(n[o]=n[o]||{},n[o][c]=U({},i[s].style),r===i[s].end-1&&s++)}return n},eo=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function UD(i,e){let t=i.nodeName,n=i.getAttribute("class"),r=i.getAttribute("id"),s="(?![a-zA-Z\\-]+)",o;if(o=new RegExp("^"+t,"i"),e=e.replace(o,""),r&&e.length&&(o=new RegExp("#"+r+s,"i"),e=e.replace(o,"")),n&&e.length){let a=n.split(" ");for(let c=a.length;c--;)o=new RegExp("\\."+a[c]+s,"i"),e=e.replace(o,"")}return e.length===0}function W7(i,e){let t=!0,n=UD(i,e.pop());return n&&e.length&&(t=function(r,s){let o,a=!0;for(;r.parentElement&&r.parentElement.nodeType===1&&s.length;)a&&(o=s.pop()),a=UD(r=r.parentElement,o);return s.length===0}(i,e)),n&&t&&e.length===0}var $7=i=>{var e;return(e=R7[i])!==null&&e!==void 0?e:i},qS=i=>i.replace(new RegExp("(".concat(Pr,")"),"gi")," $1 ").replace(/,/gi," ").replace(/\s+/gi," "),VD,zD,HD,jD,GD,WD,$D,Kn="(".concat(Pr,")"),X7=String.raw(VD||(VD=Nr(["(skewX)(",")"],["(skewX)\\(","\\)"])),Kn),q7=String.raw(zD||(zD=Nr(["(skewY)(",")"],["(skewY)\\(","\\)"])),Kn),Y7=String.raw(HD||(HD=Nr(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),Kn,Kn,Kn),Z7=String.raw(jD||(jD=Nr(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),Kn,Kn),K7=String.raw(GD||(GD=Nr(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),Kn,Kn),J7=String.raw(WD||(WD=Nr(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),Kn,Kn,Kn,Kn,Kn,Kn),ny="(?:".concat(J7,"|").concat(K7,"|").concat(Y7,"|").concat(Z7,"|").concat(X7,"|").concat(q7,")"),Q7="(?:".concat(ny,"*)"),eN=String.raw($D||($D=Nr(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),Q7),tN=new RegExp(eN),nN=new RegExp(ny,"g");function TE(i){let e=[];if(!(i=qS(i).replace(/\s*([()])\s*/gi,"$1"))||i&&!tN.test(i))return[...Jn];for(let t of i.matchAll(nN)){let n=new RegExp(ny).exec(t[0]);if(!n)continue;let r=Jn,s=n.filter(x=>!!x),[,o,...a]=s,[c,l,u,h,d,f]=a.map(x=>parseFloat(x));switch(o){case"translate":r=al(c,l);break;case"rotate":r=cl({angle:c},{x:l,y:u});break;case"scale":r=V0(c,l);break;case"skewX":r=XE(c);break;case"skewY":r=qE(c);break;case"matrix":r=[c,l,u,h,d,f]}e.push(r)}return ol(e)}function iN(i,e,t,n){let r=Array.isArray(e),s,o=e;if(i!=="fill"&&i!=="stroke"||e!==si){if(i==="strokeUniform")return e==="non-scaling-stroke";if(i==="strokeDashArray")o=e===si?null:e.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(i==="transformMatrix")o=t&&t.transformMatrix?Pn(t.transformMatrix,TE(e)):TE(e);else if(i==="visible")o=e!==si&&e!=="hidden",t&&t.visible===!1&&(o=!1);else if(i==="opacity")o=parseFloat(e),t&&t.opacity!==void 0&&(o*=t.opacity);else if(i==="textAnchor")o=e==="start"?Dt:e==="end"?cn:lt;else if(i==="charSpacing")s=ta(e,n)/n*1e3;else if(i==="paintFirst"){let a=e.indexOf("fill"),c=e.indexOf("stroke");o="fill",(a>-1&&c>-1&&c<a||a===-1&&c>-1)&&(o="stroke")}else{if(i==="href"||i==="xlink:href"||i==="font")return e;if(i==="imageSmoothing")return e==="optimizeQuality";s=r?e.map(ta):ta(e,n)}}else o="";return!r&&isNaN(s)?o:s}function rN(i,e){let t=i.match(P7);if(!t)return;let n=t[1],r=t[3],s=t[4],o=t[5],a=t[6];n&&(e.fontStyle=n),r&&(e.fontWeight=isNaN(parseFloat(r))?r:parseFloat(r)),s&&(e.fontSize=ta(s)),a&&(e.fontFamily=a),o&&(e.lineHeight=o==="normal"?1:o)}function sN(i){let e={},t=i.getAttribute("style");return t&&(typeof t=="string"?function(n,r){n.replace(/;\s*$/,"").split(";").forEach(s=>{let[o,a]=s.split(":");r[o.trim().toLowerCase()]=a.trim()})}(t,e):function(n,r){Object.entries(n).forEach(s=>{let[o,a]=s;a!==void 0&&(r[o.toLowerCase()]=a)})}(t,e)),e}var oN={stroke:"strokeOpacity",fill:"fillOpacity"};function ds(i,e,t){if(!i)return{};let n,r={},s=jE;i.parentNode&&ND.test(i.parentNode.nodeName)&&(r=ds(i.parentElement,e,t),r.fontSize&&(n=s=ta(r.fontSize)));let o=U(U(U({},e.reduce((l,u)=>{let h=i.getAttribute(u);return h&&(l[u]=h),l},{})),function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h={};for(let d in u)W7(l,d.split(" "))&&(h=U(U({},h),u[d]));return h}(i,t)),sN(i));o[iE]&&i.setAttribute(iE,o[iE]),o[nE]&&(n=ta(o[nE],s),o[nE]="".concat(n));let a={};for(let l in o){let u=$7(l),h=iN(u,o[l],r,n);a[u]=h}a&&a.font&&rN(a.font,a);let c=U(U({},r),a);return ND.test(i.nodeName)?c:function(l){let u=un.getDefaults();return Object.entries(oN).forEach(h=>{let[d,f]=h;if(l[f]===void 0||l[d]==="")return;if(l[d]===void 0){if(!u[d])return;l[d]=u[d]}if(l[d].indexOf("url(")===0)return;let x=new Qn(l[d]);l[d]=x.setAlpha(xt(x.getAlpha()*l[f],2)).toRgba()}),l}(c)}var aN=["left","top","width","height","visible"],YS=["rx","ry"],as=class i extends un{static getDefaults(){return U(U({},super.getDefaults()),i.ownDefaults)}constructor(e){super(e),this._initRxRy()}_initRxRy(){let{rx:e,ry:t}=this;e&&!t?this.ry=e:t&&!e&&(this.rx=t)}_render(e){let{width:t,height:n}=this,r=-t/2,s=-n/2,o=this.rx?Math.min(this.rx,t/2):0,a=this.ry?Math.min(this.ry,n/2):0,c=o!==0||a!==0;e.beginPath(),e.moveTo(r+o,s),e.lineTo(r+t-o,s),c&&e.bezierCurveTo(r+t-zs*o,s,r+t,s+zs*a,r+t,s+a),e.lineTo(r+t,s+n-a),c&&e.bezierCurveTo(r+t,s+n-zs*a,r+t-zs*o,s+n,r+t-o,s+n),e.lineTo(r+o,s+n),c&&e.bezierCurveTo(r+zs*o,s+n,r,s+n-zs*a,r,s+n-a),e.lineTo(r,s+a),c&&e.bezierCurveTo(r,s+zs*a,r+zs*o,s,r+o,s),e.closePath(),this._renderPaintInOrder(e)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...YS,...e])}_toSVG(){let{width:e,height:t,rx:n,ry:r}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-e/2,'" y="').concat(-t/2,'" rx="').concat(n,'" ry="').concat(r,'" width="').concat(e,'" height="').concat(t,`" />
`)]}static fromElement(e,t,n){return He(this,null,function*(){let r=ds(e,this.ATTRIBUTE_NAMES,n),{left:s=0,top:o=0,width:a=0,height:c=0,visible:l=!0}=r,u=Pt(r,aN);return new this(U(U(U({},t),u),{},{left:s,top:o,width:a,height:c,visible:!!(l&&a&&c)}))})}};V(as,"type","Rect"),V(as,"cacheProperties",[...hs,...YS]),V(as,"ownDefaults",{rx:0,ry:0}),V(as,"ATTRIBUTE_NAMES",[...eo,"x","y","rx","ry","width","height"]),_e.setClass(as),_e.setSVGClass(as);var ls="initialization",F0="added",iy="removed",B0="imperative",ZS=(i,e)=>{let{strokeUniform:t,strokeWidth:n,width:r,height:s,group:o}=e,a=o&&o!==i?Zu(o.calcTransformMatrix(),i.calcTransformMatrix()):null,c=a?e.getRelativeCenterPoint().transform(a):e.getRelativeCenterPoint(),l=!e.isStrokeAccountedForInDimensions(),u=t&&l?mS(new J(n,n),void 0,i.calcTransformMatrix()):WE,h=!t&&l?n:0,d=z0(r+h,s+h,ol([a,e.calcOwnMatrix()],!0)).add(u).scalarDivide(2);return[c.subtract(d),c.add(d)]},rl=class{calcLayoutResult(e,t){if(this.shouldPerformLayout(e))return this.calcBoundingBox(t,e)}shouldPerformLayout(e){return e.type===ls||e.type===B0||!!e.prevStrategy&&e.strategy!==e.prevStrategy}shouldLayoutClipPath(e){let{type:t,target:{clipPath:n}}=e;return t!==ls&&n&&!n.absolutePositioned}getInitialSize(e,t){return t.size}calcBoundingBox(e,t){if(t.type===B0&&t.overrides)return t.overrides;if(e.length===0)return;let{target:n}=t,{left:r,top:s,width:o,height:a}=Rr(e.map(u=>ZS(n,u)).reduce((u,h)=>u.concat(h),[])),c=new J(o,a),l=new J(r,s).add(c.scalarDivide(2));if(t.type===ls){let u=this.getInitialSize(t,{size:c,center:l});return{center:l,relativeCorrection:new J(0,0),size:u}}return{center:l.transform(n.calcOwnMatrix()),size:c}}};V(rl,"type","strategy");var $u=class extends rl{shouldPerformLayout(e){return!0}};V($u,"type","fit-content"),_e.setClass($u);var cN=["strategy"],lN=["target","strategy","bubbles","prevStrategy"],KS="layoutManager",oa=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new $u;V(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map}performLayout(e){let t=U(U({bubbles:!0,strategy:this.strategy},e),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(t);let n=this.getLayoutResult(t);n&&this.commitLayout(t,n),this.onAfterLayout(t,n),this._prevLayoutStrategy=t.strategy}attachHandlers(e,t){let{target:n}=t;return["modified","moving","resizing","rotating","scaling","skewing","changed","modifyPoly"].map(r=>e.on(r,s=>this.performLayout(r==="modified"?{type:"object_modified",trigger:r,e:s,target:n}:{type:"object_modifying",trigger:r,e:s,target:n})))}subscribe(e,t){this.unsubscribe(e,t);let n=this.attachHandlers(e,t);this._subscriptions.set(e,n)}unsubscribe(e,t){(this._subscriptions.get(e)||[]).forEach(n=>n()),this._subscriptions.delete(e)}unsubscribeTargets(e){e.targets.forEach(t=>this.unsubscribe(t,e))}subscribeTargets(e){e.targets.forEach(t=>this.subscribe(t,e))}onBeforeLayout(e){let{target:t,type:n}=e,{canvas:r}=t;if(n===ls||n===F0?this.subscribeTargets(e):n===iy&&this.unsubscribeTargets(e),t.fire("layout:before",{context:e}),r&&r.fire("object:layout:before",{target:t,context:e}),n===B0&&e.deep){let s=Pt(e,cN);t.forEachObject(o=>o.layoutManager&&o.layoutManager.performLayout(U(U({},s),{},{bubbles:!1,target:o})))}}getLayoutResult(e){let{target:t}=e,n=e.strategy.calcLayoutResult(e,t.getObjects());if(!n)return;let r=e.type===ls?new J:t.getRelativeCenterPoint(),{center:s,correction:o=new J,relativeCorrection:a=new J}=n,c=r.subtract(s).add(o).transform(e.type===ls?Jn:gi(t.calcOwnMatrix()),!0).add(a);return{result:n,prevCenter:r,nextCenter:s,offset:c}}commitLayout(e,t){let{target:n}=e,{result:{size:r},nextCenter:s}=t;var o,a;n.set({width:r.x,height:r.y}),this.layoutObjects(e,t),e.type===ls?n.set({left:(o=e.x)!==null&&o!==void 0?o:s.x+r.x*Ws(n.originX),top:(a=e.y)!==null&&a!==void 0?a:s.y+r.y*Ws(n.originY)}):(n.setPositionByOrigin(s,lt,lt),n.setCoords(),n.set("dirty",!0))}layoutObjects(e,t){let{target:n}=e;n.forEachObject(r=>{r.group===n&&this.layoutObject(e,t,r)}),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,t,n.clipPath)}layoutObject(e,t,n){let{offset:r}=t;n.set({left:n.left+r.x,top:n.top+r.y})}onAfterLayout(e,t){let{target:n,strategy:r,bubbles:s,prevStrategy:o}=e,a=Pt(e,lN),{canvas:c}=n;n.fire("layout:after",{context:e,result:t}),c&&c.fire("object:layout:after",{context:e,result:t,target:n});let l=n.parent;s&&l!=null&&l.layoutManager&&((a.path||(a.path=[])).push(n),l.layoutManager.performLayout(U(U({},a),{},{target:l}))),n.set("dirty",!0)}dispose(){this._subscriptions.forEach(e=>e.forEach(t=>t())),this._subscriptions.clear()}toObject(){return{type:KS,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}};_e.setClass(oa,KS);var uN=["type","objects","layoutManager"],FE=class extends oa{performLayout(){}},qs=class i extends nS(un){static getDefaults(){return U(U({},super.getDefaults()),i.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(t),V(this,"_activeObjects",[]),V(this,"__objectSelectionTracker",void 0),V(this,"__objectSelectionDisposer",void 0),this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(n=>{this.enterGroup(n,!1)}),this.layoutManager=t.layoutManager||new oa,this.layoutManager.performLayout({type:ls,target:this,targets:[...e],x:t.left,y:t.top})}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(Zs("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(e)===-1||(Zs("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(e){return e.filter((t,n,r)=>this.canEnterGroup(t)&&r.indexOf(t)===n)}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];let r=this._filterObjectsBeforeEnteringGroup(t),s=super.add(...r);return this._onAfterObjectsChange(F0,r),s}insertAt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];let s=this._filterObjectsBeforeEnteringGroup(n),o=super.insertAt(e,...s);return this._onAfterObjectsChange(F0,s),o}remove(){let e=super.remove(...arguments);return this._onAfterObjectsChange(iy,e),e}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e,t){this.exitGroup(e,t),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onAfterObjectsChange(e,t){this.layoutManager.performLayout({type:e,targets:t,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(e,t){let n=this[e];return super._set(e,t),e==="canvas"&&n!==t&&(this._objects||[]).forEach(r=>{r._set(e,t)}),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(e,t){let{target:n}=t,r=this._activeObjects;if(e)r.push(n),this._set("dirty",!0);else if(r.length>0){let s=r.indexOf(n);s>-1&&(r.splice(s,1),this._set("dirty",!0))}}_watchObject(e,t){e&&this._watchObject(!1,t),e?(t.on("selected",this.__objectSelectionTracker),t.on("deselected",this.__objectSelectionDisposer)):(t.off("selected",this.__objectSelectionTracker),t.off("deselected",this.__objectSelectionDisposer))}enterGroup(e,t){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,t)}_enterGroup(e,t){t&&il(e,Pn(gi(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);let n=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();n&&(n===e||e.isDescendantOf(n))&&this._activeObjects.push(e)}exitGroup(e,t){this._exitGroup(e,t),e._set("parent",void 0),e._set("canvas",void 0)}_exitGroup(e,t){e._set("group",void 0),t||(il(e,Pn(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);let n=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;n>-1&&this._activeObjects.splice(n,1)}shouldCache(){let e=un.prototype.shouldCache.call(this);if(e){for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return this.ownCaching=!1,!1}return e}willDrawShadow(){if(super.willDrawShadow())return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(e){this._renderBackground(e);for(let n=0;n<this._objects.length;n++){var t;(t=this.canvas)!==null&&t!==void 0&&t.preserveObjectStacking&&this._objects[n].group!==this?(e.save(),e.transform(...gi(this.calcTransformMatrix())),this._objects[n].render(e),e.restore()):this._objects[n].group===this&&this._objects[n].render(e)}this._drawClipPath(e,this.clipPath)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(e=>e.setCoords())}triggerLayout(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(U({target:this,type:B0},e))}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1}__serializeObjects(e,t){let n=this.includeDefaultValues;return this._objects.filter(function(r){return!r.excludeFromExport}).map(function(r){let s=r.includeDefaultValues;r.includeDefaultValues=n;let o=r[e||"toObject"](t);return r.includeDefaultValues=s,o})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=this.layoutManager.toObject();return U(U(U({},super.toObject(["subTargetCheck","interactive",...e])),t.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:t}:{}),{},{objects:this.__serializeObjects("toObject",e)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject(e=>{this._watchObject(!1,e),e.dispose()}),super.dispose()}_createSVGBgRect(e){if(!this.backgroundColor)return"";let t=as.prototype._toSVG.call(this),n=t.indexOf("COMMON_PARTS");t[n]='for="group" ';let r=t.join("");return e?e(r):r}_toSVG(e){let t=["<g ","COMMON_PARTS",` >
`],n=this._createSVGBgRect(e);n&&t.push("		",n);for(let r=0;r<this._objects.length;r++)t.push("		",this._objects[r].toSVG(e));return t.push(`</g>
`),t}getSvgStyles(){let e=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",t=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),t].join("")}toClipPathSVG(e){let t=[],n=this._createSVGBgRect(e);n&&t.push("	",n);for(let r=0;r<this._objects.length;r++)t.push("	",this._objects[r].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(t,{reviver:e})}static fromObject(e){let{type:t,objects:n=[],layoutManager:r}=e,s=Pt(e,uN);return Promise.all([nl(n),Yu(s)]).then(o=>{let[a,c]=o,l=new this(a,U(U(U({},s),c),{},{layoutManager:new FE}));if(r){let u=_e.getClass(r.type),h=_e.getClass(r.strategy);l.layoutManager=new u(new h)}else l.layoutManager=new oa;return l.layoutManager.subscribeTargets({type:ls,target:l,targets:l.getObjects()}),l.setCoords(),l})}};V(qs,"type","Group"),V(qs,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),_e.setClass(qs);var JS=(i,e)=>Math.min(e.width/i.width,e.height/i.height),QS=(i,e)=>Math.max(e.width/i.width,e.height/i.height),XD,Vt="(".concat(Pr,")"),hN="(M) (?:".concat(Vt," ").concat(Vt," ?)+"),dN="(L) (?:".concat(Vt," ").concat(Vt," ?)+"),fN="(H) (?:".concat(Vt," ?)+"),pN="(V) (?:".concat(Vt," ?)+"),xN=String.raw(XD||(XD=Nr(["(Z)s*"],["(Z)\\s*"]))),mN="(C) (?:".concat(Vt," ").concat(Vt," ").concat(Vt," ").concat(Vt," ").concat(Vt," ").concat(Vt," ?)+"),gN="(S) (?:".concat(Vt," ").concat(Vt," ").concat(Vt," ").concat(Vt," ?)+"),vN="(Q) (?:".concat(Vt," ").concat(Vt," ").concat(Vt," ").concat(Vt," ?)+"),EN="(T) (?:".concat(Vt," ").concat(Vt," ?)+"),yN="(A) (?:".concat(Vt," ").concat(Vt," ").concat(Vt," ([01]) ?([01]) ").concat(Vt," ").concat(Vt," ?)+"),qD="(?:(?:".concat(hN,")")+"|(?:".concat(dN,")")+"|(?:".concat(fN,")")+"|(?:".concat(pN,")")+"|(?:".concat(xN,")")+"|(?:".concat(mN,")")+"|(?:".concat(gN,")")+"|(?:".concat(vN,")")+"|(?:".concat(EN,")")+"|(?:".concat(yN,"))"),CN={m:"l",M:"L"},_N=(i,e,t,n,r,s,o,a,c,l,u)=>{let h=lr(i),d=ur(i),f=lr(e),x=ur(e),g=t*r*f-n*s*x+o,p=n*r*f+t*s*x+a;return["C",l+c*(-t*r*d-n*s*h),u+c*(-n*r*d+t*s*h),g+c*(t*r*x+n*s*f),p+c*(n*r*x-t*s*f),g,p]},YD=(i,e,t,n)=>{let r=Math.atan2(e,i),s=Math.atan2(n,t);return s>=r?s-r:2*Math.PI-(r-s)};function BE(i,e,t,n,r,s,o,a){let c;if(_t.cachesBoundsOfCurve&&(c=[...arguments].join(),Ou.boundsOfCurveCache[c]))return Ou.boundsOfCurveCache[c];let l=Math.sqrt,u=Math.abs,h=[],d=[[0,0],[0,0]],f=6*i-12*t+6*r,x=-3*i+9*t-9*r+3*o,g=3*t-3*i;for(let y=0;y<2;++y){if(y>0&&(f=6*e-12*n+6*s,x=-3*e+9*n-9*s+3*a,g=3*n-3*e),u(x)<1e-12){if(u(f)<1e-12)continue;let C=-g/f;0<C&&C<1&&h.push(C);continue}let w=f*f-4*g*x;if(w<0)continue;let A=l(w),b=(-f+A)/(2*x);0<b&&b<1&&h.push(b);let D=(-f-A)/(2*x);0<D&&D<1&&h.push(D)}let p=h.length,m=p,v=tM(i,e,t,n,r,s,o,a);for(;p--;){let{x:y,y:w}=v(h[p]);d[0][p]=y,d[1][p]=w}d[0][m]=i,d[1][m]=e,d[0][m+1]=o,d[1][m+1]=a;let E=[new J(Math.min(...d[0]),Math.min(...d[1])),new J(Math.max(...d[0]),Math.max(...d[1]))];return _t.cachesBoundsOfCurve&&(Ou.boundsOfCurveCache[c]=E),E}var AN=(i,e,t)=>{let[n,r,s,o,a,c,l,u]=t,h=((d,f,x,g,p,m,v)=>{if(x===0||g===0)return[];let E=0,y=0,w=0,A=Math.PI,b=v*HE,D=ur(b),C=lr(b),_=.5*(-C*d-D*f),M=.5*(-C*f+D*d),B=x**2,F=g**2,N=M**2,L=_**2,Z=B*F-B*N-F*L,Q=Math.abs(x),j=Math.abs(g);if(Z<0){let P=Math.sqrt(1-Z/(B*F));Q*=P,j*=P}else w=(p===m?-1:1)*Math.sqrt(Z/(B*N+F*L));let W=w*Q*M/j,ie=-w*j*_/Q,ue=C*W-D*ie+.5*d,de=D*W+C*ie+.5*f,$e=YD(1,0,(_-W)/Q,(M-ie)/j),X=YD((_-W)/Q,(M-ie)/j,(-_-W)/Q,(-M-ie)/j);m===0&&X>0?X-=2*A:m===1&&X<0&&(X+=2*A);let O=Math.ceil(Math.abs(X/A*2)),z=new Array(O),R=X/O,K=8/3*Math.sin(R/4)*Math.sin(R/4)/Math.sin(R/2),$=$e+R;for(let P=0;P<O;P++)z[P]=_N($e,$,C,D,Q,j,ue,de,K,E,y),E=z[P][5],y=z[P][6],$e=$,$+=R;return z})(l-i,u-e,r,s,a,c,o);for(let d=0,f=h.length;d<f;d++)h[d][1]+=i,h[d][2]+=e,h[d][3]+=i,h[d][4]+=e,h[d][5]+=i,h[d][6]+=e;return h},eM=i=>{let e=0,t=0,n=0,r=0,s=[],o,a=0,c=0;for(let l of i){let u=[...l],h;switch(u[0]){case"l":u[1]+=e,u[2]+=t;case"L":e=u[1],t=u[2],h=["L",e,t];break;case"h":u[1]+=e;case"H":e=u[1],h=["L",e,t];break;case"v":u[1]+=t;case"V":t=u[1],h=["L",e,t];break;case"m":u[1]+=e,u[2]+=t;case"M":e=u[1],t=u[2],n=u[1],r=u[2],h=["M",e,t];break;case"c":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t,u[5]+=e,u[6]+=t;case"C":a=u[3],c=u[4],e=u[5],t=u[6],h=["C",u[1],u[2],a,c,e,t];break;case"s":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t;case"S":o==="C"?(a=2*e-a,c=2*t-c):(a=e,c=t),e=u[3],t=u[4],h=["C",a,c,u[1],u[2],e,t],a=h[3],c=h[4];break;case"q":u[1]+=e,u[2]+=t,u[3]+=e,u[4]+=t;case"Q":a=u[1],c=u[2],e=u[3],t=u[4],h=["Q",a,c,e,t];break;case"t":u[1]+=e,u[2]+=t;case"T":o==="Q"?(a=2*e-a,c=2*t-c):(a=e,c=t),e=u[1],t=u[2],h=["Q",a,c,e,t];break;case"a":u[6]+=e,u[7]+=t;case"A":AN(e,t,u).forEach(d=>s.push(d)),e=u[6],t=u[7];break;case"z":case"Z":e=n,t=r,h=["Z"]}h?(s.push(h),o=h[0]):o=""}return s},I0=(i,e,t,n)=>Math.sqrt((t-i)**2+(n-e)**2),tM=(i,e,t,n,r,s,o,a)=>c=>{let l=c**3,u=(f=>3*f**2*(1-f))(c),h=(f=>3*f*(1-f)**2)(c),d=(f=>(1-f)**3)(c);return new J(o*l+r*u+t*h+i*d,a*l+s*u+n*h+e*d)},nM=i=>i**2,iM=i=>2*i*(1-i),rM=i=>(1-i)**2,wN=(i,e,t,n,r,s,o,a)=>c=>{let l=nM(c),u=iM(c),h=rM(c),d=3*(h*(t-i)+u*(r-t)+l*(o-r)),f=3*(h*(n-e)+u*(s-n)+l*(a-s));return Math.atan2(f,d)},bN=(i,e,t,n,r,s)=>o=>{let a=nM(o),c=iM(o),l=rM(o);return new J(r*a+t*c+i*l,s*a+n*c+e*l)},DN=(i,e,t,n,r,s)=>o=>{let a=1-o,c=2*(a*(t-i)+o*(r-t)),l=2*(a*(n-e)+o*(s-n));return Math.atan2(l,c)},ZD=(i,e,t)=>{let n=new J(e,t),r=0;for(let s=1;s<=100;s+=1){let o=i(s/100);r+=I0(n.x,n.y,o.x,o.y),n=o}return r},SN=(i,e)=>{let t,n=0,r=0,s={x:i.x,y:i.y},o=U({},s),a=.01,c=0,l=i.iterator,u=i.angleFinder;for(;r<e&&a>1e-4;)o=l(n),c=n,t=I0(s.x,s.y,o.x,o.y),t+r>e?(n-=a,a/=2):(s=o,n+=a,r+=t);return U(U({},o),{},{angle:u(c)})},ry=i=>{let e,t,n=0,r=0,s=0,o=0,a=0,c=[];for(let l of i){let u={x:r,y:s,command:l[0],length:0};switch(l[0]){case"M":t=u,t.x=o=r=l[1],t.y=a=s=l[2];break;case"L":t=u,t.length=I0(r,s,l[1],l[2]),r=l[1],s=l[2];break;case"C":e=tM(r,s,l[1],l[2],l[3],l[4],l[5],l[6]),t=u,t.iterator=e,t.angleFinder=wN(r,s,l[1],l[2],l[3],l[4],l[5],l[6]),t.length=ZD(e,r,s),r=l[5],s=l[6];break;case"Q":e=bN(r,s,l[1],l[2],l[3],l[4]),t=u,t.iterator=e,t.angleFinder=DN(r,s,l[1],l[2],l[3],l[4]),t.length=ZD(e,r,s),r=l[3],s=l[4];break;case"Z":t=u,t.destX=o,t.destY=a,t.length=I0(r,s,o,a),r=o,s=a}n+=t.length,c.push(t)}return c.push({length:n,x:r,y:s}),c},sM=function(i,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ry(i),n=0;for(;e-t[n].length>0&&n<t.length-2;)e-=t[n].length,n++;let r=t[n],s=e/r.length,o=i[n];switch(r.command){case"M":return{x:r.x,y:r.y,angle:0};case"Z":return U(U({},new J(r.x,r.y).lerp(new J(r.destX,r.destY),s)),{},{angle:Math.atan2(r.destY-r.y,r.destX-r.x)});case"L":return U(U({},new J(r.x,r.y).lerp(new J(o[1],o[2]),s)),{},{angle:Math.atan2(o[2]-r.y,o[1]-r.x)});case"C":case"Q":return SN(r,e)}},oM=i=>{i=qS(i);let e=[];for(let t of i.matchAll(new RegExp(qD,"gi"))){let n=t[0],r=[],s;do{if(s=new RegExp(qD,"i").exec(n),!s)break;let o=s.filter(c=>c);o.shift();let a=o.map(c=>{let l=Number.parseFloat(c);return Number.isNaN(l)?c:l});if(r.push(a),o.length<=1)break;o.shift(),n=n.replace(new RegExp("".concat(o.join(" ?")," ?$")),"")}while(s);r.reverse().forEach((o,a)=>{let c=CN[o[0]];a>0&&(c=="l"||c=="L")&&(o[0]=c),e.push(o)})}return e},MN=function(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=new J(i[0]),n=new J(i[1]),r=1,s=0,o=[],a=i.length,c=a>2,l;for(c&&(r=i[2].x<n.x?-1:i[2].x===n.x?0:1,s=i[2].y<n.y?-1:i[2].y===n.y?0:1),o.push(["M",t.x-r*e,t.y-s*e]),l=1;l<a;l++){if(!t.eq(n)){let u=t.midPointFrom(n);o.push(["Q",t.x,t.y,u.x,u.y])}t=i[l],l+1<i.length&&(n=i[l+1])}return c&&(r=t.x>i[l-2].x?1:t.x===i[l-2].x?0:-1,s=t.y>i[l-2].y?1:t.y===i[l-2].y?0:-1),o.push(["L",t.x+r*e,t.y+s*e]),o},aM=(i,e)=>i.map(t=>t.map((n,r)=>r===0||e===void 0?n:xt(n,e)).join(" ")).join(" ");function TN(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=e.onComplete||ea,n=new(U0()).XMLHttpRequest,r=e.signal,s=function(){n.abort()},o=function(){r&&r.removeEventListener("abort",s),n.onerror=n.ontimeout=ea};if(r&&r.aborted)throw new x0("request");return r&&r.addEventListener("abort",s,{once:!0}),n.onreadystatechange=function(){n.readyState===4&&(o(),t(n),n.onreadystatechange=ea)},n.onerror=n.ontimeout=o,n.open("get",i,!0),n.send(),n}var FN=(i,e)=>{let t=i._findCenterFromElement();i.transformMatrix&&((n=>{if(n.transformMatrix){let{scaleX:r,scaleY:s,angle:o,skewX:a}=tl(n.transformMatrix);n.flipX=!1,n.flipY=!1,n.set("scaleX",r),n.set("scaleY",s),n.angle=o,n.skewX=a,n.skewY=0}})(i),t=t.transform(i.transformMatrix)),delete i.transformMatrix,e&&(i.scaleX*=e.scaleX,i.scaleY*=e.scaleY,i.cropX=e.cropX,i.cropY=e.cropY,t.x+=e.offsetLeft,t.y+=e.offsetTop,i.width=e.width,i.height=e.height),i.setPositionByOrigin(t,lt,lt)},RX=Object.freeze({__proto__:null,addTransformToObject:pS,animate:KE,animateColor:AS,applyTransformToObject:il,calcAngleBetweenVectors:w0,calcDimensionsMatrix:qu,calcPlaneChangeMatrix:Zu,calcVectorRotation:bS,cancelAnimFrame:iS,capValue:sa,composeMatrix:aS,copyCanvasElement:i=>{var e;let t=ln();return t.width=i.width,t.height=i.height,(e=t.getContext("2d"))===null||e===void 0||e.drawImage(i,0,0),t},cos:lr,createCanvasElement:ln,createImage:rS,createRotateMatrix:cl,createScaleMatrix:V0,createSkewXMatrix:XE,createSkewYMatrix:qE,createTranslateMatrix:al,createVector:_0,crossProduct:Lc,degreesToRadians:rn,dotProduct:DS,ease:D7,enlivenObjectEnlivables:Yu,enlivenObjects:nl,findScaleToCover:QS,findScaleToFit:JS,getBoundsOfCurve:BE,getOrthonormalVector:QE,getPathSegmentsInfo:ry,getPointOnPath:sM,getPointer:fS,getRandomInt:E7,getRegularPolygonPath:(i,e)=>{let t=2*Math.PI/i,n=-Ks;i%2==0&&(n+=t/2);let r=new Array(i+1);for(let s=0;s<i;s++){let o=s*t+n,{x:a,y:c}=new J(lr(o),ur(o)).scalarMultiply(e);r[s]=[s===0?"M":"L",a,c]}return r[i]=["Z"],r},getSmoothPathFromPoints:MN,getSvgAttributes:i=>{let e=["instantiated_by_use","style","id","class"];switch(i){case"linearGradient":return e.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);case"radialGradient":return e.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);case"stop":return e.concat(["offset","stop-color","stop-opacity"])}return e},getUnitVector:j0,groupSVGElements:(i,e)=>i&&i.length===1?i[0]:new qs(i,e),hasStyleChanged:X0,invertTransform:gi,isBetweenVectors:_E,isIdentityMatrix:i=>i.every((e,t)=>e===Jn[t]),isTouchEvent:E0,isTransparent:jS,joinPath:aM,loadImage:Nu,magnitude:A0,makeBoundingBoxFromPoints:Rr,makePathSimpler:eM,matrixToSVG:Hu,mergeClipPaths:(i,e)=>{var t;let n=i,r=e;n.inverted&&!r.inverted&&(n=e,r=i),gE(r,(t=r.group)===null||t===void 0?void 0:t.calcTransformMatrix(),n.calcTransformMatrix());let s=n.inverted&&r.inverted;return s&&(n.inverted=r.inverted=!1),new qs([n],{clipPath:r,inverted:s})},multiplyTransformMatrices:Pn,multiplyTransformMatrixArray:ol,parsePath:oM,parsePreserveAspectRatioAttribute:cS,parseUnit:ta,pick:aa,projectStrokeOnPoints:GS,qrDecompose:tl,radiansToDegrees:ra,removeFromArray:Ko,removeTransformFromObject:(i,e)=>{let t=gi(e),n=Pn(t,i.calcOwnMatrix());il(i,n)},removeTransformMatrixForSvgParsing:FN,request:TN,requestAnimFrame:ku,resetObjectTransform:xS,rotatePoint:(i,e,t)=>i.rotate(t,e),rotateVector:JE,saveObjectTransform:ZE,sendObjectToPlane:gE,sendPointToPlane:Xs,sendVectorToPlane:mS,setStyle:Lu,sin:ur,sizeAfterTransform:z0,string:G7,stylesFromArray:XS,stylesToArray:$S,toDataURL:$E,toFixed:xt,transformPath:(i,e,t)=>(t&&(e=Pn(e,[1,0,0,1,-t.x,-t.y])),i.map(n=>{let r=[...n];for(let s=1;s<n.length-1;s+=2){let{x:o,y:a}=jn({x:n[s],y:n[s+1]},e);r[s]=o,r[s+1]=a}return r})),transformPoint:jn}),IE=class extends v0{constructor(e){let{allowTouchScrolling:t=!1,containerClass:n=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),V(this,"upper",void 0),V(this,"container",void 0);let{el:r}=this.lower,s=this.createUpperCanvas();this.upper={el:s,ctx:s.getContext("2d")},this.applyCanvasStyle(r,{allowTouchScrolling:t}),this.applyCanvasStyle(s,{allowTouchScrolling:t});let o=this.createContainerElement();o.classList.add(n),r.parentNode&&r.parentNode.replaceChild(o,r),o.append(r,s),this.container=o}createUpperCanvas(){let{el:e}=this.lower,t=ln();return t.className=e.className,t.classList.remove("lower-canvas"),t.classList.add("upper-canvas"),t.setAttribute("data-fabric","top"),t.style.cssText=e.style.cssText,t.setAttribute("draggable","true"),t}createContainerElement(){let e=sl().createElement("div");return e.setAttribute("data-fabric","wrapper"),Lu(e,{position:"relative"}),BD(e),e}applyCanvasStyle(e,t){let{allowTouchScrolling:n}=t;Lu(e,{position:"absolute",left:"0",top:"0"}),function(r,s){let o=s?"manipulation":si;Lu(r,{"touch-action":o,"-ms-touch-action":o})}(e,n),BD(e)}setDimensions(e,t){super.setDimensions(e,t);let{el:n,ctx:r}=this.upper;dS(n,r,e,t)}setCSSDimensions(e){super.setCSSDimensions(e),xE(this.upper.el,e),xE(this.container,e)}cleanupDOM(e){let t=this.container,{el:n}=this.lower,{el:r}=this.upper;super.cleanupDOM(e),t.removeChild(r),t.removeChild(n),t.parentNode&&t.parentNode.replaceChild(n,t)}dispose(){super.dispose(),Or().dispose(this.upper.el),delete this.upper,delete this.container}},P0=class i extends Gu{constructor(){super(...arguments),V(this,"targets",[]),V(this,"_hoveredTargets",[]),V(this,"_objectsToRender",void 0),V(this,"_currentTransform",null),V(this,"_groupSelector",null),V(this,"contextTopDirty",!1)}static getDefaults(){return U(U({},super.getDefaults()),i.ownDefaults)}get upperCanvasEl(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.el}get contextTop(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.ctx}get wrapperEl(){return this.elements.container}initElements(e){this.elements=new IE(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e)}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){let e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter(t=>!t.group&&t!==e).concat(e):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()}renderTop(){let e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e})}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;let t=this.getRetinaScaling(),n=Math.ceil((2*e+1)*t);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=n,this.pixelFindContext.scale(t,t)}isTargetTransparent(e,t,n){let r=this.targetFindTolerance,s=this.pixelFindContext;this.clearContext(s),s.save(),s.translate(-t+r,-n+r),s.transform(...this.viewportTransform);let o=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(s),e.selectionBackgroundColor=o,s.restore();let a=Math.round(r*this.getRetinaScaling());return jS(s,a,a,a)}_isSelectionKeyPressed(e){let t=this.selectionKey;return!!t&&(Array.isArray(t)?!!t.find(n=>!!n&&e[n]===!0):e[t])}_shouldClearSelection(e,t){let n=this.getActiveObjects(),r=this._activeObject;return!!(!t||t&&r&&n.length>1&&n.indexOf(t)===-1&&r!==t&&!this._isSelectionKeyPressed(e)||t&&!t.evented||t&&!t.selectable&&r&&r!==t)}_shouldCenterTransform(e,t,n){if(!e)return;let r;return t==="scale"||t==="scaleX"||t==="scaleY"||t==="resizing"?r=this.centeredScaling||e.centeredScaling:t==="rotate"&&(r=this.centeredRotation||e.centeredRotation),r?!n:n}_getOriginFromCorner(e,t){let n={x:e.originX,y:e.originY};return t&&(["ml","tl","bl"].includes(t)?n.x=cn:["mr","tr","br"].includes(t)&&(n.x=Dt),["tl","mt","tr"].includes(t)?n.y=fE:["bl","mb","br"].includes(t)&&(n.y=Gn)),n}_setupCurrentTransform(e,t,n){var r;let s=t.group?Xs(this.getScenePoint(e),void 0,t.group.calcTransformMatrix()):this.getScenePoint(e),{key:o="",control:a}=t.getActiveControl()||{},c=n&&a?(r=a.getActionHandler(e,t,a))===null||r===void 0?void 0:r.bind(a):CS,l=((f,x,g,p)=>{if(!x||!f)return"drag";let m=p.controls[x];return m.getActionName(g,m,p)})(n,o,e,t),u=e[this.centeredKey],h=this._shouldCenterTransform(t,l,u)?{x:lt,y:lt}:this._getOriginFromCorner(t,o),d={target:t,action:l,actionHandler:c,actionPerformed:!1,corner:o,scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,offsetX:s.x-t.left,offsetY:s.y-t.top,originX:h.x,originY:h.y,ex:s.x,ey:s.y,lastX:s.x,lastY:s.y,theta:rn(t.angle),width:t.width,height:t.height,shiftKey:e.shiftKey,altKey:u,original:U(U({},ZE(t)),{},{originX:h.x,originY:h.y})};this._currentTransform=d,this.fire("before:transform",{e,transform:d})}setCursor(e){this.upperCanvasEl.style.cursor=e}_drawSelection(e){let{x:t,y:n,deltaX:r,deltaY:s}=this._groupSelector,o=new J(t,n).transform(this.viewportTransform),a=new J(t+r,n+s).transform(this.viewportTransform),c=this.selectionLineWidth/2,l=Math.min(o.x,a.x),u=Math.min(o.y,a.y),h=Math.max(o.x,a.x),d=Math.max(o.y,a.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(l,u,h-l,d-u)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,l+=c,u+=c,h-=c,d-=c,un.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(l,u,h-l,d-u))}findTarget(e){if(this.skipTargetFind)return;let t=this.getViewportPoint(e),n=this._activeObject,r=this.getActiveObjects();if(this.targets=[],n&&r.length>=1){if(n.findControl(t,E0(e))||r.length>1&&this.searchPossibleTargets([n],t))return n;if(n===this.searchPossibleTargets([n],t)){if(this.preserveObjectStacking){let s=this.targets;this.targets=[];let o=this.searchPossibleTargets(this._objects,t);return e[this.altSelectionKey]&&o&&o!==n?(this.targets=s,n):o}return n}}return this.searchPossibleTargets(this._objects,t)}_pointIsInObjectSelectionArea(e,t){let n=e.getCoords(),r=this.getZoom(),s=e.padding/r;if(s){let[o,a,c,l]=n,u=Math.atan2(a.y-o.y,a.x-o.x),h=lr(u)*s,d=ur(u)*s,f=h+d,x=h-d;n=[new J(o.x-x,o.y-f),new J(a.x+f,a.y-x),new J(c.x+x,c.y+f),new J(l.x-f,l.y+x)]}return na.isPointInPolygon(t,n)}_checkTarget(e,t){return!!(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,Xs(t,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing||!this.isTargetTransparent(e,t.x,t.y)))}_searchPossibleTargets(e,t){let n=e.length;for(;n--;){let r=e[n];if(this._checkTarget(r,t)){if(f0(r)&&r.subTargetCheck){let s=this._searchPossibleTargets(r._objects,t);s&&this.targets.push(s)}return r}}}searchPossibleTargets(e,t){let n=this._searchPossibleTargets(e,t);if(n&&f0(n)&&n.interactive&&this.targets[0]){let r=this.targets;for(let s=r.length-1;s>0;s--){let o=r[s];if(!f0(o)||!o.interactive)return o}return r[0]}return n}getViewportPoint(e){return this._pointer?this._pointer:this.getPointer(e,!0)}getScenePoint(e){return this._absolutePointer?this._absolutePointer:this.getPointer(e)}getPointer(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1],n=this.upperCanvasEl,r=n.getBoundingClientRect(),s=fS(e),o=r.width||0,a=r.height||0;o&&a||(Gn in r&&fE in r&&(a=Math.abs(r.top-r.bottom)),cn in r&&Dt in r&&(o=Math.abs(r.right-r.left))),this.calcOffset(),s.x=s.x-this._offset.left,s.y=s.y-this._offset.top,t||(s=Xs(s,void 0,this.viewportTransform));let c=this.getRetinaScaling();c!==1&&(s.x/=c,s.y/=c);let l=o===0||a===0?new J(1,1):new J(n.width/o,n.height/a);return s.multiply(l)}_setDimensionsImpl(e,t){this._resetTransformEventData(),super._setDimensionsImpl(e,t),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=ln(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){let e=this._activeObject;return Bc(e)?e.getObjects():e?[e]:[]}_fireSelectionEvents(e,t){let n=!1,r=!1,s=this.getActiveObjects(),o=[],a=[];e.forEach(c=>{s.includes(c)||(n=!0,c.fire("deselected",{e:t,target:c}),a.push(c))}),s.forEach(c=>{e.includes(c)||(n=!0,c.fire("selected",{e:t,target:c}),o.push(c))}),e.length>0&&s.length>0?(r=!0,n&&this.fire("selection:updated",{e:t,selected:o,deselected:a})):s.length>0?(r=!0,this.fire("selection:created",{e:t,selected:o})):e.length>0&&(r=!0,this.fire("selection:cleared",{e:t,deselected:a})),r&&(this._objectsToRender=void 0)}setActiveObject(e,t){let n=this.getActiveObjects(),r=this._setActiveObject(e,t);return this._fireSelectionEvents(n,t),r}_setActiveObject(e,t){let n=this._activeObject;return n!==e&&!(!this._discardActiveObject(t,e)&&this._activeObject)&&!e.onSelect({e:t})&&(this._activeObject=e,Bc(e)&&n!==e&&(e.set("canvas",this),e.setCoords()),!0)}_discardActiveObject(e,t){let n=this._activeObject;return!!n&&!n.onDeselect({e,object:t})&&(this._currentTransform&&this._currentTransform.target===n&&this.endCurrentTransform(e),this._activeObject=void 0,!0)}discardActiveObject(e){let t=this.getActiveObjects(),n=this.getActiveObject();t.length&&this.fire("before:selection:cleared",{e,deselected:[n]});let r=this._discardActiveObject(e);return this._fireSelectionEvents(t,e),r}endCurrentTransform(e){let t=this._currentTransform;this._finalizeCurrentTransform(e),t&&t.target&&(t.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(e){let t=this._currentTransform,n=t.target,r={e,target:n,transform:t,action:t.action};n._scaling&&(n._scaling=!1),n.setCoords(),t.actionPerformed&&(this.fire("object:modified",r),n.fire("modified",r))}setViewportTransform(e){super.setViewportTransform(e);let t=this._activeObject;t&&t.setCoords()}destroy(){let e=this._activeObject;Bc(e)&&(e.removeAll(),e.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(e){let t=this._activeObject;t&&t._renderControls(e)}_toObject(e,t,n){let r=this._realizeGroupTransformOnObject(e),s=super._toObject(e,t,n);return e.set(r),s}_realizeGroupTransformOnObject(e){let{group:t}=e;if(t&&Bc(t)&&this._activeObject===t){let n=aa(e,["angle","flipX","flipY",Dt,"scaleX","scaleY","skewX","skewY",Gn]);return pS(e,t.calcOwnMatrix()),n}return{}}_setSVGObject(e,t,n){let r=this._realizeGroupTransformOnObject(t);super._setSVGObject(e,t,n),t.set(r)}};V(P0,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});var PE=class{constructor(e){V(this,"targets",[]),V(this,"__disposer",void 0);let t=()=>{let{hiddenTextarea:r}=e.getActiveObject()||{};r&&r.focus()},n=e.upperCanvasEl;n.addEventListener("click",t),this.__disposer=()=>n.removeEventListener("click",t)}exitTextEditing(){this.target=void 0,this.targets.forEach(e=>{e.isEditing&&e.exitEditing()})}add(e){this.targets.push(e)}remove(e){this.unregister(e),Ko(this.targets,e)}register(e){this.target=e}unregister(e){e===this.target&&(this.target=void 0)}onMouseMove(e){var t;!((t=this.target)===null||t===void 0)&&t.isEditing&&this.target.updateSelectionOnMouseMove(e)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}},BN=["target","oldTarget","fireCanvas","e"],mi={passive:!1},Tc=(i,e)=>{let t=i.getViewportPoint(e),n=i.getScenePoint(e);return{viewportPoint:t,scenePoint:n,pointer:t,absolutePointer:n}},Hs=function(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return i.addEventListener(...t)},Ri=function(i){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];return i.removeEventListener(...t)},IN={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}},kr=class extends P0{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),V(this,"_isClick",void 0),V(this,"textEditingManager",new PE(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onDoubleClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(t=>{this[t]=this[t].bind(this)}),this.addOrRemove(Hs,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(e,t){let n=this.upperCanvasEl,r=this._getEventPrefix();e(hS(n),"resize",this._onResize),e(n,r+"down",this._onMouseDown),e(n,"".concat(r,"move"),this._onMouseMove,mi),e(n,"".concat(r,"out"),this._onMouseOut),e(n,"".concat(r,"enter"),this._onMouseEnter),e(n,"wheel",this._onMouseWheel),e(n,"contextmenu",this._onContextMenu),e(n,"dblclick",this._onDoubleClick),e(n,"dragstart",this._onDragStart),e(n,"dragend",this._onDragEnd),e(n,"dragover",this._onDragOver),e(n,"dragenter",this._onDragEnter),e(n,"dragleave",this._onDragLeave),e(n,"drop",this._onDrop),this.enablePointerEvents||e(n,"touchstart",this._onTouchStart,mi)}removeListeners(){this.addOrRemove(Ri,"remove");let e=this._getEventPrefix(),t=ar(this.upperCanvasEl);Ri(t,"".concat(e,"up"),this._onMouseUp),Ri(t,"touchend",this._onTouchEnd,mi),Ri(t,"".concat(e,"move"),this._onMouseMove,mi),Ri(t,"touchmove",this._onMouseMove,mi)}_onMouseWheel(e){this.__onMouseWheel(e)}_onMouseOut(e){let t=this._hoveredTarget,n=U({e},Tc(this,e));this.fire("mouse:out",U(U({},n),{},{target:t})),this._hoveredTarget=void 0,t&&t.fire("mouseout",U({},n)),this._hoveredTargets.forEach(r=>{this.fire("mouse:out",U(U({},n),{},{target:r})),r&&r.fire("mouseout",U({},n))}),this._hoveredTargets=[]}_onMouseEnter(e){this._currentTransform||this.findTarget(e)||(this.fire("mouse:over",U({e},Tc(this,e))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(e){this._isClick=!1;let t=this.getActiveObject();if(t&&t.onDragStart(e)){this._dragSource=t;let n={e,target:t};return this.fire("dragstart",n),t.fire("dragstart",n),void Hs(this.upperCanvasEl,"drag",this._onDragProgress)}mE(e)}_renderDragEffects(e,t,n){let r=!1,s=this._dropTarget;s&&s!==t&&s!==n&&(s.clearContextTop(),r=!0),t?.clearContextTop(),n!==t&&n?.clearContextTop();let o=this.contextTop;o.save(),o.transform(...this.viewportTransform),t&&(o.save(),t.transform(o),t.renderDragSourceEffect(e),o.restore(),r=!0),n&&(o.save(),n.transform(o),n.renderDropTargetEffect(e),o.restore(),r=!0),o.restore(),r&&(this.contextTopDirty=!0)}_onDragEnd(e){let t=!!e.dataTransfer&&e.dataTransfer.dropEffect!==si,n=t?this._activeObject:void 0,r={e,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:t,dropTarget:n};Ri(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",r),this._dragSource&&this._dragSource.fire("dragend",r),delete this._dragSource,this._onMouseUp(e)}_onDragProgress(e){let t={e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",t),this._dragSource&&this._dragSource.fire("drag",t)}findDragTargets(e){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(e)),targets:[...this.targets]}}_onDragOver(e){let t="dragover",{target:n,targets:r}=this.findDragTargets(e),s=this._dragSource,o={e,target:n,subTargets:r,dragSource:s,canDrop:!1,dropTarget:void 0},a;this.fire(t,o),this._fireEnterLeaveEvents(n,o),n&&(n.canDrop(e)&&(a=n),n.fire(t,o));for(let c=0;c<r.length;c++){let l=r[c];l.canDrop(e)&&(a=l),l.fire(t,o)}this._renderDragEffects(e,s,a),this._dropTarget=a}_onDragEnter(e){let{target:t,targets:n}=this.findDragTargets(e),r={e,target:t,subTargets:n,dragSource:this._dragSource};this.fire("dragenter",r),this._fireEnterLeaveEvents(t,r)}_onDragLeave(e){let t={e,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",t),this._fireEnterLeaveEvents(void 0,t),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(e){let{target:t,targets:n}=this.findDragTargets(e),r=this._basicEventHandler("drop:before",U({e,target:t,subTargets:n,dragSource:this._dragSource},Tc(this,e)));r.didDrop=!1,r.dropTarget=void 0,this._basicEventHandler("drop",r),this.fire("drop:after",r)}_onContextMenu(e){let t=this.findTarget(e),n=this.targets||[],r=this._basicEventHandler("contextmenu:before",{e,target:t,subTargets:n});return this.stopContextMenu&&mE(e),this._basicEventHandler("contextmenu",r),!1}_onDoubleClick(e){this._cacheTransformEventData(e),this._handleEvent(e,"dblclick"),this._resetTransformEventData()}getPointerId(e){let t=e.changedTouches;return t?t[0]&&t[0].identifier:this.enablePointerEvents?e.pointerId:-1}_isMainEvent(e){return e.isPrimary===!0||e.isPrimary!==!1&&(e.type==="touchend"&&e.touches.length===0||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(e){e.preventDefault(),this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),this._resetTransformEventData();let t=this.upperCanvasEl,n=this._getEventPrefix(),r=ar(t);Hs(r,"touchend",this._onTouchEnd,mi),Hs(r,"touchmove",this._onMouseMove,mi),Ri(t,"".concat(n,"down"),this._onMouseDown)}_onMouseDown(e){this.__onMouseDown(e),this._resetTransformEventData();let t=this.upperCanvasEl,n=this._getEventPrefix();Ri(t,"".concat(n,"move"),this._onMouseMove,mi);let r=ar(t);Hs(r,"".concat(n,"up"),this._onMouseUp),Hs(r,"".concat(n,"move"),this._onMouseMove,mi)}_onTouchEnd(e){if(e.touches.length>0)return;this.__onMouseUp(e),this._resetTransformEventData(),delete this.mainTouchId;let t=this._getEventPrefix(),n=ar(this.upperCanvasEl);Ri(n,"touchend",this._onTouchEnd,mi),Ri(n,"touchmove",this._onMouseMove,mi),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{Hs(this.upperCanvasEl,"".concat(t,"down"),this._onMouseDown),this._willAddMouseDown=0},400)}_onMouseUp(e){this.__onMouseUp(e),this._resetTransformEventData();let t=this.upperCanvasEl,n=this._getEventPrefix();if(this._isMainEvent(e)){let r=ar(this.upperCanvasEl);Ri(r,"".concat(n,"up"),this._onMouseUp),Ri(r,"".concat(n,"move"),this._onMouseMove,mi),Hs(t,"".concat(n,"move"),this._onMouseMove,mi)}}_onMouseMove(e){let t=this.getActiveObject();!this.allowTouchScrolling&&(!t||!t.shouldStartDragging())&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(e){let t=this.getActiveObject();return!!t!=!!e||t&&e&&t!==e}__onMouseUp(e){var t;this._cacheTransformEventData(e),this._handleEvent(e,"up:before");let n=this._currentTransform,r=this._isClick,s=this._target,{button:o}=e;if(o)return(this.fireMiddleClick&&o===1||this.fireRightClick&&o===2)&&this._handleEvent(e,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);if(!this._isMainEvent(e))return;let a,c,l=!1;if(n&&(this._finalizeCurrentTransform(e),l=n.actionPerformed),!r){let u=s===this._activeObject;this.handleSelection(e),l||(l=this._shouldRender(s)||!u&&s===this._activeObject)}if(s){let u=s.findControl(this.getViewportPoint(e),E0(e)),{key:h,control:d}=u||{};if(c=h,s.selectable&&s!==this._activeObject&&s.activeOn==="up")this.setActiveObject(s,e),l=!0;else if(d){let f=d.getMouseUpHandler(e,s,d);f&&(a=this.getScenePoint(e),f.call(d,e,n,a.x,a.y))}s.isMoving=!1}if(n&&(n.target!==s||n.corner!==c)){let u=n.target&&n.target.controls[n.corner],h=u&&u.getMouseUpHandler(e,n.target,u);a=a||this.getScenePoint(e),h&&h.call(u,e,n,a.x,a.y)}this._setCursorFromEvent(e,s),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,s&&(s.__corner=void 0),l?this.requestRenderAll():r||(t=this._activeObject)!==null&&t!==void 0&&t.isEditing||this.renderTop()}_basicEventHandler(e,t){let{target:n,subTargets:r=[]}=t;this.fire(e,t),n&&n.fire(e,t);for(let s=0;s<r.length;s++)r[s]!==n&&r[s].fire(e,t);return t}_handleEvent(e,t){let n=this._target,r=this.targets||[],s=U(U({e,target:n,subTargets:r},Tc(this,e)),{},{transform:this._currentTransform},t==="up:before"||t==="up"?{isClick:this._isClick,currentTarget:this.findTarget(e),currentSubTargets:this.targets}:{});this.fire("mouse:".concat(t),s),n&&n.fire("mouse".concat(t),s);for(let o=0;o<r.length;o++)r[o]!==n&&r[o].fire("mouse".concat(t),s)}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());let t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(t,{e,pointer:t}),this._handleEvent(e,"down")}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){let t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(t,{e,pointer:t})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")}_onMouseUpInDrawingMode(e){let t=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e,pointer:t}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up")}__onMouseDown(e){this._isClick=!0,this._cacheTransformEventData(e),this._handleEvent(e,"down:before");let t=this._target,{button:n}=e;if(n)return(this.fireMiddleClick&&n===1||this.fireRightClick&&n===2)&&this._handleEvent(e,"down"),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._isMainEvent(e)||this._currentTransform)return;let r=this._shouldRender(t),s=!1;if(this.handleMultiSelection(e,t)?(t=this._activeObject,s=!0,r=!0):this._shouldClearSelection(e,t)&&this.discardActiveObject(e),this.selection&&(!t||!t.selectable&&!t.isEditing&&t!==this._activeObject)){let o=this.getScenePoint(e);this._groupSelector={x:o.x,y:o.y,deltaY:0,deltaX:0}}if(t){let o=t===this._activeObject;t.selectable&&t.activeOn==="down"&&this.setActiveObject(t,e);let a=t.findControl(this.getViewportPoint(e),E0(e));if(t===this._activeObject&&(a||!s)){this._setupCurrentTransform(e,t,o);let c=a?a.control:void 0,l=this.getScenePoint(e),u=c&&c.getMouseDownHandler(e,t,c);u&&u.call(c,e,this._currentTransform,l.x,l.y)}}r&&(this._objectsToRender=void 0),this._handleEvent(e,"down"),r&&this.requestRenderAll()}_resetTransformEventData(){this._target=void 0,this._pointer=void 0,this._absolutePointer=void 0}_cacheTransformEventData(e){this._resetTransformEventData(),this._pointer=this.getViewportPoint(e),this._absolutePointer=Xs(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)}__onMouseMove(e){if(this._isClick=!1,this._handleEvent(e,"move:before"),this._cacheTransformEventData(e),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(e);if(!this._isMainEvent(e))return;let t=this._groupSelector;if(t){let n=this.getScenePoint(e);t.deltaX=n.x-t.x,t.deltaY=n.y-t.y,this.renderTop()}else if(this._currentTransform)this._transformObject(e);else{let n=this.findTarget(e);this._setCursorFromEvent(e,n),this._fireOverOutEvents(e,n)}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move"),this._resetTransformEventData()}_fireOverOutEvents(e,t){let n=this._hoveredTarget,r=this._hoveredTargets,s=this.targets,o=Math.max(r.length,s.length);this.fireSyntheticInOutEvents("mouse",{e,target:t,oldTarget:n,fireCanvas:!0});for(let a=0;a<o;a++)this.fireSyntheticInOutEvents("mouse",{e,target:s[a],oldTarget:r[a]});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(e,t){let n=this._draggedoverTarget,r=this._hoveredTargets,s=this.targets,o=Math.max(r.length,s.length);this.fireSyntheticInOutEvents("drag",U(U({},t),{},{target:e,oldTarget:n,fireCanvas:!0}));for(let a=0;a<o;a++)this.fireSyntheticInOutEvents("drag",U(U({},t),{},{target:s[a],oldTarget:r[a]}));this._draggedoverTarget=e}fireSyntheticInOutEvents(e,t){let{target:n,oldTarget:r,fireCanvas:s,e:o}=t,a=Pt(t,BN),{targetIn:c,targetOut:l,canvasIn:u,canvasOut:h}=IN[e],d=r!==n;if(r&&d){let f=U(U({},a),{},{e:o,target:r,nextTarget:n},Tc(this,o));s&&this.fire(h,f),r.fire(l,f)}if(n&&d){let f=U(U({},a),{},{e:o,target:n,previousTarget:r},Tc(this,o));s&&this.fire(u,f),n.fire(c,f)}}__onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()}_transformObject(e){let t=this.getScenePoint(e),n=this._currentTransform,r=n.target,s=r.group?Xs(t,void 0,r.group.calcTransformMatrix()):t;n.shiftKey=e.shiftKey,n.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,n,s),n.actionPerformed&&this.requestRenderAll()}_performTransformAction(e,t,n){let r=n.x,s=n.y,o=t.action,a=t.actionHandler,c=!1;a&&(c=a(e,t,r,s)),o==="drag"&&c&&(t.target.isMoving=!0,this.setCursor(t.target.moveCursor||this.moveCursor)),t.actionPerformed=t.actionPerformed||c}_setCursorFromEvent(e,t){if(!t)return void this.setCursor(this.defaultCursor);let n=t.hoverCursor||this.hoverCursor,r=Bc(this._activeObject)?this._activeObject:null,s=(!r||t.group!==r)&&t.findControl(this.getViewportPoint(e));if(s){let o=s.control;this.setCursor(o.cursorStyleHandler(e,o,t))}else t.subTargetCheck&&this.targets.concat().reverse().map(o=>{n=o.hoverCursor||n}),this.setCursor(n)}handleMultiSelection(e,t){let n=this._activeObject,r=Bc(n);if(n&&this._isSelectionKeyPressed(e)&&this.selection&&t&&t.selectable&&(n!==t||r)&&(r||!t.isDescendantOf(n)&&!n.isDescendantOf(t))&&!t.onSelect({e})&&!n.getActiveControl()){if(r){let s=n.getObjects();if(t===n){let o=this.getViewportPoint(e);if(!(t=this.searchPossibleTargets(s,o)||this.searchPossibleTargets(this._objects,o))||!t.selectable)return!1}t.group===n?(n.remove(t),this._hoveredTarget=t,this._hoveredTargets=[...this.targets],n.size()===1&&this._setActiveObject(n.item(0),e)):(n.multiSelectAdd(t),this._hoveredTarget=n,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(s,e)}else{n.exitEditing&&n.exitEditing();let s=new(_e.getClass("ActiveSelection"))([],{canvas:this});s.multiSelectAdd(n,t),this._hoveredTarget=s,this._setActiveObject(s,e),this._fireSelectionEvents([n],e)}return!0}return!1}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;let{x:t,y:n,deltaX:r,deltaY:s}=this._groupSelector,o=new J(t,n),a=o.add(new J(r,s)),c=o.min(a),l=o.max(a).subtract(c),u=this.collectObjects({left:c.x,top:c.y,width:l.x,height:l.y},{includeIntersecting:!this.selectionFullyContained}),h=o.eq(a)?u[0]?[u[0]]:[]:u.length>1?u.filter(d=>!d.onSelect({e})).reverse():u;if(h.length===1)this.setActiveObject(h[0],e);else if(h.length>1){let d=_e.getClass("ActiveSelection");this.setActiveObject(new d(h,{canvas:this}),e)}return this._groupSelector=null,!0}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}},cM={x1:0,y1:0,x2:0,y2:0},PN=U(U({},cM),{},{r1:0,r2:0}),RN=/^(\d+\.\d+)%|(\d+)%$/;function lM(i){return i&&RN.test(i)}function uM(i,e){let t=typeof i=="number"?i:typeof i=="string"?parseFloat(i)/(lM(i)?100:1):NaN;return sa(0,Fc(t,e),1)}var ON=/\s*;\s*/,kN=/\s*:\s*/;function NN(i,e){let t,n,r=i.getAttribute("style");if(r){let o=r.split(ON);o[o.length-1]===""&&o.pop();for(let a=o.length;a--;){let[c,l]=o[a].split(kN).map(u=>u.trim());c==="stop-color"?t=l:c==="stop-opacity"&&(n=l)}}let s=new Qn(t||i.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:uM(i.getAttribute("offset"),0),color:s.toRgb(),opacity:Fc(parseFloat(n||i.getAttribute("stop-opacity")||""),1)*s.getAlpha()*e}}function LN(i,e){let t=[],n=i.getElementsByTagName("stop"),r=uM(e,1);for(let s=n.length;s--;)t.push(NN(n[s],r));return t}function hM(i){return i.nodeName==="linearGradient"||i.nodeName==="LINEARGRADIENT"?"linear":"radial"}function dM(i){return i.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function sr(i,e){return i.getAttribute(e)}function UN(i,e){return function(t,n){let r,{width:s,height:o,gradientUnits:a}=n;return Object.keys(t).reduce((c,l)=>{let u=t[l];return u==="Infinity"?r=1:u==="-Infinity"?r=0:(r=typeof u=="string"?parseFloat(u):u,typeof u=="string"&&lM(u)&&(r*=.01,a==="pixels"&&(l!=="x1"&&l!=="x2"&&l!=="r2"||(r*=s),l!=="y1"&&l!=="y2"||(r*=o)))),c[l]=r,c},{})}(hM(i)==="linear"?function(t){return{x1:sr(t,"x1")||0,y1:sr(t,"y1")||0,x2:sr(t,"x2")||"100%",y2:sr(t,"y2")||0}}(i):function(t){return{x1:sr(t,"fx")||sr(t,"cx")||"50%",y1:sr(t,"fy")||sr(t,"cy")||"50%",r1:0,x2:sr(t,"cx")||"50%",y2:sr(t,"cy")||"50%",r2:sr(t,"r")||"50%"}}(i),U(U({},e),{},{gradientUnits:dM(i)}))}var Pc=class{constructor(e){let{type:t="linear",gradientUnits:n="pixels",coords:r={},colorStops:s=[],offsetX:o=0,offsetY:a=0,gradientTransform:c,id:l}=e;this.id=l?"".concat(l,"_").concat(Js()):Js(),this.type=t,this.gradientUnits=n,this.gradientTransform=c,this.offsetX=o,this.offsetY=a,this.coords=U(U({},this.type==="radial"?PN:cM),r),this.colorStops=s.slice()}addColorStop(e){for(let t in e){let n=new Qn(e[t]);this.colorStops.push({offset:parseFloat(t),color:n.toRgb(),opacity:n.getAlpha()})}return this}toObject(e){return U(U({},aa(this,e)),{},{type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(e){let{additionalTransform:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=[],r=this.gradientTransform?this.gradientTransform.concat():Jn.concat(),s=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",o=this.colorStops.map(h=>U({},h)).sort((h,d)=>h.offset-d.offset),a=-this.offsetX,c=-this.offsetY;var l;s==="objectBoundingBox"?(a/=e.width,c/=e.height):(a+=e.width/2,c+=e.height/2),(l=e)&&typeof l._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(a-=e.pathOffset.x,c-=e.pathOffset.y),r[4]-=a,r[5]-=c;let u=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(s,'"'),'gradientTransform="'.concat(t?t+" ":"").concat(Hu(r),'"'),""].join(" ");if(this.type==="linear"){let{x1:h,y1:d,x2:f,y2:x}=this.coords;n.push("<linearGradient ",u,' x1="',h,'" y1="',d,'" x2="',f,'" y2="',x,`">
`)}else if(this.type==="radial"){let{x1:h,y1:d,x2:f,y2:x,r1:g,r2:p}=this.coords,m=g>p;n.push("<radialGradient ",u,' cx="',m?h:f,'" cy="',m?d:x,'" r="',m?g:p,'" fx="',m?f:h,'" fy="',m?x:d,`">
`),m&&(o.reverse(),o.forEach(E=>{E.offset=1-E.offset}));let v=Math.min(g,p);if(v>0){let E=v/Math.max(g,p);o.forEach(y=>{y.offset+=E*(1-y.offset)})}}return o.forEach(h=>{let{color:d,offset:f,opacity:x}=h;n.push("<stop ",'offset="',100*f+"%",'" style="stop-color:',d,x!==void 0?";stop-opacity: "+x:";",`"/>
`)}),n.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),n.join("")}toLive(e){let t=this.coords,n=this.type==="linear"?e.createLinearGradient(t.x1,t.y1,t.x2,t.y2):e.createRadialGradient(t.x1,t.y1,t.r1,t.x2,t.y2,t.r2);return this.colorStops.forEach(r=>{let{color:s,opacity:o,offset:a}=r;n.addColorStop(a,o!==void 0?new Qn(s).setAlpha(o).toRgba():s)}),n}static fromObject(e){return He(this,null,function*(){return new this(e)})}static fromElement(e,t,n){let r=dM(e),s=t._findCenterFromElement();return new this(U({id:e.getAttribute("id")||void 0,type:hM(e),coords:UN(e,{width:n.viewBoxWidth||n.width,height:n.viewBoxHeight||n.height}),colorStops:LN(e,n.opacity),gradientUnits:r,gradientTransform:TE(e.getAttribute("gradientTransform")||"")},r==="pixels"?{offsetX:t.width/2-s.x,offsetY:t.height/2-s.y}:{offsetX:0,offsetY:0}))}};V(Pc,"type","Gradient"),_e.setClass(Pc,"gradient"),_e.setClass(Pc,"linear"),_e.setClass(Pc,"radial");var VN=["type","source"],Uu=class{get type(){return"pattern"}set type(e){Zs("warn","Setting type has no effect",e)}constructor(e){V(this,"repeat","repeat"),V(this,"offsetX",0),V(this,"offsetY",0),V(this,"crossOrigin",""),V(this,"patternTransform",null),this.id=Js(),Object.assign(this,e)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(e){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?e.createPattern(this.source,this.repeat):null}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],{repeat:t,crossOrigin:n}=this;return U(U({},aa(this,e)),{},{type:"pattern",source:this.sourceToString(),repeat:t,crossOrigin:n,offsetX:xt(this.offsetX,_t.NUM_FRACTION_DIGITS),offsetY:xt(this.offsetY,_t.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(e){let{width:t,height:n}=e,{source:r,repeat:s,id:o}=this,a=Fc(this.offsetX/t,0),c=Fc(this.offsetY/n,0),l=s==="repeat-y"||s==="no-repeat"?1+Math.abs(a||0):Fc(r.width/t,0),u=s==="repeat-x"||s==="no-repeat"?1+Math.abs(c||0):Fc(r.height/n,0);return['<pattern id="SVGID_'.concat(o,'" x="').concat(a,'" y="').concat(c,'" width="').concat(l,'" height="').concat(u,'">'),'<image x="0" y="0" width="'.concat(r.width,'" height="').concat(r.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static fromObject(e,t){return He(this,null,function*(){let{type:n,source:r}=e,s=Pt(e,VN),o=yield Nu(r,U(U({},t),{},{crossOrigin:s.crossOrigin}));return new this(U(U({},s),{},{source:o}))})}};V(Uu,"type","Pattern"),_e.setClass(Uu),_e.setClass(Uu,"pattern");var zN=["path","left","top"],HN=["d"],cs=class extends un{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:n,left:r,top:s}=t;super(Pt(t,zN)),this._setPath(e||[],!0),typeof r=="number"&&this.set(Dt,r),typeof s=="number"&&this.set(Gn,s)}_setPath(e,t){this.path=eM(Array.isArray(e)?e:oM(e)),this.setBoundingBox(t)}_findCenterFromElement(){let e=this._calcBoundsFromPath();return new J(e.left+e.width/2,e.top+e.height/2)}_renderPathCommands(e){let t=-this.pathOffset.x,n=-this.pathOffset.y;e.beginPath();for(let r of this.path)switch(r[0]){case"L":e.lineTo(r[1]+t,r[2]+n);break;case"M":e.moveTo(r[1]+t,r[2]+n);break;case"C":e.bezierCurveTo(r[1]+t,r[2]+n,r[3]+t,r[4]+n,r[5]+t,r[6]+n);break;case"Q":e.quadraticCurveTo(r[1]+t,r[2]+n,r[3]+t,r[4]+n);break;case"Z":e.closePath()}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return U(U({},super.toObject(e)),{},{path:this.path.map(t=>t.slice())})}toDatalessObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=this.toObject(e);return this.sourcePath&&(delete t.path,t.sourcePath=this.sourcePath),t}_toSVG(){let e=aM(this.path,_t.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(e,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){let e=_t.NUM_FRACTION_DIGITS;return" translate(".concat(xt(-this.pathOffset.x,e),", ").concat(xt(-this.pathOffset.y,e),")")}toClipPathSVG(e){let t=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}toSVG(e){let t=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(e){let{width:t,height:n,pathOffset:r}=this._calcDimensions();this.set({width:t,height:n,pathOffset:r}),e&&this.setPositionByOrigin(r,lt,lt)}_calcBoundsFromPath(){let e=[],t=0,n=0,r=0,s=0;for(let o of this.path)switch(o[0]){case"L":r=o[1],s=o[2],e.push(new J(t,n),new J(r,s));break;case"M":r=o[1],s=o[2],t=r,n=s;break;case"C":e.push(...BE(r,s,o[1],o[2],o[3],o[4],o[5],o[6])),r=o[5],s=o[6];break;case"Q":e.push(...BE(r,s,o[1],o[2],o[1],o[2],o[3],o[4])),r=o[3],s=o[4];break;case"Z":r=t,s=n}return Rr(e)}_calcDimensions(){let e=this._calcBoundsFromPath();return U(U({},e),{},{pathOffset:new J(e.left+e.width/2,e.top+e.height/2)})}static fromObject(e){return this._fromObject(e,{extraParam:"path"})}static fromElement(e,t,n){return He(this,null,function*(){let r=ds(e,this.ATTRIBUTE_NAMES,n),{d:s}=r;return new this(s,U(U(U({},Pt(r,HN)),t),{},{left:void 0,top:void 0}))})}};V(cs,"type","Path"),V(cs,"cacheProperties",[...hs,"path","fillRule"]),V(cs,"ATTRIBUTE_NAMES",[...eo,"d"]),_e.setClass(cs),_e.setSVGClass(cs);var jN=["left","top","radius"],fM=["radius","startAngle","endAngle","counterClockwise"],js=class i extends un{static getDefaults(){return U(U({},super.getDefaults()),i.ownDefaults)}_set(e,t){return super._set(e,t),e==="radius"&&this.setRadius(t),this}_render(e){e.beginPath(),e.arc(0,0,this.radius,rn(this.startAngle),rn(this.endAngle),this.counterClockwise),this._renderPaintInOrder(e)}getRadiusX(){return this.get("radius")*this.get("scaleX")}getRadiusY(){return this.get("radius")*this.get("scaleY")}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...fM,...e])}_toSVG(){let e=(this.endAngle-this.startAngle)%360;if(e===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{let{radius:t}=this,n=rn(this.startAngle),r=rn(this.endAngle),s=lr(n)*t,o=ur(n)*t,a=lr(r)*t,c=ur(r)*t,l=e>180?1:0,u=this.counterClockwise?0:1;return['<path d="M '.concat(s," ").concat(o," A ").concat(t," ").concat(t," 0 ").concat(l," ").concat(u," ").concat(a," ").concat(c,'" '),"COMMON_PARTS",` />
`]}}static fromElement(e,t,n){return He(this,null,function*(){let r=ds(e,this.ATTRIBUTE_NAMES,n),{left:s=0,top:o=0,radius:a=0}=r;return new this(U(U({},Pt(r,jN)),{},{radius:a,left:s-a,top:o-a}))})}static fromObject(e){return super._fromObject(e)}};V(js,"type","Circle"),V(js,"cacheProperties",[...hs,...fM]),V(js,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),V(js,"ATTRIBUTE_NAMES",["cx","cy","r",...eo]),_e.setClass(js),_e.setSVGClass(js);var GN=["x1","y1","x2","y2"],WN=["x1","y1","x2","y2"],RE=["x1","x2","y1","y2"],Jo=class extends un{constructor(){let[e,t,n,r]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(U(U({},s),{},{x1:e,y1:t,x2:n,y2:r})),this._setWidthHeight();let{left:o,top:a}=s;typeof o=="number"&&this.set(Dt,o),typeof a=="number"&&this.set(Gn,a)}_setWidthHeight(){let{x1:e,y1:t,x2:n,y2:r}=this;this.width=Math.abs(n-e),this.height=Math.abs(r-t);let{left:s,top:o,width:a,height:c}=Rr([{x:e,y:t},{x:n,y:r}]),l=new J(s+a/2,o+c/2);this.setPositionByOrigin(l,lt,lt)}_set(e,t){return super._set(e,t),RE.includes(e)&&this._setWidthHeight(),this}_render(e){e.beginPath();let t=this.calcLinePoints();e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2),e.lineWidth=this.strokeWidth;let n=e.strokeStyle;var r;ki(this.stroke)?e.strokeStyle=this.stroke.toLive(e):e.strokeStyle=(r=this.stroke)!==null&&r!==void 0?r:e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=n}_findCenterFromElement(){return new J((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return U(U({},super.toObject(e)),this.calcLinePoints())}_getNonTransformedDimensions(){let e=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e}calcLinePoints(){let{x1:e,x2:t,y1:n,y2:r,width:s,height:o}=this,a=e<=t?-1:1,c=n<=r?-1:1;return{x1:a*s/2,x2:a*-s/2,y1:c*o/2,y2:c*-o/2}}_toSVG(){let{x1:e,x2:t,y1:n,y2:r}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(e,'" y1="').concat(n,'" x2="').concat(t,'" y2="').concat(r,`" />
`)]}static fromElement(e,t,n){return He(this,null,function*(){let r=ds(e,this.ATTRIBUTE_NAMES,n),{x1:s=0,y1:o=0,x2:a=0,y2:c=0}=r;return new this([s,o,a,c],Pt(r,GN))})}static fromObject(e){let{x1:t,y1:n,x2:r,y2:s}=e,o=Pt(e,WN);return this._fromObject(U(U({},o),{},{points:[t,n,r,s]}),{extraParam:"points"})}};V(Jo,"type","Line"),V(Jo,"cacheProperties",[...hs,...RE]),V(Jo,"ATTRIBUTE_NAMES",eo.concat(RE)),_e.setClass(Jo),_e.setSVGClass(Jo);var Rc=class i extends un{static getDefaults(){return U(U({},super.getDefaults()),i.ownDefaults)}_render(e){let t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,n),e.lineTo(0,-n),e.lineTo(t,n),e.closePath(),this._renderPaintInOrder(e)}_toSVG(){let e=this.width/2,t=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-e," ").concat(t,",0 ").concat(-t,",").concat(e," ").concat(t),'" />']}};V(Rc,"type","Triangle"),V(Rc,"ownDefaults",{width:100,height:100}),_e.setClass(Rc),_e.setSVGClass(Rc);var pM=["rx","ry"],Gs=class i extends un{static getDefaults(){return U(U({},super.getDefaults()),i.ownDefaults)}_set(e,t){switch(super._set(e,t),e){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t)}return this}getRx(){return this.get("rx")*this.get("scaleX")}getRy(){return this.get("ry")*this.get("scaleY")}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...pM,...e])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,us,!1),e.restore(),this._renderPaintInOrder(e)}static fromElement(e,t,n){return He(this,null,function*(){let r=ds(e,this.ATTRIBUTE_NAMES,n);return r.left=(r.left||0)-r.rx,r.top=(r.top||0)-r.ry,new this(r)})}};function $N(i){if(!i)return[];let e=i.replace(/,/g," ").trim().split(/\s+/),t=[];for(let n=0;n<e.length;n+=2)t.push({x:parseFloat(e[n]),y:parseFloat(e[n+1])});return t}V(Gs,"type","Ellipse"),V(Gs,"cacheProperties",[...hs,...pM]),V(Gs,"ownDefaults",{rx:0,ry:0}),V(Gs,"ATTRIBUTE_NAMES",[...eo,"cx","cy","rx","ry"]),_e.setClass(Gs),_e.setSVGClass(Gs);var XN=["left","top"],xM={exactBoundingBox:!1},or=class i extends un{static getDefaults(){return U(U({},super.getDefaults()),i.ownDefaults)}constructor(){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(U({points:arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]},e)),V(this,"strokeDiff",void 0);let{left:t,top:n}=e;this.initialized=!0,this.setBoundingBox(!0),typeof t=="number"&&this.set(Dt,t),typeof n=="number"&&this.set(Gn,n)}isOpen(){return!0}_projectStrokeOnPoints(e){return GS(this.points,e,this.isOpen())}_calcDimensions(e){e=U({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},e||{});let t=this.exactBoundingBox?this._projectStrokeOnPoints(e).map(l=>l.projectedPoint):this.points;if(t.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new J,strokeOffset:new J,strokeDiff:new J};let n=Rr(t),r=qu(U(U({},e),{},{scaleX:1,scaleY:1})),s=Rr(this.points.map(l=>jn(l,r,!0))),o=new J(this.scaleX,this.scaleY),a=n.left+n.width/2,c=n.top+n.height/2;return this.exactBoundingBox&&(a-=c*Math.tan(rn(this.skewX)),c-=a*Math.tan(rn(this.skewY))),U(U({},n),{},{pathOffset:new J(a,c),strokeOffset:new J(s.left,s.top).subtract(new J(n.left,n.top)).multiply(o),strokeDiff:new J(n.width,n.height).subtract(new J(s.width,s.height)).multiply(o)})}_findCenterFromElement(){let e=Rr(this.points);return new J(e.left+e.width/2,e.top+e.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(e){let{left:t,top:n,width:r,height:s,pathOffset:o,strokeOffset:a,strokeDiff:c}=this._calcDimensions();this.set({width:r,height:s,pathOffset:o,strokeOffset:a,strokeDiff:c}),e&&this.setPositionByOrigin(new J(t+r/2,n+s/2),lt,lt)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new J(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let o;if(Object.keys(e).some(a=>this.strokeUniform||this.constructor.layoutProperties.includes(a))){var t,n;let{width:a,height:c}=this._calcDimensions(e);o=new J((t=e.width)!==null&&t!==void 0?t:a,(n=e.height)!==null&&n!==void 0?n:c)}else{var r,s;o=new J((r=e.width)!==null&&r!==void 0?r:this.width,(s=e.height)!==null&&s!==void 0?s:this.height)}return o.multiply(new J(e.scaleX||this.scaleX,e.scaleY||this.scaleY))}return super._getTransformedDimensions(e)}_set(e,t){let n=this.initialized&&this[e]!==t,r=super._set(e,t);return this.exactBoundingBox&&n&&((e==="scaleX"||e==="scaleY")&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),r}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return U(U({},super.toObject(e)),{},{points:Ku(this.points)})}_toSVG(){let e=[],t=this.pathOffset.x,n=this.pathOffset.y,r=_t.NUM_FRACTION_DIGITS;for(let s=0,o=this.points.length;s<o;s++)e.push(xt(this.points[s].x-t,r),",",xt(this.points[s].y-n,r)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(e.join(""),`" />
`)]}_render(e){let t=this.points.length,n=this.pathOffset.x,r=this.pathOffset.y;if(t&&!isNaN(this.points[t-1].y)){e.beginPath(),e.moveTo(this.points[0].x-n,this.points[0].y-r);for(let s=0;s<t;s++){let o=this.points[s];e.lineTo(o.x-n,o.y-r)}!this.isOpen()&&e.closePath(),this._renderPaintInOrder(e)}}complexity(){return this.points.length}static fromElement(e,t,n){return He(this,null,function*(){return new this($N(e.getAttribute("points")),U(U({},Pt(ds(e,this.ATTRIBUTE_NAMES,n),XN)),t))})}static fromObject(e){return this._fromObject(e,{extraParam:"points"})}};V(or,"ownDefaults",xM),V(or,"type","Polyline"),V(or,"layoutProperties",["skewX","skewY","strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),V(or,"cacheProperties",[...hs,"points"]),V(or,"ATTRIBUTE_NAMES",[...eo]),_e.setClass(or),_e.setSVGClass(or);var Oc=class extends or{static getDefaults(){return U(U({},super.getDefaults()),or.ownDefaults)}isOpen(){return!1}};V(Oc,"ownDefaults",xM),V(Oc,"type","Polygon"),_e.setClass(Oc),_e.setSVGClass(Oc);var mM=["fontSize","fontWeight","fontFamily","fontStyle"],gM=["underline","overline","linethrough"],vM=[...mM,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],EM=[...vM,...gM,"textBackgroundColor","direction"],qN=[...mM,...gM,"stroke","strokeWidth","fill","deltaY","textBackgroundColor"],YN={_reNewline:GE,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:Dt,fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:Dt,pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2},Ir="justify",R0="justify-left",Vu="justify-right",zu="justify-center",O0=class extends un{isEmptyStyles(e){if(!this.styles||e!==void 0&&!this.styles[e])return!0;let t=e===void 0?this.styles:{line:this.styles[e]};for(let n in t)for(let r in t[n])for(let s in t[n][r])return!1;return!0}styleHas(e,t){if(!this.styles||t!==void 0&&!this.styles[t])return!1;let n=t===void 0?this.styles:{0:this.styles[t]};for(let r in n)for(let s in n[r])if(n[r][s][e]!==void 0)return!0;return!1}cleanStyle(e){if(!this.styles)return!1;let t=this.styles,n,r,s=0,o=!0,a=0;for(let c in t){n=0;for(let l in t[c]){let u=t[c][l]||{};s++,u[e]!==void 0?(r?u[e]!==r&&(o=!1):r=u[e],u[e]===this[e]&&delete u[e]):o=!1,Object.keys(u).length!==0?n++:delete t[c][l]}n===0&&delete t[c]}for(let c=0;c<this._textLines.length;c++)a+=this._textLines[c].length;o&&s===a&&(this[e]=r,this.removeStyle(e))}removeStyle(e){if(!this.styles)return;let t=this.styles,n,r,s;for(r in t){for(s in n=t[r],n)delete n[s][e],Object.keys(n[s]).length===0&&delete n[s];Object.keys(n).length===0&&delete t[r]}}_extendStyles(e,t){let{lineIndex:n,charIndex:r}=this.get2DCursorLocation(e);this._getLineStyle(n)||this._setLineStyle(n);let s=YE(U(U({},this._getStyleDeclaration(n,r)),t),o=>o!==void 0);this._setStyleDeclaration(n,r,s)}getSelectionStyles(e,t,n){let r=[];for(let s=e;s<(t||e);s++)r.push(this.getStyleAtPosition(s,n));return r}getStyleAtPosition(e,t){let{lineIndex:n,charIndex:r}=this.get2DCursorLocation(e);return t?this.getCompleteStyleDeclaration(n,r):this._getStyleDeclaration(n,r)}setSelectionStyles(e,t,n){for(let r=t;r<(n||t);r++)this._extendStyles(r,e);this._forceClearCache=!0}_getStyleDeclaration(e,t){var n;let r=this.styles&&this.styles[e];return r&&(n=r[t])!==null&&n!==void 0?n:{}}getCompleteStyleDeclaration(e,t){return U(U({},aa(this,this.constructor._styleProperties)),this._getStyleDeclaration(e,t))}_setStyleDeclaration(e,t,n){this.styles[e][t]=n}_deleteStyleDeclaration(e,t){delete this.styles[e][t]}_getLineStyle(e){return!!this.styles[e]}_setLineStyle(e){this.styles[e]={}}_deleteLineStyle(e){delete this.styles[e]}};V(O0,"_styleProperties",qN);var ZN=/  +/g,KN=/"/g;function sE(i,e,t,n,r){return"		".concat(function(s,o){let{left:a,top:c,width:l,height:u}=o,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_t.NUM_FRACTION_DIGITS,d=ju("fill",s,!1),[f,x,g,p]=[a,c,l,u].map(m=>xt(m,h));return"<rect ".concat(d,' x="').concat(f,'" y="').concat(x,'" width="').concat(g,'" height="').concat(p,'"></rect>')}(i,{left:e,top:t,width:n,height:r}),`
`)}var JN=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"],oE,In=class i extends O0{static getDefaults(){return U(U({},super.getDefaults()),i.ownDefaults)}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(U(U({},t),{},{text:e,styles:t?.styles||{}})),V(this,"__charBounds",[]),this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){let e=this.path;e&&(e.segmentsInfo=ry(e.path))}_splitText(){let e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(Ir)&&this.enlargeSpaces()}enlargeSpaces(){let e,t,n,r,s,o,a;for(let c=0,l=this._textLines.length;c<l;c++)if((this.textAlign===Ir||c!==l-1&&!this.isEndOfWrapping(c))&&(r=0,s=this._textLines[c],t=this.getLineWidth(c),t<this.width&&(a=this.textLines[c].match(this._reSpacesAndTabs)))){n=a.length,e=(this.width-t)/n;for(let u=0;u<=s.length;u++)o=this.__charBounds[c][u],this._reSpaceAndTab.test(s[u])?(o.width+=e,o.kernedWidth+=e,o.left+=r,r+=e):o.left+=r}}isEndOfWrapping(e){return e===this._textLines.length-1}missingNewlineOffset(e){return 1}get2DCursorLocation(e,t){let n=t?this._unwrappedTextLines:this._textLines,r;for(r=0;r<n.length;r++){if(e<=n[r].length)return{lineIndex:r,charIndex:e};e-=n[r].length+this.missingNewlineOffset(r,t)}return{lineIndex:r-1,charIndex:n[r-1].length<e?n[r-1].length:e}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){let e=super._getCacheCanvasDimensions(),t=this.fontSize;return e.width+=t*e.zoomX,e.height+=t*e.zoomY,e}_render(e){let t=this.path;t&&!t.isNotVisible()&&t._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")}_renderText(e){this.paintFirst==="stroke"?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))}_setTextStyles(e,t,n){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case lt:e.textBaseline="middle";break;case"ascender":e.textBaseline=Gn;break;case"descender":e.textBaseline=fE}e.font=this._getFontDeclaration(t,n)}calcTextWidth(){let e=this.getLineWidth(0);for(let t=1,n=this._textLines.length;t<n;t++){let r=this.getLineWidth(t);r>e&&(e=r)}return e}_renderTextLine(e,t,n,r,s,o){this._renderChars(e,t,n,r,s,o)}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;let t=e.fillStyle,n=this._getLeftOffset(),r=this._getTopOffset();for(let s=0,o=this._textLines.length;s<o;s++){let a=this.getHeightOfLine(s);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",s)){r+=a;continue}let c=this._textLines[s].length,l=this._getLineLeftOffset(s),u,h,d=0,f=0,x=this.getValueOfPropertyAt(s,0,"textBackgroundColor");for(let g=0;g<c;g++){let p=this.__charBounds[s][g];h=this.getValueOfPropertyAt(s,g,"textBackgroundColor"),this.path?(e.save(),e.translate(p.renderLeft,p.renderTop),e.rotate(p.angle),e.fillStyle=h,h&&e.fillRect(-p.width/2,-a/this.lineHeight*(1-this._fontSizeFraction),p.width,a/this.lineHeight),e.restore()):h!==x?(u=n+l+f,this.direction==="rtl"&&(u=this.width-u-d),e.fillStyle=x,x&&e.fillRect(u,r,d,a/this.lineHeight),f=p.left,d=p.width,x=h):d+=p.kernedWidth}h&&!this.path&&(u=n+l+f,this.direction==="rtl"&&(u=this.width-u-d),e.fillStyle=h,e.fillRect(u,r,d,a/this.lineHeight)),r+=a}e.fillStyle=t,this._removeShadow(e)}_measureChar(e,t,n,r){let s=Ou.getFontCache(t),o=this._getFontDeclaration(t),a=n+e,c=n&&o===this._getFontDeclaration(r),l=t.fontSize/this.CACHE_FONT_SIZE,u,h,d,f;if(n&&s[n]!==void 0&&(d=s[n]),s[e]!==void 0&&(f=u=s[e]),c&&s[a]!==void 0&&(h=s[a],f=h-d),u===void 0||d===void 0||h===void 0){let x=function(){if(!oE){let g=ln();g.width=g.height=0,oE=g.getContext("2d")}return oE}();this._setTextStyles(x,t,!0),u===void 0&&(f=u=x.measureText(e).width,s[e]=u),d===void 0&&c&&n&&(d=x.measureText(n).width,s[n]=d),c&&h===void 0&&(h=x.measureText(a).width,s[a]=h,f=h-d)}return{width:u*l,kernedWidth:f*l}}getHeightOfChar(e,t){return this.getValueOfPropertyAt(e,t,"fontSize")}measureLine(e){let t=this._measureLine(e);return this.charSpacing!==0&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t}_measureLine(e){let t,n,r=0,s=this.pathSide===cn,o=this.path,a=this._textLines[e],c=a.length,l=new Array(c);this.__charBounds[e]=l;for(let u=0;u<c;u++){let h=a[u];n=this._getGraphemeBox(h,e,u,t),l[u]=n,r+=n.kernedWidth,t=h}if(l[c]={left:n?n.left+n.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},o&&o.segmentsInfo){let u=0,h=o.segmentsInfo[o.segmentsInfo.length-1].length;switch(this.textAlign){case Dt:u=s?h-r:0;break;case lt:u=(h-r)/2;break;case cn:u=s?0:h-r}u+=this.pathStartOffset*(s?-1:1);for(let d=s?c-1:0;s?d>=0:d<c;s?d--:d++)n=l[d],u>h?u%=h:u<0&&(u+=h),this._setGraphemeOnPath(u,n),u+=n.kernedWidth}return{width:r,numOfSpaces:0}}_setGraphemeOnPath(e,t){let n=e+t.kernedWidth/2,r=this.path,s=sM(r.path,n,r.segmentsInfo);t.renderLeft=s.x-r.pathOffset.x,t.renderTop=s.y-r.pathOffset.y,t.angle=s.angle+(this.pathSide===cn?Math.PI:0)}_getGraphemeBox(e,t,n,r,s){let o=this.getCompleteStyleDeclaration(t,n),a=r?this.getCompleteStyleDeclaration(t,n-1):{},c=this._measureChar(e,o,r,a),l,u=c.kernedWidth,h=c.width;this.charSpacing!==0&&(l=this._getWidthOfCharSpacing(),h+=l,u+=l);let d={width:h,left:0,height:o.fontSize,kernedWidth:u,deltaY:o.deltaY};if(n>0&&!s){let f=this.__charBounds[t][n-1];d.left=f.left+f.width+c.kernedWidth-c.width}return d}getHeightOfLine(e){if(this.__lineHeights[e])return this.__lineHeights[e];let t=this.getHeightOfChar(e,0);for(let n=1,r=this._textLines[e].length;n<r;n++)t=Math.max(this.getHeightOfChar(e,n),t);return this.__lineHeights[e]=t*this.lineHeight*this._fontSizeMult}calcTextHeight(){let e,t=0;for(let n=0,r=this._textLines.length;n<r;n++)e=this.getHeightOfLine(n),t+=n===r-1?e/this.lineHeight:e;return t}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(e,t){e.save();let n=0,r=this._getLeftOffset(),s=this._getTopOffset();for(let o=0,a=this._textLines.length;o<a;o++){let c=this.getHeightOfLine(o),l=c/this.lineHeight,u=this._getLineLeftOffset(o);this._renderTextLine(t,e,this._textLines[o],r+u,s+n+l,o),n+=c}e.restore()}_renderTextFill(e){(this.fill||this.styleHas("fill"))&&this._renderTextCommon(e,"fillText")}_renderTextStroke(e){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())}_renderChars(e,t,n,r,s,o){let a=this.getHeightOfLine(o),c=this.textAlign.includes(Ir),l=this.path,u=!c&&this.charSpacing===0&&this.isEmptyStyles(o)&&!l,h=this.direction==="ltr",d=this.direction==="ltr"?1:-1,f=t.direction,x,g,p,m,v,E="",y=0;if(t.save(),f!==this.direction&&(t.canvas.setAttribute("dir",h?"ltr":"rtl"),t.direction=h?"ltr":"rtl",t.textAlign=h?Dt:cn),s-=a*this._fontSizeFraction/this.lineHeight,u)return this._renderChar(e,t,o,0,n.join(""),r,s),void t.restore();for(let w=0,A=n.length-1;w<=A;w++)m=w===A||this.charSpacing||l,E+=n[w],p=this.__charBounds[o][w],y===0?(r+=d*(p.kernedWidth-p.width),y+=p.width):y+=p.kernedWidth,c&&!m&&this._reSpaceAndTab.test(n[w])&&(m=!0),m||(x=x||this.getCompleteStyleDeclaration(o,w),g=this.getCompleteStyleDeclaration(o,w+1),m=X0(x,g,!1)),m&&(l?(t.save(),t.translate(p.renderLeft,p.renderTop),t.rotate(p.angle),this._renderChar(e,t,o,w,E,-y/2,0),t.restore()):(v=r,this._renderChar(e,t,o,w,E,v,s)),E="",x=g,r+=d*y,y=0);t.restore()}_applyPatternGradientTransformText(e){let t=ln(),n=this.width+this.strokeWidth,r=this.height+this.strokeWidth,s=t.getContext("2d");return t.width=n,t.height=r,s.beginPath(),s.moveTo(0,0),s.lineTo(n,0),s.lineTo(n,r),s.lineTo(0,r),s.closePath(),s.translate(n/2,r/2),s.fillStyle=e.toLive(s),this._applyPatternGradientTransform(s,e),s.fill(),s.createPattern(t,"no-repeat")}handleFiller(e,t,n){let r,s;return ki(n)?n.gradientUnits==="percentage"||n.gradientTransform||n.patternTransform?(r=-this.width/2,s=-this.height/2,e.translate(r,s),e[t]=this._applyPatternGradientTransformText(n),{offsetX:r,offsetY:s}):(e[t]=n.toLive(e),this._applyPatternGradientTransform(e,n)):(e[t]=n,{offsetX:0,offsetY:0})}_setStrokeStyles(e,t){let{stroke:n,strokeWidth:r}=t;return e.lineWidth=r,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",n)}_setFillStyles(e,t){let{fill:n}=t;return this.handleFiller(e,"fillStyle",n)}_renderChar(e,t,n,r,s,o,a){let c=this._getStyleDeclaration(n,r),l=this.getCompleteStyleDeclaration(n,r),u=e==="fillText"&&l.fill,h=e==="strokeText"&&l.stroke&&l.strokeWidth;if(h||u){if(t.save(),t.font=this._getFontDeclaration(l),c.textBackgroundColor&&this._removeShadow(t),c.deltaY&&(a+=c.deltaY),u){let d=this._setFillStyles(t,l);t.fillText(s,o-d.offsetX,a-d.offsetY)}if(h){let d=this._setStrokeStyles(t,l);t.strokeText(s,o-d.offsetX,a-d.offsetY)}t.restore()}}setSuperscript(e,t){this._setScript(e,t,this.superscript)}setSubscript(e,t){this._setScript(e,t,this.subscript)}_setScript(e,t,n){let r=this.get2DCursorLocation(e,!0),s=this.getValueOfPropertyAt(r.lineIndex,r.charIndex,"fontSize"),o=this.getValueOfPropertyAt(r.lineIndex,r.charIndex,"deltaY"),a={fontSize:s*n.size,deltaY:o+s*n.baseline};this.setSelectionStyles(a,e,t)}_getLineLeftOffset(e){let t=this.getLineWidth(e),n=this.width-t,r=this.textAlign,s=this.direction,o=this.isEndOfWrapping(e),a=0;return r===Ir||r===zu&&!o||r===Vu&&!o||r===R0&&!o?0:(r===lt&&(a=n/2),r===cn&&(a=n),r===zu&&(a=n/2),r===Vu&&(a=n),s==="rtl"&&(r===cn||r===Ir||r===Vu?a=0:r===Dt||r===R0?a=-n:r!==lt&&r!==zu||(a=-n/2)),a)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(e){if(this.__lineWidths[e]!==void 0)return this.__lineWidths[e];let{width:t}=this.measureLine(e);return this.__lineWidths[e]=t,t}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(e,t,n){var r;return(r=this._getStyleDeclaration(e,t)[n])!==null&&r!==void 0?r:this[n]}_renderTextDecoration(e,t){if(!this[t]&&!this.styleHas(t))return;let n=this._getTopOffset(),r=this._getLeftOffset(),s=this.path,o=this._getWidthOfCharSpacing(),a=this.offsets[t];for(let c=0,l=this._textLines.length;c<l;c++){let u=this.getHeightOfLine(c);if(!this[t]&&!this.styleHas(t,c)){n+=u;continue}let h=this._textLines[c],d=u/this.lineHeight,f=this._getLineLeftOffset(c),x,g,p=0,m=0,v=this.getValueOfPropertyAt(c,0,t),E=this.getValueOfPropertyAt(c,0,"fill"),y=n+d*(1-this._fontSizeFraction),w=this.getHeightOfChar(c,0),A=this.getValueOfPropertyAt(c,0,"deltaY");for(let D=0,C=h.length;D<C;D++){let _=this.__charBounds[c][D];x=this.getValueOfPropertyAt(c,D,t),g=this.getValueOfPropertyAt(c,D,"fill");let M=this.getHeightOfChar(c,D),B=this.getValueOfPropertyAt(c,D,"deltaY");if(s&&x&&g)e.save(),e.fillStyle=E,e.translate(_.renderLeft,_.renderTop),e.rotate(_.angle),e.fillRect(-_.kernedWidth/2,a*M+B,_.kernedWidth,this.fontSize/15),e.restore();else if((x!==v||g!==E||M!==w||B!==A)&&m>0){let F=r+f+p;this.direction==="rtl"&&(F=this.width-F-m),v&&E&&(e.fillStyle=E,e.fillRect(F,y+a*w+A,m,this.fontSize/15)),p=_.left,m=_.width,v=x,E=g,w=M,A=B}else m+=_.kernedWidth}let b=r+f+p;this.direction==="rtl"&&(b=this.width-b-m),e.fillStyle=g,x&&g&&e.fillRect(b,y+a*w+A,m-o,this.fontSize/15),n+=u}this._removeShadow(e)}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:t=this.fontStyle,fontWeight:n=this.fontWeight,fontSize:r=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0,o=e.includes("'")||e.includes('"')||e.includes(",")||i.genericFonts.includes(e.toLowerCase())?e:'"'.concat(e,'"');return[t,n,"".concat(s?this.CACHE_FONT_SIZE:r,"px"),o].join(" ")}render(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(e)))}graphemeSplit(e){return $0(e)}_splitTextIntoLines(e){let t=e.split(this._reNewline),n=new Array(t.length),r=[`
`],s=[];for(let o=0;o<t.length;o++)n[o]=this.graphemeSplit(t[o]),s=s.concat(n[o],r);return s.pop(),{_unwrappedLines:n,lines:t,graphemeText:s,graphemeLines:n}}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return U(U({},super.toObject([...EM,...e])),{},{styles:$S(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(e,t){let{textLayoutProperties:n}=this.constructor;super.set(e,t);let r=!1,s=!1;if(typeof e=="object")for(let o in e)o==="path"&&this.setPathInfo(),r=r||n.includes(o),s=s||o==="path";else r=n.includes(e),s=e==="path";return s&&this.setPathInfo(),r&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static fromElement(e,t,n){return He(this,null,function*(){let r=ds(e,i.ATTRIBUTE_NAMES,n),s=U(U({},t),r),{textAnchor:o=Dt,textDecoration:a="",dx:c=0,dy:l=0,top:u=0,left:h=0,fontSize:d=jE,strokeWidth:f=1}=s,x=Pt(s,JN),g=new this((e.textContent||"").replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),U({left:h+c,top:u+l,underline:a.includes("underline"),overline:a.includes("overline"),linethrough:a.includes("line-through"),strokeWidth:0,fontSize:d},x)),p=g.getScaledHeight()/g.height,m=((g.height+g.strokeWidth)*g.lineHeight-g.height)*p,v=g.getScaledHeight()+m,E=0;return o===lt&&(E=g.getScaledWidth()/2),o===cn&&(E=g.getScaledWidth()),g.set({left:g.left-E,top:g.top-(v-g.fontSize*(.07+g._fontSizeFraction))/g.lineHeight,strokeWidth:f}),g})}static fromObject(e){return this._fromObject(U(U({},e),{},{styles:XS(e.styles||{},e.text)}),{extraParam:"text"})}};V(In,"textLayoutProperties",vM),V(In,"cacheProperties",[...hs,...EM]),V(In,"ownDefaults",YN),V(In,"type","Text"),V(In,"genericFonts",["sans-serif","serif","cursive","fantasy","monospace"]),V(In,"ATTRIBUTE_NAMES",eo.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),HS(In,[class extends C0{_toSVG(){let i=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(i.textTop,i.textLeft);return this._wrapSVGTextAndBg(e)}toSVG(i){return this._createBaseSVGMarkup(this._toSVG(),{reviver:i,noStyle:!0,withShadow:!0})}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(i){let{textBgRects:e,textSpans:t}=i,n=this.getSvgTextDecoration(this);return[e.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'.concat(this.fontFamily.replace(KN,"'"),'" '):"",this.fontSize?'font-size="'.concat(this.fontSize,'" '):"",this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",n?'text-decoration="'.concat(n,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",t.join(""),`</text>
`]}_getSVGTextAndBg(i,e){let t=[],n=[],r,s=i;this.backgroundColor&&n.push(...sE(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let o=0,a=this._textLines.length;o<a;o++)r=this._getLineLeftOffset(o),this.direction==="rtl"&&(r+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",o))&&this._setSVGTextLineBg(n,o,e+r,s),this._setSVGTextLineText(t,o,e+r,s),s+=this.getHeightOfLine(o);return{textSpans:t,textBgRects:n}}_createTextCharSpan(i,e,t,n){let r=this.getSvgSpanStyles(e,i!==i.trim()||!!i.match(ZN)),s=r?'style="'.concat(r,'"'):"",o=e.deltaY,a=o?' dy="'.concat(xt(o,_t.NUM_FRACTION_DIGITS),'" '):"";return'<tspan x="'.concat(xt(t,_t.NUM_FRACTION_DIGITS),'" y="').concat(xt(n,_t.NUM_FRACTION_DIGITS),'" ').concat(a).concat(s,">").concat(WS(i),"</tspan>")}_setSVGTextLineText(i,e,t,n){let r=this.getHeightOfLine(e),s=this.textAlign.includes(Ir),o=this._textLines[e],a,c,l,u,h,d="",f=0;n+=r*(1-this._fontSizeFraction)/this.lineHeight;for(let x=0,g=o.length-1;x<=g;x++)h=x===g||this.charSpacing,d+=o[x],l=this.__charBounds[e][x],f===0?(t+=l.kernedWidth-l.width,f+=l.width):f+=l.kernedWidth,s&&!h&&this._reSpaceAndTab.test(o[x])&&(h=!0),h||(a=a||this.getCompleteStyleDeclaration(e,x),c=this.getCompleteStyleDeclaration(e,x+1),h=X0(a,c,!0)),h&&(u=this._getStyleDeclaration(e,x),i.push(this._createTextCharSpan(d,u,t,n)),d="",a=c,this.direction==="rtl"?t-=f:t+=f,f=0)}_setSVGTextLineBg(i,e,t,n){let r=this._textLines[e],s=this.getHeightOfLine(e)/this.lineHeight,o,a=0,c=0,l=this.getValueOfPropertyAt(e,0,"textBackgroundColor");for(let u=0;u<r.length;u++){let{left:h,width:d,kernedWidth:f}=this.__charBounds[e][u];o=this.getValueOfPropertyAt(e,u,"textBackgroundColor"),o!==l?(l&&i.push(...sE(l,t+c,n,a,s)),c=h,a=d,l=o):a+=f}o&&i.push(...sE(l,t+c,n,a,s))}_getSVGLineTopOffset(i){let e,t=0;for(e=0;e<i;e++)t+=this.getHeightOfLine(e);let n=this.getHeightOfLine(e);return{lineTop:t,offset:(this._fontSizeMult-this._fontSizeFraction)*n/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(i){return"".concat(super.getSvgStyles(i)," white-space: pre;")}getSvgSpanStyles(i,e){let{fontFamily:t,strokeWidth:n,stroke:r,fill:s,fontSize:o,fontStyle:a,fontWeight:c,deltaY:l}=i,u=this.getSvgTextDecoration(i);return[r?ju("stroke",r):"",n?"stroke-width: ".concat(n,"; "):"",t?"font-family: ".concat(t.includes("'")||t.includes('"')?t:"'".concat(t,"'"),"; "):"",o?"font-size: ".concat(o,"px; "):"",a?"font-style: ".concat(a,"; "):"",c?"font-weight: ".concat(c,"; "):"",u&&"text-decoration: ".concat(u,"; "),s?ju("fill",s):"",l?"baseline-shift: ".concat(-l,"; "):"",e?"white-space: pre; ":""].join("")}getSvgTextDecoration(i){return["overline","underline","line-through"].filter(e=>i[e.replace("-","")]).join(" ")}}]),_e.setClass(In),_e.setSVGClass(In);var OE=class{constructor(e){V(this,"target",void 0),V(this,"__mouseDownInPlace",!1),V(this,"__dragStartFired",!1),V(this,"__isDraggingOver",!1),V(this,"__dragStartSelection",void 0),V(this,"__dragImageDisposer",void 0),V(this,"_dispose",void 0),this.target=e;let t=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{t.forEach(n=>n()),this._dispose=void 0}}isPointerOverSelection(e){let t=this.target,n=t.getSelectionStartFromPointer(e);return t.isEditing&&n>=t.selectionStart&&n<=t.selectionEnd&&t.selectionStart<t.selectionEnd}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e)}isActive(){return this.__mouseDownInPlace}end(e){let t=this.isActive();return t&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,t}getDragStartSelection(){return this.__dragStartSelection}setDragImage(e,t){var n;let{selectionStart:r,selectionEnd:s}=t,o=this.target,a=o.canvas,c=new J(o.flipX?-1:1,o.flipY?-1:1),l=o._getCursorBoundaries(r),u=new J(l.left+l.leftOffset,l.top+l.topOffset).multiply(c).transform(o.calcTransformMatrix()),h=a.getScenePoint(e).subtract(u),d=o.getCanvasRetinaScaling(),f=o.getBoundingRect(),x=u.subtract(new J(f.left,f.top)),g=a.viewportTransform,p=x.add(h).transform(g,!0),m=o.backgroundColor,v=Ku(o.styles);o.backgroundColor="";let E={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};o.setSelectionStyles(E,0,r),o.setSelectionStyles(E,s,o.text.length),o.dirty=!0;let y=o.toCanvasElement({enableRetinaScaling:a.enableRetinaScaling,viewportTransform:!0});o.backgroundColor=m,o.styles=v,o.dirty=!0,Lu(y,{position:"fixed",left:"".concat(-y.width,"px"),border:si,width:"".concat(y.width/d,"px"),height:"".concat(y.height/d,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{y.remove()},ar(e.target||this.target.hiddenTextarea).body.appendChild(y),(n=e.dataTransfer)===null||n===void 0||n.setDragImage(y,p.x,p.y)}onDragStart(e){this.__dragStartFired=!0;let t=this.target,n=this.isActive();if(n&&e.dataTransfer){let r=this.__dragStartSelection={selectionStart:t.selectionStart,selectionEnd:t.selectionEnd},s=t._text.slice(r.selectionStart,r.selectionEnd).join(""),o=U({text:t.text,value:s},r);e.dataTransfer.setData("text/plain",s),e.dataTransfer.setData("application/fabric",JSON.stringify({value:s,styles:t.getSelectionStyles(r.selectionStart,r.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,o)}return t.abortCursorAnimation(),n}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){let t=this.target.getSelectionStartFromPointer(e),n=this.__dragStartSelection;return t<n.selectionStart||t>n.selectionEnd}return!0}return!1}targetCanDrop(e){return this.target.canDrop(e)}dragEnterHandler(e){let{e:t}=e,n=this.targetCanDrop(t);!this.__isDraggingOver&&n&&(this.__isDraggingOver=!0)}dragOverHandler(e){let{e:t}=e,n=this.targetCanDrop(t);!this.__isDraggingOver&&n?this.__isDraggingOver=!0:this.__isDraggingOver&&!n&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(t.preventDefault(),e.canDrop=!0,e.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(e){var t;let{e:n}=e,r=n.defaultPrevented;this.__isDraggingOver=!1,n.preventDefault();let s=(t=n.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain");if(s&&!r){let o=this.target,a=o.canvas,c=o.getSelectionStartFromPointer(n),{styles:l}=n.dataTransfer.types.includes("application/fabric")?JSON.parse(n.dataTransfer.getData("application/fabric")):{},u=s[Math.max(0,s.length-1)],h=0;if(this.__dragStartSelection){let d=this.__dragStartSelection.selectionStart,f=this.__dragStartSelection.selectionEnd;c>d&&c<=f?c=d:c>f&&(c-=f-d),o.removeChars(d,f),delete this.__dragStartSelection}o._reNewline.test(u)&&(o._reNewline.test(o._text[c])||c===o._text.length)&&(s=s.trimEnd()),e.didDrop=!0,e.dropTarget=o,o.insertChars(s,l,c),a.setActiveObject(o),o.enterEditing(n),o.selectionStart=Math.min(c+h,o._text.length),o.selectionEnd=Math.min(o.selectionStart+s.length,o._text.length),o.hiddenTextarea.value=o.text,o._updateTextarea(),o.hiddenTextarea.focus(),o.fire("changed",{index:c+h,action:"drop"}),a.fire("text:changed",{target:o}),a.contextTopDirty=!0,a.requestRenderAll()}}dragEndHandler(e){let{e:t}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var n;let r=this.target,s=this.target.canvas,{selectionStart:o,selectionEnd:a}=this.__dragStartSelection,c=((n=t.dataTransfer)===null||n===void 0?void 0:n.dropEffect)||si;c===si?(r.selectionStart=o,r.selectionEnd=a,r._updateTextarea(),r.hiddenTextarea.focus()):(r.clearContextTop(),c==="move"&&(r.removeChars(o,a),r.selectionStart=r.selectionEnd=o,r.hiddenTextarea&&(r.hiddenTextarea.value=r.text),r._updateTextarea(),r.fire("changed",{index:o,action:"dragend"}),s.fire("text:changed",{target:r}),s.requestRenderAll()),r.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}},KD=/[ \n\.,;!\?\-]/,kE=class extends In{constructor(){super(...arguments),V(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e)}_animateCursor(e){let{toValue:t,duration:n,delay:r,onComplete:s}=e;return KE({startValue:this._currentCursorOpacity,endValue:t,duration:n,delay:r,onComplete:s,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:o=>{this._currentCursorOpacity=o,this.renderCursorOrSelection()}})}_tick(e){this._currentTickState=this._animateCursor({toValue:1,duration:this.cursorDuration,delay:e,onComplete:this._onTickComplete})}_onTickComplete(){var e;(e=this._currentTickCompleteState)===null||e===void 0||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:100,onComplete:this._tick})}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay)}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach(t=>{t&&!t.isDone()&&(e=!0,t.abort())}),this._currentCursorOpacity=1,e&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(e=>!e||e.isDone())&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(e){let t=0,n=e-1;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n--;for(;/\S/.test(this._text[n])&&n>-1;)t++,n--;return e-t}findWordBoundaryRight(e){let t=0,n=e;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n++;for(;/\S/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t}findLineBoundaryLeft(e){let t=0,n=e-1;for(;!/\n/.test(this._text[n])&&n>-1;)t++,n--;return e-t}findLineBoundaryRight(e){let t=0,n=e;for(;!/\n/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t}searchWordBoundary(e,t){let n=this._text,r=e>0&&this._reSpace.test(n[e])&&(t===-1||!GE.test(n[e-1]))?e-1:e,s=n[r];for(;r>0&&r<n.length&&!KD.test(s);)r+=t,s=n[r];return t===-1&&KD.test(s)&&r++,r}selectWord(e){e=e||this.selectionStart;let t=this.searchWordBoundary(e,-1),n=Math.max(t,this.searchWordBoundary(e,1));this.selectionStart=t,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(e){e=e||this.selectionStart;let t=this.findLineBoundaryLeft(e),n=this.findLineBoundaryRight(e);return this.selectionStart=t,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea(),this}enterEditing(e){!this.isEditing&&this.editable&&(this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered",e?{e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e}),this.canvas.requestRenderAll()))}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;let t=this.hiddenTextarea;ar(t).activeElement!==t&&t.focus();let n=this.getSelectionStartFromPointer(e),r=this.selectionStart,s=this.selectionEnd;(n===this.__selectionStartOnMouseDown&&r!==s||r!==n&&s!==n)&&(n>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=n):(this.selectionStart=n,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===r&&this.selectionEnd===s||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(e,t,n){let r=n.slice(0,e),s=this.graphemeSplit(r).length;if(e===t)return{selectionStart:s,selectionEnd:s};let o=n.slice(e,t);return{selectionStart:s,selectionEnd:s+this.graphemeSplit(o).length}}fromGraphemeToStringSelection(e,t,n){let r=n.slice(0,e).join("").length;return e===t?{selectionStart:r,selectionEnd:r}:{selectionStart:r,selectionEnd:r+n.slice(e,t).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){let e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};let e=this.hiddenTextarea;this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();let t=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){let e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};let e=this.inCompositionMode?this.compositionStart:this.selectionStart,t=this._getCursorBoundaries(e),n=this.get2DCursorLocation(e),r=n.lineIndex,s=n.charIndex,o=this.getValueOfPropertyAt(r,s,"fontSize")*this.lineHeight,a=t.leftOffset,c=this.getCanvasRetinaScaling(),l=this.canvas.upperCanvasEl,u=l.width/c,h=l.height/c,d=u-o,f=h-o,x=new J(t.left+a,t.top+t.topOffset+o).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new J(l.clientWidth/u,l.clientHeight/h));return x.x<0&&(x.x=0),x.x>d&&(x.x=d),x.y<0&&(x.y=0),x.y>f&&(x.y=f),x.x+=this.canvas._offset.left,x.y+=this.canvas._offset.top,{left:"".concat(x.x,"px"),top:"".concat(x.y,"px"),fontSize:"".concat(o,"px"),charHeight:o}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){let e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditing(){let e=this._textBeforeEdit!==this.text;return this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),e&&this.fire("modified"),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(let e in this.styles)this._textLines[e]||delete this.styles[e]}removeStyleFromTo(e,t){let{lineIndex:n,charIndex:r}=this.get2DCursorLocation(e,!0),{lineIndex:s,charIndex:o}=this.get2DCursorLocation(t,!0);if(n!==s){if(this.styles[n])for(let a=r;a<this._unwrappedTextLines[n].length;a++)delete this.styles[n][a];if(this.styles[s])for(let a=o;a<this._unwrappedTextLines[s].length;a++){let c=this.styles[s][a];c&&(this.styles[n]||(this.styles[n]={}),this.styles[n][r+a-o]=c)}for(let a=n+1;a<=s;a++)delete this.styles[a];this.shiftLineStyles(s,n-s)}else if(this.styles[n]){let a=this.styles[n],c=o-r;for(let l=r;l<o;l++)delete a[l];for(let l in this.styles[n]){let u=parseInt(l,10);u>=o&&(a[u-c]=a[l],delete a[l])}}}shiftLineStyles(e,t){let n=Object.assign({},this.styles);for(let r in this.styles){let s=parseInt(r,10);s>e&&(this.styles[s+t]=n[s],n[s-t]||delete this.styles[s])}}insertNewlineStyleObject(e,t,n,r){let s={},o=this._unwrappedTextLines[e].length,a=o===t,c=!1;n||(n=1),this.shiftLineStyles(e,n);let l=this.styles[e]?this.styles[e][t===0?t:t-1]:void 0;for(let h in this.styles[e]){let d=parseInt(h,10);d>=t&&(c=!0,s[d-t]=this.styles[e][h],a&&t===0||delete this.styles[e][h])}let u=!1;for(c&&!a&&(this.styles[e+n]=s,u=!0),(u||o>t)&&n--;n>0;)r&&r[n-1]?this.styles[e+n]={0:U({},r[n-1])}:l?this.styles[e+n]={0:U({},l)}:delete this.styles[e+n],n--;this._forceClearCache=!0}insertCharStyleObject(e,t,n,r){this.styles||(this.styles={});let s=this.styles[e],o=s?U({},s):{};n||(n=1);for(let c in o){let l=parseInt(c,10);l>=t&&(s[l+n]=o[l],o[l-n]||delete s[l])}if(this._forceClearCache=!0,r){for(;n--;)Object.keys(r[n]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][t+n]=U({},r[n]));return}if(!s)return;let a=s[t?t-1:1];for(;a&&n--;)this.styles[e][t+n]=U({},a)}insertNewStyleBlock(e,t,n){let r=this.get2DCursorLocation(t,!0),s=[0],o,a=0;for(let c=0;c<e.length;c++)e[c]===`
`?(a++,s[a]=0):s[a]++;for(s[0]>0&&(this.insertCharStyleObject(r.lineIndex,r.charIndex,s[0],n),n=n&&n.slice(s[0]+1)),a&&this.insertNewlineStyleObject(r.lineIndex,r.charIndex+s[0],a),o=1;o<a;o++)s[o]>0?this.insertCharStyleObject(r.lineIndex+o,0,s[o],n):n&&this.styles[r.lineIndex+o]&&n[0]&&(this.styles[r.lineIndex+o][0]=n[0]),n=n&&n.slice(s[o]+1);s[o]>0&&this.insertCharStyleObject(r.lineIndex+o,0,s[o],n)}removeChars(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e+1;this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:n;r>n&&this.removeStyleFromTo(n,r);let s=this.graphemeSplit(e);this.insertNewStyleBlock(s,n,t),this._text=[...this._text.slice(0,n),...s,...this._text.slice(r)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(e,t,n){n<=e?(t===e?this._selectionDirection=Dt:this._selectionDirection===cn&&(this._selectionDirection=Dt,this.selectionEnd=e),this.selectionStart=n):n>e&&n<t?this._selectionDirection===cn?this.selectionEnd=n:this.selectionStart=n:(t===e?this._selectionDirection=cn:this._selectionDirection===Dt&&(this._selectionDirection=cn,this.selectionStart=t),this.selectionEnd=n)}},NE=class extends kE{initHiddenTextarea(){let e=this.canvas&&ar(this.canvas.getElement())||sl(),t=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off"}).map(o=>{let[a,c]=o;return t.setAttribute(a,c)});let{top:n,left:r,fontSize:s}=this._calcTextareaPosition();t.style.cssText="position: absolute; top: ".concat(n,"; left: ").concat(r,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(s,";"),(this.hiddenTextareaContainer||e.body).appendChild(t),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map(o=>{let[a,c]=o;return t.addEventListener(a,this[c].bind(this))}),this.hiddenTextarea=t}blur(){this.abortCursorAnimation()}onKeyDown(e){if(!this.isEditing)return;let t=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(e){let t=this.fromPaste;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;let n=()=>{this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void n();let r=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,s=this._text.length,o=r.length,a=this.selectionStart,c=this.selectionEnd,l=a!==c,u,h,d,f,x=o-s,g=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),p=a>g.selectionStart;l?(h=this._text.slice(a,c),x+=c-a):o<s&&(h=p?this._text.slice(c+x,c):this._text.slice(a,a-x));let m=r.slice(g.selectionEnd-x,g.selectionEnd);if(h&&h.length&&(m.length&&(u=this.getSelectionStyles(a,a+1,!1),u=m.map(()=>u[0])),l?(d=a,f=c):p?(d=c-h.length,f=c):(d=c,f=c+h.length),this.removeStyleFromTo(d,f)),m.length){let{copyPasteData:v}=Or();t&&m.join("")===v.copiedText&&!_t.disableStyleCopyPaste&&(u=v.copiedTextStyle),this.insertNewStyleBlock(m,a,u)}n()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(e){let{target:t}=e,{selectionStart:n,selectionEnd:r}=t;this.compositionStart=n,this.compositionEnd=r,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;let{copyPasteData:e}=Or();e.copiedText=this.getSelectedText(),_t.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(e,t){let n,r=this._getLineLeftOffset(e);return t>0&&(n=this.__charBounds[e][t-1],r+=n.left+n.width),r}getDownCursorOffset(e,t){let n=this._getSelectionForOffset(e,t),r=this.get2DCursorLocation(n),s=r.lineIndex;if(s===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-n;let o=r.charIndex,a=this._getWidthBeforeCursor(s,o),c=this._getIndexOnLine(s+1,a);return this._textLines[s].slice(o).length+c+1+this.missingNewlineOffset(s)}_getSelectionForOffset(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart}getUpCursorOffset(e,t){let n=this._getSelectionForOffset(e,t),r=this.get2DCursorLocation(n),s=r.lineIndex;if(s===0||e.metaKey||e.keyCode===33)return-n;let o=r.charIndex,a=this._getWidthBeforeCursor(s,o),c=this._getIndexOnLine(s-1,a),l=this._textLines[s].slice(0,o),u=this.missingNewlineOffset(s-1);return-this._textLines[s-1].length+c-l.length+(1-u)}_getIndexOnLine(e,t){let n=this._textLines[e],r,s,o=this._getLineLeftOffset(e),a=0;for(let c=0,l=n.length;c<l;c++)if(r=this.__charBounds[e][c].width,o+=r,o>t){s=!0;let u=o-r,h=o,d=Math.abs(u-t);a=Math.abs(h-t)<d?c:c-1;break}return s||(a=n.length-1),a}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)}moveCursorUp(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)}_moveCursorUpOrDown(e,t){let n=this["get".concat(e,"CursorOffset")](t,this._selectionDirection===cn);if(t.shiftKey?this.moveCursorWithShift(n):this.moveCursorWithoutShift(n),n!==0){let r=this.text.length;this.selectionStart=sa(0,this.selectionStart,r),this.selectionEnd=sa(0,this.selectionEnd,r),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(e){let t=this._selectionDirection===Dt?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),e!==0}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0}moveCursorLeft(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)}_move(e,t,n){let r;if(e.altKey)r=this["findWordBoundary".concat(n)](this[t]);else{if(!e.metaKey&&e.keyCode!==35&&e.keyCode!==36)return this[t]+=n==="Left"?-1:1,!0;r=this["findLineBoundary".concat(n)](this[t])}return r!==void 0&&this[t]!==r&&(this[t]=r,!0)}_moveLeft(e,t){return this._move(e,t,"Left")}_moveRight(e,t){return this._move(e,t,"Right")}moveCursorLeftWithoutShift(e){let t=!0;return this._selectionDirection=Dt,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t}moveCursorLeftWithShift(e){return this._selectionDirection===cn&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=Dt,this._moveLeft(e,"selectionStart")):void 0}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)}_moveCursorLeftOrRight(e,t){let n="moveCursor".concat(e).concat(t.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[n](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(e){return this._selectionDirection===Dt&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=cn,this._moveRight(e,"selectionEnd")):void 0}moveCursorRightWithoutShift(e){let t=!0;return this._selectionDirection=cn,this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t}},aE=i=>!!i.button,LE=class extends NE{constructor(){super(...arguments),V(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler),this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown),this.draggableTextDelegate=new OE(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(e){return this.draggableTextDelegate.onDragStart(e)}canDrop(e){return this.draggableTextDelegate.canDrop(e)}onMouseDown(e){if(!this.canvas)return;this.__newClickTime=+new Date;let t=e.pointer;this.isTripleClick(t)&&(this.fire("tripleclick",e),mE(e.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=t,this.__lastSelected=this.selected&&!this.getActiveControl()}isTripleClick(e){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y}doubleClickHandler(e){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(e.e))}tripleClickHandler(e){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(e.e))}_mouseDownHandler(e){let{e:t}=e;this.canvas&&this.editable&&!aE(t)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(t)||(this.canvas.textEditingManager.register(this),this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(t)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection())))}_mouseDownHandlerBefore(e){let{e:t}=e;this.canvas&&this.editable&&!aE(t)&&(this.selected=this===this.canvas._activeObject)}mouseUpHandler(e){let{e:t,transform:n}=e,r=this.draggableTextDelegate.end(t);if(this.canvas){this.canvas.textEditingManager.unregister(this);let s=this.canvas._activeObject;if(s&&s!==this)return}!this.editable||this.group&&!this.group.interactive||n&&n.actionPerformed||aE(t)||r||(this.__lastSelected&&!this.getActiveControl()?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(t),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0)}setCursorByClick(e){let t=this.getSelectionStartFromPointer(e),n=this.selectionStart,r=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(n,r,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(e){let t=this.canvas.getScenePoint(e).transform(gi(this.calcTransformMatrix())).add(new J(-this._getLeftOffset(),-this._getTopOffset())),n=0,r=0,s=0;for(let l=0;l<this._textLines.length&&n<=t.y;l++)n+=this.getHeightOfLine(l),s=l,l>0&&(r+=this._textLines[l-1].length+this.missingNewlineOffset(l-1));let o=Math.abs(this._getLineLeftOffset(s)),a=this._textLines[s].length,c=this.__charBounds[s];for(let l=0;l<a;l++){let u=o+c[l].kernedWidth;if(t.x<=u){Math.abs(t.x-u)<=Math.abs(t.x-o)&&r++;break}o=u,r++}return Math.min(this.flipX?a-r:r,this._text.length)}},c0="moveCursorUp",l0="moveCursorDown",u0="moveCursorLeft",h0="moveCursorRight",d0="exitEditing",QN=U({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:d0,27:d0,33:c0,34:l0,35:h0,36:u0,37:u0,38:c0,39:h0,40:l0},keysMapRtl:{9:d0,27:d0,33:c0,34:l0,35:u0,36:h0,37:h0,38:c0,39:u0,40:l0},ctrlKeysMapDown:{65:"selectAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1}),$s=class i extends LE{static getDefaults(){return U(U({},super.getDefaults()),i.ownDefaults)}get type(){let e=super.type;return e==="itext"?"i-text":e}constructor(e,t){super(e,t),this.initBehavior()}_set(e,t){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=t,this):(e==="canvas"&&(this.canvas instanceof kr&&this.canvas.textEditingManager.remove(this),t instanceof kr&&t.textEditingManager.add(this)),super._set(e,t))}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)}_updateAndFire(e,t){this[e]!==t&&(this._fireSelectionChanged(),this[e]=t),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,n=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,t,n)}setSelectionStyles(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,t,n)}get2DCursorLocation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,t)}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(e){let t=this.isEditing;this.isEditing=!1;let n=super.toCanvasElement(e);return this.isEditing=t,n}renderCursorOrSelection(){if(!this.isEditing)return;let e=this.clearContextTop(!0);if(!e)return;let t=this._getCursorBoundaries();this.selectionStart===this.selectionEnd?this.renderCursor(e,t):this.renderSelection(e,t),this.canvas.contextTopDirty=!0,e.restore()}_getCursorBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0,n=this._getLeftOffset(),r=this._getTopOffset(),s=this._getCursorBoundariesOffsets(e,t);return{left:n,top:r,leftOffset:s.left,topOffset:s.top}}_getCursorBoundariesOffsets(e,t){return t?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e)}__getCursorBoundariesOffsets(e){let t=0,n=0,{charIndex:r,lineIndex:s}=this.get2DCursorLocation(e);for(let l=0;l<s;l++)t+=this.getHeightOfLine(l);let o=this._getLineLeftOffset(s),a=this.__charBounds[s][r];a&&(n=a.left),this.charSpacing!==0&&r===this._textLines[s].length&&(n-=this._getWidthOfCharSpacing());let c={top:t,left:o+(n>0?n:0)};return this.direction==="rtl"&&(this.textAlign===cn||this.textAlign===Ir||this.textAlign===Vu?c.left*=-1:this.textAlign===Dt||this.textAlign===R0?c.left=o-(n>0?n:0):this.textAlign!==lt&&this.textAlign!==zu||(c.left=o-(n>0?n:0))),c}renderCursorAt(e){let t=this._getCursorBoundaries(e,!0);this._renderCursor(this.canvas.contextTop,t,e)}renderCursor(e,t){this._renderCursor(e,t,this.selectionStart)}_renderCursor(e,t,n){let r=this.get2DCursorLocation(n),s=r.lineIndex,o=r.charIndex>0?r.charIndex-1:0,a=this.getValueOfPropertyAt(s,o,"fontSize"),c=this.getObjectScaling().x*this.canvas.getZoom(),l=this.cursorWidth/c,u=this.getValueOfPropertyAt(s,o,"deltaY"),h=t.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(s)/this.lineHeight-a*(1-this._fontSizeFraction);this.inCompositionMode&&this.renderSelection(e,t),e.fillStyle=this.cursorColor||this.getValueOfPropertyAt(s,o,"fill"),e.globalAlpha=this._currentCursorOpacity,e.fillRect(t.left+t.leftOffset-l/2,h+t.top+u,l,a)}renderSelection(e,t){let n={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,n,t)}renderDragSourceEffect(){let e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0))}renderDropTargetEffect(e){let t=this.getSelectionStartFromPointer(e);this.renderCursorAt(t)}_renderSelection(e,t,n){let r=t.selectionStart,s=t.selectionEnd,o=this.textAlign.includes(Ir),a=this.get2DCursorLocation(r),c=this.get2DCursorLocation(s),l=a.lineIndex,u=c.lineIndex,h=a.charIndex<0?0:a.charIndex,d=c.charIndex<0?0:c.charIndex;for(let f=l;f<=u;f++){let x=this._getLineLeftOffset(f)||0,g=this.getHeightOfLine(f),p=0,m=0,v=0;if(f===l&&(m=this.__charBounds[l][h].left),f>=l&&f<u)v=o&&!this.isEndOfWrapping(f)?this.width:this.getLineWidth(f)||5;else if(f===u)if(d===0)v=this.__charBounds[u][d].left;else{let b=this._getWidthOfCharSpacing();v=this.__charBounds[u][d-1].left+this.__charBounds[u][d-1].width-b}p=g,(this.lineHeight<1||f===u&&this.lineHeight>1)&&(g/=this.lineHeight);let E=n.left+x+m,y=g,w=0,A=v-m;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",y=1,w=g):e.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===cn||this.textAlign===Ir||this.textAlign===Vu?E=this.width-E-A:this.textAlign===Dt||this.textAlign===R0?E=n.left+x-v:this.textAlign!==lt&&this.textAlign!==zu||(E=n.left+x-v)),e.fillRect(E,n.top+n.topOffset+w,A,y),n.topOffset+=p}}getCurrentCharFontSize(){let e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")}getCurrentCharColor(){let e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fill")}_getCurrentCharIndex(){let e=this.get2DCursorLocation(this.selectionStart,!0),t=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:t}}dispose(){this._exitEditing(),this.draggableTextDelegate.dispose(),super.dispose()}};V($s,"ownDefaults",QN),V($s,"type","IText"),_e.setClass($s),_e.setClass($s,"i-text");var kc=class i extends $s{static getDefaults(){return U(U({},super.getDefaults()),{},{controls:zS()},i.ownDefaults)}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(Ir)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(e){let t=0,n=0,r=0,s={};for(let o=0;o<e.graphemeLines.length;o++)e.graphemeText[r]===`
`&&o>0?(n=0,r++,t++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[r])&&o>0&&(n++,r++),s[o]={line:t,offset:n},r+=e.graphemeLines[o].length,n+=e.graphemeLines[o].length;return s}styleHas(e,t){if(this._styleMap&&!this.isWrapping){let n=this._styleMap[t];n&&(t=n.line)}return super.styleHas(e,t)}isEmptyStyles(e){if(!this.styles)return!0;let t,n=0,r=e+1,s=!1,o=this._styleMap[e],a=this._styleMap[e+1];o&&(e=o.line,n=o.offset),a&&(r=a.line,s=r===e,t=a.offset);let c=e===void 0?this.styles:{line:this.styles[e]};for(let l in c)for(let u in c[l]){let h=parseInt(u,10);if(h>=n&&(!s||h<t))for(let d in c[l][u])return!1}return!0}_getStyleDeclaration(e,t){if(this._styleMap&&!this.isWrapping){let n=this._styleMap[e];if(!n)return{};e=n.line,t=n.offset+t}return super._getStyleDeclaration(e,t)}_setStyleDeclaration(e,t,n){let r=this._styleMap[e];super._setStyleDeclaration(r.line,r.offset+t,n)}_deleteStyleDeclaration(e,t){let n=this._styleMap[e];super._deleteStyleDeclaration(n.line,n.offset+t)}_getLineStyle(e){let t=this._styleMap[e];return!!this.styles[t.line]}_setLineStyle(e){let t=this._styleMap[e];super._setLineStyle(t.line)}_wrapText(e,t){this.isWrapping=!0;let n=this.getGraphemeDataForRender(e),r=[];for(let s=0;s<n.wordsData.length;s++)r.push(...this._wrapLine(s,t,n));return this.isWrapping=!1,r}getGraphemeDataForRender(e){let t=this.splitByGrapheme,n=t?"":" ",r=0;return{wordsData:e.map((s,o)=>{let a=0,c=t?this.graphemeSplit(s):this.wordSplit(s);return c.length===0?[{word:[],width:0}]:c.map(l=>{let u=t?[l]:this.graphemeSplit(l),h=this._measureWord(u,o,a);return r=Math.max(h,r),a+=u.length+n.length,{word:u,width:h}})}),largestWordWidth:r}}_measureWord(e,t){let n,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=0;for(let o=0,a=e.length;o<a;o++)s+=this._getGraphemeBox(e[o],t,o+r,n,!0).kernedWidth,n=e[o];return s}wordSplit(e){return e.split(this._wordJoiners)}_wrapLine(e,t,n){let{largestWordWidth:r,wordsData:s}=n,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=this._getWidthOfCharSpacing(),c=this.splitByGrapheme,l=[],u=c?"":" ",h=0,d=[],f=0,x=0,g=!0;t-=o;let p=Math.max(t,r,this.dynamicMinWidth),m=s[e],v;for(f=0,v=0;v<m.length;v++){let{word:E,width:y}=m[v];f+=E.length,h+=x+y-a,h>p&&!g?(l.push(d),d=[],h=y,g=!0):h+=a,g||c||d.push(u),d=d.concat(E),x=c?0:this._measureWord([u],e,f),f++,g=!1}return v&&l.push(d),r+o>this.dynamicMinWidth&&(this.dynamicMinWidth=r-a+o),l}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line}missingNewlineOffset(e,t){return this.splitByGrapheme&&!t?this.isEndOfWrapping(e)?1:0:1}_splitTextIntoLines(e){let t=super._splitTextIntoLines(e),n=this._wrapText(t.lines,this.width),r=new Array(n.length);for(let s=0;s<n.length;s++)r[s]=n[s].join("");return t.lines=r,t.graphemeLines=n,t}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){let e=new Map;for(let t in this._styleMap){let n=parseInt(t,10);if(this._textLines[n]){let r=this._styleMap[t].line;e.set("".concat(r),!0)}}for(let t in this.styles)e.has(t)||delete this.styles[t]}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e])}};V(kc,"type","Textbox"),V(kc,"textLayoutProperties",[...$s.textLayoutProperties,"width"]),V(kc,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),_e.setClass(kc);var k0=class extends rl{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e)}shouldLayoutClipPath(){return!1}calcLayoutResult(e,t){let{target:n}=e,{clipPath:r}=n;if(!r||!this.shouldPerformLayout(e))return;let{width:s,height:o}=Rr(ZS(n,r)),a=new J(s,o);if(r.absolutePositioned){var c;return{center:Xs(r.getRelativeCenterPoint(),void 0,(c=n.group)===null||c===void 0?void 0:c.calcTransformMatrix()),size:a}}{let l=r.getRelativeCenterPoint().transform(n.calcOwnMatrix(),!0);if(this.shouldPerformLayout(e)){let{center:u=new J,correction:h=new J}=this.calcBoundingBox(t,e)||{};return{center:u.add(l),correction:h.subtract(l),size:a}}return{center:n.getRelativeCenterPoint().add(l),size:a}}}};V(k0,"type","clip-path"),_e.setClass(k0);var N0=class extends rl{getInitialSize(e,t){let{target:n}=e,{size:r}=t;return new J(n.width||r.x,n.height||r.y)}};V(N0,"type","fixed"),_e.setClass(N0);var UE=class extends oa{subscribeTargets(e){let t=e.target;e.targets.reduce((n,r)=>(r.parent&&n.add(r.parent),n),new Set).forEach(n=>{n.layoutManager.subscribeTargets({target:n,targets:[t]})})}unsubscribeTargets(e){let t=e.target,n=t.getObjects();e.targets.reduce((r,s)=>(s.parent&&r.add(s.parent),r),new Set).forEach(r=>{!n.some(s=>s.parent===r)&&r.layoutManager.unsubscribeTargets({target:r,targets:[t]})})}},Nc=class i extends qs{static getDefaults(){return U(U({},super.getDefaults()),i.ownDefaults)}constructor(){var e;let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],U(U({},t),{},{layoutManager:(e=t.layoutManager)!==null&&e!==void 0?e:new UE}))}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.multiSelectionStacking==="selection-order"?this.add(...t):t.forEach(r=>{let s=this._objects.findIndex(a=>a.isInFrontOf(r)),o=s===-1?this.size():s;this.insertAt(o,r)})}canEnterGroup(e){return this.getObjects().some(t=>t.isDescendantOf(e)||e.isDescendantOf(t))?(Zs("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e)}enterGroup(e,t){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,t)}exitGroup(e,t){this._exitGroup(e,t),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,t){super._onAfterObjectsChange(e,t);let n=new Set;t.forEach(r=>{let{parent:s}=r;s&&n.add(s)}),e===iy?n.forEach(r=>{r._onAfterObjectsChange(F0,t)}):n.forEach(r=>{r._set("dirty",!0)})}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,t,n){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,super._renderControls(e,t);let r=U(U({hasControls:!1},n),{},{forActiveSelection:!0});for(let s=0;s<this._objects.length;s++)this._objects[s]._renderControls(e,r);e.restore()}};V(Nc,"type","ActiveSelection"),V(Nc,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),_e.setClass(Nc),_e.setClass(Nc,"activeSelection");var VE=class{constructor(){V(this,"resources",{})}applyFilters(e,t,n,r,s){let o=s.getContext("2d");if(!o)return;o.drawImage(t,0,0,n,r);let a={sourceWidth:n,sourceHeight:r,imageData:o.getImageData(0,0,n,r),originalEl:t,originalImageData:o.getImageData(0,0,n,r),canvasEl:s,ctx:o,filterBackend:this};e.forEach(l=>{l.applyTo(a)});let{imageData:c}=a;return c.width===n&&c.height===r||(s.width=c.width,s.height=c.height),o.putImageData(c,0,0),a}},L0=class{constructor(){let{tileSize:e=_t.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};V(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),V(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo()}setupGLContext(e,t){this.dispose(),this.createWebGLCanvas(e,t)}createWebGLCanvas(e,t){let n=ln();n.width=e,n.height=t;let r=n.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});r&&(r.clearColor(0,0,0,0),this.canvas=n,this.gl=r)}applyFilters(e,t,n,r,s,o){let a=this.gl,c=s.getContext("2d");if(!a||!c)return;let l;o&&(l=this.getCachedTexture(o,t));let u={originalWidth:t.width||t.originalWidth||0,originalHeight:t.height||t.originalHeight||0,sourceWidth:n,sourceHeight:r,destinationWidth:n,destinationHeight:r,context:a,sourceTexture:this.createTexture(a,n,r,l?void 0:t),targetTexture:this.createTexture(a,n,r),originalTexture:l||this.createTexture(a,n,r,l?void 0:t),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:s},h=a.createFramebuffer();return a.bindFramebuffer(a.FRAMEBUFFER,h),e.forEach(d=>{d&&d.applyTo(u)}),function(d){let f=d.targetCanvas,x=f.width,g=f.height,p=d.destinationWidth,m=d.destinationHeight;x===p&&g===m||(f.width=p,f.height=m)}(u),this.copyGLTo2D(a,u),a.bindTexture(a.TEXTURE_2D,null),a.deleteTexture(u.sourceTexture),a.deleteTexture(u.targetTexture),a.deleteFramebuffer(h),c.setTransform(1,0,0,1,0,0),u}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(e,t,n,r,s){let{NEAREST:o,TEXTURE_2D:a,RGBA:c,UNSIGNED_BYTE:l,CLAMP_TO_EDGE:u,TEXTURE_MAG_FILTER:h,TEXTURE_MIN_FILTER:d,TEXTURE_WRAP_S:f,TEXTURE_WRAP_T:x}=e,g=e.createTexture();return e.bindTexture(a,g),e.texParameteri(a,h,s||o),e.texParameteri(a,d,s||o),e.texParameteri(a,f,u),e.texParameteri(a,x,u),r?e.texImage2D(a,0,c,c,l,r):e.texImage2D(a,0,c,t,n,0,c,l,null),g}getCachedTexture(e,t,n){let{textureCache:r}=this;if(r[e])return r[e];{let s=this.createTexture(this.gl,t.width,t.height,t,n);return s&&(r[e]=s),s}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])}copyGLTo2D(e,t){let n=e.canvas,r=t.targetCanvas,s=r.getContext("2d");if(!s)return;s.translate(0,r.height),s.scale(1,-1);let o=n.height-r.height;s.drawImage(n,0,o,r.width,r.height,0,0,r.width,r.height)}copyGLTo2DPutImageData(e,t){let n=t.targetCanvas.getContext("2d"),r=t.destinationWidth,s=t.destinationHeight,o=r*s*4;if(!n)return;let a=new Uint8Array(this.imageBuffer,0,o),c=new Uint8ClampedArray(this.imageBuffer,0,o);e.readPixels(0,0,r,s,e.RGBA,e.UNSIGNED_BYTE,a);let l=new ImageData(c,r,s);n.putImageData(l,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;let e=this.gl,t={renderer:"",vendor:""};if(!e)return t;let n=e.getExtension("WEBGL_debug_renderer_info");if(n){let r=e.getParameter(n.UNMASKED_RENDERER_WEBGL),s=e.getParameter(n.UNMASKED_VENDOR_WEBGL);r&&(t.renderer=r.toLowerCase()),s&&(t.vendor=s.toLowerCase())}return this.gpuInfo=t,t}},cE;function eL(){let{WebGLProbe:i}=Or();return i.queryWebGL(ln()),_t.enableGLFiltering&&i.isSupported(_t.textureSize)?new L0({tileSize:_t.textureSize}):new VE}function lE(){return!cE&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(cE=eL()),cE}var tL=["filters","resizeFilter","src","crossOrigin","type"],yM=["cropX","cropY"],Oi=class i extends un{static getDefaults(){return U(U({},super.getDefaults()),i.ownDefaults)}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(U({filters:[]},t)),V(this,"_lastScaleX",1),V(this,"_lastScaleY",1),V(this,"_filterScalingX",1),V(this,"_filterScalingY",1),this.cacheKey="texture".concat(Js()),this.setElement(typeof e=="string"?(this.canvas&&ar(this.canvas.getElement())||sl()).getElementById(e):e,t)}getElement(){return this._element}setElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=e,this._originalElement=e,this._setWidthHeight(t),e.classList.add(i.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(e){let t=lE(!1);t instanceof L0&&t.evictCachesForKey(e)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(e=>{let t=this[e];t&&Or().dispose(t),this[e]=void 0})}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){let e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0}}_stroke(e){if(!this.stroke||this.strokeWidth===0)return;let t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,-n),e.lineTo(t,-n),e.lineTo(t,n),e.lineTo(-t,n),e.lineTo(-t,-n),e.closePath()}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=[];return this.filters.forEach(n=>{n&&t.push(n.toObject())}),U(U({},super.toObject([...yM,...e])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:t},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){let e=[],t=this._element,n=-this.width/2,r=-this.height/2,s=[],o=[],a="",c="";if(!t)return[];if(this.hasCrop()){let l=Js();s.push('<clipPath id="imageCrop_'+l+`">
`,'	<rect x="'+n+'" y="'+r+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),a=' clip-path="url(#imageCrop_'+l+')" '}if(this.imageSmoothing||(c=' image-rendering="optimizeSpeed"'),e.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(n-this.cropX,'" y="').concat(r-this.cropY,'" width="').concat(t.width||t.naturalWidth,'" height="').concat(t.height||t.naturalHeight,'"').concat(c).concat(a,`></image>
`)),this.stroke||this.strokeDashArray){let l=this.fill;this.fill=null,o=['	<rect x="'.concat(n,'" y="').concat(r,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=l}return s=this.paintFirst!=="fill"?s.concat(o,e):s.concat(e,o),s}getSrc(e){let t=e?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src")||"":t.src:this.src||""}getSvgSrc(e){return this.getSrc(e)}setSrc(e){let{crossOrigin:t,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Nu(e,{crossOrigin:t,signal:n}).then(r=>{t!==void 0&&this.set({crossOrigin:t}),this.setElement(r)})}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){let e=this.resizeFilter,t=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),r=n.x,s=n.y,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||r>t&&s>t)return this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=r,void(this._lastScaleY=s);let a=ln(),c=o.width,l=o.height;a.width=c,a.height=l,this._element=a,this._lastScaleX=e.scaleX=r,this._lastScaleY=e.scaleY=s,lE().applyFilters([e],o,c,l,this._element),this._filterScalingX=a.width/this._originalElement.width,this._filterScalingY=a.height/this._originalElement.height}applyFilters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(e=e.filter(s=>s&&!s.isNeutralState()),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),e.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);let t=this._originalElement,n=t.naturalWidth||t.width,r=t.naturalHeight||t.height;if(this._element===this._originalElement){let s=ln();s.width=n,s.height=r,this._element=s,this._filteredEl=s}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,r),this._lastScaleX=1,this._lastScaleY=1);lE().applyFilters(e,this._originalElement,n,r,this._element),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e)}shouldCache(){return this.needsItsOwnCache()}_renderFill(e){let t=this._element;if(!t)return;let n=this._filterScalingX,r=this._filterScalingY,s=this.width,o=this.height,a=Math.max(this.cropX,0),c=Math.max(this.cropY,0),l=t.naturalWidth||t.width,u=t.naturalHeight||t.height,h=a*n,d=c*r,f=Math.min(s*n,l-h),x=Math.min(o*r,u-d),g=-s/2,p=-o/2,m=Math.min(s,l/n-a),v=Math.min(o,u/r-c);t&&e.drawImage(t,h,d,f,x,g,p,m,v)}_needsResize(){let e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:e,height:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=this.getOriginalSize();this.width=e||n.width,this.height=t||n.height}parsePreserveAspectRatioAttribute(){let e=cS(this.preserveAspectRatio||""),t=this.width,n=this.height,r={width:t,height:n},s,o=this._element.width,a=this._element.height,c=1,l=1,u=0,h=0,d=0,f=0;return!e||e.alignX===si&&e.alignY===si?(c=t/o,l=n/a):(e.meetOrSlice==="meet"&&(c=l=JS(this._element,r),s=(t-o*c)/2,e.alignX==="Min"&&(u=-s),e.alignX==="Max"&&(u=s),s=(n-a*l)/2,e.alignY==="Min"&&(h=-s),e.alignY==="Max"&&(h=s)),e.meetOrSlice==="slice"&&(c=l=QS(this._element,r),s=o-t/c,e.alignX==="Mid"&&(d=s/2),e.alignX==="Max"&&(d=s),s=a-n/l,e.alignY==="Mid"&&(f=s/2),e.alignY==="Max"&&(f=s),o=t/c,a=n/l)),{width:o,height:a,scaleX:c,scaleY:l,offsetLeft:u,offsetTop:h,cropX:d,cropY:f}}static fromObject(e){let{filters:t,resizeFilter:n,src:r,crossOrigin:s,type:o}=e,a=Pt(e,tL),c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Promise.all([Nu(r,U(U({},c),{},{crossOrigin:s})),t&&nl(t,c),n&&nl([n],c),Yu(a,c)]).then(l=>{let[u,h=[],[d]=[],f={}]=l;return new this(u,U(U({},a),{},{src:r,filters:h,resizeFilter:d},f))})}static fromURL(e){let{crossOrigin:t=null,signal:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;return Nu(e,{crossOrigin:t,signal:n}).then(s=>new this(s,r))}static fromElement(t){return He(this,arguments,function*(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,s=ds(e,this.ATTRIBUTE_NAMES,r);return this.fromURL(s["xlink:href"],n,s).catch(o=>(Zs("log","Unable to parse Image",o),null))})}};V(Oi,"type","Image"),V(Oi,"cacheProperties",[...hs,...yM]),V(Oi,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),V(Oi,"CSS_CANVAS","canvas-img"),V(Oi,"ATTRIBUTE_NAMES",[...eo,"x","y","width","height","preserveAspectRatio","xlink:href","crossOrigin","image-rendering"]),_e.setClass(Oi),_e.setSVGClass(Oi);var OX=G0(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);var CM="modifyPoly",JD=i=>function(e,t,n){let{points:r,pathOffset:s}=n;return new J(r[i]).subtract(s).transform(Pn(n.getViewportTransform(),n.calcTransformMatrix()))},_M=(i,e,t,n)=>{let{target:r,pointIndex:s}=e,o=r,a=Xs(new J(t,n),void 0,o.calcOwnMatrix());return o.points[s]=a.add(o.pathOffset),o.setDimensions(),!0},AM=(i,e)=>function(t,n,r,s){let o=n.target,a=new J(o.points[(i>0?i:o.points.length)-1]),c=a.subtract(o.pathOffset).transform(o.calcOwnMatrix()),l=e(t,U(U({},n),{},{pointIndex:i}),r,s),u=a.subtract(o.pathOffset).transform(o.calcOwnMatrix()).subtract(c);return o.left-=u.x,o.top-=u.y,l},QD=i=>Qs(CM,AM(i,_M)),kX=Object.freeze({__proto__:null,changeWidth:DE,createObjectDefaultControls:ty,createPolyActionHandler:QD,createPolyControls:function(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t={};for(let n=0;n<(typeof i=="number"?i:i.points.length);n++)t["p".concat(n)]=new Hn(U({actionName:CM,positionHandler:JD(n),actionHandler:QD(n)},e));return t},createPolyPositionHandler:JD,createResizeControls:VS,createTextboxDefaultControls:zS,dragHandler:CS,factoryPolyActionHandler:AM,getLocalPoint:H0,polyActionHandler:_M,renderCircleControl:MS,renderSquareControl:TS,rotationStyleHandler:FS,rotationWithSnapping:BS,scaleCursorStyleHandler:Ic,scaleOrSkewActionName:Ru,scaleSkewCursorStyleHandler:Qo,scalingEqually:Pu,scalingX:RS,scalingXOrSkewingY:SE,scalingY:OS,scalingYOrSkewingX:ME,skewCursorStyleHandler:kS,skewHandlerX:LS,skewHandlerY:US,wrapWithFireEvent:Qs,wrapWithFixedAnchor:ca}),q0=i=>i.webgl!==void 0;var zE="precision highp float",nL=`
    `.concat(zE,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),iL=["type"],rL=["type"],hn=class{get type(){return this.constructor.type}constructor(){let e=Pt(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},iL);V(this,"vertexSource",`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`),Object.assign(this,this.constructor.defaults,e)}getFragmentSource(){return nL}createProgram(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.vertexSource,{WebGLProbe:{GLPrecision:r="highp"}}=Or();r!=="highp"&&(t=t.replace(new RegExp(zE,"g"),zE.replace("highp",r)));let s=e.createShader(e.VERTEX_SHADER),o=e.createShader(e.FRAGMENT_SHADER),a=e.createProgram();if(!s||!o||!a)throw new Ni("Vertex, fragment shader or program creation error");if(e.shaderSource(s,n),e.compileShader(s),!e.getShaderParameter(s,e.COMPILE_STATUS))throw new Ni("Vertex shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(s)));if(e.shaderSource(o,t),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))throw new Ni("Fragment shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(o)));if(e.attachShader(a,s),e.attachShader(a,o),e.linkProgram(a),!e.getProgramParameter(a,e.LINK_STATUS))throw new Ni('Shader link error for "'.concat(this.type,'" ').concat(e.getProgramInfoLog(a)));let c=this.getUniformLocations(e,a)||{};return c.uStepW=e.getUniformLocation(a,"uStepW"),c.uStepH=e.getUniformLocation(a,"uStepH"),{program:a,attributeLocations:this.getAttributeLocations(e,a),uniformLocations:c}}getAttributeLocations(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}}getUniformLocations(e,t){return{}}sendAttributeData(e,t,n){let r=t.aPosition,s=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,s),e.enableVertexAttribArray(r),e.vertexAttribPointer(r,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}_setupFrameBuffer(e){let t=e.context;if(e.passes>1){let n=e.destinationWidth,r=e.destinationHeight;e.sourceWidth===n&&e.sourceHeight===r||(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,n,r)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0)}else t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish()}_swapTextures(e){e.passes--,e.pass++;let t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t}isNeutralState(e){let t=this.mainParameter,n=this.constructor.defaults[t];if(t){let r=this[t];return Array.isArray(n)&&Array.isArray(r)?n.every((s,o)=>s===r[o]):n===r}return!1}applyTo(e){q0(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){}getCacheKey(){return this.type}retrieveShader(e){let t=this.getCacheKey();return e.programCache[t]||(e.programCache[t]=this.createProgram(e.context)),e.programCache[t]}applyToWebGL(e){let t=e.context,n=this.retrieveShader(e);e.pass===0&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(n.program),this.sendAttributeData(t,n.attributeLocations,e.aPosition),t.uniform1f(n.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(n.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,n.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(e,t,n){e.activeTexture(n),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)}unbindAdditionalTexture(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}getMainParameter(){return this.mainParameter?this[this.mainParameter]:void 0}setMainParameter(e){this.mainParameter&&(this[this.mainParameter]=e)}sendUniformData(e,t){}createHelpLayer(e){if(!e.helpLayer){let t=ln();t.width=e.sourceWidth,t.height=e.sourceHeight,e.helpLayer=t}}toObject(){let e=this.mainParameter;return U({type:this.type},e?{[e]:this[e]}:{})}toJSON(){return this.toObject()}static fromObject(e,t){return He(this,null,function*(){return new this(Pt(e,rL))})}};V(hn,"type","BaseFilter");var sL={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `},Uc=class extends hn{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(sL[this.mode],`
        }
      }
      `)}applyTo2d(e){let{imageData:{data:t}}=e,n=new Qn(this.color).getSource(),r=n[0]*this.alpha,s=n[1]*this.alpha,o=n[2]*this.alpha,a=1-this.alpha;for(let c=0;c<t.length;c+=4){let l=t[c],u=t[c+1],h=t[c+2];switch(this.mode){case"multiply":t[c]=l*r/255,t[c+1]=u*s/255,t[c+2]=h*o/255;break;case"screen":t[c]=255-(255-l)*(255-r)/255,t[c+1]=255-(255-u)*(255-s)/255,t[c+2]=255-(255-h)*(255-o)/255;break;case"add":t[c]=l+r,t[c+1]=u+s,t[c+2]=h+o;break;case"difference":t[c]=Math.abs(l-r),t[c+1]=Math.abs(u-s),t[c+2]=Math.abs(h-o);break;case"subtract":t[c]=l-r,t[c+1]=u-s,t[c+2]=h-o;break;case"darken":t[c]=Math.min(l,r),t[c+1]=Math.min(u,s),t[c+2]=Math.min(h,o);break;case"lighten":t[c]=Math.max(l,r),t[c+1]=Math.max(u,s),t[c+2]=Math.max(h,o);break;case"overlay":t[c]=r<128?2*l*r/255:255-2*(255-l)*(255-r)/255,t[c+1]=s<128?2*u*s/255:255-2*(255-u)*(255-s)/255,t[c+2]=o<128?2*h*o/255:255-2*(255-h)*(255-o)/255;break;case"exclusion":t[c]=r+l-2*r*l/255,t[c+1]=s+u-2*s*u/255,t[c+2]=o+h-2*o*h/255;break;case"tint":t[c]=r+l*a,t[c+1]=s+u*a,t[c+2]=o+h*a}}}getUniformLocations(e,t){return{uColor:e.getUniformLocation(t,"uColor")}}sendUniformData(e,t){let n=new Qn(this.color).getSource();n[0]=this.alpha*n[0]/255,n[1]=this.alpha*n[1]/255,n[2]=this.alpha*n[2]/255,n[3]=this.alpha,e.uniform4fv(t.uColor,n)}toObject(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}};V(Uc,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),V(Uc,"type","BlendColor"),_e.setClass(Uc);var oL={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},aL=["type","image"],Vc=class extends hn{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return oL[this.mode]}applyToWebGL(e){let t=e.context,n=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(t,n,t.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(t,t.TEXTURE1)}createTexture(e,t){return e.getCachedTexture(t.cacheKey,t.getElement())}calculateMatrix(){let e=this.image,{width:t,height:n}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/t,-e.top/n,1]}applyTo2d(e){let{imageData:{data:t,width:n,height:r},filterBackend:{resources:s}}=e,o=this.image;s.blendImage||(s.blendImage=ln());let a=s.blendImage,c=a.getContext("2d");a.width!==n||a.height!==r?(a.width=n,a.height=r):c.clearRect(0,0,n,r),c.setTransform(o.scaleX,0,0,o.scaleY,o.left,o.top),c.drawImage(o.getElement(),0,0,n,r);let l=c.getImageData(0,0,n,r).data;for(let u=0;u<t.length;u+=4){let h=t[u],d=t[u+1],f=t[u+2],x=t[u+3],g=l[u],p=l[u+1],m=l[u+2],v=l[u+3];switch(this.mode){case"multiply":t[u]=h*g/255,t[u+1]=d*p/255,t[u+2]=f*m/255,t[u+3]=x*v/255;break;case"mask":t[u+3]=v}}}getUniformLocations(e,t){return{uTransformMatrix:e.getUniformLocation(t,"uTransformMatrix"),uImage:e.getUniformLocation(t,"uImage")}}sendUniformData(e,t){let n=this.calculateMatrix();e.uniform1i(t.uImage,1),e.uniformMatrix3fv(t.uTransformMatrix,!1,n)}toObject(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}static fromObject(e,t){let{type:n,image:r}=e,s=Pt(e,aL);return Oi.fromObject(r,t).then(o=>new this(U(U({},s),{},{image:o})))}};V(Vc,"type","BlendImage"),V(Vc,"defaults",{mode:"multiply",alpha:1,vertexSource:`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}),_e.setClass(Vc);var zc=class extends hn{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float total = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        float weight = 1.0 - abs(percent);
        color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
        total += weight;
      }
      gl_FragColor = color / total;
    }
  `}applyTo(e){q0(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){e.imageData=this.simpleBlur(e)}simpleBlur(e){let{ctx:t,imageData:n,filterBackend:{resources:r}}=e,{width:s,height:o}=n;r.blurLayer1||(r.blurLayer1=ln(),r.blurLayer2=ln());let a=r.blurLayer1,c=r.blurLayer2;a.width===s&&a.height===o||(c.width=a.width=s,c.height=a.height=o);let l=a.getContext("2d"),u=c.getContext("2d"),h=15,d=.06*this.blur*.5,f,x,g,p;for(l.putImageData(n,0,0),u.clearRect(0,0,s,o),p=-15;p<=h;p++)f=(Math.random()-.5)/4,x=p/h,g=d*x*s+f,u.globalAlpha=1-Math.abs(x),u.drawImage(a,g,f),l.drawImage(c,0,0),u.globalAlpha=1,u.clearRect(0,0,c.width,c.height);for(p=-15;p<=h;p++)f=(Math.random()-.5)/4,x=p/h,g=d*x*o+f,u.globalAlpha=1-Math.abs(x),u.drawImage(a,f,g),l.drawImage(c,0,0),u.globalAlpha=1,u.clearRect(0,0,c.width,c.height);t.drawImage(a,0,0);let m=t.getImageData(0,0,a.width,a.height);return l.globalAlpha=1,l.clearRect(0,0,a.width,a.height),m}getUniformLocations(e,t){return{delta:e.getUniformLocation(t,"uDelta")}}sendUniformData(e,t){let n=this.chooseRightDelta();e.uniform2fv(t.delta,n)}chooseRightDelta(){let e=1,t=[0,0];this.horizontal?this.aspectRatio>1&&(e=1/this.aspectRatio):this.aspectRatio<1&&(e=this.aspectRatio);let n=e*this.blur*.12;return this.horizontal?t[0]=n:t[1]=n,t}};V(zc,"type","Blur"),V(zc,"defaults",{blur:0,mainParameter:"blur"}),_e.setClass(zc);var Hc=class extends hn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;if(this.brightness===0)return;let n=Math.round(255*this.brightness);for(let r=0;r<t.length;r+=4)t[r]=t[r]+n,t[r+1]=t[r+1]+n,t[r+2]=t[r+2]+n}getUniformLocations(e,t){return{uBrightness:e.getUniformLocation(t,"uBrightness")}}sendUniformData(e,t){e.uniform1f(t.uBrightness,this.brightness)}};V(Hc,"type","Brightness"),V(Hc,"defaults",{brightness:0,mainParameter:"brightness"}),_e.setClass(Hc);var cL=["matrix"],wM={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0},Ys=class extends hn{setOptions(e){let{matrix:t}=e,n=Pt(e,cL);t&&(this.matrix=[...t]),Object.assign(this,n)}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(e){let t=e.imageData.data,n=this.matrix,r=this.colorsOnly;for(let s=0;s<t.length;s+=4){let o=t[s],a=t[s+1],c=t[s+2];if(r)t[s]=o*n[0]+a*n[1]+c*n[2]+255*n[4],t[s+1]=o*n[5]+a*n[6]+c*n[7]+255*n[9],t[s+2]=o*n[10]+a*n[11]+c*n[12]+255*n[14];else{let l=t[s+3];t[s]=o*n[0]+a*n[1]+c*n[2]+l*n[3]+255*n[4],t[s+1]=o*n[5]+a*n[6]+c*n[7]+l*n[8]+255*n[9],t[s+2]=o*n[10]+a*n[11]+c*n[12]+l*n[13]+255*n[14],t[s+3]=o*n[15]+a*n[16]+c*n[17]+l*n[18]+255*n[19]}}}getUniformLocations(e,t){return{uColorMatrix:e.getUniformLocation(t,"uColorMatrix"),uConstants:e.getUniformLocation(t,"uConstants")}}sendUniformData(e,t){let n=this.matrix,r=[n[0],n[1],n[2],n[3],n[5],n[6],n[7],n[8],n[10],n[11],n[12],n[13],n[15],n[16],n[17],n[18]],s=[n[4],n[9],n[14],n[19]];e.uniformMatrix4fv(t.uColorMatrix,!1,r),e.uniform4fv(t.uConstants,s)}};function la(i,e){var t;let n=(V(t=class extends Ys{},"type",i),V(t,"defaults",U(U({},wM),{},{mainParameter:void 0,matrix:e})),t);return _e.setClass(n,i),n}V(Ys,"type","ColorMatrix"),V(Ys,"defaults",wM),_e.setClass(Ys);var lL=la("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]),uL=la("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]),hL=la("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]),dL=la("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]),fL=la("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]),pL=la("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]),xL=la("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]),mL=["subFilters"],Xu=class extends hn{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{subFilters:t=[]}=e;super(Pt(e,mL)),this.subFilters=t}applyTo(e){q0(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach(t=>{t.applyTo(e)})}toObject(){return U(U({},super.toObject()),{},{subFilters:this.subFilters.map(e=>e.toObject())})}isNeutralState(){return!this.subFilters.some(e=>!e.isNeutralState())}static fromObject(e,t){return Promise.all((e.subFilters||[]).map(n=>_e.getClass(n.type).fromObject(n,t))).then(n=>new this({subFilters:n}))}};V(Xu,"type","Composed"),_e.setClass(Xu);var jc=class extends hn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}applyTo2d(e){let{imageData:{data:t}}=e;if(this.contrast===0)return;let n=Math.floor(255*this.contrast),r=259*(n+255)/(255*(259-n));for(let s=0;s<t.length;s+=4)t[s]=r*(t[s]-128)+128,t[s+1]=r*(t[s+1]-128)+128,t[s+2]=r*(t[s+2]-128)+128}getUniformLocations(e,t){return{uContrast:e.getUniformLocation(t,"uContrast")}}sendUniformData(e,t){e.uniform1f(t.uContrast,this.contrast)}};V(jc,"type","Contrast"),V(jc,"defaults",{contrast:0,mainParameter:"contrast"}),_e.setClass(jc);var gL={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `},Gc=class extends hn{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return gL[this.getCacheKey()]}applyTo2d(e){let t=e.imageData,n=t.data,r=this.matrix,s=Math.round(Math.sqrt(r.length)),o=Math.floor(s/2),a=t.width,c=t.height,l=e.ctx.createImageData(a,c),u=l.data,h=this.opaque?1:0,d,f,x,g,p,m,v,E,y,w,A,b,D;for(A=0;A<c;A++)for(w=0;w<a;w++){for(p=4*(A*a+w),d=0,f=0,x=0,g=0,D=0;D<s;D++)for(b=0;b<s;b++)v=A+D-o,m=w+b-o,v<0||v>=c||m<0||m>=a||(E=4*(v*a+m),y=r[D*s+b],d+=n[E]*y,f+=n[E+1]*y,x+=n[E+2]*y,h||(g+=n[E+3]*y));u[p]=d,u[p+1]=f,u[p+2]=x,u[p+3]=h?n[p+3]:g}e.imageData=l}getUniformLocations(e,t){return{uMatrix:e.getUniformLocation(t,"uMatrix"),uOpaque:e.getUniformLocation(t,"uOpaque"),uHalfSize:e.getUniformLocation(t,"uHalfSize"),uSize:e.getUniformLocation(t,"uSize")}}sendUniformData(e,t){e.uniform1fv(t.uMatrix,this.matrix)}toObject(){return U(U({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}};V(Gc,"type","Convolute"),V(Gc,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),_e.setClass(Gc);var vL=["gamma"],Wc=class extends hn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{gamma:t=[1,1,1]}=e;super(Pt(e,vL)),this.gamma=t}applyTo2d(e){let{imageData:{data:t}}=e,n=this.gamma,r=1/n[0],s=1/n[1],o=1/n[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});let a=this.rgbValues;for(let c=0;c<256;c++)a.r[c]=255*Math.pow(c/255,r),a.g[c]=255*Math.pow(c/255,s),a.b[c]=255*Math.pow(c/255,o);for(let c=0;c<t.length;c+=4)t[c]=a.r[t[c]],t[c+1]=a.g[t[c+1]],t[c+2]=a.b[t[c+2]]}getUniformLocations(e,t){return{uGamma:e.getUniformLocation(t,"uGamma")}}sendUniformData(e,t){e.uniform3fv(t.uGamma,this.gamma)}};V(Wc,"type","Gamma"),V(Wc,"defaults",{mainParameter:"gamma",gamma:[1,1,1]}),_e.setClass(Wc);var EL={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `},$c=class extends hn{applyTo2d(e){let{imageData:{data:t}}=e;for(let n,r=0;r<t.length;r+=4){switch(this.mode){case"average":n=(t[r]+t[r+1]+t[r+2])/3;break;case"lightness":n=(Math.min(t[r],t[r+1],t[r+2])+Math.max(t[r],t[r+1],t[r+2]))/2;break;case"luminosity":n=.21*t[r]+.72*t[r+1]+.07*t[r+2]}t[r]=n,t[r+1]=n,t[r+2]=n}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return EL[this.mode]}getUniformLocations(e,t){return{uMode:e.getUniformLocation(t,"uMode")}}sendUniformData(e,t){e.uniform1i(t.uMode,1)}isNeutralState(){return!1}};V($c,"type","Grayscale"),V($c,"defaults",{mode:"average",mainParameter:"mode"}),_e.setClass($c);var Xc=class extends Ys{calculateMatrix(){let e=this.rotation*Math.PI,t=lr(e),n=ur(e),r=1/3,s=Math.sqrt(r)*n,o=1-t;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=t+o/3,this.matrix[1]=r*o-s,this.matrix[2]=r*o+s,this.matrix[5]=r*o+s,this.matrix[6]=t+r*o,this.matrix[7]=r*o-s,this.matrix[10]=r*o-s,this.matrix[11]=r*o+s,this.matrix[12]=t+r*o}isNeutralState(){return this.calculateMatrix(),super.isNeutralState()}applyTo(e){this.calculateMatrix(),super.applyTo(e)}};V(Xc,"type","HueRotation"),V(Xc,"defaults",{rotation:0,mainParameter:"rotation"}),_e.setClass(Xc);var qc=class extends hn{applyTo2d(e){let{imageData:{data:t}}=e;for(let n=0;n<t.length;n+=4)t[n]=255-t[n],t[n+1]=255-t[n+1],t[n+2]=255-t[n+2],this.alpha&&(t[n+3]=255-t[n+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}getUniformLocations(e,t){return{uInvert:e.getUniformLocation(t,"uInvert"),uAlpha:e.getUniformLocation(t,"uAlpha")}}sendUniformData(e,t){e.uniform1i(t.uInvert,Number(this.invert)),e.uniform1i(t.uAlpha,Number(this.alpha))}};V(qc,"type","Invert"),V(qc,"defaults",{alpha:!1,invert:!0,mainParameter:"invert"}),_e.setClass(qc);var Yc=class extends hn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;if(this.noise===0)return;let n=this.noise;for(let r=0;r<t.length;r+=4){let s=(.5-Math.random())*n;t[r]+=s,t[r+1]+=s,t[r+2]+=s}}getUniformLocations(e,t){return{uNoise:e.getUniformLocation(t,"uNoise"),uSeed:e.getUniformLocation(t,"uSeed")}}sendUniformData(e,t){e.uniform1f(t.uNoise,this.noise/255),e.uniform1f(t.uSeed,Math.random())}toObject(){return U(U({},super.toObject()),{},{noise:this.noise})}};V(Yc,"type","Noise"),V(Yc,"defaults",{mainParameter:"noise",noise:0}),_e.setClass(Yc);var Zc=class extends hn{applyTo2d(e){let{imageData:{data:t,width:n,height:r}}=e;for(let s=0;s<r;s+=this.blocksize)for(let o=0;o<n;o+=this.blocksize){let a=4*s*n+4*o,c=t[a],l=t[a+1],u=t[a+2],h=t[a+3];for(let d=s;d<Math.min(s+this.blocksize,r);d++)for(let f=o;f<Math.min(o+this.blocksize,n);f++){let x=4*d*n+4*f;t[x]=c,t[x+1]=l,t[x+2]=u,t[x+3]=h}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepW;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}getUniformLocations(e,t){return{uBlocksize:e.getUniformLocation(t,"uBlocksize"),uStepW:e.getUniformLocation(t,"uStepW"),uStepH:e.getUniformLocation(t,"uStepH")}}sendUniformData(e,t){e.uniform1f(t.uBlocksize,this.blocksize)}};V(Zc,"type","Pixelate"),V(Zc,"defaults",{blocksize:4,mainParameter:"blocksize"}),_e.setClass(Zc);var Kc=class extends hn{getFragmentShader(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(e){let{imageData:{data:t}}=e,n=255*this.distance,r=new Qn(this.color).getSource(),s=[r[0]-n,r[1]-n,r[2]-n],o=[r[0]+n,r[1]+n,r[2]+n];for(let a=0;a<t.length;a+=4){let c=t[a],l=t[a+1],u=t[a+2];c>s[0]&&l>s[1]&&u>s[2]&&c<o[0]&&l<o[1]&&u<o[2]&&(t[a+3]=0)}}getUniformLocations(e,t){return{uLow:e.getUniformLocation(t,"uLow"),uHigh:e.getUniformLocation(t,"uHigh")}}sendUniformData(e,t){let n=new Qn(this.color).getSource(),r=this.distance,s=[0+n[0]/255-r,0+n[1]/255-r,0+n[2]/255-r,1],o=[n[0]/255+r,n[1]/255+r,n[2]/255+r,1];e.uniform4fv(t.uLow,s),e.uniform4fv(t.uHigh,o)}toObject(){return U(U({},super.toObject()),{},{color:this.color,distance:this.distance})}};V(Kc,"type","RemoveColor"),V(Kc,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),_e.setClass(Kc);var Jc=class extends hn{getUniformLocations(e,t){return{uDelta:e.getUniformLocation(t,"uDelta"),uTaps:e.getUniformLocation(t,"uTaps")}}sendUniformData(e,t){e.uniform2fv(t.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(t.uTaps,this.taps)}getFilterWindow(){let e=this.tempScale;return Math.ceil(this.lanczosLobes/e)}getCacheKey(){let e=this.getFilterWindow();return"".concat(this.type,"_").concat(e)}getFragmentSource(){let e=this.getFilterWindow();return this.generateShader(e)}getTaps(){let e=this.lanczosCreate(this.lanczosLobes),t=this.tempScale,n=this.getFilterWindow(),r=new Array(n);for(let s=1;s<=n;s++)r[s-1]=e(s*t);return r}generateShader(e){let t=new Array(e);for(let n=1;n<=e;n++)t[n-1]="".concat(n,".0 * uDelta");return`
      `.concat(this.fragmentSourceTOP,`
      uniform float uTaps[`).concat(e,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(t.map((n,r)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(n,") * uTaps[").concat(r,"] + texture2D(uTexture, vTexCoord - ").concat(n,") * uTaps[").concat(r,`];
              sum += 2.0 * uTaps[`).concat(r,`];
            `)).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight}applyTo(e){q0(e)?this.applyToForWebgl(e):this.applyTo2d(e)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(e){return t=>{if(t>=e||t<=-e)return 0;if(t<11920929e-14&&t>-11920929e-14)return 1;let n=(t*=Math.PI)/e;return Math.sin(t)/t*Math.sin(n)/n}}applyTo2d(e){let t=e.imageData,n=this.scaleX,r=this.scaleY;this.rcpScaleX=1/n,this.rcpScaleY=1/r;let s=t.width,o=t.height,a=Math.round(s*n),c=Math.round(o*r),l;l=this.resizeType==="sliceHack"?this.sliceByTwo(e,s,o,a,c):this.resizeType==="hermite"?this.hermiteFastResize(e,s,o,a,c):this.resizeType==="bilinear"?this.bilinearFiltering(e,s,o,a,c):this.resizeType==="lanczos"?this.lanczosResize(e,s,o,a,c):new ImageData(a,c),e.imageData=l}sliceByTwo(e,t,n,r,s){let o=e.imageData,a=.5,c=!1,l=!1,u=t*a,h=n*a,d=e.filterBackend.resources,f=0,x=0,g=t,p=0;d.sliceByTwo||(d.sliceByTwo=ln());let m=d.sliceByTwo;(m.width<1.5*t||m.height<n)&&(m.width=1.5*t,m.height=n);let v=m.getContext("2d");for(v.clearRect(0,0,1.5*t,n),v.putImageData(o,0,0),r=Math.floor(r),s=Math.floor(s);!c||!l;)t=u,n=h,r<Math.floor(u*a)?u=Math.floor(u*a):(u=r,c=!0),s<Math.floor(h*a)?h=Math.floor(h*a):(h=s,l=!0),v.drawImage(m,f,x,t,n,g,p,u,h),f=g,x=p,p+=h;return v.getImageData(f,x,r,s)}lanczosResize(e,t,n,r,s){let o=e.imageData.data,a=e.ctx.createImageData(r,s),c=a.data,l=this.lanczosCreate(this.lanczosLobes),u=this.rcpScaleX,h=this.rcpScaleY,d=2/this.rcpScaleX,f=2/this.rcpScaleY,x=Math.ceil(u*this.lanczosLobes/2),g=Math.ceil(h*this.lanczosLobes/2),p={},m={x:0,y:0},v={x:0,y:0};return function E(y){let w,A,b,D,C,_,M,B,F,N,L;for(m.x=(y+.5)*u,v.x=Math.floor(m.x),w=0;w<s;w++){for(m.y=(w+.5)*h,v.y=Math.floor(m.y),C=0,_=0,M=0,B=0,F=0,A=v.x-x;A<=v.x+x;A++)if(!(A<0||A>=t)){N=Math.floor(1e3*Math.abs(A-m.x)),p[N]||(p[N]={});for(let Z=v.y-g;Z<=v.y+g;Z++)Z<0||Z>=n||(L=Math.floor(1e3*Math.abs(Z-m.y)),p[N][L]||(p[N][L]=l(Math.sqrt(Math.pow(N*d,2)+Math.pow(L*f,2))/1e3)),b=p[N][L],b>0&&(D=4*(Z*t+A),C+=b,_+=b*o[D],M+=b*o[D+1],B+=b*o[D+2],F+=b*o[D+3]))}D=4*(w*r+y),c[D]=_/C,c[D+1]=M/C,c[D+2]=B/C,c[D+3]=F/C}return++y<r?E(y):a}(0)}bilinearFiltering(e,t,n,r,s){let o,a,c,l,u,h,d,f,x,g,p,m,v,E=0,y=this.rcpScaleX,w=this.rcpScaleY,A=4*(t-1),b=e.imageData.data,D=e.ctx.createImageData(r,s),C=D.data;for(d=0;d<s;d++)for(f=0;f<r;f++)for(u=Math.floor(y*f),h=Math.floor(w*d),x=y*f-u,g=w*d-h,v=4*(h*t+u),p=0;p<4;p++)o=b[v+p],a=b[v+4+p],c=b[v+A+p],l=b[v+A+4+p],m=o*(1-x)*(1-g)+a*x*(1-g)+c*g*(1-x)+l*x*g,C[E++]=m;return D}hermiteFastResize(e,t,n,r,s){let o=this.rcpScaleX,a=this.rcpScaleY,c=Math.ceil(o/2),l=Math.ceil(a/2),u=e.imageData.data,h=e.ctx.createImageData(r,s),d=h.data;for(let f=0;f<s;f++)for(let x=0;x<r;x++){let g=4*(x+f*r),p=0,m=0,v=0,E=0,y=0,w=0,A=0,b=(f+.5)*a;for(let D=Math.floor(f*a);D<(f+1)*a;D++){let C=Math.abs(b-(D+.5))/l,_=(x+.5)*o,M=C*C;for(let B=Math.floor(x*o);B<(x+1)*o;B++){let F=Math.abs(_-(B+.5))/c,N=Math.sqrt(M+F*F);N>1&&N<-1||(p=2*N*N*N-3*N*N+1,p>0&&(F=4*(B+D*t),A+=p*u[F+3],v+=p,u[F+3]<255&&(p=p*u[F+3]/250),E+=p*u[F],y+=p*u[F+1],w+=p*u[F+2],m+=p))}}d[g]=E/m,d[g+1]=y/m,d[g+2]=w/m,d[g+3]=A/v}return h}toObject(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}};V(Jc,"type","Resize"),V(Jc,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,fragmentSourceTOP:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
  `}),_e.setClass(Jc);var Qc=class extends hn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;if(this.saturation===0)return;let n=-this.saturation;for(let r=0;r<t.length;r+=4){let s=Math.max(t[r],t[r+1],t[r+2]);t[r]+=s!==t[r]?(s-t[r])*n:0,t[r+1]+=s!==t[r+1]?(s-t[r+1])*n:0,t[r+2]+=s!==t[r+2]?(s-t[r+2])*n:0}}getUniformLocations(e,t){return{uSaturation:e.getUniformLocation(t,"uSaturation")}}sendUniformData(e,t){e.uniform1f(t.uSaturation,-this.saturation)}};V(Qc,"type","Saturation"),V(Qc,"defaults",{saturation:0,mainParameter:"saturation"}),_e.setClass(Qc);var el=class extends hn{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;if(this.vibrance===0)return;let n=-this.vibrance;for(let r=0;r<t.length;r+=4){let s=Math.max(t[r],t[r+1],t[r+2]),o=(t[r]+t[r+1]+t[r+2])/3,a=2*Math.abs(s-o)/255*n;t[r]+=s!==t[r]?(s-t[r])*a:0,t[r+1]+=s!==t[r+1]?(s-t[r+1])*a:0,t[r+2]+=s!==t[r+2]?(s-t[r+2])*a:0}}getUniformLocations(e,t){return{uVibrance:e.getUniformLocation(t,"uVibrance")}}sendUniformData(e,t){e.uniform1f(t.uVibrance,-this.vibrance)}};V(el,"type","Vibrance"),V(el,"defaults",{vibrance:0,mainParameter:"vibrance"}),_e.setClass(el);var NX=Object.freeze({__proto__:null,BaseFilter:hn,BlackWhite:xL,BlendColor:Uc,BlendImage:Vc,Blur:zc,Brightness:Hc,Brownie:lL,ColorMatrix:Ys,Composed:Xu,Contrast:jc,Convolute:Gc,Gamma:Wc,Grayscale:$c,HueRotation:Xc,Invert:qc,Kodachrome:hL,Noise:Yc,Pixelate:Zc,Polaroid:fL,RemoveColor:Kc,Resize:Jc,Saturation:Qc,Sepia:pL,Technicolor:dL,Vibrance:el,Vintage:uL});var Ju=class extends t0{constructor(e,t,n){super(document.createElement("div")),this.fabricCanvas=null,this.ticketSize=null,this.side=null,this.decoration=null,this.axiosInstance=null,this.ticketSize=e,this.side=t,this.decoration=n,this.initCanvas(),this.loadFabric(n)}initCanvas(){this.fabricCanvas=new kr(this.name,{width:this.ticketSize.x,height:this.ticketSize.y}),this.element=this.fabricCanvas.getElement()}loadFabric(e){return He(this,null,function*(){yield this.fabricCanvas?.loadFromJSON(e),this.fabricCanvas?.renderAll()})}};var Y0=class{constructor(e,t){this._apiExecutorService=e,this._sceneGraphService=t,this.mobileTicket=null,this.frontSide=null,this.frontDecorationInfo=null,this.backSide=null,this.backDecorationinfo=null}initMobileTicket(){return He(this,null,function*(){this.frontDecorationInfo=yield this._apiExecutorService.getTicket(),this.backDecorationinfo=yield this._apiExecutorService.getTicket(),this.loadMaterial()})}loadMaterial(){new r0().load("assets/untitled.mtl",t=>{t.preload(),this.loadObject(t)})}loadObject(e){let t=new o0;t.setMaterials(e),t.load("assets/untitled.obj",n=>{this.initCardObject(n)})}initCardObject(e){this.mobileTicket=e.children[0],this.mobileTicket.scale.multiplyScalar(5);let t=this.frontDecorationInfo?.backgroundColor;this.mobileTicket.material.color.set(parseInt(t?.slice(1),16)),this.mobileTicket.rotateOnAxis(new k(0,0,1),Math.PI/2),this.mobileTicket.rotateX(Math.PI/8),this.mobileTicket.rotateY(Math.PI/8),this._sceneGraphService.scene.add(this.mobileTicket),this.initSide("front"),this.initSide("back"),this.checkFaceVisible()}initSide(e){e==="front"?(this.frontSide=new Ju(new We(350,600),"front",this.frontDecorationInfo?.fabric),this.frontSide.rotateZ(-Math.PI/2),this.frontSide.position.add(new k(0,0,2.05)),this.mobileTicket?.add(this.frontSide),this.frontSide.scale.multiplyScalar(.205)):e==="back"&&(this.backSide=new Ju(new We(350,600),"back",this.backDecorationinfo?.fabric),this.backSide.rotateZ(-Math.PI/2),this.backSide.rotateY(-Math.PI),this.mobileTicket?.add(this.backSide),this.backSide.scale.multiplyScalar(.205))}checkFaceVisible(){let e=this._sceneGraphService.camera?.getWorldDirection(new k(0,0,0)),t=this.frontSide===null?new k(0,0,1):new k(0,0,1).applyQuaternion(this.frontSide.quaternion);e.dot(t)>=0?(this.frontSide.visible=!1,this.backSide.visible=!0):(this.frontSide.visible=!0,this.backSide.visible=!1)}};function Qu(i,e){return function(){return i.apply(e,arguments)}}var{toString:yL}=Object.prototype,{getPrototypeOf:ay}=Object,K0=(i=>e=>{let t=yL.call(e);return i[t]||(i[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),Lr=i=>(i=i.toLowerCase(),e=>K0(e)===i),J0=i=>e=>typeof e===i,{isArray:ll}=Array,eh=J0("undefined");function CL(i){return i!==null&&!eh(i)&&i.constructor!==null&&!eh(i.constructor)&&Li(i.constructor.isBuffer)&&i.constructor.isBuffer(i)}var SM=Lr("ArrayBuffer");function _L(i){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(i):e=i&&i.buffer&&SM(i.buffer),e}var AL=J0("string"),Li=J0("function"),MM=J0("number"),Q0=i=>i!==null&&typeof i=="object",wL=i=>i===!0||i===!1,Z0=i=>{if(K0(i)!=="object")return!1;let e=ay(i);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in i)&&!(Symbol.iterator in i)},bL=Lr("Date"),DL=Lr("File"),SL=Lr("Blob"),ML=Lr("FileList"),TL=i=>Q0(i)&&Li(i.pipe),FL=i=>{let e;return i&&(typeof FormData=="function"&&i instanceof FormData||Li(i.append)&&((e=K0(i))==="formdata"||e==="object"&&Li(i.toString)&&i.toString()==="[object FormData]"))},BL=Lr("URLSearchParams"),IL=i=>i.trim?i.trim():i.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function th(i,e,{allOwnKeys:t=!1}={}){if(i===null||typeof i>"u")return;let n,r;if(typeof i!="object"&&(i=[i]),ll(i))for(n=0,r=i.length;n<r;n++)e.call(null,i[n],n,i);else{let s=t?Object.getOwnPropertyNames(i):Object.keys(i),o=s.length,a;for(n=0;n<o;n++)a=s[n],e.call(null,i[a],a,i)}}function TM(i,e){e=e.toLowerCase();let t=Object.keys(i),n=t.length,r;for(;n-- >0;)if(r=t[n],e===r.toLowerCase())return r;return null}var FM=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,BM=i=>!eh(i)&&i!==FM;function oy(){let{caseless:i}=BM(this)&&this||{},e={},t=(n,r)=>{let s=i&&TM(e,r)||r;Z0(e[s])&&Z0(n)?e[s]=oy(e[s],n):Z0(n)?e[s]=oy({},n):ll(n)?e[s]=n.slice():e[s]=n};for(let n=0,r=arguments.length;n<r;n++)arguments[n]&&th(arguments[n],t);return e}var PL=(i,e,t,{allOwnKeys:n}={})=>(th(e,(r,s)=>{t&&Li(r)?i[s]=Qu(r,t):i[s]=r},{allOwnKeys:n}),i),RL=i=>(i.charCodeAt(0)===65279&&(i=i.slice(1)),i),OL=(i,e,t,n)=>{i.prototype=Object.create(e.prototype,n),i.prototype.constructor=i,Object.defineProperty(i,"super",{value:e.prototype}),t&&Object.assign(i.prototype,t)},kL=(i,e,t,n)=>{let r,s,o,a={};if(e=e||{},i==null)return e;do{for(r=Object.getOwnPropertyNames(i),s=r.length;s-- >0;)o=r[s],(!n||n(o,i,e))&&!a[o]&&(e[o]=i[o],a[o]=!0);i=t!==!1&&ay(i)}while(i&&(!t||t(i,e))&&i!==Object.prototype);return e},NL=(i,e,t)=>{i=String(i),(t===void 0||t>i.length)&&(t=i.length),t-=e.length;let n=i.indexOf(e,t);return n!==-1&&n===t},LL=i=>{if(!i)return null;if(ll(i))return i;let e=i.length;if(!MM(e))return null;let t=new Array(e);for(;e-- >0;)t[e]=i[e];return t},UL=(i=>e=>i&&e instanceof i)(typeof Uint8Array<"u"&&ay(Uint8Array)),VL=(i,e)=>{let n=(i&&i[Symbol.iterator]).call(i),r;for(;(r=n.next())&&!r.done;){let s=r.value;e.call(i,s[0],s[1])}},zL=(i,e)=>{let t,n=[];for(;(t=i.exec(e))!==null;)n.push(t);return n},HL=Lr("HTMLFormElement"),jL=i=>i.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,n,r){return n.toUpperCase()+r}),bM=(({hasOwnProperty:i})=>(e,t)=>i.call(e,t))(Object.prototype),GL=Lr("RegExp"),IM=(i,e)=>{let t=Object.getOwnPropertyDescriptors(i),n={};th(t,(r,s)=>{let o;(o=e(r,s,i))!==!1&&(n[s]=o||r)}),Object.defineProperties(i,n)},WL=i=>{IM(i,(e,t)=>{if(Li(i)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;let n=i[t];if(Li(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},$L=(i,e)=>{let t={},n=r=>{r.forEach(s=>{t[s]=!0})};return ll(i)?n(i):n(String(i).split(e)),t},XL=()=>{},qL=(i,e)=>(i=+i,Number.isFinite(i)?i:e),sy="abcdefghijklmnopqrstuvwxyz",DM="0123456789",PM={DIGIT:DM,ALPHA:sy,ALPHA_DIGIT:sy+sy.toUpperCase()+DM},YL=(i=16,e=PM.ALPHA_DIGIT)=>{let t="",{length:n}=e;for(;i--;)t+=e[Math.random()*n|0];return t};function ZL(i){return!!(i&&Li(i.append)&&i[Symbol.toStringTag]==="FormData"&&i[Symbol.iterator])}var KL=i=>{let e=new Array(10),t=(n,r)=>{if(Q0(n)){if(e.indexOf(n)>=0)return;if(!("toJSON"in n)){e[r]=n;let s=ll(n)?[]:{};return th(n,(o,a)=>{let c=t(o,r+1);!eh(c)&&(s[a]=c)}),e[r]=void 0,s}}return n};return t(i,0)},JL=Lr("AsyncFunction"),QL=i=>i&&(Q0(i)||Li(i))&&Li(i.then)&&Li(i.catch),ne={isArray:ll,isArrayBuffer:SM,isBuffer:CL,isFormData:FL,isArrayBufferView:_L,isString:AL,isNumber:MM,isBoolean:wL,isObject:Q0,isPlainObject:Z0,isUndefined:eh,isDate:bL,isFile:DL,isBlob:SL,isRegExp:GL,isFunction:Li,isStream:TL,isURLSearchParams:BL,isTypedArray:UL,isFileList:ML,forEach:th,merge:oy,extend:PL,trim:IL,stripBOM:RL,inherits:OL,toFlatObject:kL,kindOf:K0,kindOfTest:Lr,endsWith:NL,toArray:LL,forEachEntry:VL,matchAll:zL,isHTMLForm:HL,hasOwnProperty:bM,hasOwnProp:bM,reduceDescriptors:IM,freezeMethods:WL,toObjectSet:$L,toCamelCase:jL,noop:XL,toFiniteNumber:qL,findKey:TM,global:FM,isContextDefined:BM,ALPHABET:PM,generateString:YL,isSpecCompliantForm:ZL,toJSONObject:KL,isAsyncFn:JL,isThenable:QL};function ul(i,e,t,n,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=i,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),n&&(this.request=n),r&&(this.response=r)}ne.inherits(ul,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ne.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var RM=ul.prototype,OM={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(i=>{OM[i]={value:i}});Object.defineProperties(ul,OM);Object.defineProperty(RM,"isAxiosError",{value:!0});ul.from=(i,e,t,n,r,s)=>{let o=Object.create(RM);return ne.toFlatObject(i,o,function(c){return c!==Error.prototype},a=>a!=="isAxiosError"),ul.call(o,i.message,e,t,n,r),o.cause=i,o.name=i.name,s&&Object.assign(o,s),o};var ft=ul;var ep=null;function cy(i){return ne.isPlainObject(i)||ne.isArray(i)}function NM(i){return ne.endsWith(i,"[]")?i.slice(0,-2):i}function kM(i,e,t){return i?i.concat(e).map(function(r,s){return r=NM(r),!t&&s?"["+r+"]":r}).join(t?".":""):e}function eU(i){return ne.isArray(i)&&!i.some(cy)}var tU=ne.toFlatObject(ne,{},null,function(e){return/^is[A-Z]/.test(e)});function nU(i,e,t){if(!ne.isObject(i))throw new TypeError("target must be an object");e=e||new(ep||FormData),t=ne.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,p){return!ne.isUndefined(p[g])});let n=t.metaTokens,r=t.visitor||u,s=t.dots,o=t.indexes,c=(t.Blob||typeof Blob<"u"&&Blob)&&ne.isSpecCompliantForm(e);if(!ne.isFunction(r))throw new TypeError("visitor must be a function");function l(x){if(x===null)return"";if(ne.isDate(x))return x.toISOString();if(!c&&ne.isBlob(x))throw new ft("Blob is not supported. Use a Buffer instead.");return ne.isArrayBuffer(x)||ne.isTypedArray(x)?c&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function u(x,g,p){let m=x;if(x&&!p&&typeof x=="object"){if(ne.endsWith(g,"{}"))g=n?g:g.slice(0,-2),x=JSON.stringify(x);else if(ne.isArray(x)&&eU(x)||(ne.isFileList(x)||ne.endsWith(g,"[]"))&&(m=ne.toArray(x)))return g=NM(g),m.forEach(function(E,y){!(ne.isUndefined(E)||E===null)&&e.append(o===!0?kM([g],y,s):o===null?g:g+"[]",l(E))}),!1}return cy(x)?!0:(e.append(kM(p,g,s),l(x)),!1)}let h=[],d=Object.assign(tU,{defaultVisitor:u,convertValue:l,isVisitable:cy});function f(x,g){if(!ne.isUndefined(x)){if(h.indexOf(x)!==-1)throw Error("Circular reference detected in "+g.join("."));h.push(x),ne.forEach(x,function(m,v){(!(ne.isUndefined(m)||m===null)&&r.call(e,m,ne.isString(v)?v.trim():v,g,d))===!0&&f(m,g?g.concat(v):[v])}),h.pop()}}if(!ne.isObject(i))throw new TypeError("data must be an object");return f(i),e}var to=nU;function LM(i){let e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(i).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function UM(i,e){this._pairs=[],i&&to(i,this,e)}var VM=UM.prototype;VM.append=function(e,t){this._pairs.push([e,t])};VM.toString=function(e){let t=e?function(n){return e.call(this,n,LM)}:LM;return this._pairs.map(function(r){return t(r[0])+"="+t(r[1])},"").join("&")};var tp=UM;function iU(i){return encodeURIComponent(i).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function nh(i,e,t){if(!e)return i;let n=t&&t.encode||iU,r=t&&t.serialize,s;if(r?s=r(e,t):s=ne.isURLSearchParams(e)?e.toString():new tp(e,t).toString(n),s){let o=i.indexOf("#");o!==-1&&(i=i.slice(0,o)),i+=(i.indexOf("?")===-1?"?":"&")+s}return i}var ly=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){ne.forEach(this.handlers,function(n){n!==null&&e(n)})}},uy=ly;var np={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1};var zM=typeof URLSearchParams<"u"?URLSearchParams:tp;var HM=typeof FormData<"u"?FormData:null;var jM=typeof Blob<"u"?Blob:null;var GM={isBrowser:!0,classes:{URLSearchParams:zM,FormData:HM,Blob:jM},protocols:["http","https","file","blob","url","data"]};var hy={};k9(hy,{hasBrowserEnv:()=>WM,hasStandardBrowserEnv:()=>rU,hasStandardBrowserWebWorkerEnv:()=>sU});var WM=typeof window<"u"&&typeof document<"u",rU=(i=>WM&&["ReactNative","NativeScript","NS"].indexOf(i)<0)(typeof navigator<"u"&&navigator.product),sU=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function";var ei=Me(Me({},hy),GM);function dy(i,e){return to(i,new ei.classes.URLSearchParams,Object.assign({visitor:function(t,n,r,s){return ei.isNode&&ne.isBuffer(t)?(this.append(n,t.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},e))}function oU(i){return ne.matchAll(/\w+|\[(\w*)]/g,i).map(e=>e[0]==="[]"?"":e[1]||e[0])}function aU(i){let e={},t=Object.keys(i),n,r=t.length,s;for(n=0;n<r;n++)s=t[n],e[s]=i[s];return e}function cU(i){function e(t,n,r,s){let o=t[s++];if(o==="__proto__")return!0;let a=Number.isFinite(+o),c=s>=t.length;return o=!o&&ne.isArray(r)?r.length:o,c?(ne.hasOwnProp(r,o)?r[o]=[r[o],n]:r[o]=n,!a):((!r[o]||!ne.isObject(r[o]))&&(r[o]=[]),e(t,n,r[o],s)&&ne.isArray(r[o])&&(r[o]=aU(r[o])),!a)}if(ne.isFormData(i)&&ne.isFunction(i.entries)){let t={};return ne.forEachEntry(i,(n,r)=>{e(oU(n),r,t,0)}),t}return null}var ip=cU;function lU(i,e,t){if(ne.isString(i))try{return(e||JSON.parse)(i),ne.trim(i)}catch(n){if(n.name!=="SyntaxError")throw n}return(t||JSON.stringify)(i)}var fy={transitional:np,adapter:["xhr","http"],transformRequest:[function(e,t){let n=t.getContentType()||"",r=n.indexOf("application/json")>-1,s=ne.isObject(e);if(s&&ne.isHTMLForm(e)&&(e=new FormData(e)),ne.isFormData(e))return r?JSON.stringify(ip(e)):e;if(ne.isArrayBuffer(e)||ne.isBuffer(e)||ne.isStream(e)||ne.isFile(e)||ne.isBlob(e))return e;if(ne.isArrayBufferView(e))return e.buffer;if(ne.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return dy(e,this.formSerializer).toString();if((a=ne.isFileList(e))||n.indexOf("multipart/form-data")>-1){let c=this.env&&this.env.FormData;return to(a?{"files[]":e}:e,c&&new c,this.formSerializer)}}return s||r?(t.setContentType("application/json",!1),lU(e)):e}],transformResponse:[function(e){let t=this.transitional||fy.transitional,n=t&&t.forcedJSONParsing,r=this.responseType==="json";if(e&&ne.isString(e)&&(n&&!this.responseType||r)){let o=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?ft.from(a,ft.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ei.classes.FormData,Blob:ei.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ne.forEach(["delete","get","head","post","put","patch"],i=>{fy.headers[i]={}});var hl=fy;var uU=ne.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),$M=i=>{let e={},t,n,r;return i&&i.split(`
`).forEach(function(o){r=o.indexOf(":"),t=o.substring(0,r).trim().toLowerCase(),n=o.substring(r+1).trim(),!(!t||e[t]&&uU[t])&&(t==="set-cookie"?e[t]?e[t].push(n):e[t]=[n]:e[t]=e[t]?e[t]+", "+n:n)}),e};var XM=Symbol("internals");function ih(i){return i&&String(i).trim().toLowerCase()}function rp(i){return i===!1||i==null?i:ne.isArray(i)?i.map(rp):String(i)}function hU(i){let e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g,n;for(;n=t.exec(i);)e[n[1]]=n[2];return e}var dU=i=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(i.trim());function py(i,e,t,n,r){if(ne.isFunction(n))return n.call(this,e,t);if(r&&(e=t),!!ne.isString(e)){if(ne.isString(n))return e.indexOf(n)!==-1;if(ne.isRegExp(n))return n.test(e)}}function fU(i){return i.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}function pU(i,e){let t=ne.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(i,n+t,{value:function(r,s,o){return this[n].call(this,e,r,s,o)},configurable:!0})})}var dl=class{constructor(e){e&&this.set(e)}set(e,t,n){let r=this;function s(a,c,l){let u=ih(c);if(!u)throw new Error("header name must be a non-empty string");let h=ne.findKey(r,u);(!h||r[h]===void 0||l===!0||l===void 0&&r[h]!==!1)&&(r[h||c]=rp(a))}let o=(a,c)=>ne.forEach(a,(l,u)=>s(l,u,c));return ne.isPlainObject(e)||e instanceof this.constructor?o(e,t):ne.isString(e)&&(e=e.trim())&&!dU(e)?o($M(e),t):e!=null&&s(t,e,n),this}get(e,t){if(e=ih(e),e){let n=ne.findKey(this,e);if(n){let r=this[n];if(!t)return r;if(t===!0)return hU(r);if(ne.isFunction(t))return t.call(this,r,n);if(ne.isRegExp(t))return t.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=ih(e),e){let n=ne.findKey(this,e);return!!(n&&this[n]!==void 0&&(!t||py(this,this[n],n,t)))}return!1}delete(e,t){let n=this,r=!1;function s(o){if(o=ih(o),o){let a=ne.findKey(n,o);a&&(!t||py(n,n[a],a,t))&&(delete n[a],r=!0)}}return ne.isArray(e)?e.forEach(s):s(e),r}clear(e){let t=Object.keys(this),n=t.length,r=!1;for(;n--;){let s=t[n];(!e||py(this,this[s],s,e,!0))&&(delete this[s],r=!0)}return r}normalize(e){let t=this,n={};return ne.forEach(this,(r,s)=>{let o=ne.findKey(n,s);if(o){t[o]=rp(r),delete t[s];return}let a=e?fU(s):String(s).trim();a!==s&&delete t[s],t[a]=rp(r),n[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){let t=Object.create(null);return ne.forEach(this,(n,r)=>{n!=null&&n!==!1&&(t[r]=e&&ne.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){let n=new this(e);return t.forEach(r=>n.set(r)),n}static accessor(e){let n=(this[XM]=this[XM]={accessors:{}}).accessors,r=this.prototype;function s(o){let a=ih(o);n[a]||(pU(r,o),n[a]=!0)}return ne.isArray(e)?e.forEach(s):s(e),this}};dl.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ne.reduceDescriptors(dl.prototype,({value:i},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>i,set(n){this[t]=n}}});ne.freezeMethods(dl);var ti=dl;function rh(i,e){let t=this||hl,n=e||t,r=ti.from(n.headers),s=n.data;return ne.forEach(i,function(a){s=a.call(t,s,r.normalize(),e?e.status:void 0)}),r.normalize(),s}function sh(i){return!!(i&&i.__CANCEL__)}function qM(i,e,t){ft.call(this,i??"canceled",ft.ERR_CANCELED,e,t),this.name="CanceledError"}ne.inherits(qM,ft,{__CANCEL__:!0});var no=qM;function xy(i,e,t){let n=t.config.validateStatus;!t.status||!n||n(t.status)?i(t):e(new ft("Request failed with status code "+t.status,[ft.ERR_BAD_REQUEST,ft.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}var YM=ei.hasStandardBrowserEnv?{write(i,e,t,n,r,s){let o=[i+"="+encodeURIComponent(e)];ne.isNumber(t)&&o.push("expires="+new Date(t).toGMTString()),ne.isString(n)&&o.push("path="+n),ne.isString(r)&&o.push("domain="+r),s===!0&&o.push("secure"),document.cookie=o.join("; ")},read(i){let e=document.cookie.match(new RegExp("(^|;\\s*)("+i+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(i){this.write(i,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function my(i){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(i)}function gy(i,e){return e?i.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):i}function oh(i,e){return i&&!my(e)?gy(i,e):e}var ZM=ei.hasStandardBrowserEnv?function(){let e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a"),n;function r(s){let o=s;return e&&(t.setAttribute("href",o),o=t.href),t.setAttribute("href",o),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:t.pathname.charAt(0)==="/"?t.pathname:"/"+t.pathname}}return n=r(window.location.href),function(o){let a=ne.isString(o)?r(o):o;return a.protocol===n.protocol&&a.host===n.host}}():function(){return function(){return!0}}();function vy(i){let e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(i);return e&&e[1]||""}function xU(i,e){i=i||10;let t=new Array(i),n=new Array(i),r=0,s=0,o;return e=e!==void 0?e:1e3,function(c){let l=Date.now(),u=n[s];o||(o=l),t[r]=c,n[r]=l;let h=s,d=0;for(;h!==r;)d+=t[h++],h=h%i;if(r=(r+1)%i,r===s&&(s=(s+1)%i),l-o<e)return;let f=u&&l-u;return f?Math.round(d*1e3/f):void 0}}var KM=xU;function JM(i,e){let t=0,n=KM(50,250);return r=>{let s=r.loaded,o=r.lengthComputable?r.total:void 0,a=s-t,c=n(a),l=s<=o;t=s;let u={loaded:s,total:o,progress:o?s/o:void 0,bytes:a,rate:c||void 0,estimated:c&&o&&l?(o-s)/c:void 0,event:r};u[e?"download":"upload"]=!0,i(u)}}var mU=typeof XMLHttpRequest<"u",QM=mU&&function(i){return new Promise(function(t,n){let r=i.data,s=ti.from(i.headers).normalize(),{responseType:o,withXSRFToken:a}=i,c;function l(){i.cancelToken&&i.cancelToken.unsubscribe(c),i.signal&&i.signal.removeEventListener("abort",c)}let u;if(ne.isFormData(r)){if(ei.hasStandardBrowserEnv||ei.hasStandardBrowserWebWorkerEnv)s.setContentType(!1);else if((u=s.getContentType())!==!1){let[g,...p]=u?u.split(";").map(m=>m.trim()).filter(Boolean):[];s.setContentType([g||"multipart/form-data",...p].join("; "))}}let h=new XMLHttpRequest;if(i.auth){let g=i.auth.username||"",p=i.auth.password?unescape(encodeURIComponent(i.auth.password)):"";s.set("Authorization","Basic "+btoa(g+":"+p))}let d=oh(i.baseURL,i.url);h.open(i.method.toUpperCase(),nh(d,i.params,i.paramsSerializer),!0),h.timeout=i.timeout;function f(){if(!h)return;let g=ti.from("getAllResponseHeaders"in h&&h.getAllResponseHeaders()),m={data:!o||o==="text"||o==="json"?h.responseText:h.response,status:h.status,statusText:h.statusText,headers:g,config:i,request:h};xy(function(E){t(E),l()},function(E){n(E),l()},m),h=null}if("onloadend"in h?h.onloadend=f:h.onreadystatechange=function(){!h||h.readyState!==4||h.status===0&&!(h.responseURL&&h.responseURL.indexOf("file:")===0)||setTimeout(f)},h.onabort=function(){h&&(n(new ft("Request aborted",ft.ECONNABORTED,i,h)),h=null)},h.onerror=function(){n(new ft("Network Error",ft.ERR_NETWORK,i,h)),h=null},h.ontimeout=function(){let p=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded",m=i.transitional||np;i.timeoutErrorMessage&&(p=i.timeoutErrorMessage),n(new ft(p,m.clarifyTimeoutError?ft.ETIMEDOUT:ft.ECONNABORTED,i,h)),h=null},ei.hasStandardBrowserEnv&&(a&&ne.isFunction(a)&&(a=a(i)),a||a!==!1&&ZM(d))){let g=i.xsrfHeaderName&&i.xsrfCookieName&&YM.read(i.xsrfCookieName);g&&s.set(i.xsrfHeaderName,g)}r===void 0&&s.setContentType(null),"setRequestHeader"in h&&ne.forEach(s.toJSON(),function(p,m){h.setRequestHeader(m,p)}),ne.isUndefined(i.withCredentials)||(h.withCredentials=!!i.withCredentials),o&&o!=="json"&&(h.responseType=i.responseType),typeof i.onDownloadProgress=="function"&&h.addEventListener("progress",JM(i.onDownloadProgress,!0)),typeof i.onUploadProgress=="function"&&h.upload&&h.upload.addEventListener("progress",JM(i.onUploadProgress)),(i.cancelToken||i.signal)&&(c=g=>{h&&(n(!g||g.type?new no(null,i,h):g),h.abort(),h=null)},i.cancelToken&&i.cancelToken.subscribe(c),i.signal&&(i.signal.aborted?c():i.signal.addEventListener("abort",c)));let x=vy(d);if(x&&ei.protocols.indexOf(x)===-1){n(new ft("Unsupported protocol "+x+":",ft.ERR_BAD_REQUEST,i));return}h.send(r||null)})};var Ey={http:ep,xhr:QM};ne.forEach(Ey,(i,e)=>{if(i){try{Object.defineProperty(i,"name",{value:e})}catch{}Object.defineProperty(i,"adapterName",{value:e})}});var e9=i=>`- ${i}`,gU=i=>ne.isFunction(i)||i===null||i===!1,sp={getAdapter:i=>{i=ne.isArray(i)?i:[i];let{length:e}=i,t,n,r={};for(let s=0;s<e;s++){t=i[s];let o;if(n=t,!gU(t)&&(n=Ey[(o=String(t)).toLowerCase()],n===void 0))throw new ft(`Unknown adapter '${o}'`);if(n)break;r[o||"#"+s]=n}if(!n){let s=Object.entries(r).map(([a,c])=>`adapter ${a} `+(c===!1?"is not supported by the environment":"is not available in the build")),o=e?s.length>1?`since :
`+s.map(e9).join(`
`):" "+e9(s[0]):"as no adapter specified";throw new ft("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return n},adapters:Ey};function yy(i){if(i.cancelToken&&i.cancelToken.throwIfRequested(),i.signal&&i.signal.aborted)throw new no(null,i)}function op(i){return yy(i),i.headers=ti.from(i.headers),i.data=rh.call(i,i.transformRequest),["post","put","patch"].indexOf(i.method)!==-1&&i.headers.setContentType("application/x-www-form-urlencoded",!1),sp.getAdapter(i.adapter||hl.adapter)(i).then(function(n){return yy(i),n.data=rh.call(i,i.transformResponse,n),n.headers=ti.from(n.headers),n},function(n){return sh(n)||(yy(i),n&&n.response&&(n.response.data=rh.call(i,i.transformResponse,n.response),n.response.headers=ti.from(n.response.headers))),Promise.reject(n)})}var t9=i=>i instanceof ti?Me({},i):i;function fs(i,e){e=e||{};let t={};function n(l,u,h){return ne.isPlainObject(l)&&ne.isPlainObject(u)?ne.merge.call({caseless:h},l,u):ne.isPlainObject(u)?ne.merge({},u):ne.isArray(u)?u.slice():u}function r(l,u,h){if(ne.isUndefined(u)){if(!ne.isUndefined(l))return n(void 0,l,h)}else return n(l,u,h)}function s(l,u){if(!ne.isUndefined(u))return n(void 0,u)}function o(l,u){if(ne.isUndefined(u)){if(!ne.isUndefined(l))return n(void 0,l)}else return n(void 0,u)}function a(l,u,h){if(h in e)return n(l,u);if(h in i)return n(void 0,l)}let c={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(l,u)=>r(t9(l),t9(u),!0)};return ne.forEach(Object.keys(Object.assign({},i,e)),function(u){let h=c[u]||r,d=h(i[u],e[u],u);ne.isUndefined(d)&&h!==a||(t[u]=d)}),t}var ap="1.6.8";var Cy={};["object","boolean","number","function","string","symbol"].forEach((i,e)=>{Cy[i]=function(n){return typeof n===i||"a"+(e<1?"n ":" ")+i}});var n9={};Cy.transitional=function(e,t,n){function r(s,o){return"[Axios v"+ap+"] Transitional option '"+s+"'"+o+(n?". "+n:"")}return(s,o,a)=>{if(e===!1)throw new ft(r(o," has been removed"+(t?" in "+t:"")),ft.ERR_DEPRECATED);return t&&!n9[o]&&(n9[o]=!0,console.warn(r(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(s,o,a):!0}};function vU(i,e,t){if(typeof i!="object")throw new ft("options must be an object",ft.ERR_BAD_OPTION_VALUE);let n=Object.keys(i),r=n.length;for(;r-- >0;){let s=n[r],o=e[s];if(o){let a=i[s],c=a===void 0||o(a,s,i);if(c!==!0)throw new ft("option "+s+" must be "+c,ft.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new ft("Unknown option "+s,ft.ERR_BAD_OPTION)}}var cp={assertOptions:vU,validators:Cy};var io=cp.validators,fl=class{constructor(e){this.defaults=e,this.interceptors={request:new uy,response:new uy}}request(e,t){return He(this,null,function*(){try{return yield this._request(e,t)}catch(n){if(n instanceof Error){let r;Error.captureStackTrace?Error.captureStackTrace(r={}):r=new Error;let s=r.stack?r.stack.replace(/^.+\n/,""):"";n.stack?s&&!String(n.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+s):n.stack=s}throw n}})}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=fs(this.defaults,t);let{transitional:n,paramsSerializer:r,headers:s}=t;n!==void 0&&cp.assertOptions(n,{silentJSONParsing:io.transitional(io.boolean),forcedJSONParsing:io.transitional(io.boolean),clarifyTimeoutError:io.transitional(io.boolean)},!1),r!=null&&(ne.isFunction(r)?t.paramsSerializer={serialize:r}:cp.assertOptions(r,{encode:io.function,serialize:io.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=s&&ne.merge(s.common,s[t.method]);s&&ne.forEach(["delete","get","head","post","put","patch","common"],x=>{delete s[x]}),t.headers=ti.concat(o,s);let a=[],c=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(t)===!1||(c=c&&g.synchronous,a.unshift(g.fulfilled,g.rejected))});let l=[];this.interceptors.response.forEach(function(g){l.push(g.fulfilled,g.rejected)});let u,h=0,d;if(!c){let x=[op.bind(this),void 0];for(x.unshift.apply(x,a),x.push.apply(x,l),d=x.length,u=Promise.resolve(t);h<d;)u=u.then(x[h++],x[h++]);return u}d=a.length;let f=t;for(h=0;h<d;){let x=a[h++],g=a[h++];try{f=x(f)}catch(p){g.call(this,p);break}}try{u=op.call(this,f)}catch(x){return Promise.reject(x)}for(h=0,d=l.length;h<d;)u=u.then(l[h++],l[h++]);return u}getUri(e){e=fs(this.defaults,e);let t=oh(e.baseURL,e.url);return nh(t,e.params,e.paramsSerializer)}};ne.forEach(["delete","get","head","options"],function(e){fl.prototype[e]=function(t,n){return this.request(fs(n||{},{method:e,url:t,data:(n||{}).data}))}});ne.forEach(["post","put","patch"],function(e){function t(n){return function(s,o,a){return this.request(fs(a||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}fl.prototype[e]=t(),fl.prototype[e+"Form"]=t(!0)});var ah=fl;var _y=class i{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(s){t=s});let n=this;this.promise.then(r=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](r);n._listeners=null}),this.promise.then=r=>{let s,o=new Promise(a=>{n.subscribe(a),s=a}).then(r);return o.cancel=function(){n.unsubscribe(s)},o},e(function(s,o,a){n.reason||(n.reason=new no(s,o,a),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;let t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}static source(){let e;return{token:new i(function(r){e=r}),cancel:e}}},i9=_y;function Ay(i){return function(t){return i.apply(null,t)}}function wy(i){return ne.isObject(i)&&i.isAxiosError===!0}var by={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(by).forEach(([i,e])=>{by[e]=i});var r9=by;function s9(i){let e=new ah(i),t=Qu(ah.prototype.request,e);return ne.extend(t,ah.prototype,e,{allOwnKeys:!0}),ne.extend(t,e,null,{allOwnKeys:!0}),t.create=function(r){return s9(fs(i,r))},t}var gn=s9(hl);gn.Axios=ah;gn.CanceledError=no;gn.CancelToken=i9;gn.isCancel=sh;gn.VERSION=ap;gn.toFormData=to;gn.AxiosError=ft;gn.Cancel=gn.CanceledError;gn.all=function(e){return Promise.all(e)};gn.spread=Ay;gn.isAxiosError=wy;gn.mergeConfig=fs;gn.AxiosHeaders=ti;gn.formToJSON=i=>ip(ne.isHTMLForm(i)?new FormData(i):i);gn.getAdapter=sp.getAdapter;gn.HttpStatusCode=r9;gn.default=gn;var ro=gn;var{Axios:RZ,AxiosError:OZ,CanceledError:kZ,isCancel:NZ,CancelToken:LZ,VERSION:UZ,all:VZ,Cancel:zZ,isAxiosError:HZ,spread:jZ,toFormData:GZ,AxiosHeaders:WZ,HttpStatusCode:$Z,formToJSON:XZ,getAdapter:qZ,mergeConfig:YZ}=ro;var so=(()=>{let e=class e{constructor(){this.SCENE_BACKGROUND_COLOR="#FFFFFF",this.MOIM_ID="",this.DIARY_ID="",this.FACE_TYPE="",this.VIEW_TYPE=""}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var oo=(()=>{let e=class e{constructor(n){this._ssalonConfigService=n,this.apiExecutor=null,this.apiExecutorJson=null,this.apiURL="https://ssalon.co.kr/api",this.tokens={access:"eyJhbGciOiJIUzI1NiJ9.eyJjYXRlZ29yeSI6ImFjY2VzcyIsInVzZXJuYW1lIjoibmF2ZXIgbHphV19oUmprc1kzZXo1NUtJckpXdE9mMk1qTi1GZzJJbUF5SXBPOFNlcyIsInJvbGUiOiJST0xFX1VTRVIiLCJpYXQiOjE3MTUyNDA4NjUsImV4cCI6MTcxNTMyNzI2NX0.PL-LWei2pL-NBhpxDFGkyCjLAgXYYhb4hWk7wNCJY24",refresh:"eyJhbGciOiJIUzI1NiJ9.eyJjYXRlZ29yeSI6InJlZnJlc2giLCJ1c2VybmFtZSI6Im5hdmVyIGx6YVdfaFJqa3NZM2V6NTVLSXJKV3RPZjJNak4tRmcySW1BeUlwTzhTZXMiLCJyb2xlIjoiUk9MRV9VU0VSIiwiaWF0IjoxNzE1MjQwODY1LCJleHAiOjE3MTUzMjcyNjV9.Ow5FwPpGzlumSzO2ELoCuYRqqg3bu73K-jt9aqf3nb4"},this._token=this.tokens.access,this.refreshToken=this.tokens.refresh,this.initApiExecutor()}setToken(n){this._token=n}initApiExecutor(){this.apiExecutor=ro.create({baseURL:this.apiURL,headers:{"Content-Type":"multipart/form-data","Access-Control-Allow-Origin":"*"}}),this.apiExecutorJson=ro.create({baseURL:this.apiURL,headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*",Authorization:`Bearer ${this._token}`,Refresh:this.refreshToken}})}getTicket(){return He(this,null,function*(){try{return(yield this.apiExecutor?.get(`/tickets/${this._ssalonConfigService.MOIM_ID}`)).data}catch{return(yield ro.get("assets/decoration.json")).data}})}editTicket(n){return He(this,null,function*(){try{return(yield this.apiExecutor?.put(`/tickets/${this._ssalonConfigService.MOIM_ID}`,n)).data}catch(r){return console.log(r),(yield ro.get("assets/decoration.json")).data}})}getDiary(){return He(this,null,function*(){try{return(yield this.apiExecutor?.post(`/diary/${this._ssalonConfigService.DIARY_ID}`)).data}catch{return(yield ro.get("assets/decoration.json")).data}})}editDiary(n){return He(this,null,function*(){})}getBarcode(){return He(this,null,function*(){try{return(yield this.apiExecutorJson?.get(`/tickets/${this._ssalonConfigService.MOIM_ID}/link`)).data}catch{return"asdfo7a809sd7fwae9089iafa"}})}checkQR(n){return He(this,null,function*(){try{let r={qrKey:n};return(yield this.apiExecutorJson?.post(`/tickets/${this._ssalonConfigService.MOIM_ID}/link`,r)).data}catch{}})}changeAttendanceStatus(n,r=!1){return He(this,null,function*(){try{return(yield this.apiExecutorJson?.post(`/moims/${this._ssalonConfigService.MOIM_ID}/attendance/${n}`)).data}catch{}})}getJoiningUsers(){return He(this,null,function*(){try{return(yield this.apiExecutorJson?.get(`/moims/${this._ssalonConfigService.MOIM_ID}/users`)).data}catch{}})}};e.\u0275fac=function(r){return new(r||e)(nt(so))},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var pl=(()=>{let e=class e{constructor(n,r,s){this._route=n,this._apiExecutorService=r,this._ssalonConfigService=s,this.scene=null,this.camera=null,this.lights={},this.nativeElement=null,this.webGLRenderer=null,this.css3dRenderer=null,this.arcballControls=null,this.mobileTicket=null,this.mobileTicketAutoRotate=!1,this._route.queryParams.subscribe(o=>{this._ssalonConfigService.MOIM_ID=o.moimId,this._ssalonConfigService.VIEW_TYPE=o.viewType,this._ssalonConfigService.FACE_TYPE=o.faceType,o.token!==void 0&&(this._apiExecutorService._token=o.token)})}initThree(){let n=this.nativeElement.clientWidth,r=this.nativeElement.clientHeight;this.scene=new zf,this.scene.background=new Ge(16777215),this.camera=new zn(75,n/r,.1,2e3),this.camera.position.z=600,this.createLight("pointLight1",new k(0,0,300)),this.createLight("pointLight2",new k(0,0,-300)),this.createLight("pointLight3",new k(0,400,300)),this.initCss3dRenderer(n,r),this.initWebGLRenderer(n,r),this.createArcballControls(),this.mobileTicket=new Y0(this._apiExecutorService,this),this.mobileTicket.initMobileTicket(),EU(this)}createLight(n,r){this.lights[n]=new $f(16777215),this.lights[n].position.copy(r),this.lights[n].intensity=10,this.lights[n].decay=.3,this.lights[n].lookAt(0,0,0),this.scene.add(this.lights[n])}initWebGLRenderer(n,r){this.webGLRenderer=new Vf({antialias:!0}),this.webGLRenderer.setPixelRatio(window.devicePixelRatio),this.webGLRenderer.autoClear=!1,this.webGLRenderer.domElement.style.touchAction="none",this.webGLRenderer.setSize(n,r),this.nativeElement.appendChild(this.webGLRenderer.domElement)}initCss3dRenderer(n,r){this.css3dRenderer=new n0,this.css3dRenderer.domElement.style.touchAction="none",this.css3dRenderer.domElement.style.position="absolute",this.css3dRenderer.setSize(n,r),this.nativeElement.appendChild(this.css3dRenderer.domElement)}destroy(){this.nativeElement.removeChild(this.webGLRenderer.domElement),this.nativeElement.removeChild(this.css3dRenderer.domElement)}createArcballControls(){this.arcballControls=new i0(this.camera,this.css3dRenderer.domElement,this.scene),this.arcballControls.setGizmosVisible(!1),this.arcballControls.enableAnimations=!0,this.arcballControls.dampingFactor=2,this.arcballControls.addEventListener("change",()=>{this.css3dRenderer.render(this.scene,this.camera),this.mobileTicket?.checkFaceVisible()}),this.arcballControls.enabled=!0}onRender(){this.webGLRenderer.render(this.scene,this.camera),this.css3dRenderer.render(this.scene,this.camera)}focusFront(){this.arcballControls.reset()}rotateCard(){this.mobileTicket.mobileTicket?.rotateX(.002),this.mobileTicket.mobileTicket?.rotateY(.002),this.mobileTicket.mobileTicket?.rotateZ(.002),this.mobileTicket?.frontSide!==null&&this.mobileTicket?.backSide!==null&&this.mobileTicket?.checkFaceVisible()}};e.\u0275fac=function(r){return new(r||e)(nt(Ar),nt(oo),nt(so))},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})(),EU=function(i){let e=new qf,t=function(){i.mobileTicketAutoRotate&&i.rotateCard(),i.onRender(),requestAnimationFrame(t)};t()};var yU=["rendererContainer"],o9=(()=>{let e=class e{constructor(n){this._sceneGraphService=n,this.rendererContainer=null,this.majorFace="front",this.isEditing=!1}ngOnInit(){}ngAfterViewInit(){this._sceneGraphService.nativeElement=this.rendererContainer.nativeElement,this._sceneGraphService.initThree()}ngOnDestroy(){this._sceneGraphService.destroy()}};e.\u0275fac=function(r){return new(r||e)(en(pl))},e.\u0275cmp=Qt({type:e,selectors:[["app-mobile-ticket-viewer"]],viewQuery:function(r,s){if(r&1&&jt(yU,5),r&2){let o;Lt(o=Ut())&&(s.rendererContainer=o.first)}},standalone:!0,features:[nn],decls:2,vars:0,consts:[["rendererContainer",""],["id","viewport"]],template:function(r,s){r&1&&Ct(0,"div",1,0)},styles:["#viewport[_ngcontent-%COMP%]{width:100%;height:100%}"]});let i=e;return i})();function CU(i,e){if(i&1&&Ct(0,"img",3),i&2){let t=Xe();ke("src",t.buttonElement.imgSrc,Yi)("height",t.heightSize)}}function _U(i,e){if(i&1&&(be(0,"div",4),Zi(1),Ie()),i&2){let t=Xe();yt("font-size",t.heightSize,"px")("color",t.highContrast?"#f0f0f0":"black"),me(),Er(" ",t.buttonElement.label," ")}}var hp=(()=>{let e=class e{constructor(){this.heightSize=20,this.buttonElement=null,this.type="img",this.highContrast=!1,this.onClickEvent=new Bt}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=Qt({type:e,selectors:[["app-simple-button"]],inputs:{heightSize:"heightSize",buttonElement:"buttonElement",type:"type",highContrast:"highContrast"},outputs:{onClickEvent:"onClickEvent"},standalone:!0,features:[nn],decls:3,vars:2,consts:[["id","simple-button",3,"click"],[3,"src","height",4,"ngIf"],["id","text-div",3,"font-size","color",4,"ngIf"],[3,"src","height"],["id","text-div"]],template:function(r,s){r&1&&(be(0,"div",0),Nt("click",function(){return s.onClickEvent.emit()}),tn(1,CU,1,2,"img",1)(2,_U,2,5,"div",2),Ie()),r&2&&(me(),ke("ngIf",s.type==="img"),me(),ke("ngIf",s.type==="text"))},dependencies:[Cr],styles:["#simple-button[_ngcontent-%COMP%]{margin:10px;display:flex;justify-content:center;align-items:center;border-radius:5px}#simple-button[_ngcontent-%COMP%]:hover{cursor:pointer}#text-div[_ngcontent-%COMP%]{text-align:center}"]});let i=e;return i})();var AU=["toggleButton"];function wU(i,e){if(i&1){let t=qn();be(0,"div",8,1),Nt("click",function(){zt(t);let r=Xe().$implicit,s=Xe(2);return Ht(s.onClickToggleButton(r.value))}),Ct(2,"img",9),Ie()}if(i&2){let t=Xe().$implicit,n=Xe(2);yt("width",n.outerSize)("height",n.outerSize),me(2),ke("src",n.getImgSrc(t.imgSrc,t.value),Yi)("width",n.innerSize)("height",n.innerSize)}}function bU(i,e){if(i&1&&(be(0,"h4"),Zi(1),Ie()),i&2){let t=Xe().$implicit,n=Xe(2);yt("width",n.innerSize+10,"px"),me(),Hl(t.label)}}function DU(i,e){if(i&1&&(Do(0,5),be(1,"div"),tn(2,wU,3,7,"div",6)(3,bU,2,3,"h4",7),Ie(),So()),i&2){let t=e.$implicit,n=Xe(2);me(2),ke("ngIf",t.value!==n.noneStatusValue),me(),ke("ngIf",!1)}}function SU(i,e){if(i&1&&(Do(0),tn(1,DU,4,2,"ng-container",4),So()),i&2){let t=e.$implicit;me(),ke("ngForOf",t)}}var a9=(()=>{let e=class e{constructor(){this.buttons=null,this.elements=[],this.selectedValues=[],this.noneStatusValue=-1,this.outerSize="40px",this.innerSize=20,this.enableMultipleSelection=!1,this.columnNum=10,this.isLabelVisible=!0,this.onClickToggleButtonEvent=new Bt,this.modifiedElements=[]}ngOnInit(){let n=[];for(let r=0;r<this.elements.length;r+=this.columnNum)n.push(this.elements.slice(r,r+this.columnNum));this.modifiedElements=n}ngAfterViewInit(){let n=this.buttons.toArray();for(let r of this.selectedValues)n[r].nativeElement.classList.add("selected")}onClickToggleButton(n){let r=this.buttons.toArray();if(this.enableMultipleSelection)this.selectedValues.includes(n)?(r[n].nativeElement.classList.remove("selected"),this.selectedValues.splice(this.selectedValues.indexOf(n),1)):(r[n].nativeElement.classList.add("selected"),this.selectedValues.push(n));else{if(this.selectedValues.includes(n))return;for(let s in r)Number(s)!==n?r[Number(s)].nativeElement.classList.remove("selected"):r[n].nativeElement.classList.add("selected");this.selectedValues=[n]}this.onClickToggleButtonEvent.emit(n)}setUnselectedStatus(){let n=this.buttons.toArray();for(let r in n)n[Number(r)].nativeElement.classList.remove("selected");this.selectedValues=[],this.onClickToggleButtonEvent.emit(this.noneStatusValue)}getImgSrc(n,r){let s=n;return this.selectedValues.includes(r)&&(s=s.replace(".png","_selected.png")),s}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=Qt({type:e,selectors:[["app-circle-toggle-button-group"]],viewQuery:function(r,s){if(r&1&&jt(AU,5),r&2){let o;Lt(o=Ut())&&(s.buttons=o)}},inputs:{elements:"elements",selectedValues:"selectedValues",noneStatusValue:"noneStatusValue",outerSize:"outerSize",innerSize:"innerSize",enableMultipleSelection:"enableMultipleSelection",columnNum:"columnNum",isLabelVisible:"isLabelVisible"},outputs:{onClickToggleButtonEvent:"onClickToggleButtonEvent"},standalone:!0,features:[nn],decls:3,vars:1,consts:[["toggleButtonContainer",""],["toggleButton",""],["id","container"],[4,"ngFor","ngForOf"],["class","color-row",4,"ngFor","ngForOf"],[1,"color-row"],["class","toggle-button",3,"width","height","click",4,"ngIf"],[3,"width",4,"ngIf"],[1,"toggle-button",3,"click"],[3,"src","width","height"]],template:function(r,s){r&1&&(be(0,"div",2,0),tn(2,SU,2,1,"ng-container",3),Ie()),r&2&&(me(2),ke("ngForOf",s.modifiedElements))},dependencies:[yr,Cr],styles:["#container[_ngcontent-%COMP%]{display:flex}#container[_ngcontent-%COMP%]::-webkil-scrollbar{display:none}#feature-buttons[_ngcontent-%COMP%]{position:absolute;display:flex;right:0}.toggle-button[_ngcontent-%COMP%]{border-radius:50%;background-color:#efefef;display:flex;justify-content:center;align-items:center;margin:8px;flex:0 0 auto}.toggle-button[_ngcontent-%COMP%]:hover{cursor:pointer}.selected[_ngcontent-%COMP%]{background-color:#000!important}.color-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-evenly;margin-bottom:10px}"]});let i=e;return i})();var MU=["toggleButton"];function TU(i,e){if(i&1){let t=qn();be(0,"div",6,1),Nt("click",function(){let r=zt(t).$implicit,s=Xe(2);return Ht(s.onClickToggleButton(r.value))}),Ct(2,"div",7),Ie()}if(i&2){let t=e.$implicit,n=Xe(2);yt("width",n.outerSize)("height",n.outerSize),me(2),yt("background-color",t.color)("width",n.innerSize)("height",n.innerSize)}}function FU(i,e){if(i&1&&(be(0,"div")(1,"div",4),tn(2,TU,3,10,"div",5),Ie()()),i&2){let t=e.$implicit;me(2),ke("ngForOf",t)}}var ch=class{constructor(){this.BLACK={color:"#000000",value:Rn.BLACK},this.WHITE={color:"#FFFFFF",value:Rn.WHITE},this.RED={color:"#FF0000",value:Rn.RED},this.GREEN={color:"#00FF00",value:Rn.GREEN},this.BLUE={color:"#0000FF",value:Rn.BLUE},this.YELLOW={color:"#FFFF00",value:Rn.YELLOW},this.CYAN={color:"#00FFFF",value:Rn.CYAN},this.MAGENTA={color:"#FF00FF",value:Rn.MAGENTA},this.GRAY={color:"#808080",value:Rn.GRAY},this.LIGHT_GRAY={color:"#C0C0C0",value:Rn.LIGHT_GRAY},this.DARK_GRAY={color:"#A9A9A9",value:Rn.DARK_GRAY},this.ORANGE={color:"#FFA500",value:Rn.ORANGE},this.PINK={color:"#FFC0CB",value:Rn.PINK},this.PURPLE={color:"#800080",value:Rn.PURPLE},this.BROWN={color:"#A52A2A",value:Rn.BROWN},this.SSALON={color:"#006BFF",value:Rn.SSALON},this.SsalonColors=[this.BLACK,this.WHITE,this.RED,this.GREEN,this.BLUE,this.YELLOW,this.CYAN,this.MAGENTA,this.GRAY,this.LIGHT_GRAY,this.DARK_GRAY,this.ORANGE,this.PINK,this.PURPLE,this.BROWN,this.SSALON]}getColorByValue(e){return this.SsalonColors.find(t=>t.value===e).color}getSsalonColorObjectByValue(e){return this.SsalonColors.find(t=>t.value===e)}getSsalonColorObjectByColor(e){return this.SsalonColors.find(t=>t.color===e)}},Rn=function(i){return i[i.BLACK=0]="BLACK",i[i.WHITE=1]="WHITE",i[i.RED=2]="RED",i[i.GREEN=3]="GREEN",i[i.BLUE=4]="BLUE",i[i.YELLOW=5]="YELLOW",i[i.CYAN=6]="CYAN",i[i.MAGENTA=7]="MAGENTA",i[i.GRAY=8]="GRAY",i[i.LIGHT_GRAY=9]="LIGHT_GRAY",i[i.DARK_GRAY=10]="DARK_GRAY",i[i.ORANGE=11]="ORANGE",i[i.PINK=12]="PINK",i[i.PURPLE=13]="PURPLE",i[i.BROWN=14]="BROWN",i[i.SSALON=15]="SSALON",i}(Rn||{}),c9=(()=>{let e=class e{constructor(){this.buttons=null,this.selectedValue=0,this.noneStatusValue=0,this.outerSize="30px",this.innerSize="20px",this.columnNum=10,this.onClickToggleButtonEvent=new Bt,this.ssalonColor=new ch,this.modifiedSsalonColors=[]}ngOnInit(){for(var n=[],r=0;r<this.ssalonColor.SsalonColors.length;r+=this.columnNum)n.push(this.ssalonColor.SsalonColors.slice(r,r+this.columnNum));this.modifiedSsalonColors=n}ngAfterViewInit(){this.buttons.toArray()[this.selectedValue].nativeElement.classList.add("selected")}onClickToggleButton(n){let r=this.buttons.toArray();if(this.selectedValue!==n){for(let s in r)Number(s)!==n?r[Number(s)].nativeElement.classList.remove("selected"):r[n].nativeElement.classList.add("selected");this.selectedValue=n,this.onClickToggleButtonEvent.emit(n)}}getImgSrc(n,r){let s=n;return this.selectedValue===r&&(s=s.replace(".png","_selected.png")),s}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=Qt({type:e,selectors:[["app-color-board"]],viewQuery:function(r,s){if(r&1&&jt(MU,5),r&2){let o;Lt(o=Ut())&&(s.buttons=o)}},inputs:{selectedValue:"selectedValue",noneStatusValue:"noneStatusValue",outerSize:"outerSize",innerSize:"innerSize",columnNum:"columnNum"},outputs:{onClickToggleButtonEvent:"onClickToggleButtonEvent"},standalone:!0,features:[nn],decls:3,vars:1,consts:[["toggleButtonContainer",""],["toggleButton",""],["id","container"],[4,"ngFor","ngForOf"],[1,"color-row"],["class","color-back",3,"width","height","click",4,"ngFor","ngForOf"],[1,"color-back",3,"click"],[1,"color-circle"]],template:function(r,s){r&1&&(be(0,"div",2,0),tn(2,FU,3,1,"div",3),Ie()),r&2&&(me(2),ke("ngForOf",s.modifiedSsalonColors))},dependencies:[yr],styles:[".color-back[_ngcontent-%COMP%]{width:25px;height:25px;border-radius:50%;background-color:#efefef;display:flex;justify-content:center;align-items:center}.color-back[_ngcontent-%COMP%]:hover{cursor:pointer}.color-circle[_ngcontent-%COMP%]{width:20px;height:20px;border-radius:50%}.color-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-evenly;margin-bottom:10px}.selected[_ngcontent-%COMP%]{background-color:#006bff!important}"]});let i=e;return i})();var BU=["toggleButton"];function IU(i,e){if(i&1){let t=qn();be(0,"div",4,1),Nt("click",function(){let r=zt(t).$implicit,s=Xe();return Ht(s.onClickToggleButton(r.value))}),Zi(2),Ie()}if(i&2){let t=e.$implicit,n=Xe();yt("width",n.buttonWidth)("font-family",t.imgSrc),me(2),Er(" ",t.label,"")}}var l9=(()=>{let e=class e{constructor(){this.buttons=null,this.elements=[],this.selectedValue=0,this.onClickToggleButtonEvent=new Bt,this.buttonWidth="30%"}ngOnInit(){this.buttonWidth=`${100/this.elements.length}%`}ngAfterViewInit(){this.buttons.toArray()[this.selectedValue].nativeElement.classList.add("selected")}onClickToggleButton(n){if(this.selectedValue===n)return;let r=this.buttons.toArray();for(let s in r)Number(s)!==n?r[Number(s)].nativeElement.classList.remove("selected"):r[n].nativeElement.classList.add("selected");this.selectedValue=n,this.onClickToggleButtonEvent.emit(this.elements[n].imgSrc)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=Qt({type:e,selectors:[["app-simple-toggle-button-group"]],viewQuery:function(r,s){if(r&1&&jt(BU,5),r&2){let o;Lt(o=Ut())&&(s.buttons=o)}},inputs:{elements:"elements",selectedValue:"selectedValue"},outputs:{onClickToggleButtonEvent:"onClickToggleButtonEvent"},standalone:!0,features:[nn],decls:3,vars:1,consts:[["toggleButtonContainer",""],["toggleButton",""],[1,"container"],["class","toggle-button",3,"width","font-family","click",4,"ngFor","ngForOf"],[1,"toggle-button",3,"click"]],template:function(r,s){r&1&&(be(0,"div",2,0),tn(2,IU,3,5,"div",3),Ie()),r&2&&(me(2),ke("ngForOf",s.elements))},dependencies:[yr],styles:[".container[_ngcontent-%COMP%]{width:auto;display:flex;flex-direction:row;overflow-x:auto}.toggle-button[_ngcontent-%COMP%]{height:100%;min-width:50px;display:flex;justify-content:center;align-items:center;border-radius:5px;margin:5px;color:#efefef;background-color:transparent}.toggle-button[_ngcontent-%COMP%]:hover{cursor:pointer}.selected[_ngcontent-%COMP%]{background-color:#0090f2}"]});let i=e;return i})();var PU=["editFeatureButtons"],RU=["backgroundPath"],OU=["textEditInput"],kU=["drawCanvas"],NU=["selectedPhotoContainer"],LU=i=>[i];function UU(i,e){if(i&1){let t=qn();be(0,"div"),Ll(),be(1,"svg",18),Ct(2,"path",19,2),Ie(),Ul(),be(4,"app-color-board",20),Nt("onClickToggleButtonEvent",function(r){zt(t);let s=Xe();return Ht(s.changeBackgroundColor(r))}),Ie()()}if(i&2){let t=Xe();me(4),ke("outerSize","30px")("innerSize","24px")("selectedValue",t.backgroundColor.value)}}function VU(i,e){if(i&1){let t=qn();be(0,"div")(1,"div",21,3)(3,"textarea",22,4),Nt("input",function(r){zt(t);let s=Xe();return Ht(s.onChangeSsalonTextAttribute("text",r))}),Ie()(),be(5,"div",23)(6,"app-circle-toggle-button-group",24),Nt("onClickToggleButtonEvent",function(r){zt(t);let s=Xe();return Ht(s.onChangeSsalonTextAttribute("textAlign",r))}),Ie()(),be(7,"app-simple-toggle-button-group",25),Nt("onClickToggleButtonEvent",function(r){zt(t);let s=Xe();return Ht(s.onChangeSsalonTextAttribute("fontFamily",r))}),Ie(),be(8,"app-color-board",20),Nt("onClickToggleButtonEvent",function(r){zt(t);let s=Xe();return Ht(s.onChangeSsalonTextAttribute("color",r))}),Ie()()}if(i&2){let t=Xe();me(3),yt("text-align",t.ssalonTextAttribute.textAlign)("color",t.ssalonTextAttribute.color)("font-family",t.ssalonTextAttribute.fontFamily),me(2),yt("justify-content","center"),me(),ke("elements",t.textAlignButtons)("outerSize","30px")("selectedValues",tA(15,LU,t.getSsalonTextEnumByString(t.ssalonTextAttribute.textAlign))),me(),ke("elements",t.fonts),me(),ke("outerSize","30px")("innerSize","24px")("selectedValue",t.ssalonColor.getSsalonColorObjectByColor(t.ssalonTextAttribute.color).value)}}function zU(i,e){i&1&&(be(0,"div",26),Ct(1,"img",27,5),Ie())}function HU(i,e){if(i&1){let t=qn();be(0,"div")(1,"div",31),Nt("click",function(){let r=zt(t).$implicit,s=Xe(3);return Ht(s.selectSticker(r.value))}),Ct(2,"img",32),Ie()()}if(i&2){let t=e.$implicit;me(),yt("width","100px")("height","150px"),me(),ke("src",t.imgSrc,Yi)}}function jU(i,e){if(i&1&&(be(0,"div"),tn(1,HU,3,5,"div",30),Ie()),i&2){let t=e.$implicit;yt("display","flex")("justify-content","space-evenly")("margin-bottom","20px"),me(),ke("ngForOf",t)}}function GU(i,e){if(i&1&&(be(0,"div",28,6),tn(2,jU,2,7,"div",29),Ie()),i&2){let t=Xe();me(2),ke("ngForOf",t.getStickerArray())}}function WU(i,e){if(i&1){let t=qn();be(0,"div"),Ll(),be(1,"svg",18),Ct(2,"path",19,2),be(4,"foreignObject",33),Ul(),Ct(5,"canvas",34,7),Ie()(),be(7,"app-color-board",35),Nt("onClickToggleButtonEvent",function(r){zt(t);let s=Xe();return Ht(s.onChangeSsalonTextAttribute("color",r))}),Ie()()}i&2&&(me(7),ke("outerSize","30px")("innerSize","24px"))}var At=function(i){return i[i.BACKGROUND_COLOR_CHANGE=0]="BACKGROUND_COLOR_CHANGE",i[i.PHOTO=1]="PHOTO",i[i.STICKER=2]="STICKER",i[i.TEXT=3]="TEXT",i[i.DRAW=4]="DRAW",i[i.NONE=5]="NONE",i}(At||{}),hr=function(i){return i[i.LEFT=0]="LEFT",i[i.CENTER=1]="CENTER",i[i.RIGHT=2]="RIGHT",i}(hr||{}),u9=(()=>{let e=class e{constructor(n,r){this._apiExecutorService=n,this._sceneGraphService=r,this.editFeatureButtons=null,this.backgroundPath=null,this.textEditInput=null,this.drawCanvas=null,this.selectedPhotoContainer=null,this.onChangeViewer=new Bt,this.onObjectEditEnded=new Bt,this.onBackgroundColorEditEnded=new Bt,this.onClickPreview=new Bt,this.editMode=At.NONE,this.ssalonColor=new ch,this.mobileTicketEditMode=At,this.goBackButtonElement={imgSrc:"assets/icons/go-back.png",label:"\uB4A4\uB85C\uAC00\uAE30",value:0},this.previewButtonElement={imgSrc:"assets/icons/view.png",label:"\uBBF8\uB9AC\uBCF4\uAE30",value:0},this.completeButtonElement={imgSrc:"",label:"\uC644\uB8CC",value:0},this.editFeatures=[{imgSrc:"assets/icons/color-board.png",label:"\uBBF8\uB9AC\uBCF4\uAE30 \uBDF0",value:At.BACKGROUND_COLOR_CHANGE},{imgSrc:"assets/icons/photo.png",label:"\uC0AC\uC9C4",value:At.PHOTO},{imgSrc:"assets/icons/sticker.png",label:"\uC2A4\uD2F0\uCEE4",value:At.STICKER},{imgSrc:"assets/icons/text.png",label:"\uD14D\uC2A4\uD2B8",value:At.TEXT},{imgSrc:"assets/icons/draw.png",label:"\uADF8\uB9AC\uAE30",value:At.DRAW},{imgSrc:"assets/icons/view.png",label:"\uADF8\uB9AC\uAE30",value:At.NONE}],this._backgroundColorViewLoaded=!1,this.stickers=[],this.editingSticker=null,this.editingStickerSrc="",this.textFocused=!1,this.textAlign="left",this.textAlignButtons=[{imgSrc:"assets/text-aligns/textalign-left.png",label:"\uC88C",value:hr.LEFT},{imgSrc:"assets/text-aligns/textalign-center.png",label:"\uC911",value:hr.CENTER},{imgSrc:"assets/text-aligns/textalign-right.png",label:"\uC6B0",value:hr.RIGHT}],this.fonts=[{imgSrc:"Ariel",label:"Aa",value:0},{imgSrc:"Josefin Sans",label:"Aa",value:1},{imgSrc:"Jersey 15",label:"Aa",value:2},{imgSrc:"Roboto",label:"Aa",value:3},{imgSrc:"Jacquarda Bastarda 9 Charted",label:"Aa",value:4}],this.fontFamily="Josefin Sans",this.isTextAddMode=!0,this.textColor=this.ssalonColor.WHITE,this.editingText=null,this.colorBoard=[],this.drawingFabricCanvas=null,this._isDrawing=!1,this._drawingPoints=[],this._isDrawingFabricCanvasLoaded=!1,this.drawingFabricPaths=[],this.backgroundColor=this.ssalonColor.LIGHT_GRAY,this.ssalonTextAttribute={text:"",fontFamily:"Josefin Sans",color:"#FFFFFF",textAlign:"left"},this.ssalonPhotoAttribute={src:[]},this.ssalonStickerAttribute={src:[]},this.ssalonPathAttribute={color:"#FFFFFF",strokeWidth:1},this.fabricObjects=[],this.lastUsedFeature=At.NONE}ngAfterViewInit(){this.loadDecorationInfo(),this.getStickers()}ngAfterViewChecked(){this.backgroundPath&&!this._backgroundColorViewLoaded&&(this.backgroundPath.nativeElement.setAttribute("fill",this.backgroundColor.color),this._backgroundColorViewLoaded=!0),this.textEditInput&&!this.textFocused&&(this.fabricObjects.length===1&&(this.textEditInput.nativeElement.value=this.ssalonTextAttribute.text),this.textEditInput.nativeElement.focus(),this.textFocused=!0),this.drawCanvas&&!this._isDrawingFabricCanvasLoaded&&(this.initDrawingCanvas(),this._isDrawingFabricCanvasLoaded=!0)}loadDecorationInfo(){return He(this,null,function*(){let n=yield this._apiExecutorService.getTicket();this.backgroundColor=this.ssalonColor.getSsalonColorObjectByColor(n.backgroundColor),this.onBackgroundColorEditEnded.emit(this.backgroundColor.color)})}onClickChangeEditMode(n){switch(n){case At.BACKGROUND_COLOR_CHANGE:break;case At.PHOTO:let r=document.createElement("input");r.type="file",r.accept="image/*",r.onchange=function(){if(r.files&&r.files[0]){let s=new FileReader;s.onload=(function(o){let a=document.getElementById("selected-photo-container");a.src=o.target.result,a.width=200}).bind(this),s.readAsDataURL(r.files[0])}},r.click();break;case At.STICKER:break;case At.TEXT:this.textFocused=!1;break;case At.DRAW:break;case At.NONE:break}this.editMode=n,this.onChangeViewer.emit(n)}onClickPreviewButton(){this.onClickPreview.emit()}onClickEndDetailedEditViewer(){this.lastUsedFeature=this.editMode,this.editMode=At.NONE,this.editFeatureButtons.setUnselectedStatus(),this.onChangeViewer.emit(At.NONE),this.onEndEditObject()}changeBackgroundColor(n){this.backgroundPath?.nativeElement.setAttribute("fill",this.ssalonColor.getSsalonColorObjectByValue(n).color),this.backgroundColor=this.ssalonColor.getSsalonColorObjectByValue(n)}getStickers(){["https://test-bukkit-240415.s3.ap-northeast-2.amazonaws.com/sticker/image+1.png?v=0","https://test-bukkit-240415.s3.ap-northeast-2.amazonaws.com/sticker/image+2.png?v=0","https://test-bukkit-240415.s3.ap-northeast-2.amazonaws.com/sticker/image+3.png?v=0","https://test-bukkit-240415.s3.ap-northeast-2.amazonaws.com/sticker/image+4.png?v=0","https://test-bukkit-240415.s3.ap-northeast-2.amazonaws.com/sticker/image+5.png?v=0","https://test-bukkit-240415.s3.ap-northeast-2.amazonaws.com/sticker/image+6.png?v=0","https://test-bukkit-240415.s3.ap-northeast-2.amazonaws.com/sticker/image+8.png?v=0"].forEach((r,s)=>{this.stickers.push({imgSrc:r+"?timestamp="+new Date().getTime(),label:`${s}`,value:s})})}getStickerArray(){let n=[];for(let r=0;r<this.stickers.length;r+=3)n.push(this.stickers.slice(r,r+3));return n}selectSticker(n){this.ssalonStickerAttribute.src.includes(this.stickers[n].imgSrc)?this.ssalonStickerAttribute.src.splice(this.ssalonStickerAttribute.src.indexOf(this.stickers[n].imgSrc),1):this.ssalonStickerAttribute.src.push(this.stickers[n].imgSrc)}syncTextAttributeWithSelectedText(){this.fabricObjects.length===1&&(this.ssalonTextAttribute={text:this.fabricObjects[0].text,fontFamily:this.fabricObjects[0].fontFamily,color:this.fabricObjects[0].fill,textAlign:this.fabricObjects[0].textAlign})}onChangeSsalonTextAttribute(n,r){switch(n){case"text":this.ssalonTextAttribute.text=this.textEditInput.nativeElement.value;break;case"fontFamily":this.ssalonTextAttribute.fontFamily=r;break;case"color":this.ssalonTextAttribute.color=this.ssalonColor.getSsalonColorObjectByValue(r).color;break;case"textAlign":switch(r){case hr.LEFT:this.ssalonTextAttribute.textAlign="left";break;case hr.CENTER:this.ssalonTextAttribute.textAlign="center";break;case hr.RIGHT:this.ssalonTextAttribute.textAlign="right";break}break}}getSsalonTextEnumByString(n){switch(n){case"left":return hr.LEFT;case"center":return hr.CENTER;case"right":return hr.RIGHT;default:return hr.CENTER}}loadImageRecursive(n){return He(this,null,function*(){let r=this.lastUsedFeature===At.PHOTO?this.ssalonPhotoAttribute:this.ssalonStickerAttribute;if(n===r.src.length)this.onObjectEditEnded.emit(this.fabricObjects),this.lastUsedFeature===At.PHOTO?this.ssalonPhotoAttribute.src=[]:this.ssalonStickerAttribute.src=[],this.lastUsedFeature=At.NONE;else{let s=yield Oi.fromURL(r.src[n],{crossOrigin:"anonymous"});this.fabricObjects.push(s),this.loadImageRecursive(n+1)}})}onEndEditObject(){if(this.lastUsedFeature===At.BACKGROUND_COLOR_CHANGE)this.onBackgroundColorEditEnded.emit(this.backgroundColor.color);else{switch(this.lastUsedFeature){case At.PHOTO:return;case At.STICKER:this.loadImageRecursive(0);return;case At.TEXT:this.fabricObjects.length===0?this.fabricObjects.push(new In(this.ssalonTextAttribute.text,{top:100,left:100,fill:this.ssalonTextAttribute.color,textAlign:this.ssalonTextAttribute.textAlign,fontFamily:this.ssalonTextAttribute.fontFamily})):(this.fabricObjects[0].set("text",this.ssalonTextAttribute.text),this.fabricObjects[0].set("fill",this.ssalonTextAttribute.color),this.fabricObjects[0].set("textAlign",this.ssalonTextAttribute.textAlign),this.fabricObjects[0].set("fontFamily",this.ssalonTextAttribute.fontFamily),this.lastUsedFeature=At.NONE);break;case At.DRAW:break;case At.NONE:break}this.onObjectEditEnded.emit(this.lastUsedFeature===At.NONE?null:this.fabricObjects),this.lastUsedFeature=At.NONE}this.fabricObjects=[],this.drawingFabricCanvas?.destroy()}onClickCompletedEditing(){}initDrawingCanvas(){this.drawingFabricCanvas=new kr(this.drawCanvas.nativeElement),this.drawingFabricCanvas.renderAll(),this.drawingFabricCanvas.on("mouse:down",n=>{this._isDrawing=!0,this.addPoint(n.e),this.drawPath()}),this.drawingFabricCanvas.on("mouse:move",n=>{this._isDrawing&&(this.addPoint(n.e),this.drawPath())}),this.drawingFabricCanvas.on("mouse:up",()=>{this._isDrawing=!1,this._drawingPoints.length=0})}addPoint(n){let r=this.drawingFabricCanvas.getPointer(n);this._drawingPoints.push(new We(r.x,r.y))}drawPath(){let n=this._drawingPoints.map(s=>`${s.x} ${s.y}`).join(" "),r=new cs(`M ${n}`,{fill:"transparent",stroke:"white",strokeWidth:2});this.fabricObjects.length=0,this.fabricObjects.push(r),this.drawingFabricCanvas.clear(),this.drawingFabricCanvas.renderAll(),this.drawingFabricCanvas.add(r)}endTicketWebView(){}};e.\u0275fac=function(r){return new(r||e)(en(oo),en(pl))},e.\u0275cmp=Qt({type:e,selectors:[["app-mobile-ticket-editor"]],viewQuery:function(r,s){if(r&1&&(jt(PU,5),jt(RU,5),jt(OU,5),jt(kU,5),jt(NU,5)),r&2){let o;Lt(o=Ut())&&(s.editFeatureButtons=o.first),Lt(o=Ut())&&(s.backgroundPath=o.first),Lt(o=Ut())&&(s.textEditInput=o.first),Lt(o=Ut())&&(s.drawCanvas=o.first),Lt(o=Ut())&&(s.selectedPhotoContainer=o.first)}},outputs:{onChangeViewer:"onChangeViewer",onObjectEditEnded:"onObjectEditEnded",onBackgroundColorEditEnded:"onBackgroundColorEditEnded",onClickPreview:"onClickPreview"},standalone:!0,features:[nn],decls:21,vars:21,consts:[["editFeatureButtons",""],["detailedEditor",""],["backgroundPath",""],["textEditFeatureContainer",""],["textEditInput",""],["selectedPhotoContainer",""],["stickerEditFeatureContainer",""],["drawCanvas",""],[1,"container"],[1,"horizontal-container"],[1,"back-button",3,"onClickEvent","buttonElement","heightSize"],["id","edit-feature-buttons",3,"onClickToggleButtonEvent","elements","innerSize","outerSize","noneStatusValue"],[1,"complete-button",3,"onClickEvent","buttonElement","heightSize","type"],["id","detail-editor",3,"hidden"],[1,"complete-button",3,"onClickEvent","buttonElement","heightSize","type","highContrast"],[4,"ngIf"],["id","photo-edit-feature-container",4,"ngIf"],["id","sticker-edit-feature-container",4,"ngIf"],["width","350","height","600","viewBox","-87.5 -150 525 900","fill","none","xmlns","http://www.w3.org/2000/svg",1,"ticket-background"],["fill-rule","evenodd","clip-rule","evenodd","d","M9.53674e-06 40C9.53674e-06 17.9086 17.9086 0 40 0H310C332.091 0 350 17.9086 350 40L350 451.714C333.431 451.714 320 463.227 320 477.429C320 491.63 333.431 503.143 350 503.143L350 560C350 582.091 332.091 600 310 600H40C17.9086 600 9.53674e-06 582.091 9.53674e-06 560L0 503.143C16.5685 503.143 30 491.63 30 477.429C30 463.227 16.5685 451.714 0 451.714L9.53674e-06 40Z","fill","#D9D9D9"],[1,"color-board",3,"onClickToggleButtonEvent","outerSize","innerSize","selectedValue"],["id","text-edit-feature-container"],["id","text-edit-input","autocomplete","off","type","text",3,"input"],["id","text-align",1,"horizontal-container"],[3,"onClickToggleButtonEvent","elements","outerSize","selectedValues"],[1,"fonts",3,"onClickToggleButtonEvent","elements"],["id","photo-edit-feature-container"],["id","selected-photo-container"],["id","sticker-edit-feature-container"],[3,"display","justify-content","margin-bottom",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"sticker",3,"click"],["width","80px",3,"src"],["width","350","height","600"],["id","draw-canvas","width","350","height","600"],[1,"color-board",3,"onClickToggleButtonEvent","outerSize","innerSize"]],template:function(r,s){if(r&1){let o=qn();be(0,"div",8)(1,"div",9)(2,"div")(3,"app-simple-button",10),Nt("onClickEvent",function(){return zt(o),Ht(s.endTicketWebView())}),Ie()(),be(4,"div")(5,"app-circle-toggle-button-group",11,0),Nt("onClickToggleButtonEvent",function(c){return zt(o),Ht(s.onClickChangeEditMode(c))}),Ie()(),be(7,"div")(8,"app-simple-button",12),Nt("onClickEvent",function(){return zt(o),Ht(s.onClickPreviewButton())}),Ie()()(),be(9,"div",13,1)(11,"div",9)(12,"div")(13,"app-simple-button",10),Nt("onClickEvent",function(){return zt(o),Ht(s.onClickEndDetailedEditViewer())}),Ie()(),be(14,"div")(15,"app-simple-button",14),Nt("onClickEvent",function(){return zt(o),Ht(s.onClickEndDetailedEditViewer())}),Ie()()(),tn(16,UU,5,3,"div",15)(17,VU,9,17,"div",15)(18,zU,3,0,"div",16)(19,GU,3,1,"div",17)(20,WU,8,2,"div",15),Ie()()}r&2&&(me(3),ke("buttonElement",s.goBackButtonElement)("heightSize",36),me(2),ke("elements",s.editFeatures)("innerSize",20)("outerSize","36px")("noneStatusValue",s.mobileTicketEditMode.NONE),me(3),ke("buttonElement",s.previewButtonElement)("heightSize",15)("type","text"),me(),ke("hidden",s.editMode===s.mobileTicketEditMode.NONE),me(4),ke("buttonElement",s.goBackButtonElement)("heightSize",40),me(2),ke("buttonElement",s.completeButtonElement)("heightSize",15)("type","text")("highContrast",!0),me(),ke("ngIf",s.editMode===s.mobileTicketEditMode.BACKGROUND_COLOR_CHANGE),me(),ke("ngIf",s.editMode===s.mobileTicketEditMode.TEXT),me(),ke("ngIf",s.editMode===s.mobileTicketEditMode.PHOTO),me(),ke("ngIf",s.editMode===s.mobileTicketEditMode.STICKER),me(),ke("ngIf",s.editMode===s.mobileTicketEditMode.DRAW))},dependencies:[hp,l9,a9,c9,yr,Cr],styles:[".editor-button[_ngcontent-%COMP%]{width:50px;height:50px;margin:10px}.feature-button-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;width:100%}.container[_ngcontent-%COMP%]{width:100%;height:100%;position:relative}.horizontal-container[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:row;justify-content:space-between;align-items:center}#detail-editor[_ngcontent-%COMP%]{position:fixed;top:0;left:0;background-color:#000000e6;width:100%;height:100%}#text-edit-input[_ngcontent-%COMP%]{font-size:30px;font-family:Courier New,Courier,monospace;-webkit-text-size-adjust:100%;background-color:transparent;caret-color:#006bff;color:#efefef;width:70%;height:400px;border:none;outline:none;text-align:center}#text-edit-feature-container[_ngcontent-%COMP%]{position:absolute;width:100%;top:30%;left:50%;transform:translate(-50%,-30%);display:flex;justify-content:center}.fonts[_ngcontent-%COMP%]{position:absolute;bottom:120px;left:0;width:100%;height:20px}.color-board[_ngcontent-%COMP%]{position:absolute;width:100%;bottom:20px}#text-align[_ngcontent-%COMP%]{position:absolute;bottom:180px;left:0;width:100%}#preview[_ngcontent-%COMP%]{position:absolute;top:0;right:0}.sticker[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.sticker[_ngcontent-%COMP%]:hover{cursor:pointer}.selected[_ngcontent-%COMP%]{border:2px solid #006BFF}.ticket-background[_ngcontent-%COMP%]{position:absolute;top:0;left:50%;transform:translate(-50%)}#sticker-edit-feature-container[_ngcontent-%COMP%]{overflow-y:auto;height:100%}#selected-photo-container[_ngcontent-%COMP%]{position:absolute;width:200px;top:40%;left:50%;transform:translate(-50%,-30%);display:flex;justify-content:center}"]});let i=e;return i})();var $U=Math.PI/180,GK=180/Math.PI;function h9(i){return i*$U}var XU=["backgroundPath"],qU=["editCanvas"],d9=(()=>{let e=class e{constructor(n){this._apiExecutorService=n,this.backgroundPath=null,this.editCanvas=null,this.onClickText=new Bt,this.canvas=null,this.isCursorDown=!1}ngOnInit(){}ngAfterViewInit(){this.initFabric()}initFabric(){return He(this,null,function*(){this.canvas=new kr(this.editCanvas?.nativeElement),this.canvas.selection=!1,this.canvas.on("mouse:down",n=>{n.target!==null&&n.target instanceof In&&(this.isCursorDown=!0)}),this.canvas.on("mouse:up",n=>{n.target!==null&&n.target instanceof In&&(this.isCursorDown&&this.onClickText?.emit(n.target),this.isCursorDown=!1)}),this.canvas.on("object:moving",n=>{this.isCursorDown=!1}),this.canvas.on("object:scaling",n=>{this.isCursorDown=!1}),this.canvas.on("object:rotating",n=>{this.isCursorDown=!1}),yield this.loadDecorationInfo()})}addRemoveIconToControl(){var n="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='utf-8'%3F%3E%3C!DOCTYPE svg PUBLIC '-//W3C//DTD SVG 1.1//EN' 'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3E%3Csvg version='1.1' id='Ebene_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' x='0px' y='0px' width='595.275px' height='595.275px' viewBox='200 215 230 470' xml:space='preserve'%3E%3Ccircle style='fill:%23F44336;' cx='299.76' cy='439.067' r='218.516'/%3E%3Cg%3E%3Crect x='267.162' y='307.978' transform='matrix(0.7071 -0.7071 0.7071 0.7071 -222.6202 340.6915)' style='fill:white;' width='65.545' height='262.18'/%3E%3Crect x='266.988' y='308.153' transform='matrix(0.7071 0.7071 -0.7071 0.7071 398.3889 -83.3116)' style='fill:white;' width='65.544' height='262.179'/%3E%3C/g%3E%3C/svg%3E",r=document.createElement("img");r.src=n,console.log(un.prototype),un.prototype.controls.deleteControl=new Hn({x:.5,y:-.5,offsetY:16,cursorStyle:"pointer",mouseUpHandler:s,render:o});function s(a,c){var l=c.target,u=l.canvas;u.remove(l),u.requestRenderAll()}function o(a,c,l,u,h){var d=20;a.save(),a.translate(c,l),a.rotate(h9(h.angle)),a.drawImage(r,-d/2,-d/2,d,d),a.restore()}}loadDecorationInfo(){return He(this,null,function*(){let n=yield this._apiExecutorService.getTicket();yield this.canvas?.loadFromJSON(n.fabric),this.canvas?.renderAll()})}updateCanvas(n){if(console.log(this.canvas?.toJSON()),n!==null)for(let r=0;r<n.length;r++)this.canvas?.add(n[r]);this.canvas?.renderAll()}getCanvasCapture(){return this.canvas?.toDataURL({format:"png",multiplier:2,enableRetinaScaling:!0})}updateBackgroundColor(n){this.backgroundPath?.nativeElement.setAttribute("fill",n)}};e.\u0275fac=function(r){return new(r||e)(en(oo))},e.\u0275cmp=Qt({type:e,selectors:[["app-mobile-ticket-edit-viewer"]],viewQuery:function(r,s){if(r&1&&(jt(XU,5),jt(qU,5)),r&2){let o;Lt(o=Ut())&&(s.backgroundPath=o.first),Lt(o=Ut())&&(s.editCanvas=o.first)}},outputs:{onClickText:"onClickText"},standalone:!0,features:[nn],decls:7,vars:0,consts:[["backgroundPath",""],["editCanvas",""],[1,"container"],["width","350","height","600","viewBox","0 0 350 600","fill","none","xmlns","http://www.w3.org/2000/svg",1,"ticket-view-elements"],["fill-rule","evenodd","clip-rule","evenodd","d","M0 40C0 17.9086 17.9086 0 40 0H310C332.091 0 350 17.9086 350 40V425C336.193 425 325 436.193 325 450C325 463.807 336.193 475 350 475V560C350 582.091 332.091 600 310 600H40C17.9086 600 0 582.091 0 560V475C13.8071 475 25 463.807 25 450C25 436.193 13.8071 425 0 425V40Z","fill","#D9D9D9"],["width","100%","height","100%"],["width","350","height","600"]],template:function(r,s){r&1&&(be(0,"div",2),Ll(),be(1,"svg",3),Ct(2,"path",4,0),be(4,"foreignObject",5),Ul(),Ct(5,"canvas",6,1),Ie()()())},styles:[".ticket-view-elements[_ngcontent-%COMP%]{width:350px;height:600px}.container[_ngcontent-%COMP%]{display:flex;justify-content:center;height:100%;width:100%}"]});let i=e;return i})();var E9=Vy(f9()),y9=Vy(g9());var YU=["circleStatus"];function ZU(i,e){if(i&1&&(be(0,"div",10),Zi(1),Ie()),i&2){let t=Xe().$implicit,n=Xe(2);yt("width",n.outerSize*2,"px"),me(),Er(" ",t.label,"")}}function KU(i,e){if(i&1&&(Do(0,5),be(1,"div",6)(2,"div",7),Ct(3,"img",8,1),Ie(),tn(5,ZU,2,3,"div",9),Ie(),So()),i&2){let t=e.$implicit,n=Xe(2);me(2),yt("width",n.outerSize+3,"px")("height",n.outerSize+3,"px")("background-color",n.getBorderColor(t.status)),me(),ke("src",t.imgSrc,Yi)("width",n.outerSize)("height",n.outerSize),me(2),ke("ngIf",n.isLabelVisible)}}function JU(i,e){if(i&1&&(Do(0),tn(1,KU,6,10,"ng-container",4),So()),i&2){let t=e.$implicit;me(),ke("ngForOf",t)}}var v9=(()=>{let e=class e{constructor(){this.buttons=null,this.elements=[],this.outerSize=40,this.columnNum=10,this.isLabelVisible=!0,this.onClickToggleButtonEvent=new Bt,this.modifiedElements=[]}ngOnInit(){let n=[];for(let r=0;r<this.elements.length;r+=this.columnNum)n.push(this.elements.slice(r,r+this.columnNum));this.modifiedElements=n}ngAfterViewInit(){}changeStatus(n,r){this.elements.find(s=>s.value===n).status=r}getBorderColor(n){return n?"#4DAF50":"#F44336"}};e.\u0275fac=function(r){return new(r||e)},e.\u0275cmp=Qt({type:e,selectors:[["app-circle-toggle-status-group"]],viewQuery:function(r,s){if(r&1&&jt(YU,5),r&2){let o;Lt(o=Ut())&&(s.buttons=o)}},inputs:{elements:"elements",outerSize:"outerSize",columnNum:"columnNum",isLabelVisible:"isLabelVisible"},outputs:{onClickToggleButtonEvent:"onClickToggleButtonEvent"},standalone:!0,features:[nn],decls:3,vars:1,consts:[["toggleButtonContainer",""],["circleStatus",""],["id","container"],[4,"ngFor","ngForOf"],["class","color-row",4,"ngFor","ngForOf"],[1,"color-row"],[1,"status-container"],[1,"img-container"],[1,"circle-status",3,"src","width","height"],["class","nickname-container",3,"width",4,"ngIf"],[1,"nickname-container"]],template:function(r,s){r&1&&(be(0,"div",2,0),tn(2,JU,2,1,"ng-container",3),Ie()),r&2&&(me(2),ke("ngForOf",s.modifiedElements))},dependencies:[yr,Cr],styles:["#container[_ngcontent-%COMP%]{display:flex}#container[_ngcontent-%COMP%]::-webkil-scrollbar{display:none}#feature-buttons[_ngcontent-%COMP%]{position:absolute;display:flex;right:0}.status-container[_ngcontent-%COMP%]{margin:5px;display:flex;flex-direction:column;align-items:center}.circle-status[_ngcontent-%COMP%]{border-radius:50%}.img-container[_ngcontent-%COMP%]{border-radius:50%;background-color:#efefef;border-width:2px;display:flex;justify-content:center;align-items:center;margin:8px;flex:0 0 auto}.nickname-container[_ngcontent-%COMP%]{text-align:center;text-overflow:ellipsis;font-weight:500}.toggle-button[_ngcontent-%COMP%]:hover{cursor:pointer}.selected[_ngcontent-%COMP%]{background-color:#000!important}.color-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-evenly;margin-bottom:10px}"]});let i=e;return i})();var QU=["mobileTicketEditViewer"],eV=["mobileTicketEditor"],tV=["barcodeContainer"],nV=["qrVideo"],iV=["qrCanvas"],rV=["joiningUsersComponent"];function sV(i,e){if(i&1){let t=qn();be(0,"div",11,0)(2,"div",12)(3,"div")(4,"app-simple-button",13),Nt("onClickEvent",function(){zt(t);let r=Xe();return Ht(r.onClickBackButton())}),Ie()()(),be(5,"div"),Ct(6,"app-mobile-ticket-viewer"),Ie()()}if(i&2){let t=Xe();me(2),yt("justify-content","space-between"),me(2),ke("buttonElement",t.goBackButtonElement)("heightSize",36),me(),yt("height","100%")}}function oV(i,e){if(i&1){let t=qn();be(0,"div",11,1)(2,"div")(3,"app-mobile-ticket-edit-viewer",14,2),Nt("onClickText",function(r){zt(t);let s=Xe();return Ht(s.openTextEditor(r))}),Ie()(),be(5,"app-mobile-ticket-editor",15,3),Nt("onChangeViewer",function(r){zt(t);let s=Xe();return Ht(s.changeEditMode(r))})("onClickPreview",function(){zt(t);let r=Xe();return Ht(r.onClickPreviewButton())})("onObjectEditEnded",function(r){zt(t);let s=Xe();return Ht(s.applyEdit(r))})("onBackgroundColorEditEnded",function(r){zt(t);let s=Xe();return Ht(s.applyBackgroundColorEdit(r))}),Ie()()}if(i&2){let t=Xe();me(2),yt("height","100%")("width","100%")("position","absolute")("top","60px")("left","0px"),me(3),yt("position","absolute")("top","0px")("left","0px")("width","100%")("height",t.editMode===t.mobileTicketEditMode.NONE?"60px":"100%")}}function aV(i,e){if(i&1&&(be(0,"div",11,4)(2,"div"),Ct(3,"app-mobile-ticket-viewer"),Ie(),be(4,"div"),Ct(5,"app-simple-button",16),Ie()()),i&2){let t=Xe();me(2),yt("height","100%"),me(3),ke("buttonElement",t.joinButtonElement)}}function cV(i,e){if(i&1&&(be(0,"div",11,5)(2,"div",17),Ct(3,"video",18,6)(5,"canvas",19,7),be(7,"div",20),Ct(8,"img",21),Ie()(),be(9,"div",22)(10,"div",12)(11,"div",23)(12,"div",24),Ct(13,"img",25),Ie(),be(14,"div",26)(15,"div",27),Zi(16),Ie(),be(17,"div",27),Zi(18),Ie()()()(),be(19,"div",28),Ct(20,"app-circle-toggle-status-group",29,8),Ie()()()),i&2){let t=Xe();me(3),yt("width","100%")("height","100%")("object-fit","cover"),me(2),yt("display","none"),me(4),yt("margin-top","30px"),me(),yt("justify-content","center"),me(2),yt("width",52,"px")("height",52,"px"),me(),ke("src",t.checkStatus.checkingUser?t.checkStatus.checkingUser.profilePictureUrl:"assets/data_error.png",Yi),me(2),yt("font-size","20px"),me(),Er(" ",t.checkStatus.checkingUser?t.checkStatus.checkingUser.nickname:"\uC54C\uC218\uC5C6\uC74C",""),me(),yt("color",t.checkStatus.color),me(),Hl(t.checkStatus.text),me(2),ke("elements",t.joiningUsers)}}function lV(i,e){if(i&1&&(be(0,"div",11,9)(2,"div"),Ct(3,"app-mobile-ticket-viewer"),Ie(),be(4,"div",30)(5,"div",31),Ct(6,"img",32),Ie()()()),i&2){let t=Xe();me(2),yt("height","100%"),me(4),ke("src",t.qrCodeSrc,Yi)}}var oi=function(i){return i[i.APPVIEW=0]="APPVIEW",i[i.APPEDITVIEW=1]="APPEDITVIEW",i[i.WEBVIEW=2]="WEBVIEW",i[i.QRCHECKVIEW=3]="QRCHECKVIEW",i[i.QRSHOWVIEW=4]="QRSHOWVIEW",i}(oi||{}),C9=(()=>{let e=class e{constructor(n,r,s){this._apiExecutorService=n,this._ssalonConfigService=r,this._sceneGraphService=s,this.mobileTicketEditViewer=null,this.mobileTicketEditor=null,this.barcodeContainer=null,this.qrVideo=null,this.qrCanvas=null,this.joiningUsersComponent=null,this.mobileTicketViewMode=oi,this.mode=oi.APPEDITVIEW,this.mobileTicketEditMode=At,this.editMode=At.NONE,this.goBackButtonElement={imgSrc:"assets/icons/go-back.png",label:"\uB4A4\uB85C\uAC00\uAE30",value:0},this.joinButtonElement={imgSrc:"assets/icons/view.png",label:"\uCC38\uC5EC\uD558\uAE30",value:0},this.isDetectingQRCode=!1,this.isCameraLoaded=!1,this.qrStream=null,this.qrCodeSrc="",this.joiningUsers=[],this.checkStatus={checkStatus:null,color:"#006BFF",text:"QR\uCF54\uB4DC\uB97C \uC778\uC2DD\uD574\uC8FC\uC138\uC694."}}ngOnInit(){}ngAfterViewInit(){return He(this,null,function*(){this.setFirstPage(),yield this._apiExecutorService.changeAttendanceStatus(4)})}ngAfterViewChecked(){return He(this,null,function*(){this.startQRCodeDetection()})}setFirstPage(){this._ssalonConfigService.VIEW_TYPE==="edit"?this.changeViewMode(oi.APPEDITVIEW):this._ssalonConfigService.VIEW_TYPE==="view"?this.changeViewMode(oi.APPVIEW):this._ssalonConfigService.VIEW_TYPE==="qrcheck"?this.changeViewMode(oi.QRCHECKVIEW):this._ssalonConfigService.VIEW_TYPE==="qrshow"?this.changeViewMode(oi.QRSHOWVIEW):this.changeViewMode(oi.WEBVIEW)}startQRCodeDetection(){return He(this,null,function*(){if(this.qrVideo&&this.qrCanvas&&!this.isCameraLoaded)try{this.isCameraLoaded=!0,this.qrCanvas.nativeElement.setAttribute("willReadFrequently","true"),this.qrStream=yield navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}),console.log("1"),this.qrVideo.nativeElement.srcObject=this.qrStream,console.log("2"),this.qrVideo.nativeElement.play(),console.log("3"),this.detectQRCode()}catch(n){console.error(n)}})}detectQRCode(){return He(this,null,function*(){if(this.qrVideo&&this.qrCanvas)for(;;){if(this.qrVideo.nativeElement.readyState===this.qrVideo.nativeElement.HAVE_ENOUGH_DATA){let n=this.qrCanvas.nativeElement.getContext("2d");this.qrCanvas.nativeElement.height=this.qrVideo.nativeElement.videoHeight,this.qrCanvas.nativeElement.width=this.qrVideo.nativeElement.videoWidth,n?.drawImage(this.qrVideo?.nativeElement,0,0,this.qrCanvas.nativeElement?.width,this.qrCanvas.nativeElement?.height);let r=n?.getImageData(0,0,this.qrCanvas.nativeElement?.width,this.qrCanvas.nativeElement?.height),s=(0,E9.default)(r.data,r.width,r.height);if(s){try{let o=yield this._apiExecutorService.checkQR(s.data);this.checkStatus={checkStatus:o.attendance,checkingUser:{nickname:o.nickname,profilePictureUrl:o.profilePictureUrl,attendance:o.attendance,userId:o.userId},color:"#4DAF50",text:"\uD658\uC601\uD569\uB2C8\uB2E4."},this.checkStatus.checkingUser.attendance&&this.joiningUsersComponent?.changeStatus(this.checkStatus.checkingUser.userId,!0)}catch{this.checkStatus={checkStatus:!1,color:"#F44336",text:"\uCC38\uAC00\uC790\uAC00 \uC544\uB2D9\uB2C8\uB2E4."}}yield new Promise(o=>setTimeout(o,1e3)),this.checkStatus={checkStatus:null,color:"#006BFF",text:"QR\uCF54\uB4DC\uB97C \uC778\uC2DD\uD574\uC8FC\uC138\uC694."}}}yield new Promise(n=>setTimeout(n,100))}})}stopDetectQRCode(){this.qrStream&&(this.qrStream.getTracks().forEach(n=>{n.stop()}),this.isDetectingQRCode=!1,this.isCameraLoaded=!1)}onClickQRCodeButton(){this.isDetectingQRCode?this.stopDetectQRCode():this.changeViewMode(oi.QRCHECKVIEW),this.isDetectingQRCode=!this.isDetectingQRCode}changeEditMode(n){this.editMode=n}changeViewMode(n){return He(this,null,function*(){n===oi.APPVIEW?this.updateServer():n===oi.QRSHOWVIEW?(yield this.setQrCodeImgSrc(),this._sceneGraphService.mobileTicketAutoRotate=!0):n===oi.QRCHECKVIEW&&(yield this._apiExecutorService.getJoiningUsers()).forEach((s,o)=>{this.joiningUsers.push({imgSrc:s.profilePictureUrl,label:s.nickname,value:s.userId,status:s.attendance})}),this.stopDetectQRCode(),this.mode=n})}addFabricObject(n){}onClickBackButton(){this.changeViewMode(oi.APPEDITVIEW)}applyEdit(n){this.mobileTicketEditViewer?.updateCanvas(n)}applyBackgroundColorEdit(n){this.mobileTicketEditViewer?.updateBackgroundColor(n)}onClickPreviewButton(){return He(this,null,function*(){yield this.updateServer(),this.changeViewMode(oi.APPVIEW)})}setQrCodeImgSrc(){return He(this,null,function*(){let n=(0,y9.default)(0,"L");n.addData(yield this._apiExecutorService.getBarcode()),n.make(),this.qrCodeSrc=n.createDataURL(4,0)})}updateServer(){return He(this,null,function*(){if(this.mobileTicketEditViewer!==null&&this.mobileTicketEditor!==null){let o=function(c){for(var l=atob(c.split(",")[1]),u=c.split(",")[0].split(":")[1].split(";")[0],h=new ArrayBuffer(l.length),d=new Uint8Array(h),f=0;f<l.length;f++)d[f]=l.charCodeAt(f);return new Blob([h],{type:u})};var n=o;let r=new FormData,s=this.mobileTicketEditViewer.getCanvasCapture(),a={thumbnailUrl:"image.png",backgroundColor:this.mobileTicketEditor.backgroundColor.color,fabric:this.mobileTicketEditViewer.canvas?.toJSON()};r.append("json",JSON.stringify(a)),r.append("files",o(s),"image.png"),console.log(o(s)),yield this._apiExecutorService.editTicket(r)}})}openTextEditor(n){this.mobileTicketEditor.fabricObjects.push(n),this.mobileTicketEditor.syncTextAttributeWithSelectedText(),this.mobileTicketEditor.onClickChangeEditMode(At.TEXT)}};e.\u0275fac=function(r){return new(r||e)(en(oo),en(so),en(pl))},e.\u0275cmp=Qt({type:e,selectors:[["app-ticket"]],viewQuery:function(r,s){if(r&1&&(jt(QU,5),jt(eV,5),jt(tV,5),jt(nV,5),jt(iV,5),jt(rV,5)),r&2){let o;Lt(o=Ut())&&(s.mobileTicketEditViewer=o.first),Lt(o=Ut())&&(s.mobileTicketEditor=o.first),Lt(o=Ut())&&(s.barcodeContainer=o.first),Lt(o=Ut())&&(s.qrVideo=o.first),Lt(o=Ut())&&(s.qrCanvas=o.first),Lt(o=Ut())&&(s.joiningUsersComponent=o.first)}},standalone:!0,features:[nn],decls:5,vars:5,consts:[["appView",""],["appEditView",""],["mobileTicketEditViewer",""],["mobileTicketEditor",""],["webView",""],["qrCheckView",""],["qrVideo",""],["qrCanvas",""],["joiningUsersComponent",""],["qrShowView",""],["class","container",4,"ngIf"],[1,"container"],[1,"horizontal-container"],[1,"back-button",3,"onClickEvent","buttonElement","heightSize"],[3,"onClickText"],[3,"onChangeViewer","onClickPreview","onObjectEditEnded","onBackgroundColorEditEnded"],[3,"buttonElement"],["id","qr-detector"],["autoplay","","playsInline",""],["id","qr-canvas"],["id","qr-guide-container"],["id","qr-guide","src","assets/qr-guide.png","height","300px"],["id","join-user-container"],["id","qr-checking-user-container"],["id","qr-checking-user-profile-container"],["id","qr-checking-user-profile-img","height","50px",3,"src"],["id","qr-check-info-container"],[1,"qr-check-info"],["id","join-user-list"],[3,"elements"],["id","qrcode-overay"],["id","qrcode-container"],["id","qrcode","alt","\uC774\uBBF8\uC9C0",3,"src"]],template:function(r,s){r&1&&tn(0,sV,7,6,"div",10)(1,oV,7,20,"div",10)(2,aV,6,3,"div",10)(3,cV,22,24,"div",10)(4,lV,7,3,"div",10),r&2&&(ke("ngIf",s.mode===s.mobileTicketViewMode.APPVIEW),me(),ke("ngIf",s.mode===s.mobileTicketViewMode.APPEDITVIEW),me(),ke("ngIf",s.mode===s.mobileTicketViewMode.WEBVIEW),me(),ke("ngIf",s.mode===s.mobileTicketViewMode.QRCHECKVIEW),me(),ke("ngIf",s.mode===s.mobileTicketViewMode.QRSHOWVIEW))},dependencies:[o9,u9,d9,v9,hp,Cr],styles:[".container[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;position:relative}.horizontal-container[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}#qrcode-overay[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute;top:0;left:0;background-color:#000c;display:flex;justify-content:center;align-items:center}#qrcode-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:150px;height:150px;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background-color:#fff;border-radius:10px}#qrcode[_ngcontent-%COMP%]{width:130px;height:130px}#qr-detector[_ngcontent-%COMP%]{width:100%;height:300px;position:relative}#qr-guide-container[_ngcontent-%COMP%]{position:absolute;top:0;width:100%}#qr-guide[_ngcontent-%COMP%]{position:absolute;top:0;left:50%;transform:translate(-50%)}#qr-checking-user-container[_ngcontent-%COMP%]{display:flex;align-items:center}#qr-checking-user-profile-container[_ngcontent-%COMP%]{margin:5px;border-radius:50%;display:flex;justify-content:center;align-items:center}#qr-checking-user-profile-img[_ngcontent-%COMP%]{border-radius:50%}#qr-check-info-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-direction:column;margin-left:20px}.qr-check-info[_ngcontent-%COMP%]{font-family:Pretendard;font-size:17px;margin:5px}#join-user-list[_ngcontent-%COMP%]{margin-top:50px}"]});let i=e;return i})();var uh=(()=>{let e=class e{constructor(n,r){this._route=n,this._ssalonConfigService=r}ngOnInit(){let n=this._route.snapshot.data.data;this._ssalonConfigService.MOIM_ID=n.moimId,this._ssalonConfigService.VIEW_TYPE=n.viewType,this._ssalonConfigService.FACE_TYPE=n.faceType}ngAfterViewInit(){console.log(this._ssalonConfigService)}};e.\u0275fac=function(r){return new(r||e)(en(Ar),en(so))},e.\u0275cmp=Qt({type:e,selectors:[["app-root"]],standalone:!0,features:[nn],decls:1,vars:0,consts:[["id","ticket-component"]],template:function(r,s){r&1&&Ct(0,"app-ticket",0)},dependencies:[C9],styles:["#ticket-component[_ngcontent-%COMP%]{width:100%;height:100%}"]});let i=e;return i})();var _9=(()=>{let e=class e{constructor(){}resolve(n,r){return{moimId:n.queryParams.moimId,viewType:n.queryParams.viewType,faceType:n.queryParams.faceType,qr:n.queryParams.qr}}};e.\u0275fac=function(r){return new(r||e)},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();var A9=[{path:"?moimId=:moimId&viewType=:viewType&faceType=:faceType&qr=:qr",component:uh},{path:"",component:uh,resolve:{data:_9}}];var w9={providers:[dw(A9)]};FA(uh,w9).catch(i=>console.error(i));
